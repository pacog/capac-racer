(this["webpackJsonpcapac-racer"]=this["webpackJsonpcapac-racer"]||[]).push([[0],Array(22).concat([function(e,t,n){},,,,,,,,,,,,,,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFYWFhAAAAQQerqwAAAAJ0Uk5T/wDltzBKAAAAFklEQVR4nGNggIH6/2DwYJQx0hkwAABHzKo6mLcE9gAAAABJRU5ErkJggg=="},,,,,,,function(e,t,n){e.exports=n(84)},,,,,function(e,t,n){},,,,,,,function(e,t,n){},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),i=n.n(c),o=n(17),u=n(18),l=function(){function e(t){var n=t.timeToWait,r=void 0===n?1e4:n,a=t.started,c=void 0!==a&&a;Object(o.a)(this,e),this._timeToWait=r,this._isRunning=c,this._elapsedTime=0}return Object(u.a)(e,[{key:"setTimeToWait",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;e<=0&&(this._timeToWait=Number.MAX_VALUE)}},{key:"notifyTimePassed",value:function(e){this._isRunning&&(this._elapsedTime+=e,this._elapsedTime>=this._timeToWait&&(this._callbackOnEnd(this._timeToWait-this._elapsedTime),this._isRunning=!1))}},{key:"restart",value:function(e){var t=e.callbackOnEnd,n=void 0===t?function(){}:t;this._elapsedTime=0,this._isRunning=!0,this._callbackOnEnd=n}},{key:"pause",value:function(){this._isRunning=!1}},{key:"unpause",value:function(){this._isRunning=!0}},{key:"stop",value:function(){this._isRunning=!1,this._callbackOnEnd=null}},{key:"reset",value:function(){this._elapsedTime=0,this._isRunning=!1,this._callbackOnEnd=null}},{key:"getTimeLeft",value:function(){return Math.max(this._timeToWait-this._elapsedTime,0)}},{key:"getTimePassed",value:function(){return this._elapsedTime}}]),e}(),s=new l({timeToWait:30999}),m=!1,d=0,p=0;function f(e){for(d+=e-p,p=e;d>=1e3/60;)y(1e3/60),d-=1e3/60;requestAnimationFrame(f)}var v=[];function y(e){v.forEach((function(t){return t(e)}))}var h=function(e){v=v.filter((function(t){return e!==t}))},g=function(e){return v=v.concat([e]),function(){h(e)}},b=(n(48),n(1)),E=n(7),N=n(30),O=n(31),S=n(6),x=n(3),k="HUMAN",j="AI",I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.max(Math.min(e,n),t)},P=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},T=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},C=function(e,t){return e.x===t.x&&e.y===t.y},A=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},w=function(e,t){return A(T(e,t))},_=function(e){return{x:Math.round(e.x),y:Math.round(e.y)}},z=function(e,t,n){var r=T(t,e.position),a=A(r);return Object(x.a)({},e,{position:t,speed:r,prevPositions:e.prevPositions.concat(t),turnsSpent:e.turnsSpent+1,maxSpeed:Math.max(a,e.maxSpeed),realTimeUsed:e.realTimeUsed+n})},R=function(e,t,n){var r=Math.floor(t/3);return Object(x.a)({},e,{speed:{x:0,y:0},turnsGrounded:r,crashes:e.crashes+1,turnsSpent:e.turnsSpent+1,realTimeUsed:e.realTimeUsed+n})},M=function(e){return Object(x.a)({},e,{turnsGrounded:Math.max(0,e.turnsGrounded-1),turnsSpent:e.turnsSpent+1})},L=function(e,t){var n=e.checkpointsPassed.slice();return t.sort().forEach((function(e){(0===e||n[e-1])&&(n[e]=!0)})),Object(x.a)({},e,{checkpointsPassed:n})},U="MOVE_TO",D="SET_PLAYERS",G="NOTIFY_COLLISION",W="REDUCE_GROUNDED",F="NOTIFY_VISITED_CHECKPOINTS",H=Object(E.combineReducers)({byId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return t.players.reduce((function(e,t){return Object(x.a)({},e,Object(S.a)({},t.id,Object(x.a)({},Y,{},t)))}),{});case U:return Object(x.a)({},e,Object(S.a)({},t.playerId,z(e[t.playerId],t.position,t.timePassed)));case G:return Object(x.a)({},e,Object(S.a)({},t.playerId,R(e[t.playerId],t.speed,t.timePassed)));case W:return Object(x.a)({},e,Object(S.a)({},t.playerId,M(e[t.playerId])));case F:return Object(x.a)({},e,Object(S.a)({},t.playerId,L(e[t.playerId],t.newCheckpointIndexes)));default:return e}}}),Y={position:{x:0,y:0},speed:{x:0,y:0},prevPositions:[],turnsGrounded:0,checkpointsPassed:[!1],turnsSpent:0,realTimeUsed:0,maxSpeed:0,crashes:0,type:k,levelAI:0};var B,q=H,J=Object(E.combineReducers)({zoom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1?arguments[1]:void 0;return t.type,e},gridSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),V=Symbol("MAIN_MENU"),K=Symbol("GAME"),X=Symbol("CIRCUIT_SELECTION"),Q=Symbol("PLAYERS_SELECTION"),Z=Symbol("HIGH_SCORES"),$=Symbol("CREDITS"),ee=Symbol("LOADING_GAME"),te=Symbol("REPLAY_GAME"),ne=Symbol("TUTORIAL"),re={id:"car",name:"car",dotColor:"#e4223c",dotSize:12,round:"50%",trailColor:"#e4223c",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/car.png")},ae={id:"rocket",name:"rocket",dotColor:"#39c3b6",dotSize:12,round:"50%",trailColor:"#39c3b6",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/rocket.png")},ce={id:"turtle",name:"turtle",dotColor:"#43c830",dotSize:12,round:"50%",trailColor:"#43c830",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/turtle.png")},ie={id:"skull",name:"skull",dotColor:"#9a9e9f",dotSize:12,round:"50%",trailColor:"#9a9e9f",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/skull.png")},oe={id:"clown",name:"clown",dotColor:"#fdfffc",dotSize:12,round:"50%",trailColor:"#fdfffc",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/clown.png")},ue={id:"dancer",name:"dancer",dotColor:"#5c0eab",dotSize:12,round:"50%",trailColor:"#5c0eab",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/dancer.png")},le={id:"panda",name:"panda",dotColor:"#212121",dotSize:12,round:"50%",trailColor:"#212121",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/panda.png")},se={id:"coffin",name:"coffin",dotColor:"#ad7222",dotSize:12,round:"50%",trailColor:"#ad7222",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/coffin.png")},me={id:"broom",name:"broom",dotColor:"#c5db0f",dotSize:12,round:"50%",trailColor:"#c5db0f",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/broom.png")},de={id:"sailboat",name:"sailboat",dotColor:"#016fdf",dotSize:12,round:"50%",trailColor:"#016fdf",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/sailboat.png")},pe=(B={},Object(S.a)(B,re.id,re),Object(S.a)(B,ae.id,ae),Object(S.a)(B,ce.id,ce),Object(S.a)(B,ie.id,ie),Object(S.a)(B,oe.id,oe),Object(S.a)(B,ue.id,ue),Object(S.a)(B,le.id,le),Object(S.a)(B,se.id,se),Object(S.a)(B,me.id,me),Object(S.a)(B,de.id,de),B),fe=function(e){return e&&e.length?e[Math.floor(Math.random()*e.length)]:null},ve=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,r=0;r<n;r+=1){var a=e();if(-1===t.indexOf(a))return a}throw new Error("keepPickingUntilNotInArray: tried ".concat(n," times, no luck"))},ye=["Max","Carlitros","Michael","Fernando","Lol\xedn","Esquizo","Agapito","Tolomeo"],he=["Cucaracha","Aubergine","Tentacles","Rex","Danger","Senna","Alonso","Schumacher","Jander"],ge=function(){return"".concat(fe(ye)," ").concat(fe(he))},be="CHANGE_SCREEN",Ee="SET_SELECTED_CIRCUIT",Ne="SET_SELECTED_PLAYERS",Oe="REMOVE_PLAYER",Se="UPDATE_PLAYER",xe="TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START",ke="TOGGLE_PLAY_WITH_TIMER",je=function(e){return{type:be,screenId:e}},Ie=function(e,t){return{type:Ne,players:e,playerOrder:t}},Pe=function(e,t){return{type:Se,playerId:e,attrsToUpdate:t}},Te=[{id:"DEFAULT_PLAYER",name:ge(),style:fe(Object.values(pe)),type:k,levelAI:0}],Ce=["DEFAULT_PLAYER"],Ae=Object(E.combineReducers)({currentScreen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case be:return t.screenId;default:return e}},selectedCircuit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ee:return t.circuitId;default:return e}},selectedPlayerOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne:return t.playerOrder;case Oe:return e.filter((function(e){return e!==t.playerId}));default:return e}},selectedPlayers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne:return t.players;case Oe:return e.filter((function(e){return e.id!==t.playerId}));case Se:return e.map((function(e){return e.id!==t.playerId?e:Object(x.a)({},e,{},t.attrsToUpdate)}));default:return e}},randomizePlayerOrderOnStart:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case xe:return!e;default:return e}},playWithTimer:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ke:return!e;default:return e}}}),we=Symbol("NOT_STARTED"),_e=Symbol("START_SCREEN"),ze=Symbol("PLAYER_TURN_START_SCREEN"),Re=Symbol("WAITING_FOR_PLAYER_INPUT"),Me=(Symbol("ANIMATING_PLAYER_MOVEMENT"),Symbol("ANIMATING_RANDOM_PLAYER_MOVEMENT")),Le=Symbol("NOTIFY_COLLISION"),Ue=Symbol("NOTIFY_AI_COLLISION"),De=Symbol("NOTIFY_GROUNDED"),Ge=Symbol("NOTIFY_AI_GROUNDED"),We=Symbol("NOTIFY_VICTORY"),Fe=Symbol("NOTIFY_HIGH_SCORE"),He=Symbol("SHOW_MENU"),Ye=Symbol("AI_THINKING_SCREEN"),Be="INIT_GAME",qe="INIT_REPLAY",Je="SET_GAME_STATE",Ve="ADVANCE_PLAYER_TURN",Ke="SET_LATEST_HIGH_SCORE",Xe="SET_SELECTED_POSITION",Qe="SET_SELECTED_AI_MOVE",Ze=function(e){return{type:Je,newGameState:e}},$e={gameState:we,prevGameState:null,players:[],currentTurnPlayerId:null,circuitInfo:null,latestHighScore:null,selectedPosition:null,raceHistory:null,selectedAIMove:null},et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Be:return Object(x.a)({},e,{gameState:_e,currentTurnPlayerId:t.playerOrder[0],players:t.playerOrder.slice(),circuitInfo:Object(x.a)({},t.circuitInfo),latestHighScore:null,selectedPosition:null,selectedAIMove:null});case qe:return Object(x.a)({},e,{gameState:_e,circuitInfo:Object(x.a)({},t.circuitInfo),raceHistory:t.raceHistory});case Ve:return Object(x.a)({},e,{currentTurnPlayerId:tt(e.players,e.currentTurnPlayerId),selectedPosition:null,selectedAIMove:null});case Je:return Object(x.a)({},e,{gameState:t.newGameState,prevGameState:e.gameState});case Ke:return Object(x.a)({},e,{latestHighScore:t.highScore});case Xe:return Object(x.a)({},e,{selectedPosition:t.newPosition});case Qe:return Object(x.a)({},e,{selectedAIMove:t.newMove});default:return e}};function tt(e,t){var n=e.indexOf(t);return e[(n+1)%e.length]}var nt=Object(E.combineReducers)({players:q,map:J,mainUI:Ae,game:et}),rt=function(){if(!window.localStorage)return null;var e;try{e=window.localStorage.getItem("players")}catch(t){return null}return e?JSON.parse(e):null},at=n(5),ct=n(87),it=n(86),ot=n(4),ut=n.n(ot);n(55);function lt(e){var t=e.variant;return a.a.createElement("div",{className:"logo logo-".concat(t)},a.a.createElement("div",{className:"logo-up"},"Capac"),a.a.createElement("div",{className:"logo-down"},"Racer"))}lt.defaultProps={variant:"big"};var st=lt,mt=(n(56),function(e){var t=e.className,n=Object(b.b)();return a.a.createElement("div",{className:ut()("full-screen",t)},a.a.createElement("div",{className:"main-menu-content"},a.a.createElement("div",{className:"transition-from-left"},a.a.createElement(st,null)),a.a.createElement("div",{className:"main-menu-buttons transition-from-right"},a.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(je(X))}},"Start new game"),a.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(je(ne))}},"How to play"),a.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(je(Z))}},"High scores"),a.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(je($))}},"Credits"))),a.a.createElement("div",{className:"app-version"},"v",window.capac_racer_version))}),dt=function(e,t,n){var r=function(e){return"number"===typeof e?e*t*n:e};return{x:r(e.x),y:r(e.y),dx:r(e.dx),dy:r(e.dy),baseX:r(e.baseX),baseY:r(e.baseY)}},pt=function(e,t){if(!t)return t;var n=e.map.zoom,r=e.map.gridSize;return dt(t,r,n)},ft=function(e,t){for(var n={x:e.position.x+e.speed.x,y:e.position.y+e.speed.y},r=[],a=-1;a<=1;a+=1)for(var c=-1;c<=1;c+=1)r.push({baseX:n.x,baseY:n.y,x:n.x+a,y:n.y+c,dx:a,dy:c});return r.filter((function(e){return!function(e,t){return!!t.map((function(e){return e.position})).find((function(t){return C(t,e)}))}(e,t)}))};var vt=function(e){return e.game.gameState===Re},yt=function(e){return e.game.gameState===Me},ht=function(e){return e.game.gameState===Ye},gt=function(e){return e.game.selectedAIMove},bt=function(e){return function(e){return e.game.gameState!==we}(e)?e.players.byId[e.game.currentTurnPlayerId]:null},Et=function(e){return e.game.players.map((function(t){return e.players.byId[t]}))},Nt=function(e,t){return Et(e).filter((function(e){return e.id!==t}))},Ot=function(e,t){return Nt(e,t).map((function(e){return e.position})).map((function(t){return pt(e,t)}))},St=function(e){var t=e.mainUI.selectedPlayerOrder,n=e.mainUI.selectedPlayers;return t.map((function(e){return n.find((function(t){return t.id===e}))}))},xt=function(e,t){var n=Et(e).filter((function(e){return e.id!==t.id}));return ft(t,n).map((function(t){return{screen:pt(e,t),position:t}}))},kt=function(e){return e.game.selectedPosition},jt=function(e){return e.game.raceHistory},It=n(8),Pt=n.n(It),Tt=n(32),Ct=n.n(Tt),At={mouth:{id:"mouth",name:"Mouth",collisionImg:"".concat("/capac-racer","/circuits/circuit1/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit1/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit1/cp1.png"),"".concat("/capac-racer","/circuits/circuit1/cp2.png"),"".concat("/capac-racer","/circuits/circuit1/cp3.png"),"".concat("/capac-racer","/circuits/circuit1/cp4.png"),"".concat("/capac-racer","/circuits/circuit1/cp5.png"),"".concat("/capac-racer","/circuits/circuit1/cp6.png"),"".concat("/capac-racer","/circuits/circuit1/cp7.png"),"".concat("/capac-racer","/circuits/circuit1/cp8.png"),"".concat("/capac-racer","/circuits/circuit1/cp9.png")],maxPlayers:3,startingPositions:[{x:37,y:22},{x:37,y:23},{x:37,y:24}],initialSpeed:{x:2,y:0}},heart:{id:"heart",name:"Heart",collisionImg:"".concat("/capac-racer","/circuits/circuit2/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit2/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit2/cp1.png"),"".concat("/capac-racer","/circuits/circuit2/cp2.png"),"".concat("/capac-racer","/circuits/circuit2/cp3.png"),"".concat("/capac-racer","/circuits/circuit2/cp4.png"),"".concat("/capac-racer","/circuits/circuit2/cp5.png"),"".concat("/capac-racer","/circuits/circuit2/cp6.png"),"".concat("/capac-racer","/circuits/circuit2/cp7.png")],maxPlayers:3,startingPositions:[{x:37,y:28},{x:36,y:27},{x:35,y:26}],initialSpeed:{x:2,y:-2}},rosco:{id:"rosco",name:"Rosco",collisionImg:"".concat("/capac-racer","/circuits/circuit3/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit3/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit3/cp1.png"),"".concat("/capac-racer","/circuits/circuit3/cp2.png"),"".concat("/capac-racer","/circuits/circuit3/cp3.png"),"".concat("/capac-racer","/circuits/circuit3/cp4.png"),"".concat("/capac-racer","/circuits/circuit3/cp5.png"),"".concat("/capac-racer","/circuits/circuit3/cp6.png"),"".concat("/capac-racer","/circuits/circuit3/cp7.png"),"".concat("/capac-racer","/circuits/circuit3/cp8.png")],maxPlayers:4,startingPositions:[{x:33,y:34},{x:33,y:33},{x:33,y:32},{x:33,y:35}],initialSpeed:{x:-2,y:0}},horse:{id:"horse",name:"Horse",collisionImg:"".concat("/capac-racer","/circuits/circuit4/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit4/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit4/cp1.png"),"".concat("/capac-racer","/circuits/circuit4/cp2.png"),"".concat("/capac-racer","/circuits/circuit4/cp3.png"),"".concat("/capac-racer","/circuits/circuit4/cp4.png"),"".concat("/capac-racer","/circuits/circuit4/cp5.png"),"".concat("/capac-racer","/circuits/circuit4/cp6.png"),"".concat("/capac-racer","/circuits/circuit4/cp7.png"),"".concat("/capac-racer","/circuits/circuit4/cp8.png"),"".concat("/capac-racer","/circuits/circuit4/cp9.png"),"".concat("/capac-racer","/circuits/circuit4/cp10.png"),"".concat("/capac-racer","/circuits/circuit4/cp11.png"),"".concat("/capac-racer","/circuits/circuit4/cp12.png"),"".concat("/capac-racer","/circuits/circuit4/cp13.png"),"".concat("/capac-racer","/circuits/circuit4/cp14.png"),"".concat("/capac-racer","/circuits/circuit4/cp15.png"),"".concat("/capac-racer","/circuits/circuit4/cp16.png"),"".concat("/capac-racer","/circuits/circuit4/cp17.png"),"".concat("/capac-racer","/circuits/circuit4/cp18.png"),"".concat("/capac-racer","/circuits/circuit4/cp19.png")],maxPlayers:3,startingPositions:[{x:26,y:31},{x:26,y:32},{x:26,y:33}],initialSpeed:{x:2,y:0}}},wt=function(e){return new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)}),{once:!0}),r.addEventListener("error",(function(e){n(e)}),{once:!0}),r.src=e}))},_t=function(e){var t=document.createElement("canvas"),n=e.width,r=e.height;t.width=n,t.height=r,t.getContext("2d").drawImage(e,0,0,n,r);var a=t.getContext("2d").getImageData(0,0,n,r).data;return{width:n,height:r,getPixel:function(e,t){var r=4*(e+t*n);return{r:a[r+0],g:a[r+1],b:a[r+2],a:a[r+3]}}}},zt=n(39),Rt=function(e){var t=e.r,n=e.g,r=e.b;return 0!==e.a&&(255!==t||255!==n||255!==r)},Mt=function(e){var t=Object(x.a)({},e);return wt(e.collisionImg).then((function(e){return t.width=e.width,t.height=e.height,_t(e)})).then((function(n){return t.collisionPixelGetter=n,Promise.all(e.checkpoints.map((function(e){return wt(e)})))})).then((function(e){return Promise.all(e.map((function(e){return _t(e)})))})).then((function(e){return t.checkpointPixelGetters=e,t.centerOfCheckpoints=e.map((function(e){return function(e){for(var t=[],n=0;n<e.width;n+=1)for(var r=0;r<e.height;r+=1)Rt(e.getPixel(n,r))&&t.push([n,r]);if(!t.length)return null;var a=t.reduce((function(e,n){return[e[0]+n[0]/t.length,e[1]+n[1]/t.length]}),[0,0]);return{x:a[0],y:a[1]}}(e)})),t}))},Lt=function(e,t,n){var r=Wt(e).map(_);if(Gt(r,t.collisionPixelGetter))return!0;var a=!0,c=!1,i=void 0;try{for(var o,u=function(){var e=o.value;if(n.find((function(t){return C(t,e)})))return{v:!0}},l=r[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=u();if("object"===typeof s)return s.v}}catch(m){c=!0,i=m}finally{try{a||null==l.return||l.return()}finally{if(c)throw i}}return!1},Ut=function(e){var t=e.from,n=e.to,r=e.circuit,a=e.otherPlayers,c=e.zoom,i=e.gridSize,o=[dt(t,i,c),dt(n,i,c)],u=a.map((function(e){return e.position})).map((function(e){return dt(e,i,c)}));return!Lt(o,r,u)},Dt=function(e,t){var n=Wt(e).map(_);return t.checkpointPixelGetters.map((function(e){return Gt(n,e)})).map((function(e,t){return{doesItCollide:e,index:t}})).filter((function(e){return!!e.doesItCollide})).map((function(e){return e.index}))};function Gt(e,t){var n=!0,r=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var o=c.value,u=t.getPixel(o.x,o.y);if(Rt(u))return!0}}catch(l){r=!0,a=l}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return!1}function Wt(e){var t=Object(at.a)(e,2),n=t[0],r=t[1],a=w(n,r),c=Math.ceil(2*a);if(c<2)return[];var i,o=T(r,n);return(i=c,Object(zt.a)(Array(i).keys())).map((function(e){return P(n,function(e,t){return{x:e.x*t,y:e.y*t}}(o,e/(c-1)))}))}var Ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){var n=new l({timeToWait:e}),r=function(e){n.notifyTimePassed(e)};g(r),n.restart({callbackOnEnd:function(){h(r),n.stop(),t()}})}))},Ht=n(19),Yt=function(){try{return JSON.parse(localStorage.getItem("high-scores"))||{}}catch(e){return{}}},Bt=function(e){return(Yt()[e]||[]).map((function(e){return Object(x.a)({},e,{date:new Date(e.date)})}))},qt=function(e,t,n){if(n.type===j)return!1;var r=Bt(t.id);return r.length<5||!!Vt(e,r[r.length-1])},Jt=function(e,t,n){if(!qt(e,t,n))return null;for(var r,a=Bt(t.id),c=0;c<a.length;c+=1)if(Vt(e,a[c])){r=c;break}var i=Object(x.a)({},e,{id:Object(Ht.v4)()}),o=a.slice();return"number"===typeof r?o.splice(r,0,i):o.push(i),function(e,t){var n=Yt(),r=Object(x.a)({},n,Object(S.a)({},e.id,t));try{localStorage.setItem("high-scores",JSON.stringify(r,2))}catch(a){console.warn("error saving high score",a)}}(t,o=o.slice(0,5)),i};function Vt(e,t){return!(e.turns>t.turns)&&(e.turns<t.turns||e.realTimeUsed<t.realTimeUsed)}n(60);var Kt=n(40),Xt=n(33),Qt=[{randomSolutionChance:.2,maxIterations:50,maxThinkingDepth:5,timeThinking:{min:2500,max:3500}},{randomSolutionChance:.15,maxIterations:200,maxThinkingDepth:10,timeThinking:{min:1500,max:2500}},{randomSolutionChance:.07,maxIterations:700,maxThinkingDepth:30,timeThinking:{min:700,max:2e3}},{randomSolutionChance:0,maxIterations:1500,maxThinkingDepth:99999,timeThinking:{min:100,max:300}}],Zt=function(){function e(t,n,r,a,c){Object(o.a)(this,e),this.playerInfo=Object(x.a)({},t,{prevPositions:t.prevPositions.slice(),checkpointsPassed:t.checkpointsPassed.slice()}),this.currentIteration=n,this.circuit=r,this.mapZoom=a,this.mapGridSize=c,this._updatePartialScore()}return Object(u.a)(e,[{key:"expand",value:function(t,n){var r=this;if(this.currentIteration>=n)return[];var a=1===this.currentIteration?t:[];return ft(this.playerInfo,a).filter((function(e){return function(e){return Ut({from:r.playerInfo.position,to:e,zoom:r.mapZoom,gridSize:r.mapGridSize,circuit:r.circuit,otherPlayers:[]})}(e)})).map((function(e){var t=function(e){var t=e.from,n=e.to,r=e.circuit,a=e.zoom,c=e.gridSize,i=[dt(t,c,a),dt(n,c,a)];return Dt(i,r)}({from:r.playerInfo.position,to:e,zoom:r.mapZoom,gridSize:r.mapGridSize,circuit:r.circuit}),n=z(r.playerInfo,e,0);return L(n,t)})).map((function(t){return new e(t,r.currentIteration+1,r.circuit,r.mapZoom,r.mapGridSize)}))}},{key:"updateScoreWithTotals",value:function(e){var t=e.maxAvgSpeed,n=e.maxCheckpointsCoveredPerTurn,r=e.maxCheckpointsCovered;this.avgSpeedScore=(this.avgSpeed+1)/(t+1),this.checkpointsCoveredPerTurnScore=(this.checkpointsCoveredPerTurn+1)/(n+1),this.checkpointsCoveredScore=(this.checkpointsCovered+1)/(r+1),this.score=.1*this.avgSpeedScore+.3*this.checkpointsCoveredPerTurnScore+.6*this.checkpointsCoveredScore,this.summary={avgSpeedScore:this.avgSpeedScore.toFixed(2),checkpointsCoveredPerTurnScore:this.checkpointsCoveredPerTurnScore.toFixed(2),checkpointsCoveredScore:this.checkpointsCoveredScore.toFixed(2)}}},{key:"_updatePartialScore",value:function(){if(this.playerInfo.prevPositions.length)if(function(e){var t={},n=!0,r=!1,a=void 0;try{for(var c,i=e.prevPositions[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var o=c.value,u="".concat(o.x,"_").concat(o.y);if(t[u])return!0;t[u]=!0}}catch(l){r=!0,a=l}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return!1}(this.playerInfo))this.score=-1e3;else{this.avgSpeed=function(e){if(!e.prevPositions.length)return 0;for(var t=0,n=0;n<e.prevPositions.length-1;n+=1){var r=e.prevPositions[n],a=e.prevPositions[n+1];t+=w(r,a)}return t/e.prevPositions.length}(this.playerInfo);var e=function(e){for(var t=0,n=0;n<e.checkpointsPassed.length-1&&e.checkpointsPassed[n];n+=1)t+=1;return t}(this.playerInfo),t=1-this._getPercentageToNextCheckpoint();this.checkpointsCovered=e+t,this.checkpointsCoveredPerTurn=this.checkpointsCovered/this.getTurns(),this.score=1}else this.score=-1}},{key:"getScore",value:function(){return this.score}},{key:"getFirstMove",value:function(){var e=this.playerInfo.prevPositions.length-this.currentIteration+1;return this.playerInfo.prevPositions[e]}},{key:"getTurns",value:function(){return this.playerInfo.prevPositions.length}},{key:"isFinished",value:function(){return function(e){var t=!0,n=!1,r=void 0;try{for(var a,c=e.checkpointsPassed[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){if(!a.value)return!1}}catch(i){n=!0,r=i}finally{try{t||null==c.return||c.return()}finally{if(n)throw r}}return!0}(this.playerInfo)}},{key:"_getPercentageToNextCheckpoint",value:function(){return(function(e){for(var t=e.player,n=e.circuit,r=e.gridSize,a=e.zoom,c=0;c<t.checkpointsPassed.length;c+=1)if(!t.checkpointsPassed[c]){var i=dt(t.position,r,a);return w(i,n.centerOfCheckpoints[c])}return 0}({player:this.playerInfo,zoom:this.mapZoom,gridSize:this.mapGridSize,circuit:this.circuit})+1)/(function(e){var t=e.centerOfCheckpoints;return t.map((function(e,n){return w(e,t[(n+1)%t.length])})).reduce((function(e,t){return Math.max(e,t)}),0)}(this.circuit)+1)}}]),e}(),$t=function(e,t,n,r,a){return new Promise((function(c){if(function(e){var t=Qt[e.levelAI].randomSolutionChance;return Math.random()<t}(e))c(function(e){var t=e.player,n=e.otherPlayers,r=e.zoom,a=e.circuit,c=e.gridSize,i=ft(t,n).filter((function(e){return function(e){return Ut({from:t.position,to:e,zoom:r,gridSize:c,circuit:a,otherPlayers:[]})}(e)}));i.length||(i=ft(t,n));return fe(i)}({player:e,otherPlayers:t,zoom:r,circuit:n,gridSize:a}));else{var i=function(e){return en.apply(this,arguments)}({player:e,otherPlayers:t,circuit:n,zoom:r,gridSize:a});!function(){var e,t,n,r,a,o,u;Pt.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:e=!0,t=!1,l.prev=2,r=Object(Xt.a)(i);case 4:return l.next=6,Pt.a.awrap(r.next());case 6:return a=l.sent,e=a.done,l.next=10,Pt.a.awrap(a.value);case 10:if(o=l.sent,e){l.next=21;break}return u=o,l.next=15,Pt.a.awrap(new Promise((function(e){requestAnimationFrame(e)})));case 15:if(!u.isFinished){l.next=18;break}return c(u.move),l.abrupt("break",21);case 18:e=!0,l.next=4;break;case 21:l.next=27;break;case 23:l.prev=23,l.t0=l.catch(2),t=!0,n=l.t0;case 27:if(l.prev=27,l.prev=28,e||null==r.return){l.next=32;break}return l.next=32,Pt.a.awrap(r.return());case 32:if(l.prev=32,!t){l.next=35;break}throw n;case 35:return l.finish(32);case 36:return l.finish(27);case 37:case"end":return l.stop()}}),null,null,[[2,23,27,37],[28,,32,36]])}()}}))};function en(){return(en=Object(Kt.a)(Pt.a.mark((function e(t){var n,r,a,c,i,o,u,l,s,m,d,p,f;return Pt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.player,r=t.otherPlayers,a=t.circuit,c=t.zoom,i=t.gridSize,o=[new Zt(n,1,a,c,i)],u=[],l=null,s=Qt[n.levelAI].maxIterations,m=Qt[n.levelAI].maxThinkingDepth,d=1,50,p=Pt.a.mark((function e(){var t,n,a,c,i,s,p,f,v,y,h,g,b;return Pt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(d+=1,t=nn(o),o=o.filter((function(e){return e!==t})),n=t.expand(r,m),a=n.filter((function(e){return e.isFinished()})),c=!0,i=!1,s=void 0,e.prev=8,p=a[Symbol.iterator]();!(c=(f=p.next()).done);c=!0)v=f.value,(!l||v.getTurns()<l.getTurns())&&(l=v);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),i=!0,s=e.t0;case 16:e.prev=16,e.prev=17,c||null==p.return||p.return();case 19:if(e.prev=19,!i){e.next=22;break}throw s;case 22:return e.finish(19);case 23:return e.finish(16);case 24:if(u=u.concat(a),y=n.filter((function(e){return!e.isFinished()})).filter((function(e){return e.getScore()>=0})).filter((function(e){return!l||e.getTurns()<l.getTurns()})),o=o.concat(y),h=o.reduce((function(e,t){return Math.max(e,t.avgSpeed)}),0),g=o.reduce((function(e,t){return Math.max(e,t.checkpointsCoveredPerTurn)}),0),b=o.reduce((function(e,t){return Math.max(e,t.checkpointsCovered)}),0),o.forEach((function(e){e.updateScoreWithTotals({maxAvgSpeed:h,maxCheckpointsCoveredPerTurn:g,maxCheckpointsCovered:b})})),d%50!==0){e.next=34;break}return e.next=34,{isFinished:!1};case 34:case"end":return e.stop()}}),e,null,[[8,12,16,24],[17,,19,23]])}));case 9:if(!(o.length&&d<=s)){e.next=13;break}return e.delegateYield(p(),"t0",11);case 11:e.next=9;break;case 13:return f=l?l.getFirstMove():o.length?nn(o).getFirstMove():tn(n,r),e.next=16,{isFinished:!0,move:f};case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tn(e,t){var n=ft(e,t);return fe(n)}function nn(e){return e.reduce((function(e,t){return t.getScore()>e.getScore()?t:e}),e[0])}var rn=function(){var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(e){return window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}(),an=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.category,r=t.label,a=t.value;window.gtag&&window.gtag("event",e,{event_category:n,event_label:r,value:a})},cn=function(){return function(e,t){var n=bt(t());n.turnsGrounded?e(function(e){return function(t){e.type!==k?(t(Ze(Ge)),setTimeout((function(){t(un())}),2e3)):t(Ze(De))}}(n)):n.type!==j?t().mainUI.playWithTimer?e(Ze(ze)):e(vn()):e(yn(n))}},on=function(){return function(e){e({type:Ve}),e(cn())}},un=function(){return function(e,t){var n,r=bt(t());e((n=r.id,{type:W,playerId:n})),e(on())}},ln=function(e){var t=e.players,n=e.playerOrder,r=e.circuit;return function(e,a){e(je(ee));var c=function(e){var t=e.players,n=e.playerOrder,r=e.circuit;return n.map((function(e){return t.find((function(t){return t.id===e}))})).map((function(e,t){var n=r.startingPositions[t];return Object(x.a)({},e,{position:Object(x.a)({},n),prevPositions:[Object(x.a)({},n)],speed:Object(x.a)({},r.initialSpeed),checkpointsPassed:r.checkpoints.map((function(){return!1}))})}))}({players:t,playerOrder:n,circuit:r}).map(Sn);e(function(e){return{type:D,players:e}}(c)),an("init_game",{category:"game",label:null===r||void 0===r?void 0:r.id}),an("total_players",{category:"game",value:t.length,label:null===r||void 0===r?void 0:r.id}),an("human_players",{category:"game",value:t.filter((function(e){return e.type===k})).length,label:null===r||void 0===r?void 0:r.id}),an("ai_players",{category:"game",value:t.filter((function(e){return e.type===j})).length,label:null===r||void 0===r?void 0:r.id}),a().mainUI.playWithTimer||s.setTimeToWait(-1),Mt(r).then((function(t){e(function(e,t){return{type:Be,playerOrder:e,circuitInfo:t}}(n,t)),e(je(K))}))}},sn=function(){return function(e,t){var n=t(),r=n.mainUI.randomizePlayerOrderOnStart?Ct()(n.mainUI.selectedPlayerOrder):n.mainUI.selectedPlayerOrder;!function(e,t){if(window.localStorage){var n={version:window.capac_racer_version,playerOrder:e,players:t};try{window.localStorage.setItem("players",JSON.stringify(n))}catch(r){console.warn("Error trying to save localStorage",r)}}}(n.mainUI.selectedPlayerOrder,n.mainUI.selectedPlayers),e(ln({players:n.mainUI.selectedPlayers,playerOrder:r,circuit:At[n.mainUI.selectedCircuit]}))}},mn=function(e,t,n){return function(r){var a=w(e.position,t);if(an("collision",{category:"game",label:(null===e||void 0===e?void 0:e.type)===j?"ai":"human",value:a}),r(function(e,t,n){return{type:G,playerId:e,speed:t,timePassed:n}}(e.id,a,n)),e.type===j)return r(Ze(Ue)),void setTimeout((function(){r(on())}),2e3);r(Ze(Le))}},dn=function(e,t,n,r,a){return function(c,i){c(gn(r,a));var o=function(e){var t=bt(e),n=!0,r=!1,a=void 0;try{for(var c,i=t.checkpointsPassed[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){if(!c.value)return!1}}catch(o){r=!0,a=o}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return!0}(i());c(function(e,t,n){return{type:U,playerId:e,position:t,timePassed:n}}(e.id,t,n)),c(o?function(e,t){return function(n){an("victory",{category:"game"});var r={name:e.name,date:new Date,turns:e.turnsSpent,realTimeUsed:e.realTimeUsed,maxSpeed:e.maxSpeed,crashes:e.crashes,path:e.prevPositions,playerStyle:e.style};if(qt(r,t,e)){var a=Jt(r,t,e);an("high_score",{category:"game",label:null===t||void 0===t?void 0:t.id,value:null===a||void 0===a?void 0:a.turns}),n({type:Ke,highScore:a}),n(Ze(Fe))}else n(Ze(We))}}(bt(i()),a):on())}};var pn=function(e,t){return function(n,r){var a=s.getTimePassed();s.stop();var c=r(),i=c.game.circuitInfo,o=c.map.zoom,u=c.map.gridSize;if(Ut({from:e.position,to:t,zoom:o,gridSize:u,circuit:i,otherPlayers:Nt(c,e.id)})){var l=[pt(c,e.position),pt(c,t)];n(dn(e,t,a,l,i))}else n(mn(e,t,a))}},fn=function(e,t){return function(n){rn?n({type:Xe,newPosition:t}):n(pn(e,t))}},vn=function(){return function(e,t){e(Ze(Re));var n=function(){};t().mainUI.playWithTimer&&(n=function(){var n=kt(t());if(n){var r=bt(t());e(pn(r,n))}else e((function(e,t){e(Ze(Me)),Ft(3e3).then((function(){var n=bt(t()),r=Et(t()).filter((function(e){return e.id!==n.id})),a=ft(n,r),c=fe(a);e(pn(n,c))}))}))}),s.restart({callbackOnEnd:n})}},yn=function(e){return function(t,n){var r,a,c,i,o,u,l,s,m;return Pt.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return t(Ze(Ye)),r=n(),a=r.game.circuitInfo,c=Et(n()).filter((function(t){return t.id!==e.id})),i=r.map.zoom,o=r.map.gridSize,u=$t(e,c,a,i,o),l=hn(e),d.next=10,Pt.a.awrap(Promise.all([Ft(l),u]));case 10:return s=d.sent,m=s[1],t({type:Qe,newMove:m}),d.next=15,Pt.a.awrap(Ft(1e3));case 15:t(pn(e,m));case 16:case"end":return d.stop()}}))}};function hn(e){var t,n,r=Qt[e.levelAI].timeThinking;return t=r.min,n=r.max,t+Math.random()*(n-t)}var gn=function(e,t){return function(n,r){var a=Dt(e,t);if(a.length){var c,i=bt(r());n((c=i.id,{type:F,playerId:c,newCheckpointIndexes:a}))}}},bn=function(){return function(e){an("finish_game",{category:"game"}),e(je(V)),s.reset()}};var En=function(){return function(e){e(Ze(He)),s.pause()}},Nn=function(){return function(e,t){var n=t().game.prevGameState;e(Ze(n)),s.unpause()}},On=function(){return function(e,t){switch(t().game.gameState){case He:e(Nn());break;case Re:e(En())}}};function Sn(e,t){return e.name?e:Object(x.a)({},e,{name:xn(t)})}function xn(e){switch(e){case 0:return"Anonymous";case 1:return"Mistery racer";case 2:return"Shy runner";case 3:return"Jane Doe";default:return"John Doe"}}var kn=function(e,t){return function(n){an("show_replay",{category:"replay"}),Mt(t).then((function(t){n(function(e,t){return{type:qe,raceHistory:e,circuitInfo:t}}(e,t)),n(je(te))}))}};n(61);var jn=function(e){var t=e.counterObject,n=a.a.useState(0),r=Object(at.a)(n,2),c=r[0],i=r[1],o=a.a.useRef(),u=function e(){i(t.getTimeLeft()),o.current=requestAnimationFrame(e)};return a.a.useEffect((function(){return o.current=requestAnimationFrame(u),function(){return cancelAnimationFrame(o.current)}}),[]),a.a.createElement("div",{className:"counter-display"},a.a.createElement("div",{className:"counter-display-text"},"Time left:"),a.a.createElement("div",{className:"counter-display-number"},(c/1e3).toFixed(3)))},In=n(38),Pn=n(2),Tn=n.n(Pn),Cn=Tn.a.shape({id:Tn.a.string,name:Tn.a.string,dotColor:Tn.a.string,dotSize:Tn.a.number,round:Tn.a.string,trailColor:Tn.a.string,trailDotsSize:Tn.a.number,trailWidth:Tn.a.number,icon:Tn.a.string}),An=Tn.a.shape({x:Tn.a.number,y:Tn.a.number}),wn=(Tn.a.shape({id:Tn.a.string.isRequired,name:Tn.a.string.isRequired,style:Cn}),Tn.a.shape({id:Tn.a.string.isRequired,name:Tn.a.string.isRequired,style:Cn,position:An.isRequired,speed:An.isRequired,prevPositions:Tn.a.arrayOf(An)}),Tn.a.shape({id:Tn.a.string.isRequired,name:Tn.a.string.isRequired,style:Cn,path:Tn.a.arrayOf(An)}),Tn.a.shape({id:Tn.a.string,name:Tn.a.string,turns:Tn.a.number,time:Tn.a.number}),Tn.a.shape({id:Tn.a.string,name:Tn.a.string}),Tn.a.shape({x:Tn.a.number,y:Tn.a.number,dx:Tn.a.number,yy:Tn.a.number,baseX:Tn.a.number,baseY:Tn.a.number}),n(22),{x:120,y:100}),_n=function(e){var t=e.children,n=e.currentPlayer,c=Object(r.useState)({x:0,y:0}),i=Object(at.a)(c,2),o=i[0],u=i[1],l=Object(r.useState)(null),s=Object(at.a)(l,2),m=s[0],d=s[1],p=Object(r.useState)(!1),f=Object(at.a)(p,2),v=f[0],y=f[1],h=Object(r.useState)(null),g=Object(at.a)(h,2),E=g[0],N=g[1],O=Object(b.c)((function(e){return e.game.circuitInfo})),S=Object(b.c)((function(e){return pt(e,n.position)}));Object(r.useEffect)((function(){if(m&&n&&n.position){var e={topLeft:T({x:0,y:0},o),size:m};if(!function(e,t,n){return e.x>=t.topLeft.x+n.x&&e.x<=t.topLeft.x+t.size.width-n.x&&e.y>=t.topLeft.y+n.y&&e.y<=t.topLeft.y+t.size.height-n.y}(S,e,wn)){var t=function(e,t,n){var r=t.topLeft.x+n.x,a=t.topLeft.x+t.size.width-n.x,c=t.topLeft.y+n.y,i=t.topLeft.y+t.size.height-n.y;return{x:I(e.x,r,a),y:I(e.y,c,i)}}(S,e,wn),r=T(t,S);u(P(o,r))}}}),[n,m]);var x=function(e){y(!0);var t=zn(e);N(t)},k=function(){y(!1),N(null)},j=function(e){if(v&&E){var t=zn(e),n=T(t,E);N(t),u(P(o,n))}};return a.a.createElement("div",{className:"game-board"},a.a.createElement(In.a,{handleHeight:!0,handleWidth:!0,onResize:function(e,t){d({width:e,height:t})}},a.a.createElement("div",{className:ut()("game-board-content",{"is-dragging":v}),style:{width:O.width,height:O.height,transform:"translate(".concat(o.x,"px, ").concat(o.y,"px)")},onMouseDown:x,onMouseUp:k,onMouseMove:j,onTouchStart:x,onTouchEnd:k,onTouchMove:j,onTouchCancel:k},t)))};function zn(e){var t=e;return"touchstart"!==e.type&&"touchmove"!==e.type||(t=e.touches[0]),{x:t.clientX,y:t.clientY}}_n.defaultProps={currentPlayer:null};var Rn=_n,Mn=n(36),Ln=n.n(Mn),Un=(n(62),function(e){var t=60*e.zoom/(60/e.cellSize);return a.a.createElement("div",{className:"grid",style:{backgroundImage:"url(".concat(Ln.a,")"),backgroundSize:"".concat(t,"px ").concat(t,"px")}})});Un.defaultProps={};var Dn=Un;n(63);var Gn=function(e){var t=e.playerStyle;return a.a.createElement("div",{className:"player-icon",style:{backgroundImage:"url(".concat(t.icon,")")}})};n(64);var Wn=function(e){var t=e.player,n=e.isActive,c=Object(r.useRef)(null);Object(r.useEffect)((function(){!function(e,t){if(!e)return;e.style.setProperty("--player-color",t.dotColor),e.style.setProperty("--player-border-radius",t.round)}(c.current,t.style)}),[t.style]);var i=Object(b.c)((function(e){return pt(e,t.position)}));return a.a.createElement("div",{ref:c,className:ut()("player",{"is-active":n}),style:{left:i.x,top:i.y}},a.a.createElement(Gn,{playerStyle:t.style}),n&&a.a.createElement("div",{className:"player-active-indicator"}))},Fn=n(9),Hn=function(e,t){e&&(e.style.setProperty("--player-color",t.dotColor),e.style.setProperty("--player-size","".concat(t.dotSize+2,"px")),e.style.setProperty("--movement-picker-size","".concat(t.dotSize-1,"px")),e.style.setProperty("--movement-picker-size-center","".concat(t.dotSize+2,"px")),e.style.setProperty("--player-border-radius",t.round))},Yn=function(e,t,n,r){return Lt(t,n,r)?"red":e.style.trailColor};n(65);var Bn=function(e){var t=e.player,n=e.onPositionSelected,c=e.onConfirmSelection,i=Object(r.useRef)(null),o=Object(r.useState)(null),u=Object(at.a)(o,2),l=u[0],s=u[1],m=Object(r.useState)(!1),d=Object(at.a)(m,2),p=d[0],f=d[1];Object(r.useEffect)((function(){Hn(i.current,t.style)}),[t.style]);var v=Object(b.c)((function(e){return function(e,t){if(!t.prevPositions.length||t.prevPositions.length<2)return null;var n=t.prevPositions[t.prevPositions.length-2],r={x:n.x-t.position.x,y:n.y-t.position.y};return pt(e,r)}(e,t)}))||{x:0,y:0},y=Object(r.useState)(v),h=Object(at.a)(y,2),g=h[0],E=h[1];Object(r.useEffect)((function(){var e=setTimeout((function(){E({x:0,y:0}),f(!0)}));return function(){return clearTimeout(e)}}),[]),Object(r.useEffect)((function(){return s(null),function(){return s(null)}}),[t]);var N=Object(b.c)((function(e){return e.game.circuitInfo})),O=Object(b.c)((function(e){return pt(e,t.position)})),S=Object(b.c)((function(e){return xt(e,t)})),x=Object(b.c)((function(e){return function(e,t){var n={x:t.position.x+t.speed.x,y:t.position.y+t.speed.y};return pt(e,n)}(e,t)})),k=Object(b.c)((function(e){return Ot(e,t.id)})),j=Object(b.c)(kt),I=Object(b.c)((function(e){return pt(e,j)})),P=function(e){if(!e||!e.length)return{x:0,y:0};var t=e.reduce((function(e,t){return Math.max(e,t.screen.y)}),Number.MIN_VALUE);return{x:e.reduce((function(e,t){return t.screen.x+e}),0)/e.length,y:t}}(S),T=l||I,C=T&&Lt([O,T],N,k);return a.a.createElement("div",{ref:i,className:"movement-picker-container",style:{transform:"translate(".concat(g.x,"px, ").concat(g.y,"px)")}},S.map((function(e){return a.a.createElement("div",{key:"".concat(t.id,"_").concat(e.position.x,"_").concat(e.position.y),className:ut()("movement-picker",{"movement-picker-center":!e.screen.dx&&!e.screen.dy}),style:{left:e.screen.baseX,top:e.screen.baseY,transform:p?"translate(".concat(e.screen.dx,"px, ").concat(e.screen.dy,"px)"):"translate(0, 0)"},onClick:function(){return n(e.position)},onMouseEnter:function(){return s(e.screen)},onMouseLeave:function(){return s(null)}})})),rn&&j&&a.a.createElement("button",{className:"button button-bg movement-picker-select-button",style:{left:P.x,top:P.y},onClick:c},"Select"),T&&a.a.createElement("svg",{className:"movement-picker-temp-line"},a.a.createElement(Fn.a,{points:[O,T],stroke:Yn(t,[O,T],N,k),strokeWidth:t.style.trailWidth,strokeDasharray:"2",fill:"none",r:2})),a.a.createElement("svg",{className:"movement-picker-ghost-line"},a.a.createElement(Fn.a,{points:[O,x],stroke:t.style.trailColor,strokeWidth:t.style.trailWidth,strokeDasharray:"1",fill:"none",r:2})),T&&C&&a.a.createElement("div",{className:"movement-picker-crash",style:{left:T.x,top:T.y}}))};n(66);function qn(e){var t=e.player,n=e.children,c=e.switchRandomEvery,i=e.highlightMove,o=Object(r.useRef)(null),u=Object(r.useState)(null),l=Object(at.a)(u,2),s=l[0],m=l[1],d=Object(r.useState)(null),p=Object(at.a)(d,2),f=p[0],v=p[1];Object(r.useEffect)((function(){Hn(o.current,t.style)}),[t.style]),Object(r.useEffect)((function(){return m(null),function(){return m(null)}}),[t]);var y=Object(b.c)((function(e){return e.game.circuitInfo})),h=Object(b.c)((function(e){return pt(e,t.position)})),g=Object(b.c)((function(e){return xt(e,t)}));Object(r.useEffect)((function(){var e=setInterval((function(){var e=fe(g);v(e),m(e.screen)}),c);return function(){clearInterval(e)}}),[t,g,c]);var E=Object(b.c)((function(e){return Ot(e,t.id)})),N=Object(b.c)((function(e){return pt(e,i)}));return a.a.createElement("div",{ref:o},n&&a.a.createElement("div",{className:"random-selection-animation-warning",style:{top:h.y,left:h.x}},n),g.map((function(e){var n=Jn(t,e);return a.a.createElement("div",{key:n,className:ut()("random-selection-animation",{"is-highlighted":!N&&f&&Jn(t,f)===n}),style:{left:e.screen.x,top:e.screen.y}})})),N&&a.a.createElement("div",{className:"random-selection-animation-highlighted-move",style:{left:N.x,top:N.y}}),!N&&s&&a.a.createElement("svg",{className:"random-selection-animation-temp-line"},a.a.createElement(Fn.a,{points:[h,s],stroke:Yn(t,[h,s],y,E),strokeWidth:t.style.trailWidth,strokeDasharray:"2",fill:"none",r:2})))}function Jn(e,t){return"".concat(e.id,"_").concat(t.position.x,"_").concat(t.position.y)}qn.defaultProps={children:null,switchRandomEvery:100,highlightMove:null};var Vn=qn;n(67);var Kn=function(e){var t=e.player,n=e.isActive,c=Object(r.useRef)(null);Object(r.useEffect)((function(){!function(e,t){if(!e)return;e.style.setProperty("--player-trail-color",t.dotColor),e.style.setProperty("--player-trail-size","".concat(t.dotSize,"px")),e.style.setProperty("--player-trail-border-radius",t.round)}(c.current,t.style)}),[t.style]);var i=Object(b.c)((function(e){return e}));if(!t.prevPositions.length)return"";var o=t.prevPositions.map((function(e){return pt(i,e)})),u=o.slice(0,o.length-1);return a.a.createElement("div",{className:ut()("player-trail-container",{"is-active":n}),ref:c},a.a.createElement("svg",{className:"player-trail"},a.a.createElement(Fn.a,{points:o,stroke:t.style.trailColor,strokeWidth:t.style.trailWidth,fill:"none",r:2})),u.map((function(e,t){return Object(x.a)({},e,{turn:t+1})})).map((function(e){return a.a.createElement("div",{key:"".concat(t.id,"_").concat(e.x,"_").concat(e.y,"_").concat(e.turn),className:"player-trail-point",style:{left:e.x,top:e.y}})})))},Xn=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return Et(e)})),n=Object(b.c)((function(e){return bt(e)})),r=Object(b.c)((function(e){return e.map.zoom})),c=Object(b.c)((function(e){return e.map.gridSize})),i=Object(b.c)((function(e){return e.game.circuitInfo})),o=Object(b.c)(vt),u=Object(b.c)(yt),l=Object(b.c)(ht),s=Object(b.c)(gt);return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"game-board-circuit-bg",style:{backgroundImage:"url(".concat(i.bgImg,")"),backgroundSize:"".concat(i.width,"px ").concat(i.height,"px")}}),a.a.createElement(Dn,{zoom:r,cellSize:c}),t.map((function(e){return a.a.createElement("div",{key:e.id},a.a.createElement(Wn,{player:e,isActive:e===n}),a.a.createElement(Kn,{player:e,isActive:e===n}))})),n&&o&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Bn,{key:null===n||void 0===n?void 0:n.id,player:n,onPositionSelected:function(t){return e(fn(n,t))},onConfirmSelection:function(){var t;e((t=n,function(e,n){var r=kt(n());e(pn(t,r))}))}})),n&&u&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Vn,{player:n},"Too late!",a.a.createElement("br",null)," Choosing a random move for you...")),n&&l&&a.a.createElement(a.a.Fragment,null,a.a.createElement(Vn,{player:n,switchRandomEvery:Qn(n),highlightMove:s})))};function Qn(e){switch(e.levelAI){case 0:return 800;case 1:return 400;case 2:return 200;case 3:return 100;default:return 75}}Xn.defaultProps={};var Zn=Xn,$n=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return bt(e)})),n=Object(b.c)(vt),r=Object(b.c)((function(e){return e.mainUI.playWithTimer})),c=!t||t.type===k;return a.a.createElement("div",{className:"game-board-container"},a.a.createElement(Rn,{currentPlayer:t},a.a.createElement(Zn,null)),n&&r&&a.a.createElement(jn,{counterObject:s}),c&&a.a.createElement("div",{className:"pause-button-container"},a.a.createElement("button",{type:"button",className:"button button-small",onClick:function(){return e(En())}},"Pause")))};$n.defaultProps={};var er=$n,tr=function(e){var t=e.player,n=e.isActive;return a.a.createElement("li",{className:ut()("player-list-item",{"is-active":n})},a.a.createElement("div",{className:"player-list-item-decorator-container"},a.a.createElement("div",{className:"player-list-item-decorator"}),a.a.createElement(Gn,{playerStyle:t.style})),a.a.createElement("div",null,t.name))},nr=(n(68),function(){var e=Object(b.c)((function(e){return Et(e)})),t=Object(b.c)((function(e){return bt(e)}));return a.a.createElement("ul",{className:"player-list"},e.map((function(e){return a.a.createElement(tr,{key:e.id,player:e,isActive:e===t})})))}),rr=function(){var e=Object(b.b)();return a.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(cn())}},a.a.createElement("div",{className:"game-screen-modal-content"},"Everybody ready?",a.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Start game!")))},ar=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return bt(e)}));return a.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(vn())}},a.a.createElement("div",{className:"game-screen-modal-content"},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},t.name),", it is your turn"),a.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Start my turn")))},cr=n(13),ir=n.n(cr),or=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return bt(e)}));return a.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(on())}},a.a.createElement("div",{className:"game-screen-modal-content"},a.a.createElement("div",null,"You crashed!"),a.a.createElement("div",{className:"secondary-text mt-s"},"(grounded for ",t.turnsGrounded," ",ir()("turn",t.turnsGrounded),")"),a.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Next turn")))},ur=function(){var e=Object(r.useState)(!1),t=Object(at.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){var e=setTimeout((function(){return c(!0)}),100);return function(){clearTimeout(e)}}),[]);var i=Object(b.c)((function(e){return bt(e)}));return(a.a.createElement("div",{className:"game-screen-modal game-screen-modal-non-invasive"},a.a.createElement("div",{className:ut()("game-screen-modal-content",{"is-hidden":!n})},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},i.name)," ","has crashed :("))))},lr=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return bt(e)}));return a.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(un())}},a.a.createElement("div",{className:"game-screen-modal-content"},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},t.name),", you are grounded because you crashed!"),a.a.createElement("div",{className:"secondary-text mt-s"},"(",t.turnsGrounded," ",ir()("turn",t.turnsGrounded)," left)"),a.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Next turn")))},sr=function(){var e=Object(r.useState)(!1),t=Object(at.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){var e=setTimeout((function(){return c(!0)}),100);return function(){clearTimeout(e)}}),[]);var i=Object(b.c)((function(e){return bt(e)}));return(a.a.createElement("div",{className:"game-screen-modal game-screen-modal-non-invasive"},a.a.createElement("div",{className:ut()("game-screen-modal-content",{"is-hidden":!n})},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},i.name)," is grounded after a crash."),a.a.createElement("div",{className:"secondary-text"},"(",i.turnsGrounded," ",ir()("turn",i.turnsGrounded)," left)"))))},mr=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return bt(e)}));return a.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(bn())}},a.a.createElement("div",{className:"game-screen-modal-content"},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},t.name)," ","won!"),a.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Yay!")))},dr=function(){var e=Object(b.b)();return(a.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(Nn())}},a.a.createElement("div",{className:"game-screen-modal-content"},a.a.createElement("div",null,"Paused"),a.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Continue!"),a.a.createElement("button",{className:"button game-screen-modal-button game-screen-modal-button-secondary ",type:"button",onClick:function(t){t.stopPropagation(),e(bn())}},"Exit game"))))};n(69);function pr(e){var t=e.scores,n=e.highlightedScore,r=e.canReplay,c=e.circuit,i=Object(b.b)();return a.a.createElement("div",{className:"score-board"},!!t.length&&t.map((function(e,t){var o;return(a.a.createElement("div",{onClick:function(){return function(e){r&&i(kn(e,c))}(e)},className:ut()("score-board-item",{"is-highlighted":n&&n.id===e.id,"is-clickable":r}),key:"score-board-item-".concat(e.id)},a.a.createElement("div",{className:"score-board-item-index"},t+1),a.a.createElement("div",{className:"score-board-item-name"},e.name),a.a.createElement("div",{className:"score-board-item-turns"},a.a.createElement("span",{className:"score-board-item-value"},e.turns),a.a.createElement("span",{className:"score-board-item-text"}," ","turns")),a.a.createElement("div",{className:"score-board-item-turns"},a.a.createElement("span",{className:"score-board-item-value"},null===(o=e.date)||void 0===o?void 0:o.toLocaleDateString())),a.a.createElement("div",{className:"score-board-item-time"},"(",a.a.createElement("span",{className:"score-board-item-value"},(e.realTimeUsed/1e3).toFixed(2)," "),a.a.createElement("span",{className:"score-board-item-text"},"seconds"),")")))})),!t.length&&a.a.createElement("div",{className:"score-board-empty"},"No high scores yet!"))}pr.defaultProps={highlightedScore:null,canReplay:!1};var fr=pr,vr=function(){var e=Object(b.b)(),t=Object(b.c)((function(e){return bt(e)})),n=Object(b.c)((function(e){return function(e){return e.game.latestHighScore}(e)})),r=Object(b.c)((function(e){return e.game.circuitInfo})),c=Bt(r.id);return a.a.createElement("div",{className:"game-screen-modal"},a.a.createElement("div",{className:"game-screen-modal-content"},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},t.name)," ","won, and set a high score for this circuit!"),a.a.createElement("div",{className:"notify-high-scores-circuit"},a.a.createElement(fr,{circuit:r,scores:c,highlightedScore:n})),a.a.createElement("button",{className:"button game-screen-modal-button",type:"button",onClick:function(){return e(bn())}},"Back to main menu")))},yr=function(){var e=Object(r.useState)(!1),t=Object(at.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){var e=setTimeout((function(){return c(!0)}),1e3);return function(){clearTimeout(e)}}),[]);var i=Object(b.c)((function(e){return bt(e)}));return(a.a.createElement("div",{className:"game-screen-modal game-screen-modal-non-invasive"},a.a.createElement("div",{className:ut()("game-screen-modal-content",{"is-hidden":!n})},a.a.createElement("div",null,a.a.createElement("span",{className:"player-name"},i.name)," is choosing its next move..."))))},hr=(n(70),function(){switch(Object(b.c)((function(e){return function(e){return e.game.gameState}(e)}))){case _e:return a.a.createElement(rr,null);case ze:return a.a.createElement(ar,null);case Le:return a.a.createElement(or,null);case Ue:return a.a.createElement(ur,null);case De:return a.a.createElement(lr,null);case Ge:return a.a.createElement(sr,null);case We:return a.a.createElement(mr,null);case Fe:return a.a.createElement(vr,null);case He:return a.a.createElement(dr,null);case Ye:return a.a.createElement(yr,null);default:return""}});hr.defaultProps={};var gr=hr;function br(e){var t=e.keys;return Object(r.useEffect)((function(){var e=function(e){t[e.code]&&t[e.code]()};return window.document.addEventListener("keyup",e),function(){window.document.removeEventListener("keyup",e)}}),[t]),a.a.createElement(a.a.Fragment,null)}br.propTypes={keys:Tn.a.objectOf(Tn.a.func).isRequired};var Er,Nr,Or=br;function Sr(e){var t=e.onBlur;return Object(r.useEffect)((function(){if("undefined"===typeof document.addEventListener||void 0===Er)return function(){};var e=function(){document[Er]&&t()};return document.addEventListener(Nr,e,!1),function(){document.removeEventListener(Nr,e,!1)}}),[t]),a.a.createElement(a.a.Fragment,null)}"undefined"!==typeof document.hidden?(Er="hidden",Nr="visibilitychange"):"undefined"!==typeof document.msHidden?(Er="msHidden",Nr="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(Er="webkitHidden",Nr="webkitvisibilitychange"),Sr.propTypes={onBlur:Tn.a.func.isRequired};var xr=Sr,kr=(n(71),function(){var e=Object(b.b)();return a.a.createElement("div",{className:"transition-opacity"},a.a.createElement(Or,{keys:{Escape:function(){return e(On())},Space:function(){return e(On())}}}),a.a.createElement(xr,{onBlur:function(){return e((function(e,t){switch(t().game.gameState){case Re:e(En())}}))}}),a.a.createElement(er,null),a.a.createElement(nr,null),a.a.createElement(gr,null))});n(72);var jr=function(e){var t=e.circuit,n=e.onClick;return a.a.createElement("div",{className:"circuit-selector",onClick:n},a.a.createElement("img",{className:"circuit-selector-img",src:t.bgImg,alt:t.name}),a.a.createElement("div",{className:"circuit-selector-footer"},a.a.createElement("div",{className:"circuit-selector-name"},t.name),a.a.createElement("div",{className:"circuit-selector-players"},t.maxPlayers," players")))},Ir=(n(73),Object.values(At));var Pr=function(e){var t=e.className,n=Object(b.b)();return a.a.createElement("div",{className:ut()("full-screen full-screen-with-header-and-footer circuit-selection",t)},a.a.createElement("div",{className:"menu-header transition-from-top"},a.a.createElement(st,{variant:"small"}),a.a.createElement("h1",{className:"menu-header-title"},"Select circuit")),a.a.createElement("div",{className:"menu-content circuit-selection-content transition-from-bottom"},a.a.createElement("div",{className:"circuit-selection-list"},Ir.map((function(e){return a.a.createElement(jr,{key:e.id,onClick:function(){var t;n((t=e.id,{type:Ee,circuitId:t})),n(je(Q))},circuit:e})})))),a.a.createElement("footer",{className:"menu-footer transition-from-bottom"},a.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(je(V))}},"Back")))},Tr=function(e){return function(t,n){var r=n().mainUI.selectedPlayers,a=Object.values(pe),c=r.filter((function(t){return t.id!==e.id})),i=a.reduce((function(e,t){return function(e,t){var n=!0,r=!1,a=void 0;try{for(var c,i=t[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){if(c.value.style.id===e.id)return!0}}catch(o){r=!0,a=o}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return!1}(t,c)?e:e.concat([t])}),[]),o=(i.findIndex((function(t){return t.id===e.style.id}))+1)%i.length;t(Pe(e.id,{style:i[o]}))}};n(74);var Cr=function(e){var t=e.player,n=e.onRemove,r=e.canBeRemoved,c=e.onNameChange,i=e.onTypeChange,o=e.onLevelAIChange,u=e.onSelectNewStyle;return a.a.createElement("div",{className:"player-selector"},a.a.createElement("div",{className:"player-selector-top"},a.a.createElement("input",{className:"player-selector-input",type:"text",value:t.name,onChange:function(e){return c(e.target.value)}}),a.a.createElement("button",{type:"button",className:"player-selector-style-container",onClick:u},a.a.createElement(Gn,{playerStyle:t.style})),a.a.createElement("button",{type:"button",className:"button button-small",onClick:n,disabled:!r,style:{opacity:r?1:0}},"Delete")),a.a.createElement("div",{className:"player-selector-bottom"},a.a.createElement("button",{type:"button",className:ut()("player-selector-toggle",{"is-selected":t.type===k}),onClick:function(){return i(k)}},"Human"),a.a.createElement("button",{type:"button",className:ut()("player-selector-toggle",{"is-selected":t.type===j}),onClick:function(){return i(j)}},"AI"),t.type===j&&a.a.createElement("div",{className:"player-selector-ai-level"},a.a.createElement("input",{value:t.levelAI,type:"range",min:"0",max:"3",step:"1",onChange:function(e){return o(parseInt(e.target.value,10))}}),a.a.createElement("div",{className:"player-selector-ai-level-text"},function(e){switch(e){case 0:return"Super Easy";case 1:return"Very Easy";case 2:return"Easy";case 3:default:return"Normal"}}(t.levelAI)))))};n(75);var Ar=function(e){var t=e.className,n=Object(b.b)(),c=Object(b.c)(St),i=Object(b.c)((function(e){return e.mainUI.selectedCircuit})),o=At[i];Object(r.useEffect)((function(){var e;c.length&&c.length>o.maxPlayers&&n((e=o.maxPlayers,function(t,n){var r=n(),a=r.mainUI.selectedPlayers,c=r.mainUI.selectedPlayerOrder,i=function(e,t){return t.map((function(t){return e.find((function(e){return e.id===t}))}))}(a,c);t(Ie(i.slice(0,e),c.slice(0,e)))}))}),[c,o,n]);var u=Object(b.c)((function(e){return e.mainUI.randomizePlayerOrderOnStart})),l=Object(b.c)((function(e){return e.mainUI.playWithTimer})),s=c.length>1;return a.a.createElement("div",{className:ut()("full-screen full-screen-with-header-and-footer",t)},a.a.createElement("div",{className:"menu-header transition-from-right"},a.a.createElement(st,{variant:"small"}),a.a.createElement("h1",{className:"menu-header-title"},"Choose players")),a.a.createElement("div",{className:"menu-content player-selection-content transition-from-right"},a.a.createElement("div",{className:"player-selection-content-inner"},c.map((function(e){return a.a.createElement(Cr,{key:e.id,player:e,onRemove:function(){var t;s&&n((t=e.id,{type:Oe,playerId:t}))},canBeRemoved:s,onNameChange:function(t){return n(Pe(e.id,{name:t}))},onTypeChange:function(t){return n(Pe(e.id,{type:t}))},onSelectNewStyle:function(){return n(Tr(e))},onLevelAIChange:function(t){return n(Pe(e.id,{levelAI:t}))}})})),c.length<o.maxPlayers&&a.a.createElement("button",{type:"button",className:"button player-selection-add-player-button",onClick:function(){return n((function(e,t){var n=t(),r=n.mainUI.selectedPlayerOrder,a=n.mainUI.selectedPlayers,c=Object.values(pe),i=a.map((function(e){return e.name})),o=a.map((function(e){return e.style})),u=ve((function(){return fe(c)}),o),l=ve(ge,i),s={id:Object(Ht.v4)(),name:l,style:u,type:k,levelAI:0};e(Ie(a.concat(s),r.concat(s.id)))}))}},"Add Player"),c.length>1&&a.a.createElement("div",{className:"transition-from-right"},a.a.createElement("label",{className:"player-selection-checkbox"},a.a.createElement("input",{type:"checkbox",checked:u,onChange:function(){return n({type:xe})}}),"Randomize player order when race starts")),a.a.createElement("div",{className:"transition-from-right"},a.a.createElement("label",{className:"player-selection-checkbox player-selection-checkbox-last"},a.a.createElement("input",{type:"checkbox",checked:l,onChange:function(){return n({type:ke})}}),"Play with timer")))),a.a.createElement("footer",{className:"menu-footer transition-from-right"},a.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(je(X))}},"Back"),a.a.createElement("div",{className:"menu-footer-filler"}),a.a.createElement("button",{className:"button",type:"button",onClick:function(){n(sn())}},"Start game!")))},wr=(n(76),Object.values(At));var _r=function(){var e=Object(r.useState)([]),t=Object(at.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(wr[0]),o=Object(at.a)(i,2),u=o[0],l=o[1];Object(r.useEffect)((function(){u.id&&c(Bt(u.id))}),[u]);var s=Object(b.b)();return a.a.createElement("div",{className:"full-screen full-screen-with-header-and-footer high-scores"},a.a.createElement("div",{className:"menu-header transition-from-top"},a.a.createElement(st,{variant:"small"}),a.a.createElement("h1",{className:"menu-header-title"},"High scores")),a.a.createElement("div",{className:"menu-content transition-from-bottom"},a.a.createElement("div",{className:"high-scores-circuit-tabs-container"},a.a.createElement("div",{className:"high-scores-circuit-tabs"},wr.map((function(e){return a.a.createElement("div",{key:e.id,className:ut()("high-scores-circuit-tab",{"is-active":e.id===u.id})},a.a.createElement("div",{onClick:function(){return l(e)}},e.name))})))),a.a.createElement("div",{className:"high-scores-circuit"},a.a.createElement(fr,{circuit:u,scores:n,canReplay:!0}))),a.a.createElement("footer",{className:"menu-footer transition-from-bottom"},a.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){s(je(V))}},"Back")))},zr=(n(77),function(e){var t=e.className,n=Object(b.b)();return a.a.createElement("div",{className:ut()("full-screen","full-screen-with-header-and-footer",t)},a.a.createElement("div",{className:"menu-header transition-from-right"},a.a.createElement(st,{variant:"small"}),a.a.createElement("h1",{className:"menu-header-title"},"Credits")),a.a.createElement("div",{className:"menu-content transition-from-right credits-content"},a.a.createElement("div",{className:"credits-content-item"},a.a.createElement("p",null,"Created by Paco G\xf3mez Granados"),a.a.createElement("p",null,a.a.createElement("a",{href:"https://pacog.github.io/portfolio/",target:"_BLANK",rel:"noopener noreferrer"},"https://pacog.github.io/portfolio/")),a.a.createElement("p",null,a.a.createElement("a",{href:"https://twitter.com/PacoGomezGrana",target:"_BLANK",rel:"noopener noreferrer"},"@PacoGomezGrana"))),a.a.createElement("div",{className:"credits-content-item"},a.a.createElement("p",null,"Based on an original idea by"),a.a.createElement("p",null,a.a.createElement("a",{href:"https://twitter.com/esqizo",target:"_BLANK",rel:"noopener noreferrer"},"@esqizo")," ","and cousins")),a.a.createElement("div",{className:"credits-content-item"},a.a.createElement("p",null,"Circuit graphics inspired by"),a.a.createElement("p",null,a.a.createElement("a",{href:"https://codepen.io/ste-vg",target:"_BLANK",rel:"noopener noreferrer"},"Steve Gardner"),"\xb4s"," ",a.a.createElement("a",{href:"https://codepen.io/ste-vg/full/BaaQamG",target:"_BLANK",rel:"noopener noreferrer"},"Race Car Island")))),a.a.createElement("footer",{className:"menu-footer transition-from-right"},a.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(je(V))}},"Back")))}),Rr=(n(78),function(e){var t=e.className;return a.a.createElement("div",{className:ut()("full-screen",t)},a.a.createElement("div",{className:"loading-game"},a.a.createElement("div",{className:"lds-ellipsis"},a.a.createElement("div",null),a.a.createElement("div",null),a.a.createElement("div",null),a.a.createElement("div",null))))}),Mr=(n(79),re);var Lr=function(e){var t=e.raceHistory,n=e.isActive,c=Object(r.useRef)(null);Object(r.useEffect)((function(){!function(e,t){if(!e)return;e.style.setProperty("--player-trail-color",t.dotColor),e.style.setProperty("--player-trail-size","".concat(t.dotSize,"px")),e.style.setProperty("--player-trail-border-radius",t.round)}(c.current,t.style||Mr)}),[t]);var i=Object(b.c)((function(e){return e}));if(!t.path.length)return"";var o=t.path.map((function(e){return pt(i,e)}));return a.a.createElement("div",{className:ut()("player-trail-container",{"is-active":n}),ref:c},a.a.createElement("svg",{className:"player-trail"},a.a.createElement(Fn.a,{points:o,stroke:Mr.trailColor,strokeWidth:Mr.trailWidth,fill:"none",r:2})),o.map((function(e,t){return Object(x.a)({},e,{turn:t+1})})).map((function(e){return a.a.createElement("div",{key:"".concat(e.x,"_").concat(e.y,"_").concat(e.turn),className:"player-trail-point",style:{left:e.x,top:e.y}})})))},Ur=function(e){var t=e.playerInPosition,n=Object(b.c)((function(e){return jt(e)})),r=Object(b.c)((function(e){return e.map.zoom})),c=Object(b.c)((function(e){return e.map.gridSize})),i=Object(b.c)((function(e){return e.game.circuitInfo}));return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"replay-game-board-circuit-bg",style:{backgroundImage:"url(".concat(i.bgImg,")"),backgroundSize:"".concat(i.width,"px ").concat(i.height,"px")}}),a.a.createElement(Dn,{zoom:r,cellSize:c}),a.a.createElement(Wn,{player:t,isActive:!0}),a.a.createElement(Lr,{raceHistory:n,isActive:!0}))};Ur.defaultProps={};var Dr=Ur,Gr=(n(80),function(){var e=Object(b.c)((function(e){return jt(e)})),t=Object(r.useState)(null),n=Object(at.a)(t,2),c=n[0],i=n[1],o=Object(r.useState)(0),u=Object(at.a)(o,2),l=u[0],s=u[1],m=Object(b.b)();return Object(r.useEffect)((function(){e&&i({id:e.id,name:e.name,style:e.playerStyle,position:e.path[l],speed:{x:0,y:0},prevPositions:[]})}),[e,l]),a.a.createElement("div",{className:"game-board-container"},c&&a.a.createElement(Rn,{currentPlayer:c},a.a.createElement(Dr,{playerInPosition:c})),a.a.createElement("div",{className:"game-board-back-button-container"},a.a.createElement("button",{type:"button",className:"button button-small",onClick:function(){return m(je(V))}},"Back")),e&&e.path.length&&a.a.createElement("div",{className:"replay-game-board-turn-selector"},a.a.createElement("span",{className:"replay-game-board-turn-selector-label"},"Turn:"," "),a.a.createElement("input",{type:"range",value:l,max:e.path.length-1,onChange:function(e){return s(parseFloat(e.target.value))}}),a.a.createElement("span",{className:"replay-game-board-turn-selector-value"},l+1)))});Gr.defaultProps={};var Wr=Gr,Fr=(n(81),function(){return a.a.createElement("div",{className:"transition-opacity"},a.a.createElement(Wr,null))});var Hr=function(e){var t=e.onNext;return a.a.createElement("div",{className:"tutorial-screen"},a.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-0 "}),a.a.createElement("div",{className:"tutorial-screen-text"},a.a.createElement("div",{className:"tutorial-screen-text-filler"},a.a.createElement("p",null,"This is your car.")),a.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Next")))};var Yr=function(e){var t=e.onNext;return a.a.createElement("div",{className:"tutorial-screen"},a.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-1 "}),a.a.createElement("div",{className:"tutorial-screen-text"},a.a.createElement("div",{className:"tutorial-screen-text-filler"},a.a.createElement("p",null,"You can move it by clicking in of the 9 buttons.")),a.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Next")))};var Br=function(e){var t=e.onNext;return a.a.createElement("div",{className:"tutorial-screen"},a.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-2 "}),a.a.createElement("div",{className:"tutorial-screen-text"},a.a.createElement("div",{className:"tutorial-screen-text-filler"},a.a.createElement("p",null,"Your next move will depend on your previous move, so be careful!")),a.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Next")))};var qr=function(e){var t=e.onNext;return a.a.createElement("div",{className:"tutorial-screen"},a.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-3 "}),a.a.createElement("div",{className:"tutorial-screen-text"},a.a.createElement("div",{className:"tutorial-screen-text-filler"},a.a.createElement("p",null,"If you go too fast, you may crash and be penalised.")),a.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Done!")))};n(82);var Jr=function(e){var t=e.className,n=Object(b.b)(),c=Object(r.useState)(0),i=Object(at.a)(c,2),o=i[0],u=i[1],l=function(){u(o+1)};return a.a.createElement("div",{className:ut()("full-screen full-screen-with-header-and-footer",t)},a.a.createElement("div",{className:"menu-header transition-from-right"},a.a.createElement(st,{variant:"small"}),a.a.createElement("h1",{className:"menu-header-title"},"How to play")),a.a.createElement("div",{className:"menu-content transition-from-right tutorial-screen-container"},0===o&&a.a.createElement(Hr,{onNext:l}),1===o&&a.a.createElement(Yr,{onNext:l}),2===o&&a.a.createElement(Br,{onNext:l}),3===o&&a.a.createElement(qr,{onNext:function(){n(je(V))}})),a.a.createElement("footer",{className:"menu-footer transition-from-right"},a.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(je(V))}},"Back"),a.a.createElement("div",{className:"menu-footer-filler"})))};var Vr=function(){var e=Object(r.useState)(!1),t=Object(at.a)(e,2),n=t[0],c=t[1],i=Object(b.c)((function(e){return e.mainUI.currentScreen}));Object(r.useEffect)((function(){var e=setTimeout((function(){c(!0)}),500);return function(){return clearTimeout(e)}}),[]);var o=[{screenName:V,Component:mt},{screenName:X,Component:Pr},{screenName:Q,Component:Ar},{screenName:Z,Component:_r},{screenName:K,Component:kr},{screenName:$,Component:zr},{screenName:ee,Component:Rr},{screenName:te,Component:Fr},{screenName:ne,Component:Jr}];return a.a.createElement(ct.a,{className:"menu-screen"},o.filter((function(e){var t=e.screenName;return n&&i===t})).map((function(e){var t=e.screenName,n=e.Component;return a.a.createElement(it.a,{key:t.toString(),timeout:300,classNames:"fade"},a.a.createElement(n,null))})))},Kr=(n(83),Object(E.createStore)(nt,Object(N.composeWithDevTools)(Object(E.applyMiddleware)(O.a))));var Xr=function(){return Object(r.useEffect)((function(){!function(e){var t=e.players;t&&Kr.dispatch(Ie(t.players,t.playerOrder))}({players:rt()})}),[]),a.a.createElement(b.a,{store:Kr},a.a.createElement(Vr,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Qr=n(37),Zr=n.n(Qr);window.capac_racer_version="1.1.1",i.a.render(a.a.createElement(Xr,null),document.getElementById("root")),m||(requestAnimationFrame(f),m=!0),g((function(e){s.notifyTimePassed(e)})),function(){var e=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};window.addEventListener("resize",Zr()(e,200)),e()}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}]),[[43,1,2]]]);
//# sourceMappingURL=main.2a4a83db.chunk.js.map