(this["webpackJsonpcapac-racer"]=this["webpackJsonpcapac-racer"]||[]).push([[0],Array(27).concat([function(e,t,n){},,,,,,,,,,,,,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFYWFhAAAAQQerqwAAAAJ0Uk5T/wDltzBKAAAAFklEQVR4nGNggIH6/2DwYJQx0hkwAABHzKo6mLcE9gAAAABJRU5ErkJggg=="},,,,,,,function(e,t,n){e.exports=n(85)},function(e,t){},,,,,function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(48);var a=n(0),r=n.n(a),c=n(15),i=n.n(c),o=n(11),s=n(12),l=function(){function e(t){var n=t.timeToWait,a=void 0===n?1e4:n,r=t.started,c=void 0!==r&&r;Object(o.a)(this,e),this._elapsedTime=0,this._timeToWait=a,this._isRunning=c}return Object(s.a)(e,[{key:"setTimeToWait",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;e<=0&&(this._timeToWait=Number.MAX_VALUE)}},{key:"notifyTimePassed",value:function(e){this._isRunning&&(this._elapsedTime+=e,this._elapsedTime>=this._timeToWait&&(this._callbackOnEnd(),this._isRunning=!1))}},{key:"restart",value:function(e){var t=e.callbackOnEnd,n=void 0===t?function(){}:t;this._elapsedTime=0,this._isRunning=!0,this._callbackOnEnd=n}},{key:"pause",value:function(){this._isRunning=!1}},{key:"unpause",value:function(){this._isRunning=!0}},{key:"stop",value:function(){this._isRunning=!1,this._callbackOnEnd=null}},{key:"reset",value:function(){this._elapsedTime=0,this._isRunning=!1,this._callbackOnEnd=null}},{key:"getTimeLeft",value:function(){return Math.max(this._timeToWait-this._elapsedTime,0)}},{key:"getTimePassed",value:function(){return this._elapsedTime}}]),e}(),u=new l({timeToWait:30999}),m=!1,d=0,p=0;function f(e){for(d+=e-p,p=e;d>=1e3/60;)h(1e3/60),d-=1e3/60;requestAnimationFrame(f)}var v=[];function h(e){v.forEach((function(t){return t(e)}))}var y=function(e){v=v.filter((function(t){return e!==t}))},E=function(e){return v=v.concat([e]),function(){y(e)}},g=(n(53),n(1)),b=n(7),N=n(34),S=n(35),O=n(5),P=n(3),I="HUMAN",T="AI",x=n(13),_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.max(Math.min(e,n),t)},k=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},C=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},A=function(e,t){return e.x===t.x&&e.y===t.y},j=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},w=function(e,t){return j(C(e,t))},R=function(e){return{x:Math.round(e.x),y:Math.round(e.y)}},L=function(e,t,n){return e.x>=t.topLeft.x+n.x&&e.x<=t.topLeft.x+t.size.width-n.x&&e.y>=t.topLeft.y+n.y&&e.y<=t.topLeft.y+t.size.height-n.y},z=function(e,t,n){var a=t.topLeft.x+n.x,r=t.topLeft.x+t.size.width-n.x,c=t.topLeft.y+n.y,i=t.topLeft.y+t.size.height-n.y;return{x:_(e.x,a,r),y:_(e.y,c,i)}},D=function(e,t,n){var a=C(t,e.position),r=j(a);return Object(P.a)({},e,{position:t,speed:a,prevPositions:e.prevPositions.concat(t),turnsSpent:e.turnsSpent+1,maxSpeed:Math.max(r,e.maxSpeed),realTimeUsed:e.realTimeUsed+n})},M=function(e,t,n){var a=Math.floor(t/3);return Object(P.a)({},e,{speed:{x:0,y:0},turnsGrounded:a,crashes:e.crashes+1,turnsSpent:e.turnsSpent+1,realTimeUsed:e.realTimeUsed+n})},G=function(e){return Object(P.a)({},e,{turnsGrounded:Math.max(0,e.turnsGrounded-1),turnsSpent:e.turnsSpent+1})},U=function(e,t){var n=e.checkpointsPassed.slice();return t.sort().forEach((function(e){(0===e||n[e-1])&&(n[e]=!0)})),Object(P.a)({},e,{checkpointsPassed:n})},Y=n(89),H={},F=function(e){if(!H[e])return H[e]=!0,e;var t="".concat(e,"__").concat(Object(Y.a)());return H[t]=!0,t},W={MOVE_TO:F("MOVE_TO"),SET_PLAYERS:F("SET_PLAYERS"),NOTIFY_COLLISION:F("NOTIFY_COLLISION"),REDUCE_GROUNDED:F("REDUCE_GROUNDED"),NOTIFY_VISITED_CHECKPOINTS:F("NOTIFY_VISITED_CHECKPOINTS")},V=Object(b.combineReducers)({byId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W.SET_PLAYERS:return t.players.reduce((function(e,t){return Object(P.a)({},e,Object(O.a)({},t.id,Object(P.a)({},B,{},t)))}),{});case W.MOVE_TO:return Object(P.a)({},e,Object(O.a)({},t.playerId,D(e[t.playerId],t.position,t.timePassed)));case W.NOTIFY_COLLISION:return Object(P.a)({},e,Object(O.a)({},t.playerId,M(e[t.playerId],t.speed,t.timePassed)));case W.REDUCE_GROUNDED:return Object(P.a)({},e,Object(O.a)({},t.playerId,G(e[t.playerId])));case W.NOTIFY_VISITED_CHECKPOINTS:return Object(P.a)({},e,Object(O.a)({},t.playerId,U(e[t.playerId],t.newCheckpointIndexes)));default:return e}}}),B={position:{x:0,y:0},speed:{x:0,y:0},prevPositions:[],turnsGrounded:0,checkpointsPassed:[!1],turnsSpent:0,realTimeUsed:0,maxSpeed:0,crashes:0,type:I,levelAI:0};var q,J=V,K=Object(b.combineReducers)({zoom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1?arguments[1]:void 0;return t.type,e},gridSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1?arguments[1]:void 0;return t.type,e}}),Z=F("MAIN_MENU"),X=F("GAME"),Q=F("CIRCUIT_SELECTION"),$=F("PLAYERS_SELECTION"),ee=F("HIGH_SCORES"),te=F("CREDITS"),ne=F("LOADING_GAME"),ae=F("REPLAY_GAME"),re=F("TUTORIAL"),ce={id:"car",name:"car",dotColor:"#e4223c",dotSize:12,round:"50%",trailColor:"#e4223c",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/car.png")},ie={id:"rocket",name:"rocket",dotColor:"#39c3b6",dotSize:12,round:"50%",trailColor:"#39c3b6",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/rocket.png")},oe={id:"turtle",name:"turtle",dotColor:"#43c830",dotSize:12,round:"50%",trailColor:"#43c830",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/turtle.png")},se={id:"skull",name:"skull",dotColor:"#9a9e9f",dotSize:12,round:"50%",trailColor:"#9a9e9f",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/skull.png")},le={id:"clown",name:"clown",dotColor:"#fdfffc",dotSize:12,round:"50%",trailColor:"#fdfffc",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/clown.png")},ue={id:"dancer",name:"dancer",dotColor:"#5c0eab",dotSize:12,round:"50%",trailColor:"#5c0eab",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/dancer.png")},me={id:"panda",name:"panda",dotColor:"#212121",dotSize:12,round:"50%",trailColor:"#212121",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/panda.png")},de={id:"coffin",name:"coffin",dotColor:"#ad7222",dotSize:12,round:"50%",trailColor:"#ad7222",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/coffin.png")},pe={id:"broom",name:"broom",dotColor:"#c5db0f",dotSize:12,round:"50%",trailColor:"#c5db0f",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/broom.png")},fe={id:"sailboat",name:"sailboat",dotColor:"#016fdf",dotSize:12,round:"50%",trailColor:"#016fdf",trailDotsSize:6,trailWidth:2,icon:"".concat("/capac-racer","/player-icons/sailboat.png")},ve=(q={},Object(O.a)(q,ce.id,ce),Object(O.a)(q,ie.id,ie),Object(O.a)(q,oe.id,oe),Object(O.a)(q,se.id,se),Object(O.a)(q,le.id,le),Object(O.a)(q,ue.id,ue),Object(O.a)(q,me.id,me),Object(O.a)(q,de.id,de),Object(O.a)(q,pe.id,pe),Object(O.a)(q,fe.id,fe),q),he=function(e){return e&&e.length?e[Math.floor(Math.random()*e.length)]:null},ye=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return e===t},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4,r=function(a){var r=e();if(!t.find((function(e){return n(e,r)})))return{v:r}},c=0;c<a;c+=1){var i=r(c);if("object"===typeof i)return i.v}throw new Error("keepPickingUntilNotInArray: tried ".concat(a," times, no luck"))},Ee=["Max","Carlitros","Michael","Fernando","Lol\xedn","Esquizo","Agapito","Tolomeo"],ge=["Cucaracha","Aubergine","Tentacles","Rex","Danger","Senna","Alonso","Schumacher","Jander"],be=function(){return"".concat(he(Ee)," ").concat(he(ge))},Ne={CHANGE_SCREEN:F("CHANGE_SCREEN"),SET_SELECTED_CIRCUIT:F("SET_SELECTED_CIRCUIT"),SET_SELECTED_PLAYERS:F("SET_SELECTED_PLAYERS"),REMOVE_PLAYER:F("REMOVE_PLAYER"),UPDATE_PLAYER:F("UPDATE_PLAYER"),TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:"TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START",TOGGLE_PLAY_WITH_TIMER:F("TOGGLE_PLAY_WITH_TIMER")},Se=function(e){return{type:Ne.CHANGE_SCREEN,screenId:e}},Oe=function(e,t){return{type:Ne.SET_SELECTED_PLAYERS,players:e,playerOrder:t}},Pe=function(e,t){return{type:Ne.UPDATE_PLAYER,playerId:e,attrsToUpdate:t}},Ie=[{id:"DEFAULT_PLAYER",name:be(),style:he(Object.values(ve)),type:I,levelAI:0}],Te=["DEFAULT_PLAYER"],xe=Object(b.combineReducers)({currentScreen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne.CHANGE_SCREEN:return t.screenId;default:return e}},selectedCircuit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne.SET_SELECTED_CIRCUIT:return t.circuitId;default:return e}},selectedPlayerOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne.SET_SELECTED_PLAYERS:return t.playerOrder;case Ne.REMOVE_PLAYER:return e.filter((function(e){return e!==t.playerId}));default:return e}},selectedPlayers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne.SET_SELECTED_PLAYERS:return t.players;case Ne.REMOVE_PLAYER:return e.filter((function(e){return e.id!==t.playerId}));case Ne.UPDATE_PLAYER:return e.map((function(e){return e.id!==t.playerId?e:Object(P.a)({},e,{},t.attrsToUpdate)}));default:return e}},randomizePlayerOrderOnStart:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:return!e;default:return e}},playWithTimer:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ne.TOGGLE_PLAY_WITH_TIMER:return!e;default:return e}}}),_e=F("NOT_STARTED"),ke=F("START_SCREEN"),Ce=F("PLAYER_TURN_START_SCREEN"),Ae=F("WAITING_FOR_PLAYER_INPUT"),je=(F("ANIMATING_PLAYER_MOVEMENT"),F("ANIMATING_RANDOM_PLAYER_MOVEMENT")),we=F("NOTIFY_COLLISION"),Re=F("NOTIFY_AI_COLLISION"),Le=F("NOTIFY_GROUNDED"),ze=F("NOTIFY_AI_GROUNDED"),De=F("NOTIFY_VICTORY"),Me=F("NOTIFY_HIGH_SCORE"),Ge=F("SHOW_MENU"),Ue=F("AI_THINKING_SCREEN"),Ye={INIT_GAME:F("INIT_GAME"),INIT_REPLAY:F("INIT_REPLAY"),SET_GAME_STATE:F("SET_GAME_STATE"),ADVANCE_PLAYER_TURN:F("ADVANCE_PLAYER_TURN"),SET_CIRCUIT:F("SET_CIRCUIT"),SET_LATEST_HIGH_SCORE:F("SET_LATEST_HIGH_SCORE"),SET_SELECTED_POSITION:F("SET_SELECTED_POSITION"),SET_SELECTED_AI_MOVE:F("SET_SELECTED_AI_MOVE")},He=function(e){return{type:Ye.SET_GAME_STATE,newGameState:e}},Fe={gameState:_e,prevGameState:null,players:[],currentTurnPlayerId:null,circuitInfo:null,latestHighScore:null,selectedPosition:null,raceHistory:null,selectedAIMove:null},We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.INIT_GAME:return Object(P.a)({},e,{gameState:ke,currentTurnPlayerId:t.playerOrder[0],players:t.playerOrder.slice(),circuitInfo:Object(P.a)({},t.circuitInfo),latestHighScore:null,selectedPosition:null,selectedAIMove:null});case Ye.INIT_REPLAY:return Object(P.a)({},e,{gameState:ke,circuitInfo:Object(P.a)({},t.circuitInfo),raceHistory:t.raceHistory});case Ye.ADVANCE_PLAYER_TURN:return Object(P.a)({},e,{currentTurnPlayerId:Ve(e.players,e.currentTurnPlayerId),selectedPosition:null,selectedAIMove:null});case Ye.SET_GAME_STATE:return Object(P.a)({},e,{gameState:t.newGameState,prevGameState:e.gameState});case Ye.SET_LATEST_HIGH_SCORE:return Object(P.a)({},e,{latestHighScore:t.highScore});case Ye.SET_SELECTED_POSITION:return Object(P.a)({},e,{selectedPosition:t.newPosition});case Ye.SET_SELECTED_AI_MOVE:return Object(P.a)({},e,{selectedAIMove:t.newMove});default:return e}};function Ve(e,t){var n=e.indexOf(t);return e[(n+1)%e.length]}var Be=Object(b.combineReducers)({players:J,map:K,mainUI:xe,game:We}),qe=function(){if(!window.localStorage)return null;var e;try{e=window.localStorage.getItem("players")}catch(t){return null}return e?JSON.parse(e):null},Je=n(6),Ke=n(90),Ze=n(88),Xe=n(4),Qe=n.n(Xe);n(58);function $e(e){var t=e.variant;return r.a.createElement("div",{className:"logo logo-".concat(t)},r.a.createElement("div",{className:"logo-up"},"Capac"),r.a.createElement("div",{className:"logo-down"},"Racer"))}$e.defaultProps={variant:"big"};var et=$e,tt=(n(59),function(e){var t=e.className,n=Object(g.c)();return r.a.createElement("div",{className:Qe()("full-screen",t)},r.a.createElement("div",{className:"main-menu-content"},r.a.createElement("div",{className:"transition-from-left"},r.a.createElement(et,null)),r.a.createElement("div",{className:"main-menu-buttons transition-from-right"},r.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(Se(Q))}},"Start new game"),r.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(Se(re))}},"How to play"),r.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(Se(ee))}},"High scores"),r.a.createElement("button",{className:"button",type:"button",onClick:function(){return n(Se(te))}},"Credits"))),r.a.createElement("div",{className:"app-version"},"v",window.capac_racer_version))}),nt=function(e,t,n){var a=function(e){return"number"===typeof e?e*t*n:e};return{x:a(e.x),y:a(e.y),dx:a(e.dx),dy:a(e.dy),baseX:a(e.baseX),baseY:a(e.baseY)}},at=function(e){return e.map.zoom},rt=function(e){return e.map.gridSize},ct=function(e,t){if(!t)return t;var n=e.map.zoom,a=e.map.gridSize;return nt(t,a,n)},it=function(e,t){for(var n={x:e.position.x+e.speed.x,y:e.position.y+e.speed.y},a=[],r=-1;r<=1;r+=1)for(var c=-1;c<=1;c+=1)a.push({baseX:n.x,baseY:n.y,x:n.x+r,y:n.y+c,dx:r,dy:c});return a.filter((function(e){return!function(e,t){return!!t.map((function(e){return e.position})).find((function(t){return A(t,e)}))}(e,t)}))};var ot=function(e){return e.game.gameState===Ae},st=function(e){return e.game.gameState===je},lt=function(e){return e.game.gameState===Ue},ut=function(e){return e.game.selectedAIMove},mt=function(e){return function(e){return e.game.gameState!==_e}(e)?e.players.byId[e.game.currentTurnPlayerId]:null},dt=function(e){return e.game.players.map((function(t){return e.players.byId[t]}))},pt=function(e,t){return dt(e).filter((function(e){return e.id!==t}))},ft=function(e,t){return pt(e,t).map((function(e){return e.position})).map((function(t){return ct(e,t)}))},vt=function(e){return e.game.gameState},ht=function(e){var t=e.mainUI.selectedPlayerOrder,n=e.mainUI.selectedPlayers;return t.map((function(e){return n.find((function(t){return t.id===e}))}))},yt=function(e,t){var n=dt(e).filter((function(e){return e.id!==t.id}));return it(t,n).map((function(t){return{screen:ct(e,t),position:t}}))},Et=function(e,t){if(!t.prevPositions.length||t.prevPositions.length<2)return null;var n=t.prevPositions[t.prevPositions.length-2],a={x:n.x-t.position.x,y:n.y-t.position.y};return ct(e,a)},gt=function(e,t){var n={x:t.position.x+t.speed.x,y:t.position.y+t.speed.y};return ct(e,n)},bt=function(e){return e.game.latestHighScore},Nt=function(e){return e.game.selectedPosition},St=function(e){return e.game.raceHistory},Ot=function(e){return e.game.circuitInfo},Pt=function(e){return e.mainUI.currentScreen},It=function(e){return e.mainUI.selectedCircuit},Tt=function(e){return e.mainUI.randomizePlayerOrderOnStart},xt=function(e){return e.mainUI.playWithTimer},_t=n(10),kt=n.n(_t),Ct=n(20),At=n(36),jt=n.n(At),wt={mouth:{id:"mouth",name:"Mouth",collisionImg:"".concat("/capac-racer","/circuits/circuit1/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit1/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit1/cp1.png"),"".concat("/capac-racer","/circuits/circuit1/cp2.png"),"".concat("/capac-racer","/circuits/circuit1/cp3.png"),"".concat("/capac-racer","/circuits/circuit1/cp4.png"),"".concat("/capac-racer","/circuits/circuit1/cp5.png"),"".concat("/capac-racer","/circuits/circuit1/cp6.png"),"".concat("/capac-racer","/circuits/circuit1/cp7.png"),"".concat("/capac-racer","/circuits/circuit1/cp8.png"),"".concat("/capac-racer","/circuits/circuit1/cp9.png")],maxPlayers:3,startingPositions:[{x:37,y:22},{x:37,y:23},{x:37,y:24}],initialSpeed:{x:2,y:0}},heart:{id:"heart",name:"Heart",collisionImg:"".concat("/capac-racer","/circuits/circuit2/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit2/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit2/cp1.png"),"".concat("/capac-racer","/circuits/circuit2/cp2.png"),"".concat("/capac-racer","/circuits/circuit2/cp3.png"),"".concat("/capac-racer","/circuits/circuit2/cp4.png"),"".concat("/capac-racer","/circuits/circuit2/cp5.png"),"".concat("/capac-racer","/circuits/circuit2/cp6.png"),"".concat("/capac-racer","/circuits/circuit2/cp7.png")],maxPlayers:3,startingPositions:[{x:37,y:28},{x:36,y:27},{x:35,y:26}],initialSpeed:{x:2,y:-2}},rosco:{id:"rosco",name:"Rosco",collisionImg:"".concat("/capac-racer","/circuits/circuit3/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit3/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit3/cp1.png"),"".concat("/capac-racer","/circuits/circuit3/cp2.png"),"".concat("/capac-racer","/circuits/circuit3/cp3.png"),"".concat("/capac-racer","/circuits/circuit3/cp4.png"),"".concat("/capac-racer","/circuits/circuit3/cp5.png"),"".concat("/capac-racer","/circuits/circuit3/cp6.png"),"".concat("/capac-racer","/circuits/circuit3/cp7.png"),"".concat("/capac-racer","/circuits/circuit3/cp8.png")],maxPlayers:4,startingPositions:[{x:33,y:34},{x:33,y:33},{x:33,y:32},{x:33,y:35}],initialSpeed:{x:-2,y:0}},horse:{id:"horse",name:"Horse",collisionImg:"".concat("/capac-racer","/circuits/circuit4/collision.png"),bgImg:"".concat("/capac-racer","/circuits/circuit4/bg.png"),checkpoints:["".concat("/capac-racer","/circuits/circuit4/cp1.png"),"".concat("/capac-racer","/circuits/circuit4/cp2.png"),"".concat("/capac-racer","/circuits/circuit4/cp3.png"),"".concat("/capac-racer","/circuits/circuit4/cp4.png"),"".concat("/capac-racer","/circuits/circuit4/cp5.png"),"".concat("/capac-racer","/circuits/circuit4/cp6.png"),"".concat("/capac-racer","/circuits/circuit4/cp7.png"),"".concat("/capac-racer","/circuits/circuit4/cp8.png"),"".concat("/capac-racer","/circuits/circuit4/cp9.png"),"".concat("/capac-racer","/circuits/circuit4/cp10.png"),"".concat("/capac-racer","/circuits/circuit4/cp11.png"),"".concat("/capac-racer","/circuits/circuit4/cp12.png"),"".concat("/capac-racer","/circuits/circuit4/cp13.png"),"".concat("/capac-racer","/circuits/circuit4/cp14.png"),"".concat("/capac-racer","/circuits/circuit4/cp15.png"),"".concat("/capac-racer","/circuits/circuit4/cp16.png"),"".concat("/capac-racer","/circuits/circuit4/cp17.png"),"".concat("/capac-racer","/circuits/circuit4/cp18.png"),"".concat("/capac-racer","/circuits/circuit4/cp19.png")],maxPlayers:3,startingPositions:[{x:26,y:31},{x:26,y:32},{x:26,y:33}],initialSpeed:{x:2,y:0}}},Rt=function(e){return new Promise((function(t,n){var a=new Image;a.addEventListener("load",(function(){t(a)}),{once:!0}),a.addEventListener("error",(function(e){n(e)}),{once:!0}),a.src=e}))},Lt=function(e){var t=document.createElement("canvas"),n=e.width,a=e.height;t.width=n,t.height=a,t.getContext("2d").drawImage(e,0,0,n,a);var r=t.getContext("2d").getImageData(0,0,n,a).data;return{width:n,height:a,getPixel:function(e,t){var a=4*(e+t*n);return{r:r[a+0],g:r[a+1],b:r[a+2],a:r[a+3]}}}},zt=n(43),Dt=function(e){var t=e.r,n=e.g,a=e.b;return 0!==e.a&&(255!==t||255!==n||255!==a)},Mt=function(){var e=Object(Ct.a)(kt.a.mark((function e(t){var n,a,r,c;return kt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rt(t.collisionImg);case 2:return n=e.sent,e.next=5,Lt(n);case 5:return a=e.sent,e.next=8,Promise.all(t.checkpoints.map((function(e){return Rt(e)})));case 8:return r=e.sent,e.next=11,Promise.all(r.map((function(e){return Lt(e)})));case 11:return c=e.sent,e.abrupt("return",Object(P.a)({},t,{width:n.width,height:n.height,collisionPixelGetter:a,checkpointPixelGetters:c,centerOfCheckpoints:c.map(Wt)}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gt=function(e,t,n){var a=Ft(e).map(R);if(Ht(a,t.collisionPixelGetter))return!0;var r,c=Object(x.a)(a);try{var i=function(){var e=r.value;if(n.find((function(t){return A(t,e)})))return{v:!0}};for(c.s();!(r=c.n()).done;){var o=i();if("object"===typeof o)return o.v}}catch(s){c.e(s)}finally{c.f()}return!1},Ut=function(e){var t=e.from,n=e.to,a=e.circuit,r=e.otherPlayers,c=e.zoom,i=e.gridSize,o=[nt(t,i,c),nt(n,i,c)],s=r.map((function(e){return e.position})).map((function(e){return nt(e,i,c)}));return!Gt(o,a,s)},Yt=function(e,t){var n=Ft(e).map(R);return t.checkpointPixelGetters.map((function(e){return Ht(n,e)})).map((function(e,t){return{doesItCollide:e,index:t}})).filter((function(e){return!!e.doesItCollide})).map((function(e){return e.index}))};function Ht(e,t){var n,a=Object(x.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value,c=t.getPixel(r.x,r.y);if(Dt(c))return!0}}catch(i){a.e(i)}finally{a.f()}return!1}function Ft(e){var t=Object(Je.a)(e,2),n=t[0],a=t[1],r=w(n,a),c=Math.ceil(2*r);if(c<2)return[];var i,o=C(a,n);return(i=c,Object(zt.a)(Array(i).keys())).map((function(e){return k(n,function(e,t){return{x:e.x*t,y:e.y*t}}(o,e/(c-1)))}))}function Wt(e){for(var t=[],n=0;n<e.width;n+=1)for(var a=0;a<e.height;a+=1)Dt(e.getPixel(n,a))&&t.push([n,a]);if(!t.length)return null;var r=t.reduce((function(e,n){return[e[0]+n[0]/t.length,e[1]+n[1]/t.length]}),[0,0]);return{x:r[0],y:r[1]}}var Vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){var n=new l({timeToWait:e}),a=function(e){n.notifyTimePassed(e)};E(a),n.restart({callbackOnEnd:function(){y(a),n.stop(),t()}})}))},Bt=function(){try{return JSON.parse(localStorage.getItem("high-scores"))||{}}catch(e){return{}}},qt=function(e){return(Bt()[e]||[]).map((function(e){return Object(P.a)({},e,{date:new Date(e.date)})}))},Jt=function(e,t,n){if(n.type===T)return!1;var a=qt(t.id);return a.length<5||!!Zt(e,a[a.length-1])},Kt=function(e,t,n){if(!Jt(e,t,n))return null;for(var a,r=qt(t.id),c=0;c<r.length;c+=1)if(Zt(e,r[c])){a=c;break}var i=Object(P.a)({},e,{id:Object(Y.a)()}),o=r.slice();return"number"===typeof a?o.splice(a,0,i):o.push(i),function(e,t){var n=Bt(),a=Object(P.a)({},n,Object(O.a)({},e.id,t));try{localStorage.setItem("high-scores",JSON.stringify(a,void 0,2))}catch(r){console.warn("error saving high score",r)}}(t,o=o.slice(0,5)),i};function Zt(e,t){return!(e.turns>t.turns)&&(e.turns<t.turns||e.realTimeUsed<t.realTimeUsed)}n(61);var Xt=n(44),Qt=n(37),$t=[{randomSolutionChance:.2,maxIterations:50,maxThinkingDepth:5,timeThinking:{min:2500,max:3500}},{randomSolutionChance:.15,maxIterations:200,maxThinkingDepth:10,timeThinking:{min:1500,max:2500}},{randomSolutionChance:.07,maxIterations:700,maxThinkingDepth:30,timeThinking:{min:700,max:2e3}},{randomSolutionChance:0,maxIterations:1500,maxThinkingDepth:99999,timeThinking:{min:100,max:300}}],en=function(){function e(t,n,a,r,c){Object(o.a)(this,e),this.playerInfo=Object(P.a)({},t,{prevPositions:t.prevPositions.slice(),checkpointsPassed:t.checkpointsPassed.slice()}),this.currentIteration=n,this.circuit=a,this.mapZoom=r,this.mapGridSize=c,this._updatePartialScore()}return Object(s.a)(e,[{key:"expand",value:function(t,n){var a=this;if(this.currentIteration>=n)return[];var r=1===this.currentIteration?t:[];return it(this.playerInfo,r).filter((function(e){return function(e){return Ut({from:a.playerInfo.position,to:e,zoom:a.mapZoom,gridSize:a.mapGridSize,circuit:a.circuit,otherPlayers:[]})}(e)})).map((function(e){var t=function(e){var t=e.from,n=e.to,a=e.circuit,r=e.zoom,c=e.gridSize,i=[nt(t,c,r),nt(n,c,r)];return Yt(i,a)}({from:a.playerInfo.position,to:e,zoom:a.mapZoom,gridSize:a.mapGridSize,circuit:a.circuit}),n=D(a.playerInfo,e,0);return U(n,t)})).map((function(t){return new e(t,a.currentIteration+1,a.circuit,a.mapZoom,a.mapGridSize)}))}},{key:"updateScoreWithTotals",value:function(e){var t=e.maxAvgSpeed,n=e.maxCheckpointsCoveredPerTurn,a=e.maxCheckpointsCovered;this.avgSpeedScore=(this.avgSpeed+1)/(t+1),this.checkpointsCoveredPerTurnScore=(this.checkpointsCoveredPerTurn+1)/(n+1),this.checkpointsCoveredScore=(this.checkpointsCovered+1)/(a+1),this.score=.1*this.avgSpeedScore+.3*this.checkpointsCoveredPerTurnScore+.6*this.checkpointsCoveredScore,this.summary={avgSpeedScore:this.avgSpeedScore.toFixed(2),checkpointsCoveredPerTurnScore:this.checkpointsCoveredPerTurnScore.toFixed(2),checkpointsCoveredScore:this.checkpointsCoveredScore.toFixed(2)}}},{key:"_updatePartialScore",value:function(){if(this.playerInfo.prevPositions.length)if(function(e){var t,n={},a=Object(x.a)(e.prevPositions);try{for(a.s();!(t=a.n()).done;){var r=t.value,c="".concat(r.x,"_").concat(r.y);if(n[c])return!0;n[c]=!0}}catch(i){a.e(i)}finally{a.f()}return!1}(this.playerInfo))this.score=-1e3;else{this.avgSpeed=function(e){if(!e.prevPositions.length)return 0;for(var t=0,n=0;n<e.prevPositions.length-1;n+=1){var a=e.prevPositions[n],r=e.prevPositions[n+1];t+=w(a,r)}return t/e.prevPositions.length}(this.playerInfo);var e=function(e){for(var t=0,n=0;n<e.checkpointsPassed.length-1&&e.checkpointsPassed[n];n+=1)t+=1;return t}(this.playerInfo),t=1-this._getPercentageToNextCheckpoint();this.checkpointsCovered=e+t,this.checkpointsCoveredPerTurn=this.checkpointsCovered/this.getTurns(),this.score=1}else this.score=-1}},{key:"getScore",value:function(){return this.score}},{key:"getFirstMove",value:function(){var e=this.playerInfo.prevPositions.length-this.currentIteration+1;return this.playerInfo.prevPositions[e]}},{key:"getTurns",value:function(){return this.playerInfo.prevPositions.length}},{key:"isFinished",value:function(){return function(e){var t,n=Object(x.a)(e.checkpointsPassed);try{for(n.s();!(t=n.n()).done;){if(!t.value)return!1}}catch(a){n.e(a)}finally{n.f()}return!0}(this.playerInfo)}},{key:"_getPercentageToNextCheckpoint",value:function(){return(function(e){for(var t=e.player,n=e.circuit,a=e.gridSize,r=e.zoom,c=0;c<t.checkpointsPassed.length;c+=1)if(!t.checkpointsPassed[c]){var i=nt(t.position,a,r);return w(i,n.centerOfCheckpoints[c])}return 0}({player:this.playerInfo,zoom:this.mapZoom,gridSize:this.mapGridSize,circuit:this.circuit})+1)/(function(e){var t=e.centerOfCheckpoints;return t.map((function(e,n){return w(e,t[(n+1)%t.length])})).reduce((function(e,t){return Math.max(e,t)}),0)}(this.circuit)+1)}}]),e}(),tn=function(e,t,n,a,r){return new Promise((function(c){if(function(e){var t=$t[e.levelAI].randomSolutionChance;return Math.random()<t}(e))c(function(e){var t=e.player,n=e.otherPlayers,a=e.zoom,r=e.circuit,c=e.gridSize,i=it(t,n).filter((function(e){return function(e){return Ut({from:t.position,to:e,zoom:a,gridSize:c,circuit:r,otherPlayers:[]})}(e)}));i.length||(i=it(t,n));return he(i)}({player:e,otherPlayers:t,zoom:a,circuit:n,gridSize:r}));else{var i=function(e){return nn.apply(this,arguments)}({player:e,otherPlayers:t,circuit:n,zoom:a,gridSize:r});Object(Ct.a)(kt.a.mark((function e(){var t,n,a,r,o,s,l;return kt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,e.prev=2,r=Object(Qt.a)(i);case 4:return e.next=6,r.next();case 6:return o=e.sent,t=o.done,e.next=10,o.value;case 10:if(s=e.sent,t){e.next=21;break}return l=s,e.next=15,new Promise((function(e){requestAnimationFrame(e)}));case 15:if(!l.isFinished){e.next=18;break}return c(l.move),e.abrupt("break",21);case 18:t=!0,e.next=4;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(2),n=!0,a=e.t0;case 27:if(e.prev=27,e.prev=28,t||null==r.return){e.next=32;break}return e.next=32,r.return();case 32:if(e.prev=32,!n){e.next=35;break}throw a;case 35:return e.finish(32);case 36:return e.finish(27);case 37:case"end":return e.stop()}}),e,null,[[2,23,27,37],[28,,32,36]])})))()}}))};function nn(){return(nn=Object(Xt.a)(kt.a.mark((function e(t){var n,a,r,c,i,o,s,l,u,m,d,p,f;return kt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.player,a=t.otherPlayers,r=t.circuit,c=t.zoom,i=t.gridSize,o=[new en(n,1,r,c,i)],s=[],l=null,u=$t[n.levelAI].maxIterations,m=$t[n.levelAI].maxThinkingDepth,d=1,50,p=kt.a.mark((function e(){var t,n,r,c,i,u,p,f,v,h;return kt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d+=1,t=rn(o),o=o.filter((function(e){return e!==t})),n=t.expand(a,m),r=n.filter((function(e){return e.isFinished()})),c=Object(x.a)(r);try{for(c.s();!(i=c.n()).done;)u=i.value,(!l||u.getTurns()<l.getTurns())&&(l=u)}catch(y){c.e(y)}finally{c.f()}if(s=s.concat(r),p=n.filter((function(e){return!e.isFinished()})).filter((function(e){return e.getScore()>=0})).filter((function(e){return!l||e.getTurns()<l.getTurns()})),o=o.concat(p),f=o.reduce((function(e,t){return Math.max(e,t.avgSpeed)}),0),v=o.reduce((function(e,t){return Math.max(e,t.checkpointsCoveredPerTurn)}),0),h=o.reduce((function(e,t){return Math.max(e,t.checkpointsCovered)}),0),o.forEach((function(e){e.updateScoreWithTotals({maxAvgSpeed:f,maxCheckpointsCoveredPerTurn:v,maxCheckpointsCovered:h})})),d%50!==0){e.next=17;break}return e.next=17,{isFinished:!1};case 17:case"end":return e.stop()}}),e)}));case 9:if(!(o.length&&d<=u)){e.next=13;break}return e.delegateYield(p(),"t0",11);case 11:e.next=9;break;case 13:return f=l?l.getFirstMove():o.length?rn(o).getFirstMove():an(n,a),e.next=16,{isFinished:!0,move:f};case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function an(e,t){var n=it(e,t);return he(n)}function rn(e){return e.reduce((function(e,t){return t.getScore()>e.getScore()?t:e}),e[0])}var cn=function(){var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(e){return window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}(),on=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.category,a=t.label,r=t.value;window.gtag&&window.gtag("event",e,{event_category:n,event_label:a,value:r})},sn=function(){return function(e,t){var n=mt(t());n.turnsGrounded?e(function(e){return function(t){e.type!==I?(t(He(ze)),setTimeout((function(){t(un())}),2e3)):t(He(Le))}}(n)):n.type!==T?t().mainUI.playWithTimer?e(He(Ce)):e(yn()):e(En(n))}},ln=function(){return function(e){e({type:Ye.ADVANCE_PLAYER_TURN}),e(sn())}},un=function(){return function(e,t){var n,a=mt(t());e((n=a.id,{type:W.REDUCE_GROUNDED,playerId:n})),e(ln())}},mn=function(e){var t=e.players,n=e.playerOrder,a=e.circuit;return function(e,r){e(Se(ne));var c=function(e){var t=e.players,n=e.playerOrder,a=e.circuit;return n.map((function(e){return t.find((function(t){return t.id===e}))})).map((function(e,t){var n=a.startingPositions[t];return Object(P.a)({},e,{position:Object(P.a)({},n),prevPositions:[Object(P.a)({},n)],speed:Object(P.a)({},a.initialSpeed),checkpointsPassed:a.checkpoints.map((function(){return!1}))})}))}({players:t,playerOrder:n,circuit:a}).map(In);e(function(e){return{type:W.SET_PLAYERS,players:e}}(c)),on("init_game",{category:"game",label:null===a||void 0===a?void 0:a.id}),on("total_players",{category:"game",value:t.length,label:null===a||void 0===a?void 0:a.id}),on("human_players",{category:"game",value:t.filter((function(e){return e.type===I})).length,label:null===a||void 0===a?void 0:a.id}),on("ai_players",{category:"game",value:t.filter((function(e){return e.type===T})).length,label:null===a||void 0===a?void 0:a.id}),r().mainUI.playWithTimer||u.setTimeToWait(-1),Mt(a).then((function(t){e(function(e,t){return{type:Ye.INIT_GAME,playerOrder:e,circuitInfo:t}}(n,t)),e(Se(X))}))}},dn=function(){return function(e,t){var n=t(),a=n.mainUI.randomizePlayerOrderOnStart?jt()(n.mainUI.selectedPlayerOrder):n.mainUI.selectedPlayerOrder;!function(e,t){if(window.localStorage){var n={version:window.capac_racer_version,playerOrder:e,players:t};try{window.localStorage.setItem("players",JSON.stringify(n))}catch(a){console.warn("Error trying to save localStorage",a)}}}(n.mainUI.selectedPlayerOrder,n.mainUI.selectedPlayers),e(mn({players:n.mainUI.selectedPlayers,playerOrder:a,circuit:wt[n.mainUI.selectedCircuit]}))}},pn=function(e,t,n){return function(a){var r=w(e.position,t);if(on("collision",{category:"game",label:(null===e||void 0===e?void 0:e.type)===T?"ai":"human",value:r}),a(function(e,t,n){return{type:W.NOTIFY_COLLISION,playerId:e,speed:t,timePassed:n}}(e.id,r,n)),e.type===T)return a(He(Re)),void setTimeout((function(){a(ln())}),2e3);a(He(we))}},fn=function(e,t,n,a,r){return function(c,i){c(bn(a,r));var o=function(e){var t,n=mt(e),a=Object(x.a)(n.checkpointsPassed);try{for(a.s();!(t=a.n()).done;){if(!t.value)return!1}}catch(r){a.e(r)}finally{a.f()}return!0}(i());c(function(e,t,n){return{type:W.MOVE_TO,playerId:e,position:t,timePassed:n}}(e.id,t,n)),c(o?function(e,t){return function(n){on("victory",{category:"game"});var a={name:e.name,date:new Date,turns:e.turnsSpent,realTimeUsed:e.realTimeUsed,maxSpeed:e.maxSpeed,crashes:e.crashes,path:e.prevPositions,playerStyle:e.style};if(Jt(a,t,e)){var r=Kt(a,t,e);on("high_score",{category:"game",label:null===t||void 0===t?void 0:t.id,value:null===r||void 0===r?void 0:r.turns}),n({type:Ye.SET_LATEST_HIGH_SCORE,highScore:r}),n(He(Me))}else n(He(De))}}(mt(i()),r):ln())}};var vn=function(e,t){return function(n,a){var r=u.getTimePassed();u.stop();var c=a(),i=Ot(c),o=c.map.zoom,s=c.map.gridSize;if(Ut({from:e.position,to:t,zoom:o,gridSize:s,circuit:i,otherPlayers:pt(c,e.id)})){var l=[ct(c,e.position),ct(c,t)];n(fn(e,t,r,l,i))}else n(pn(e,t,r))}},hn=function(e,t){return function(n){cn?n({type:Ye.SET_SELECTED_POSITION,newPosition:t}):n(vn(e,t))}},yn=function(){return function(e,t){e(He(Ae));var n=function(){};t().mainUI.playWithTimer&&(n=function(){var n=Nt(t());if(n){var a=mt(t());e(vn(a,n))}else e((function(e,t){e(He(je)),Vt(3e3).then((function(){var n=mt(t()),a=dt(t()).filter((function(e){return e.id!==n.id})),r=it(n,a),c=he(r);e(vn(n,c))}))}))}),u.restart({callbackOnEnd:n})}},En=function(e){return function(){var t=Object(Ct.a)(kt.a.mark((function t(n,a){var r,c,i,o,s,l,u,m,d;return kt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(He(Ue)),r=a(),c=Ot(r),i=dt(a()).filter((function(t){return t.id!==e.id})),o=r.map.zoom,s=r.map.gridSize,l=tn(e,i,c,o,s),u=gn(e),t.next=10,Promise.all([Vt(u),l]);case 10:return m=t.sent,d=m[1],n({type:Ye.SET_SELECTED_AI_MOVE,newMove:d}),t.next=15,Vt(1e3);case 15:n(vn(e,d));case 16:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()};function gn(e){var t,n,a=$t[e.levelAI].timeThinking;return t=a.min,n=a.max,t+Math.random()*(n-t)}var bn=function(e,t){return function(n,a){var r=Yt(e,t);if(r.length){var c,i=mt(a());n((c=i.id,{type:W.NOTIFY_VISITED_CHECKPOINTS,playerId:c,newCheckpointIndexes:r}))}}},Nn=function(){return function(e){on("finish_game",{category:"game"}),e(Se(Z)),u.reset()}};var Sn=function(){return function(e){e(He(Ge)),u.pause()}},On=function(){return function(e,t){var n=t().game.prevGameState;e(He(n)),u.unpause()}},Pn=function(){return function(e,t){switch(t().game.gameState){case Ge:e(On());break;case Ae:e(Sn())}}};function In(e,t){return e.name?e:Object(P.a)({},e,{name:Tn(t)})}function Tn(e){switch(e){case 0:return"Anonymous";case 1:return"Mistery racer";case 2:return"Shy runner";case 3:return"Jane Doe";default:return"John Doe"}}var xn=function(e,t){return function(n){on("show_replay",{category:"replay"}),Mt(t).then((function(t){n(function(e,t){return{type:Ye.INIT_REPLAY,raceHistory:e,circuitInfo:t}}(e,t)),n(Se(ae))}))}},_n=n(16),kn=n(17),Cn=(n(62),function(e){Object(kn.a)(n,e);var t=Object(_n.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={timeLeft:0},e.requestRef=null,e.animate=function(){e.setState({timeLeft:e.props.counterObject.getTimeLeft()}),e.requestRef=requestAnimationFrame(e.animate)},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.animate()}},{key:"componentWillUnmount",value:function(){this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){return r.a.createElement("div",{className:"counter-display"},r.a.createElement("div",{className:"counter-display-text"},"Time left:"),r.a.createElement("div",{className:"counter-display-number"},(this.state.timeLeft/1e3).toFixed(3)))}}]),n}(r.a.Component)),An=n(42),jn=n(2),wn=n.n(jn),Rn=wn.a.shape({id:wn.a.string,name:wn.a.string,dotColor:wn.a.string,dotSize:wn.a.number,round:wn.a.string,trailColor:wn.a.string,trailDotsSize:wn.a.number,trailWidth:wn.a.number,icon:wn.a.string}),Ln=wn.a.shape({x:wn.a.number,y:wn.a.number}),zn=(wn.a.shape({id:wn.a.string.isRequired,name:wn.a.string.isRequired,style:Rn}),wn.a.shape({id:wn.a.string.isRequired,name:wn.a.string.isRequired,style:Rn,position:Ln.isRequired,speed:Ln.isRequired,prevPositions:wn.a.arrayOf(Ln)}),wn.a.shape({id:wn.a.string.isRequired,name:wn.a.string.isRequired,style:Rn,path:wn.a.arrayOf(Ln)}),wn.a.shape({id:wn.a.string,name:wn.a.string,turns:wn.a.number,time:wn.a.number}),wn.a.shape({id:wn.a.string,name:wn.a.string}),wn.a.shape({x:wn.a.number,y:wn.a.number,dx:wn.a.number,yy:wn.a.number,baseX:wn.a.number,baseY:wn.a.number}),n(27),{x:120,y:100}),Dn=function(e){Object(kn.a)(n,e);var t=Object(_n.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={cameraPosition:{x:0,y:0},boardSize:null,isDragging:!1,dragStart:null},e.moveCurrentPlayerIntoView=function(){if(e.state.boardSize&&e.props.currentPlayer&&e.props.currentPlayer.position){var t={topLeft:C({x:0,y:0},e.state.cameraPosition),size:e.state.boardSize};if(!L(e.props.playerScreenPosition,t,zn)){var n=z(e.props.playerScreenPosition,t,zn),a=C(n,e.props.playerScreenPosition),r=e.state.cameraPosition;e.setState({cameraPosition:k(r,a)})}}},e.handlePointerDown=function(t){var n=Gn(t);e.setState({isDragging:!0,dragStart:n})},e.handlePointerUp=function(){e.setState({isDragging:!1,dragStart:null})},e.handlePointerMove=function(t){if(e.state.isDragging&&e.state.dragStart){var n=Gn(t),a=C(n,e.state.dragStart),r=e.state.cameraPosition;e.setState({dragStart:n,cameraPosition:k(r,a)})}},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.moveCurrentPlayerIntoView()}},{key:"componentDidUpdate",value:function(e){this.props.currentPlayer!==e.currentPlayer&&this.moveCurrentPlayerIntoView()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"game-board"},r.a.createElement(An.a,{handleHeight:!0,handleWidth:!0,onResize:function(t,n){e.setState({boardSize:{width:t,height:n}},e.moveCurrentPlayerIntoView)}},r.a.createElement("div",{className:Qe()("game-board-content",{"is-dragging":this.state.isDragging}),style:{width:this.props.circuitInfo.width,height:this.props.circuitInfo.height,transform:"translate(".concat(this.state.cameraPosition.x,"px, ").concat(this.state.cameraPosition.y,"px)")},onMouseDown:this.handlePointerDown,onMouseUp:this.handlePointerUp,onMouseMove:this.handlePointerMove,onTouchStart:this.handlePointerDown,onTouchEnd:this.handlePointerUp,onTouchMove:this.handlePointerMove,onTouchCancel:this.handlePointerUp},this.props.children)))}}]),n}(r.a.Component);Dn.defaultProps={currentPlayer:null,children:r.a.createElement(r.a.Fragment,null),circuitInfo:null,playerScreenPosition:null};var Mn=Object(g.b)((function(e,t){var n=mt(e);return Object(P.a)({},t,{circuitInfo:Ot(e),playerScreenPosition:ct(e,null===n||void 0===n?void 0:n.position),currentPlayer:n})}))(Dn);function Gn(e){var t=e;return"touchstart"!==e.type&&"touchmove"!==e.type||(t=e.touches[0]),{x:t.clientX,y:t.clientY}}var Un=n(40),Yn=n.n(Un),Hn=(n(63),function(e){var t=60*e.zoom/(60/e.cellSize);return r.a.createElement("div",{className:"grid",style:{backgroundImage:"url(".concat(Yn.a,")"),backgroundSize:"".concat(t,"px ").concat(t,"px")}})});Hn.defaultProps={};var Fn=Hn;n(64);var Wn=function(e){var t=e.playerStyle;return r.a.createElement("div",{className:"player-icon",style:{backgroundImage:"url(".concat(t.icon,")")}})},Vn=function(e){if(!e)return{};var t=e.style||e.playerStyle||{};return{"--player-color":t.dotColor,"--player-border-radius":t.round,"--player-trail-border-radius":t.round,"--player-size":"".concat(t.dotSize+2,"px"),"--movement-picker-size":"".concat(t.dotSize-1,"px"),"--movement-picker-size-center":"".concat(t.dotSize+2,"px"),"--player-trail-color":t.dotColor,"--player-trail-size":"".concat(t.dotSize,"px")}},Bn=function(e,t,n,a){return Gt(t,n,a)?"red":e.style.trailColor},qn=(n(65),function(e){var t=e.player,n=e.isActive,a=Object(g.d)((function(e){return ct(e,t.position)}));return r.a.createElement("div",{className:Qe()("player",{"is-active":n}),style:Object(P.a)({},Vn(t),{left:a.x,top:a.y})},r.a.createElement(Wn,{playerStyle:t.style}),n&&r.a.createElement("div",{className:"player-active-indicator"}))}),Jn=n(14),Kn=n(26);function Zn(e){return r.a.createElement(r.a.Fragment,null,e.possiblePositions.map((function(t,n){return r.a.createElement(Kn.a.div,{key:"".concat(e.player.id,"_").concat(t.position.x,"_").concat(t.position.y),className:Qe()("movement-picker",{"movement-picker-center":!t.screen.dx&&!t.screen.dy}),style:{left:t.screen.baseX,top:t.screen.baseY},animate:{x:t.screen.dx,y:t.screen.dy},initial:{x:0,y:0},transition:{ease:"easeInOut",duration:.3,delay:.2+.1*n},onClick:function(){return e.onPositionSelected(t.position)},onMouseEnter:function(){return e.onPositionHover(t.screen)},onMouseLeave:e.onPositionHoverEnd})})))}Zn.defaultProps={};var Xn=Zn,Qn=(n(66),function(e){Object(kn.a)(n,e);var t=Object(_n.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={tempLine:null},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=function(e){if(!e||!e.length)return{x:0,y:0};var t=e.reduce((function(e,t){return Math.max(e,t.screen.y)}),Number.MIN_VALUE);return{x:e.reduce((function(e,t){return t.screen.x+e}),0)/e.length,y:t}}(this.props.possiblePositions),n=this.state.tempLine||this.props.selectedPositionScreen,a=n&&Gt([this.props.originalPlayerScreenPosition,n],this.props.circuit,this.props.otherPlayersPosition);return r.a.createElement(Kn.a.div,{className:"movement-picker-container",animate:{x:0,y:0},initial:{x:this.props.lastMovement.x,y:this.props.lastMovement.y},transition:{ease:"easeIn",duration:.3},style:Object(P.a)({},Vn(this.props.player))},r.a.createElement(Xn,{onPositionSelected:this.props.onPositionSelected,onPositionHover:function(t){return e.setState({tempLine:t})},onPositionHoverEnd:function(){return e.setState({tempLine:null})},player:this.props.player,possiblePositions:this.props.possiblePositions}),cn&&this.props.selectedPosition&&r.a.createElement("button",{className:"button button-bg movement-picker-select-button",style:{left:t.x,top:t.y},onClick:this.props.onConfirmSelection},"Select"),n&&r.a.createElement("svg",{className:"movement-picker-temp-line"},r.a.createElement(Jn.a,{points:[this.props.originalPlayerScreenPosition,n],stroke:Bn(this.props.player,[this.props.originalPlayerScreenPosition,n],this.props.circuit,this.props.otherPlayersPosition),strokeWidth:this.props.player.style.trailWidth,strokeDasharray:"2",fill:"none",r:2})),r.a.createElement("svg",{className:"movement-picker-ghost-line"},r.a.createElement(Jn.a,{points:[this.props.originalPlayerScreenPosition,this.props.nextPivot],stroke:this.props.player.style.trailColor,strokeWidth:this.props.player.style.trailWidth,strokeDasharray:"1",fill:"none",r:2})),n&&a&&r.a.createElement("div",{className:"movement-picker-crash",style:{left:n.x,top:n.y}}))}}]),n}(r.a.Component));Qn.defaultProps={lastMovement:{x:0,y:0},otherPlayersPosition:[],selectedPosition:null,selectedPositionScreen:null};var $n=Object(g.b)((function(e,t){var n=Nt(e);return Object(P.a)({},t,{lastMovement:Et(e,t.player)||{x:0,y:0},circuit:Ot(e),originalPlayerScreenPosition:ct(e,t.player.position),possiblePositions:yt(e,t.player),nextPivot:gt(e,t.player),otherPlayersPosition:ft(e,t.player.id),selectedPosition:n,selectedPositionScreen:ct(e,n)})}))(Qn);n(67);function ea(e){var t=e.player,n=e.children,c=e.switchRandomEvery,i=e.highlightMove,o=Object(a.useState)(null),s=Object(Je.a)(o,2),l=s[0],u=s[1],m=Object(a.useState)(null),d=Object(Je.a)(m,2),p=d[0],f=d[1];Object(a.useEffect)((function(){return u(null),function(){return u(null)}}),[t]);var v=Object(g.d)(Ot),h=Object(g.d)((function(e){return ct(e,t.position)})),y=Object(g.d)((function(e){return yt(e,t)}));Object(a.useEffect)((function(){var e=setInterval((function(){var e=he(y);f(e),u(e.screen)}),c);return function(){clearInterval(e)}}),[t,y,c]);var E=Object(g.d)((function(e){return ft(e,t.id)})),b=Object(g.d)((function(e){return ct(e,i)}));return r.a.createElement("div",{style:Vn(t)},n&&r.a.createElement("div",{className:"random-selection-animation-warning",style:{top:h.y,left:h.x}},n),y.map((function(e){var n=ta(t,e);return r.a.createElement("div",{key:n,className:Qe()("random-selection-animation",{"is-highlighted":!b&&p&&ta(t,p)===n}),style:{left:e.screen.x,top:e.screen.y}})})),b&&r.a.createElement("div",{className:"random-selection-animation-highlighted-move",style:{left:b.x,top:b.y}}),!b&&l&&r.a.createElement("svg",{className:"random-selection-animation-temp-line"},r.a.createElement(Jn.a,{points:[h,l],stroke:Bn(t,[h,l],v,E),strokeWidth:t.style.trailWidth,strokeDasharray:"2",fill:"none",r:2})))}function ta(e,t){return"".concat(e.id,"_").concat(t.position.x,"_").concat(t.position.y)}ea.defaultProps={children:null,switchRandomEvery:100,highlightMove:null};var na=ea,aa=(n(68),function(e){var t=e.player,n=e.isActive,a=Object(g.d)((function(e){return e}));if(!t.prevPositions.length)return r.a.createElement(r.a.Fragment,null);var c=t.prevPositions.map((function(e){return ct(a,e)})),i=c.slice(0,c.length-1);return r.a.createElement("div",{className:Qe()("player-trail-container",{"is-active":n}),style:Vn(t)},r.a.createElement("svg",{className:"player-trail"},r.a.createElement(Jn.a,{points:c,stroke:t.style.trailColor,strokeWidth:t.style.trailWidth,fill:"none",r:2})),i.map((function(e,t){return Object(P.a)({},e,{turn:t+1})})).map((function(e){return r.a.createElement("div",{key:"".concat(t.id,"_").concat(e.x,"_").concat(e.y,"_").concat(e.turn),className:"player-trail-point",style:{left:e.x,top:e.y}})})))}),ra=function(){var e=Object(g.c)(),t=Object(g.d)(dt),n=Object(g.d)(mt),a=Object(g.d)(at),c=Object(g.d)(rt),i=Object(g.d)(Ot),o=Object(g.d)(ot),s=Object(g.d)(st),l=Object(g.d)(lt),u=Object(g.d)(ut);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"game-board-circuit-bg",style:{backgroundImage:"url(".concat(i.bgImg,")"),backgroundSize:"".concat(i.width,"px ").concat(i.height,"px")}}),r.a.createElement(Fn,{zoom:a,cellSize:c}),t.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(qn,{player:e,isActive:e===n}),r.a.createElement(aa,{player:e,isActive:e===n}))})),n&&o&&r.a.createElement(r.a.Fragment,null,r.a.createElement($n,{key:null===n||void 0===n?void 0:n.id,player:n,onPositionSelected:function(t){return e(hn(n,t))},onConfirmSelection:function(){var t;e((t=n,function(e,n){var a=Nt(n());e(vn(t,a))}))}})),n&&s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(na,{player:n},"Too late!",r.a.createElement("br",null)," Choosing a random move for you...")),n&&l&&r.a.createElement(r.a.Fragment,null,r.a.createElement(na,{player:n,switchRandomEvery:ca(n),highlightMove:u})))};function ca(e){switch(e.levelAI){case 0:return 800;case 1:return 400;case 2:return 200;case 3:return 100;default:return 75}}ra.defaultProps={};var ia=ra,oa=function(){var e=Object(g.c)(),t=Object(g.d)(mt),n=Object(g.d)(ot),a=Object(g.d)(xt),c=!t||t.type===I;return r.a.createElement("div",{className:"game-board-container"},r.a.createElement(Mn,null,r.a.createElement(ia,null)),n&&a&&r.a.createElement(Cn,{counterObject:u}),c&&r.a.createElement("div",{className:"pause-button-container"},r.a.createElement("button",{type:"button",className:"button button-small",onClick:function(){return e(Sn())}},"Pause")))};oa.defaultProps={};var sa=oa,la=function(e){var t=e.player,n=e.isActive;return r.a.createElement("li",{className:Qe()("player-list-item",{"is-active":n})},r.a.createElement("div",{className:"player-list-item-decorator-container"},r.a.createElement("div",{className:"player-list-item-decorator"}),r.a.createElement(Wn,{playerStyle:t.style})),r.a.createElement("div",null,t.name))},ua=(n(69),function(){var e=Object(g.d)((function(e){return dt(e)})),t=Object(g.d)((function(e){return mt(e)}));return r.a.createElement("ul",{className:"player-list"},e.map((function(e){return r.a.createElement(la,{key:e.id,player:e,isActive:e===t})})))}),ma=function(){var e=Object(g.c)();return r.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(sn())}},r.a.createElement("div",{className:"game-screen-modal-content"},"Everybody ready?",r.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Start game!")))},da=function(){var e=Object(g.c)(),t=Object(g.d)(mt);return r.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(yn())}},r.a.createElement("div",{className:"game-screen-modal-content"},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},t.name),", it is your turn"),r.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Start my turn")))},pa=n(21),fa=n.n(pa),va=function(){var e=Object(g.c)(),t=Object(g.d)(mt);return r.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(ln())}},r.a.createElement("div",{className:"game-screen-modal-content"},r.a.createElement("div",null,"You crashed!"),r.a.createElement("div",{className:"secondary-text mt-s"},"(grounded for ",t.turnsGrounded," ",fa()("turn",t.turnsGrounded),")"),r.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Next turn")))},ha=function(e){Object(kn.a)(n,e);var t=Object(_n.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={showContent:!1},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.timeout=window.setTimeout((function(){return e.setState({showContent:!0})}),this.props.showAfter)}},{key:"componentWillUnmount",value:function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.render(this.state.showContent))}}]),n}(r.a.Component);ha.defaultProps={showAfter:100,render:function(){}};var ya=ha,Ea=function(){var e=Object(g.d)(mt);return r.a.createElement(ya,{render:function(t){return r.a.createElement("div",{className:"game-screen-modal game-screen-modal-non-invasive"},r.a.createElement("div",{className:Qe()("game-screen-modal-content",{"is-hidden":!t})},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},e.name)," ","has crashed :(")))}})},ga=function(){var e=Object(g.c)(),t=Object(g.d)(mt);return r.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(un())}},r.a.createElement("div",{className:"game-screen-modal-content"},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},t.name),", you are grounded because you crashed!"),r.a.createElement("div",{className:"secondary-text mt-s"},"(",t.turnsGrounded," ",fa()("turn",t.turnsGrounded)," left)"),r.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Next turn")))},ba=function(){var e=Object(g.d)(mt);return r.a.createElement(ya,{render:function(t){return r.a.createElement("div",{className:"game-screen-modal game-screen-modal-non-invasive"},r.a.createElement("div",{className:Qe()("game-screen-modal-content",{"is-hidden":!t})},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},e.name)," ","is grounded after a crash."),r.a.createElement("div",{className:"secondary-text"},"(",e.turnsGrounded," ",fa()("turn",e.turnsGrounded)," ","left)")))}})},Na=function(){var e=Object(g.c)(),t=Object(g.d)(mt);return r.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(Nn())}},r.a.createElement("div",{className:"game-screen-modal-content"},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},t.name)," ","won!"),r.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Yay!")))},Sa=function(){var e=Object(g.c)();return r.a.createElement("div",{className:"game-screen-modal",onClick:function(){return e(On())}},r.a.createElement("div",{className:"game-screen-modal-content"},r.a.createElement("div",null,"Paused"),r.a.createElement("button",{className:"button game-screen-modal-button",type:"button"},"Continue!"),r.a.createElement("button",{className:"button game-screen-modal-button game-screen-modal-button-secondary ",type:"button",onClick:function(t){t.stopPropagation(),e(Nn())}},"Exit game")))};n(70);function Oa(e){var t=e.scores,n=e.highlightedScore,a=e.canReplay,c=e.circuit,i=Object(g.c)();return r.a.createElement("div",{className:"score-board"},!!t.length&&t.map((function(e,t){var o;return r.a.createElement("div",{onClick:function(){return function(e){a&&i(xn(e,c))}(e)},className:Qe()("score-board-item",{"is-highlighted":n&&n.id===e.id,"is-clickable":a}),key:"score-board-item-".concat(e.id)},r.a.createElement("div",{className:"score-board-item-index"},t+1),r.a.createElement("div",{className:"score-board-item-name"},e.name),r.a.createElement("div",{className:"score-board-item-turns"},r.a.createElement("span",{className:"score-board-item-value"},e.turns),r.a.createElement("span",{className:"score-board-item-text"}," ","turns")),r.a.createElement("div",{className:"score-board-item-turns"},r.a.createElement("span",{className:"score-board-item-value"},null===(o=e.date)||void 0===o?void 0:o.toLocaleDateString())),r.a.createElement("div",{className:"score-board-item-time"},"(",r.a.createElement("span",{className:"score-board-item-value"},(e.realTimeUsed/1e3).toFixed(2)," "),r.a.createElement("span",{className:"score-board-item-text"},"seconds"),")"))})),!t.length&&r.a.createElement("div",{className:"score-board-empty"},"No high scores yet!"))}Oa.defaultProps={highlightedScore:null,canReplay:!1};var Pa=Oa,Ia=function(){var e=Object(g.c)(),t=Object(g.d)(mt),n=Object(g.d)(bt),a=Object(g.d)(Ot),c=qt(a.id);return r.a.createElement("div",{className:"game-screen-modal"},r.a.createElement("div",{className:"game-screen-modal-content"},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},t.name)," ","won, and set a high score for this circuit!"),r.a.createElement("div",{className:"notify-high-scores-circuit"},r.a.createElement(Pa,{circuit:a,scores:c,highlightedScore:n})),r.a.createElement("button",{className:"button game-screen-modal-button",type:"button",onClick:function(){return e(Nn())}},"Back to main menu")))},Ta=function(){var e=Object(g.d)(mt);return r.a.createElement(ya,{showAfter:1e3,render:function(t){return r.a.createElement("div",{className:"game-screen-modal game-screen-modal-non-invasive"},r.a.createElement("div",{className:Qe()("game-screen-modal-content",{"is-hidden":!t})},r.a.createElement("div",null,r.a.createElement("span",{className:"player-name"},e.name)," ","is choosing its next move...")))}})},xa=(n(71),function(){switch(Object(g.d)(vt)){case ke:return r.a.createElement(ma,null);case Ce:return r.a.createElement(da,null);case we:return r.a.createElement(va,null);case Re:return r.a.createElement(Ea,null);case Le:return r.a.createElement(ga,null);case ze:return r.a.createElement(ba,null);case De:return r.a.createElement(Na,null);case Me:return r.a.createElement(Ia,null);case Ge:return r.a.createElement(Sa,null);case Ue:return r.a.createElement(Ta,null);default:return r.a.createElement(r.a.Fragment,null)}});xa.defaultProps={};var _a=xa;function ka(e){var t=e.keys;return Object(a.useEffect)((function(){var e=function(e){t[e.code]&&t[e.code]()};return window.document.addEventListener("keyup",e),function(){window.document.removeEventListener("keyup",e)}}),[t]),r.a.createElement(r.a.Fragment,null)}ka.propTypes={keys:wn.a.objectOf(wn.a.func).isRequired};var Ca,Aa,ja=ka;function wa(e){var t=e.onBlur;return Object(a.useEffect)((function(){if("undefined"===typeof document.addEventListener||void 0===Ca)return function(){};var e=function(){document[Ca]&&t()};return document.addEventListener(Aa,e,!1),function(){document.removeEventListener(Aa,e,!1)}}),[t]),r.a.createElement(r.a.Fragment,null)}"undefined"!==typeof document.hidden?(Ca="hidden",Aa="visibilitychange"):"undefined"!==typeof document.msHidden?(Ca="msHidden",Aa="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(Ca="webkitHidden",Aa="webkitvisibilitychange"),wa.propTypes={onBlur:wn.a.func.isRequired};var Ra=wa,La=(n(72),function(){var e=Object(g.c)();return r.a.createElement("div",{className:"transition-opacity"},r.a.createElement(ja,{keys:{Escape:function(){return e(Pn())},Space:function(){return e(Pn())}}}),r.a.createElement(Ra,{onBlur:function(){return e((function(e,t){switch(t().game.gameState){case Ae:e(Sn())}}))}}),r.a.createElement(sa,null),r.a.createElement(ua,null),r.a.createElement(_a,null))});n(73);var za=function(e){var t=e.circuit,n=e.onClick;return r.a.createElement("div",{className:"circuit-selector",onClick:n},r.a.createElement("img",{className:"circuit-selector-img",src:t.bgImg,alt:t.name}),r.a.createElement("div",{className:"circuit-selector-footer"},r.a.createElement("div",{className:"circuit-selector-name"},t.name),r.a.createElement("div",{className:"circuit-selector-players"},t.maxPlayers," players")))},Da=(n(74),Object.values(wt));var Ma=function(e){var t=e.className,n=Object(g.c)();return r.a.createElement("div",{className:Qe()("full-screen full-screen-with-header-and-footer circuit-selection",t)},r.a.createElement("div",{className:"menu-header transition-from-top"},r.a.createElement(et,{variant:"small"}),r.a.createElement("h1",{className:"menu-header-title"},"Select circuit")),r.a.createElement("div",{className:"menu-content circuit-selection-content transition-from-bottom"},r.a.createElement("div",{className:"circuit-selection-list"},Da.map((function(e){return r.a.createElement(za,{key:e.id,onClick:function(){var t;n((t=e.id,{type:Ne.SET_SELECTED_CIRCUIT,circuitId:t})),n(Se($))},circuit:e})})))),r.a.createElement("footer",{className:"menu-footer transition-from-bottom"},r.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(Se(Z))}},"Back")))},Ga=function(e){return function(t,n){var a=n().mainUI.selectedPlayers,r=Object.values(ve),c=a.filter((function(t){return t.id!==e.id})),i=r.reduce((function(e,t){return function(e,t){var n,a=Object(x.a)(t);try{for(a.s();!(n=a.n()).done;){if(n.value.style.id===e.id)return!0}}catch(r){a.e(r)}finally{a.f()}return!1}(t,c)?e:e.concat([t])}),[]),o=(i.findIndex((function(t){return t.id===e.style.id}))+1)%i.length;t(Pe(e.id,{style:i[o]}))}};n(75);var Ua=function(e){var t=e.player,n=e.onRemove,a=e.canBeRemoved,c=e.onNameChange,i=e.onTypeChange,o=e.onLevelAIChange,s=e.onSelectNewStyle;return r.a.createElement("div",{className:"player-selector"},r.a.createElement("div",{className:"player-selector-top"},r.a.createElement("input",{className:"player-selector-input",type:"text",value:t.name,onChange:function(e){return c(e.target.value)}}),r.a.createElement("button",{type:"button",className:"player-selector-style-container",onClick:s},r.a.createElement(Wn,{playerStyle:t.style})),r.a.createElement("button",{type:"button",className:"button button-small",onClick:n,disabled:!a,style:{opacity:a?1:0}},"Delete")),r.a.createElement("div",{className:"player-selector-bottom"},r.a.createElement("button",{type:"button",className:Qe()("player-selector-toggle",{"is-selected":t.type===I}),onClick:function(){return i(I)}},"Human"),r.a.createElement("button",{type:"button",className:Qe()("player-selector-toggle",{"is-selected":t.type===T}),onClick:function(){return i(T)}},"AI"),t.type===T&&r.a.createElement("div",{className:"player-selector-ai-level"},r.a.createElement("input",{value:t.levelAI,type:"range",min:"1",max:"3",step:"1",onChange:function(e){return o(parseInt(e.target.value,10))}}),r.a.createElement("div",{className:"player-selector-ai-level-text"},function(e){switch(e){case 0:return"Super Easy";case 1:return"Very Easy";case 2:return"Easy";case 3:default:return"Normal"}}(t.levelAI)))))};n(76);var Ya=function(e){var t=e.className,n=Object(g.c)(),c=Object(g.d)(ht),i=Object(g.d)(It),o=wt[i];Object(a.useEffect)((function(){var e;c.length&&c.length>o.maxPlayers&&n((e=o.maxPlayers,function(t,n){var a=n(),r=a.mainUI.selectedPlayers,c=a.mainUI.selectedPlayerOrder,i=function(e,t){return t.map((function(t){return e.find((function(e){return e.id===t}))}))}(r,c);t(Oe(i.slice(0,e),c.slice(0,e)))}))}),[c,o,n]);var s=Object(g.d)(Tt),l=Object(g.d)(xt),u=c.length>1;return r.a.createElement("div",{className:Qe()("full-screen full-screen-with-header-and-footer",t)},r.a.createElement("div",{className:"menu-header transition-from-right"},r.a.createElement(et,{variant:"small"}),r.a.createElement("h1",{className:"menu-header-title"},"Choose players")),r.a.createElement("div",{className:"menu-content player-selection-content transition-from-right"},r.a.createElement("div",{className:"player-selection-content-inner"},c.map((function(e){return r.a.createElement(Ua,{key:e.id,player:e,onRemove:function(){var t;u&&n((t=e.id,{type:Ne.REMOVE_PLAYER,playerId:t}))},canBeRemoved:u,onNameChange:function(t){return n(Pe(e.id,{name:t}))},onTypeChange:function(t){return n(Pe(e.id,{type:t}))},onSelectNewStyle:function(){return n(Ga(e))},onLevelAIChange:function(t){return n(Pe(e.id,{levelAI:t}))}})})),c.length<o.maxPlayers&&r.a.createElement("button",{type:"button",className:"button player-selection-add-player-button",onClick:function(){return n((function(e,t){var n=t(),a=n.mainUI.selectedPlayerOrder,r=n.mainUI.selectedPlayers,c=Object.values(ve),i=r.map((function(e){return e.name})),o=r.map((function(e){return e.style})),s=ye((function(){return he(c)}),o,(function(e,t){return e.id===t.id})),l=ye(be,i),u={id:Object(Y.a)(),name:l,style:s,type:I,levelAI:0};e(Oe(r.concat(u),a.concat(u.id)))}))}},"Add Player"),c.length>1&&r.a.createElement("div",{className:"transition-from-right"},r.a.createElement("label",{className:"player-selection-checkbox"},r.a.createElement("input",{type:"checkbox",checked:s,onChange:function(){return n({type:Ne.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START})}}),"Randomize player order when race starts")),r.a.createElement("div",{className:"transition-from-right"},r.a.createElement("label",{className:"player-selection-checkbox player-selection-checkbox-last"},r.a.createElement("input",{type:"checkbox",checked:l,onChange:function(){return n({type:Ne.TOGGLE_PLAY_WITH_TIMER})}}),"Play with timer")))),r.a.createElement("footer",{className:"menu-footer transition-from-right"},r.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(Se(Q))}},"Back"),r.a.createElement("div",{className:"menu-footer-filler"}),r.a.createElement("button",{className:"button",type:"button",onClick:function(){n(dn())}},"Start game!")))},Ha=(n(77),Object.values(wt));var Fa=function(){var e=Object(a.useState)([]),t=Object(Je.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(Ha[0]),o=Object(Je.a)(i,2),s=o[0],l=o[1];Object(a.useEffect)((function(){s.id&&c(qt(s.id))}),[s]);var u=Object(g.c)();return r.a.createElement("div",{className:"full-screen full-screen-with-header-and-footer high-scores"},r.a.createElement("div",{className:"menu-header transition-from-top"},r.a.createElement(et,{variant:"small"}),r.a.createElement("h1",{className:"menu-header-title"},"High scores")),r.a.createElement("div",{className:"menu-content transition-from-bottom"},r.a.createElement("div",{className:"high-scores-circuit-tabs-container"},r.a.createElement("div",{className:"high-scores-circuit-tabs"},Ha.map((function(e){return r.a.createElement("div",{key:e.id,className:Qe()("high-scores-circuit-tab",{"is-active":e.id===s.id})},r.a.createElement("div",{onClick:function(){return l(e)}},e.name))})))),r.a.createElement("div",{className:"high-scores-circuit"},r.a.createElement(Pa,{circuit:s,scores:n,canReplay:!0}))),r.a.createElement("footer",{className:"menu-footer transition-from-bottom"},r.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){u(Se(Z))}},"Back")))},Wa=(n(78),function(e){var t=e.className,n=Object(g.c)();return r.a.createElement("div",{className:Qe()("full-screen","full-screen-with-header-and-footer",t)},r.a.createElement("div",{className:"menu-header transition-from-right"},r.a.createElement(et,{variant:"small"}),r.a.createElement("h1",{className:"menu-header-title"},"Credits")),r.a.createElement("div",{className:"menu-content transition-from-right credits-content"},r.a.createElement("div",{className:"credits-content-item"},r.a.createElement("p",null,"Created by Paco G\xf3mez Granados"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://pacog.github.io/portfolio/",target:"_BLANK",rel:"noopener noreferrer"},"https://pacog.github.io/portfolio/")),r.a.createElement("p",null,r.a.createElement("a",{href:"https://twitter.com/PacoGomezGrana",target:"_BLANK",rel:"noopener noreferrer"},"@PacoGomezGrana"))),r.a.createElement("div",{className:"credits-content-item"},r.a.createElement("p",null,"Based on an original idea by"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://twitter.com/esqizo",target:"_BLANK",rel:"noopener noreferrer"},"@esqizo")," ","and cousins")),r.a.createElement("div",{className:"credits-content-item"},r.a.createElement("p",null,"Circuit graphics inspired by"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://codepen.io/ste-vg",target:"_BLANK",rel:"noopener noreferrer"},"Steve Gardner"),"\xb4s"," ",r.a.createElement("a",{href:"https://codepen.io/ste-vg/full/BaaQamG",target:"_BLANK",rel:"noopener noreferrer"},"Race Car Island")))),r.a.createElement("footer",{className:"menu-footer transition-from-right"},r.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(Se(Z))}},"Back")))}),Va=(n(79),function(e){var t=e.className;return r.a.createElement("div",{className:Qe()("full-screen",t)},r.a.createElement("div",{className:"loading-game"},r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))))}),Ba=(n(80),ce),qa=function(e){var t=e.raceHistory,n=e.isActive,a=Object(g.d)((function(e){return e}));if(!t.path.length)return r.a.createElement(r.a.Fragment,null);var c=t.path.map((function(e){return ct(a,e)}));return r.a.createElement("div",{className:Qe()("player-trail-container",{"is-active":n}),style:Vn(t)},r.a.createElement("svg",{className:"player-trail"},r.a.createElement(Jn.a,{points:c,stroke:Ba.trailColor,strokeWidth:Ba.trailWidth,fill:"none",r:2})),c.map((function(e,t){return Object(P.a)({},e,{turn:t+1})})).map((function(e){return r.a.createElement("div",{key:"".concat(e.x,"_").concat(e.y,"_").concat(e.turn),className:"player-trail-point",style:{left:e.x,top:e.y}})})))},Ja=function(e){var t=e.playerInPosition,n=Object(g.d)((function(e){return St(e)})),a=Object(g.d)((function(e){return e.map.zoom})),c=Object(g.d)((function(e){return e.map.gridSize})),i=Object(g.d)(Ot);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"replay-game-board-circuit-bg",style:{backgroundImage:"url(".concat(i.bgImg,")"),backgroundSize:"".concat(i.width,"px ").concat(i.height,"px")}}),r.a.createElement(Fn,{zoom:a,cellSize:c}),r.a.createElement(qn,{player:t,isActive:!0}),r.a.createElement(qa,{raceHistory:n,isActive:!0}))};Ja.defaultProps={};var Ka=Ja,Za=(n(81),function(){var e=Object(g.d)((function(e){return St(e)})),t=Object(a.useState)(null),n=Object(Je.a)(t,2),c=n[0],i=n[1],o=Object(a.useState)(0),s=Object(Je.a)(o,2),l=s[0],u=s[1],m=Object(g.c)();return Object(a.useEffect)((function(){e&&i({id:e.id,name:e.name,style:e.playerStyle,position:e.path[l],speed:{x:0,y:0},prevPositions:[]})}),[e,l]),r.a.createElement("div",{className:"game-board-container"},c&&r.a.createElement(Mn,{currentPlayer:c},r.a.createElement(Ka,{playerInPosition:c})),r.a.createElement("div",{className:"game-board-back-button-container"},r.a.createElement("button",{type:"button",className:"button button-small",onClick:function(){return m(Se(Z))}},"Back")),e&&e.path.length&&r.a.createElement("div",{className:"replay-game-board-turn-selector"},r.a.createElement("span",{className:"replay-game-board-turn-selector-label"},"Turn:"," "),r.a.createElement("input",{type:"range",value:l,max:e.path.length-1,onChange:function(e){return u(parseFloat(e.target.value))}}),r.a.createElement("span",{className:"replay-game-board-turn-selector-value"},l+1)))});Za.defaultProps={};var Xa=Za,Qa=(n(82),function(){return r.a.createElement("div",{className:"transition-opacity"},r.a.createElement(Xa,null))});var $a=function(e){var t=e.onNext;return r.a.createElement("div",{className:"tutorial-screen"},r.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-0 "}),r.a.createElement("div",{className:"tutorial-screen-text"},r.a.createElement("div",{className:"tutorial-screen-text-filler"},r.a.createElement("p",null,"This is your car.")),r.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Next")))};var er=function(e){var t=e.onNext;return r.a.createElement("div",{className:"tutorial-screen"},r.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-1 "}),r.a.createElement("div",{className:"tutorial-screen-text"},r.a.createElement("div",{className:"tutorial-screen-text-filler"},r.a.createElement("p",null,"You can move it by clicking in of the 9 buttons.")),r.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Next")))};var tr=function(e){var t=e.onNext;return r.a.createElement("div",{className:"tutorial-screen"},r.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-2 "}),r.a.createElement("div",{className:"tutorial-screen-text"},r.a.createElement("div",{className:"tutorial-screen-text-filler"},r.a.createElement("p",null,"Your next move will depend on your previous move, so be careful!")),r.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Next")))};var nr=function(e){var t=e.onNext;return r.a.createElement("div",{className:"tutorial-screen"},r.a.createElement("div",{className:"tutorial-screen-image  tutorial-screen-image-3 "}),r.a.createElement("div",{className:"tutorial-screen-text"},r.a.createElement("div",{className:"tutorial-screen-text-filler"},r.a.createElement("p",null,"If you go too fast, you may crash and be penalised.")),r.a.createElement("button",{className:"button tutorial-screen-button",type:"button",onClick:t},"Done!")))};n(83);var ar=function(e){var t=e.className,n=Object(g.c)(),c=Object(a.useState)(0),i=Object(Je.a)(c,2),o=i[0],s=i[1],l=function(){s(o+1)};return r.a.createElement("div",{className:Qe()("full-screen full-screen-with-header-and-footer",t)},r.a.createElement("div",{className:"menu-header transition-from-right"},r.a.createElement(et,{variant:"small"}),r.a.createElement("h1",{className:"menu-header-title"},"How to play")),r.a.createElement("div",{className:"menu-content transition-from-right tutorial-screen-container"},0===o&&r.a.createElement($a,{onNext:l}),1===o&&r.a.createElement(er,{onNext:l}),2===o&&r.a.createElement(tr,{onNext:l}),3===o&&r.a.createElement(nr,{onNext:function(){n(Se(Z))}})),r.a.createElement("footer",{className:"menu-footer transition-from-right"},r.a.createElement("button",{className:"button menu-footer-back-button",type:"button",onClick:function(){n(Se(Z))}},"Back"),r.a.createElement("div",{className:"menu-footer-filler"})))};var rr=function(){var e=Object(a.useState)(!1),t=Object(Je.a)(e,2),n=t[0],c=t[1],i=Object(g.d)(Pt);Object(a.useEffect)((function(){var e=setTimeout((function(){c(!0)}),500);return function(){return clearTimeout(e)}}),[]);var o=[{screenName:Z,Component:tt},{screenName:Q,Component:Ma},{screenName:$,Component:Ya},{screenName:ee,Component:Fa},{screenName:X,Component:La},{screenName:te,Component:Wa},{screenName:ne,Component:Va},{screenName:ae,Component:Qa},{screenName:re,Component:ar}];return r.a.createElement(Ke.a,{className:"menu-screen"},o.filter((function(e){var t=e.screenName;return n&&i===t.toString()})).map((function(e){var t=e.screenName,n=e.Component;return r.a.createElement(Ze.a,{key:t.toString(),timeout:300,classNames:"fade"},r.a.createElement(n,{className:""}))})))},cr=(n(84),Object(b.createStore)(Be,Object(N.composeWithDevTools)(Object(b.applyMiddleware)(S.a))));var ir=function(){return Object(a.useEffect)((function(){!function(e){var t=e.players;t&&cr.dispatch(Oe(t.players,t.playerOrder))}({players:qe()})}),[]),r.a.createElement(g.a,{store:cr},r.a.createElement(rr,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var or=n(41),sr=n.n(or);window.capac_racer_version="1.2.1",i.a.render(r.a.createElement(ir,null),document.getElementById("root")),m||(requestAnimationFrame(f),m=!0),E((function(e){u.notifyTimePassed(e)})),function(){var e=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};window.addEventListener("resize",sr()(e,200)),e()}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}]),[[47,1,2]]]);
//# sourceMappingURL=main.9883b736.chunk.js.map