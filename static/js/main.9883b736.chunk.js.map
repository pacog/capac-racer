{"version":3,"sources":["components/Grid/grid.png","utils/Counter.js","utils/waitingForPlayerCounter.js","constants/ux.js","utils/gameLoop.js","constants/player-types.js","utils/clamp.js","utils/vector2d.js","utils/player.js","utils/getUniqueIdString.js","store/players/actions.js","store/players/reducer.js","store/map/reducer.js","constants/screens.js","constants/player-styles.js","utils/random.js","utils/getRandomName.js","store/main-ui/actions.js","store/main-ui/reducer.js","constants/game-states.js","store/game/actions.js","store/game/reducer.js","store/rootReducer.js","utils/playersStorage.js","components/Logo/index.jsx","screens/MainMenu/index.jsx","utils/screenUtils.js","store/map/selectors.js","store/players/selectors.js","store/game/selectors.js","store/main-ui/selectors.js","constants/circuits.js","utils/loadImage.js","utils/imgPixelGetter.js","utils/pixel.js","utils/circuit.js","utils/range.js","utils/gameLoopTimeout.js","utils/highScoresStorage.js","constants/ai-levels.js","utils/PartialCircuitSolution.js","utils/ai.js","utils/request-animation-frame.js","utils/is-touch-device.js","utils/analytics.js","store/game/async-actions.js","components/CounterDisplay/index.jsx","components/propTypes.js","components/GameBoard/GameBoardCameraHandler.jsx","components/Grid/index.jsx","components/PlayerIcon/index.jsx","utils/playerPainter.js","components/Player/index.jsx","components/MovementPicker/PossibleDestinations.jsx","components/MovementPicker/index.jsx","components/RandomSelectionAnimation/index.jsx","components/PlayerTrail/index.jsx","components/GameBoard/GameBoardContents.jsx","components/GameBoard/index.jsx","components/PlayerList/PlayerListItem.jsx","components/PlayerList/index.jsx","components/GameScreenModals/StartGameModal.jsx","components/GameScreenModals/StartTurnModal.jsx","components/GameScreenModals/NotifyCollisionModal.jsx","components/ShowContentAfter/index.jsx","components/GameScreenModals/NotifyAICollisionModal.jsx","components/GameScreenModals/NotifyGroundedModal.jsx","components/GameScreenModals/NotifyAIGroundedModal.jsx","components/GameScreenModals/NotifyVictoryModal.jsx","components/GameScreenModals/InGameMenuModal.jsx","components/ScoreBoard/index.jsx","components/GameScreenModals/NotifyHighScoreModal.jsx","components/GameScreenModals/AIThinkingModal.jsx","components/GameScreenModals/index.jsx","components/KeyPressListener/index.jsx","components/WindowBlurListener/index.jsx","screens/Game/index.jsx","components/CircuitSelector/index.jsx","screens/CircuitSelection/index.jsx","store/main-ui/async-actions.js","components/PlayerSelector/index.jsx","screens/PlayersSelection/index.jsx","utils/players-order.js","screens/HighScores/index.jsx","screens/Credits/index.jsx","screens/LoadingGame/index.jsx","components/ReplayPlayerTrail/index.jsx","components/ReplayGameBoard/ReplayGameBoardContents.jsx","components/ReplayGameBoard/index.jsx","screens/ReplayGame/index.jsx","screens/Tutorial/TutorialScreen0.jsx","screens/Tutorial/TutorialScreen1.jsx","screens/Tutorial/TutorialScreen2.jsx","screens/Tutorial/TutorialScreen3.jsx","screens/Tutorial/index.jsx","Router.jsx","App.js","serviceWorker.js","index.js","utils/addVhCssVar.js"],"names":["module","exports","Counter","timeToWait","started","_elapsedTime","this","_timeToWait","_isRunning","Number","MAX_VALUE","time","_callbackOnEnd","callbackOnEnd","Math","max","counter","initted","delta","lastFrameTimeMs","gameLoop","timestamp","update","requestAnimationFrame","callbacksToUpdate","timeDiff","forEach","callback","removeFromUpdate","filter","eachCallback","addToUpdate","concat","HUMAN","AI","clamp","x","min","add","v1","v2","y","substract","isEqual","magnitude","v","sqrt","distance","round","isInsideViewport","vector","viewport","padding","topLeft","size","width","height","getClosestPointInsideViewport","minX","maxX","minY","maxY","movePlayerTo","player","position","timePassed","newSpeed","speedMagnitude","speed","prevPositions","turnsSpent","maxSpeed","realTimeUsed","crashPlayer","turnsGrounded","floor","crashes","reduceGrounded","addCheckpoints","newIndexes","newCheckpoints","checkpointsPassed","slice","sort","newIndex","usedIds","getUniqueIdString","intendedId","uniqueId","uuid","actionTypes","MOVE_TO","id","SET_PLAYERS","NOTIFY_COLLISION","REDUCE_GROUNDED","NOTIFY_VISITED_CHECKPOINTS","players","combineReducers","byId","state","action","type","reduce","accumulator","PLAYER_DEFAULT_INFO","playerId","newCheckpointIndexes","levelAI","map","zoom","gridSize","MAIN_MENU","GAME","CIRCUIT_SELECTION","PLAYERS_SELECTION","HIGH_SCORES","CREDITS","LOADING_GAME","REPLAY_GAME","TUTORIAL","CAR","name","dotColor","dotSize","trailColor","trailDotsSize","trailWidth","icon","process","ROCKET","TURTLE","SKULL","CLOWN","DANCER","PANDA","COFFIN","BROOM","SAILBOAT","STYLES","pickRandomFromArray","array","length","random","keepPickingUntilNotInArray","pickerFn","arrayToAvoid","compareFunction","a","b","maxTries","i","newPick","find","el","Error","FIRST_NAMES","LAST_NAMES","getRandomName","CHANGE_SCREEN","SET_SELECTED_CIRCUIT","SET_SELECTED_PLAYERS","REMOVE_PLAYER","UPDATE_PLAYER","TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START","TOGGLE_PLAY_WITH_TIMER","changeScreen","screenId","setSelectedPlayers","playerOrder","updatePlayer","attrsToUpdate","initialPlayers","style","Object","values","defaultOrder","mainUI","currentScreen","selectedCircuit","circuitId","selectedPlayerOrder","selectedPlayers","randomizePlayerOrderOnStart","playWithTimer","NOT_STARTED","START_SCREEN","PLAYER_TURN_START_SCREEN","WAITING_FOR_PLAYER_INPUT","ANIMATING_RANDOM_PLAYER_MOVEMENT","NOTIFY_AI_COLLISION","NOTIFY_GROUNDED","NOTIFY_AI_GROUNDED","NOTIFY_VICTORY","NOTIFY_HIGH_SCORE","SHOW_MENU","AI_THINKING_SCREEN","INIT_GAME","INIT_REPLAY","SET_GAME_STATE","ADVANCE_PLAYER_TURN","SET_CIRCUIT","SET_LATEST_HIGH_SCORE","SET_SELECTED_POSITION","SET_SELECTED_AI_MOVE","setGameState","newGameState","defaultState","gameState","gameStates","prevGameState","currentTurnPlayerId","circuitInfo","latestHighScore","selectedPosition","raceHistory","selectedAIMove","game","getNextTurn","highScore","newPosition","newMove","currentPlayer","indexOf","getSavedPlayers","window","localStorage","result","getItem","e","JSON","parse","Logo","variant","className","defaultProps","MainMenu","dispatch","useDispatch","classNames","onClick","capac_racer_version","getScreenCoordinates","worldPosition","mapZoom","project","n","dx","dy","baseX","baseY","getZoom","getGridSize","projectToScreenPosition","mapGridSize","getPossibleDestinations","otherPlayers","positionAfterSpeed","positions","j","push","otherPosition","isPositionColliding","isWaitingForPlayerInput","isAnimatingRandomSelection","isAnimatingAISelection","getAISelectedMove","getCurrentPlayer","isGameStarted","getAllPlayers","getOtherPlayers","getOtherPlayersPositionInScreen","getGameState","getOrderedPlayers","getPossibleDestinationsForPlayerInScreen","otherPlayer","eachPosition","screen","getMovedPixelsSinceLastTurn","lastPosition","moved","getPivotForPlayerInScreen","getLatestHighScore","getSelectedPosition","getRaceHistory","getCircuitInfo","getCurrentScreen","getSelectedCircuit","shouldRandomizePlayerOrderOnStart","shouldPlayWithTimer","circuits","mouth","collisionImg","bgImg","checkpoints","maxPlayers","startingPositions","initialSpeed","heart","rosco","horse","loadImage","url","Promise","resolve","reject","img","Image","addEventListener","once","error","src","createFromImage","canvas","document","createElement","getContext","drawImage","rawData","getImageData","data","getPixel","basePosition","r","g","hasContent","createFromConfig","config","createPixelGetterFromImage","collisionPixelGetter","all","checkpointImg","loadedCheckpointImages","checkpointImage","checkpointPixelGetters","centerOfCheckpoints","getCenterOfCheckpoint","doesLineCollide","line","circuit","otherPlayersPosition","pixelsToCheck","getPixelsToCheck","doesAnyPixelCollideInImage","pixelToCheck","checkIfPlayerCanMove","from","to","movementLine","getCheckpointsVisitedInLine","checkpointPixelGetter","doesItCollide","index","imagePixelGetter","pixelInCollisionMap","start","end","lineLength","nPixelsToCheck","ceil","diffVector","Array","keys","factor","scale","checkpoint","resultArray","acc","pixel","timeout","timeMs","notifyPassOfTime","notifyTimePassed","addToGameLoopUpdate","restart","removeFromGameLoopUpdate","stop","getAll","getByCircuitId","score","date","Date","shouldScoreBeAdded","circuitScores","isBetterScore","addScore","insertBefore","scoreToAdd","v4","newScores","splice","newAll","setItem","stringify","undefined","console","warn","updateCircuitScores","otherScore","turns","levels","randomSolutionChance","maxIterations","maxThinkingDepth","timeThinking","PartialCircuitSolution","playerInfo","currentIteration","_updatePartialScore","maxDepthForSolutions","otherPlayersToConsider","canMoveThere","visitedCheckpointsInTurn","getCheckpointsInMovement","maxAvgSpeed","maxCheckpointsCoveredPerTurn","maxCheckpointsCovered","avgSpeedScore","avgSpeed","checkpointsCoveredPerTurnScore","checkpointsCoveredPerTurn","checkpointsCoveredScore","checkpointsCovered","summary","toFixed","positionHash","doesPlayerHaveRepeatedPositions","totalDistance","point","nextPoint","getAverageSpeed","getCheckpointsPassed","nextCheckpoint","_getPercentageToNextCheckpoint","getTurns","indexWithFirstPosition","hasPlayerFinishedRace","playerPositionScreen","getDistanceToNextCheckpoint","cp","eachDistance","getMaxCheckpointDistance","chooseNextMovement","chance","aiLevels","shouldGetRandomSolution","possiblePositions","returnRandomNonCrashingMove","solutionsGenerator","createSolutionsGenerator","solution","isFinished","move","openSolutions","finishedSolutions","bestFinishedSolution","solutionToExpand","getMostPromisingSolution","newSolutions","expand","newFinishedSolutions","newOpenSolutions","getScore","updateScoreWithTotals","getFirstMove","returnRandomMove","solutions","best","isTouchDevice","prefixes","split","DocumentTouch","query","matchMedia","matches","mq","join","checkTouchDevice","track","category","label","value","gtag","event_category","event_label","startTurn","getState","nextPlayer","setTimeout","reduceGroundedAndNextTurn","notifyGrounded","startWaitingForPlayerInput","handleAITurn","nextTurn","initGameWithConfig","playersWithMapPosition","initialPosition","initMapPositionForPlayers","fixPlayersWithoutName","setPlayers","waitingForPlayerCounter","setTimeToWait","then","initGame","initGameWithSavedConfig","shuffle","playersInfoToStore","version","storeSavedPlayers","handlePlayerCollision","newIntendedPosition","notifyCollision","handleCorrectMovement","detectAndStoreCheckpoints","hasPlayerWon","hasCurrentPlayerWon","moveTo","path","playerStyle","newScore","handleVictory","handlePlayerMovement","getTimePassed","handlePlayerPositionSelection","nextPosition","nextMovementPromise","minTimeToWaitForPlayer","getMinTimeToWaitForPlayer","nextMovement","finishGame","reset","pause","unpause","lastState","tryToToggleInGameMenu","getNameForPlayerWithoutName","showReplay","initReplay","CounterDisplay","timeLeft","requestRef","animate","setState","props","counterObject","getTimeLeft","cancelAnimationFrame","React","Component","PropTypes","shape","string","number","vector2d","PADDING_FOR_VIEWPORT","isRequired","arrayOf","yy","GameBoardCameraHandler","cameraPosition","boardSize","isDragging","dragStart","moveCurrentPlayerIntoView","playerScreenPosition","closestPointInViewport","newCameraMovement","oldCameraPosition","handlePointerDown","event","coordinates","getCoordinatesFromPointerEvent","handlePointerUp","handlePointerMove","cursorPosition","movement","prevProps","handleHeight","handleWidth","onResize","transform","onMouseDown","onMouseUp","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","children","connect","ownProps","eventToUse","touches","clientX","clientY","Grid","backgroundSize","cellSize","backgroundImage","gridImg","PlayerIcon","getPlayerStyleCSS","getColorForTempLine","points","Player","isActive","useSelector","left","top","PossibleDestinations","div","key","initial","transition","ease","duration","delay","onPositionSelected","onMouseEnter","onPositionHover","onMouseLeave","onPositionHoverEnd","MovementPicker","tempLine","selectButtonPosition","possiblePlayerPositions","MIN_VALUE","getSelectButtonPosition","lineToPaint","selectedPositionScreen","wouldCollide","originalPlayerScreenPosition","lastMovement","screenPosition","onConfirmSelection","stroke","strokeWidth","strokeDasharray","fill","nextPivot","RandomSelectionAnimation","switchRandomEvery","highlightMove","useState","setTempLine","highlightedPosition","setHighlightedPosition","useEffect","interval","setInterval","randomPosition","clearInterval","moveToHighlight","getKey","PlayerTrail","storeState","pointsWithoutLast","turn","GameBoardContents","waitingForPlayerInput","animatingRandomSelection","animatingAISelection","AIMove","getRandomSpeedForAI","GameBoard","shouldShowPauseButton","PlayerListItem","PlayerList","StartGameModal","StartTurnModal","NotifyCollisionModal","pluralize","ShowContentAfter","showContent","showAfter","clearTimeout","render","NotifyAICollisionModal","NotifyGroundedModal","NotifyAIGroundedModal","NotifyVictoryModal","InGameMenuModal","stopPropagation","ScoreBoard","scores","highlightedScore","canReplay","onScoreClicked","toLocaleDateString","NotifyHighScoreModal","highScoresForCircuit","AIThinkingModal","GameScreenModals","KeyPressListener","onKeyPress","code","removeEventListener","propTypes","objectOf","func","hidden","visibilityChange","WindowBlurListener","onBlur","handleVisibilityChange","msHidden","webkitHidden","Game","Escape","Space","CircuitSelector","alt","circuitsArray","CircuitSelection","selectNewStyleForPlayer","allStyles","stylesToUse","isStyleUsedByPlayers","nextStyleIndex","findIndex","PlayerSelector","onRemove","canBeRemoved","onNameChange","onTypeChange","onLevelAIChange","onSelectNewStyle","onChange","target","disabled","opacity","step","parseInt","level","getRobotNameByLevel","PlayersSelection","numberOfPlayers","order","orderedPlayers","getPlayersOrderedBy","newName","newType","newLevelAI","currentNames","currentStyles","newStyle","newPlayer","checked","HighScores","scoresForCurrentCircuit","setScoresForCurrentCircuit","activeCircuit","setActiveCircuit","Credits","href","rel","LoadingGame","defaultStyle","ReplayPlayerTrail","ReplayGameBoardContents","playerInPosition","ReplayGameBoard","setPlayerInPosition","currentTurn","setCurrentTurn","parseFloat","ReplayGame","TutorialScreen0","onNext","TutorialScreen1","TutorialScreen2","TutorialScreen3","Tutorial","setCurrentScreen","goToNextScreen","Router","gameReady","setGameReady","currentScreenName","allScreens","screenName","screens","TransitionGroup","toString","CSSTransition","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","App","restoreSavedConfig","Boolean","location","hostname","match","ReactDOM","getElementById","setVH","vh","innerHeight","documentElement","setProperty","debounce","addVHCSSVar","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9883b736.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFYWFhAAAAQQerqwAAAAJ0Uk5T/wDltzBKAAAAFklEQVR4nGNggIH6/2DwYJQx0hkwAABHzKo6mLcE9gAAAABJRU5ErkJggg==\"","export default class Counter {\n    /**\n     *\n     * @param {Object} params\n     * @param {number} [params.timeToWait=10000]\n     * @param {boolean} [params.started=false]\n     */\n    constructor({ timeToWait = 10000, started = false }) {\n        this._timeToWait = timeToWait;\n        this._isRunning = started;\n    }\n\n    /** @type {number} */\n    _timeToWait;\n\n    /** @type {boolean} */\n    _isRunning;\n\n    _elapsedTime = 0;\n\n    /**\n     * @param {number} [timeToWait=10000]\n     */\n    setTimeToWait(timeToWait = 10000) {\n        if (timeToWait <= 0) {\n            this._timeToWait = Number.MAX_VALUE;\n        }\n    }\n\n    /**\n     * @param {number} time\n     */\n    notifyTimePassed(time) {\n        if (!this._isRunning) {\n            return;\n        }\n        this._elapsedTime += time;\n        if (this._elapsedTime >= this._timeToWait) {\n            this._callbackOnEnd();\n            this._isRunning = false;\n        }\n    }\n\n    /**\n     *\n     * @param {Object} params\n     * @param {Function} params.callbackOnEnd\n     */\n    restart({ callbackOnEnd = () => {} }) {\n        this._elapsedTime = 0;\n        this._isRunning = true;\n        this._callbackOnEnd = callbackOnEnd;\n    }\n\n    pause() {\n        this._isRunning = false;\n    }\n\n    unpause() {\n        this._isRunning = true;\n    }\n\n    stop() {\n        this._isRunning = false;\n        this._callbackOnEnd = null;\n    }\n\n    reset() {\n        this._elapsedTime = 0;\n        this._isRunning = false;\n        this._callbackOnEnd = null;\n    }\n\n    getTimeLeft() {\n        return Math.max(this._timeToWait - this._elapsedTime, 0);\n    }\n\n    getTimePassed() {\n        return this._elapsedTime;\n    }\n}\n","import { TIME_FOR_USER_TO_PICK_POSITION } from 'constants/ux';\nimport Counter from './Counter';\n\nconst counter = new Counter({ timeToWait: TIME_FOR_USER_TO_PICK_POSITION });\n\nexport default counter;\n","export const TIME_FOR_USER_TO_PICK_POSITION = 30999; // ms\nexport const TIME_SHOWING_RANDOM_SELECTOR = 3000; // ms\nexport const SWITCH_RANDOM_SELECTION_EVERY = 100; // ms\nexport const WAIT_AFTER_AI_COLLISION = 2000;\nexport const WAIT_AFTER_AI_GROUNDED = 2000;\n","let initted = false;\nlet delta = 0;\nlet lastFrameTimeMs = 0;\n// We want to simulate 1000 ms / 60 FPS = 16.667 ms per frame every time we run update()\nconst timestep = 1000 / 60;\n\nfunction gameLoop(timestamp) {\n    delta += timestamp - lastFrameTimeMs;\n    lastFrameTimeMs = timestamp;\n\n    // Simulate the total elapsed time in fixed-size chunks\n    while (delta >= timestep) {\n        update(timestep);\n        delta -= timestep;\n    }\n    requestAnimationFrame(gameLoop);\n}\n\nlet callbacksToUpdate = [];\n\nfunction update(timeDiff) {\n    callbacksToUpdate.forEach((callback) => callback(timeDiff));\n}\n\nexport const init = () => {\n    if (!initted) {\n        requestAnimationFrame(gameLoop);\n        initted = true;\n    }\n};\n\nexport const removeFromUpdate = (callback) => {\n    callbacksToUpdate = callbacksToUpdate.filter(\n        (eachCallback) => callback !== eachCallback,\n    );\n};\n\nexport const addToUpdate = (callback) => {\n    callbacksToUpdate = callbacksToUpdate.concat([callback]);\n    return () => {\n        removeFromUpdate(callback);\n    };\n};\n","export const HUMAN = 'HUMAN';\nexport const AI = 'AI';\n","/**\n *\n * @param {number} x\n * @param {number} [min=0]\n * @param {number} [max=1]\n */\nexport const clamp = (x, min = 0, max = 1) => {\n    return Math.max(Math.min(x, max), min);\n};\n","import { clamp } from './clamp';\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n * @returns {Point}\n */\nexport const add = (v1, v2) => {\n    return { x: v1.x + v2.x, y: v1.y + v2.y };\n};\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n * @returns {Point}\n */\nexport const substract = (v1, v2) => {\n    return { x: v1.x - v2.x, y: v1.y - v2.y };\n};\n\n/**\n * @param {Point} v1\n * @param {number} factor\n * @returns {Point}\n */\nexport const scale = (v1, factor) => {\n    return { x: v1.x * factor, y: v1.y * factor };\n};\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n */\nexport const isEqual = (v1, v2) => {\n    return v1.x === v2.x && v1.y === v2.y;\n};\n\n/**\n * @param {Point} v\n * @returns {number}\n */\nexport const magnitude = (v) => {\n    return Math.sqrt(v.x ** 2 + v.y ** 2);\n};\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n * @returns {number}\n */\nexport const distance = (v1, v2) => {\n    return magnitude(substract(v1, v2));\n};\n\n/**\n * @param {Point} v1\n * @returns {Point}\n */\nexport const round = (v1) => {\n    return { x: Math.round(v1.x), y: Math.round(v1.y) };\n};\n\n/**\n * @param {Point} vector\n * @param {Viewport} viewport\n * @param {Point} padding\n */\nexport const isInsideViewport = (vector, viewport, padding) => {\n    return (\n        vector.x >= viewport.topLeft.x + padding.x &&\n        vector.x <= viewport.topLeft.x + viewport.size.width - padding.x &&\n        vector.y >= viewport.topLeft.y + padding.y &&\n        vector.y <= viewport.topLeft.y + viewport.size.height - padding.y\n    );\n};\n\n/**\n * @param {Point} vector\n * @param {Viewport} viewport\n * @param {Point} padding\n * @returns {Point}\n */\nexport const getClosestPointInsideViewport = (vector, viewport, padding) => {\n    const minX = viewport.topLeft.x + padding.x;\n    const maxX = viewport.topLeft.x + viewport.size.width - padding.x;\n    const minY = viewport.topLeft.y + padding.y;\n    const maxY = viewport.topLeft.y + viewport.size.height - padding.y;\n    return {\n        x: clamp(vector.x, minX, maxX),\n        y: clamp(vector.y, minY, maxY),\n    };\n};\n","import { substract, magnitude, distance } from 'utils/vector2d';\n\nexport const movePlayerTo = (player, position, timePassed) => {\n    const newSpeed = substract(position, player.position);\n    const speedMagnitude = magnitude(newSpeed);\n\n    return {\n        ...player,\n        position,\n        speed: newSpeed,\n        prevPositions: player.prevPositions.concat(position),\n        turnsSpent: player.turnsSpent + 1,\n        maxSpeed: Math.max(speedMagnitude, player.maxSpeed),\n        realTimeUsed: player.realTimeUsed + timePassed,\n    };\n};\n\nexport const crashPlayer = (player, speed, timePassed) => {\n    const newSpeed = { x: 0, y: 0 };\n    const turnsGrounded = Math.floor(speed / 3);\n    return {\n        ...player,\n        speed: newSpeed,\n        turnsGrounded,\n        crashes: player.crashes + 1,\n        turnsSpent: player.turnsSpent + 1,\n        realTimeUsed: player.realTimeUsed + timePassed,\n    };\n};\n\nexport const reduceGrounded = (player) => {\n    return {\n        ...player,\n        turnsGrounded: Math.max(0, player.turnsGrounded - 1),\n        turnsSpent: player.turnsSpent + 1,\n    };\n};\n\nexport const addCheckpoints = (player, newIndexes) => {\n    const newCheckpoints = player.checkpointsPassed.slice();\n    newIndexes.sort().forEach((newIndex) => {\n        // Only do checkpoints in correct order.\n        if (newIndex === 0 || newCheckpoints[newIndex - 1]) {\n            newCheckpoints[newIndex] = true;\n        }\n    });\n    return {\n        ...player,\n        checkpointsPassed: newCheckpoints,\n    };\n};\n\nexport const doesPlayerHaveRepeatedPositions = (player) => {\n    const positionHash = {};\n    // eslint-disable-next-line no-restricted-syntax\n    for (const position of player.prevPositions) {\n        const id = `${position.x}_${position.y}`;\n        if (positionHash[id]) {\n            return true;\n        }\n        positionHash[id] = true;\n    }\n    return false;\n};\n\nexport const getAverageSpeed = (player) => {\n    if (!player.prevPositions.length) {\n        return 0;\n    }\n    let totalDistance = 0;\n    for (let i = 0; i < player.prevPositions.length - 1; i += 1) {\n        const point = player.prevPositions[i];\n        const nextPoint = player.prevPositions[i + 1];\n        totalDistance += distance(point, nextPoint);\n    }\n    return totalDistance / player.prevPositions.length;\n};\n\nexport const getCheckpointsPassed = (player) => {\n    let result = 0;\n    for (let i = 0; i < player.checkpointsPassed.length - 1; i += 1) {\n        if (!player.checkpointsPassed[i]) {\n            break;\n        }\n        result += 1;\n    }\n    return result;\n};\n\nexport const hasPlayerFinishedRace = (player) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const checkpoint of player.checkpointsPassed) {\n        if (!checkpoint) {\n            return false;\n        }\n    }\n    return true;\n};\n","import { v4 as uuid } from 'uuid';\n\n/** @type {Object.<string, boolean>} */\nconst usedIds = {};\n\n/**\n * Gets a unique string id. Will return the intended one if it hasn't been used yet, or will add a unique string to it if it has.\n * @param {string} intendedId\n */\nexport const getUniqueIdString = (intendedId) => {\n    if (!usedIds[intendedId]) {\n        usedIds[intendedId] = true;\n        return intendedId;\n    }\n    const uniqueId = `${intendedId}__${uuid()}`;\n    usedIds[uniqueId] = true;\n    return uniqueId;\n};\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const actionTypes = {\n    MOVE_TO: id('MOVE_TO'),\n    SET_PLAYERS: id('SET_PLAYERS'),\n    NOTIFY_COLLISION: id('NOTIFY_COLLISION'),\n    REDUCE_GROUNDED: id('REDUCE_GROUNDED'),\n    NOTIFY_VISITED_CHECKPOINTS: id('NOTIFY_VISITED_CHECKPOINTS'),\n};\n\nexport const moveTo = (playerId, position, timePassed) => {\n    return {\n        type: actionTypes.MOVE_TO,\n        playerId,\n        position,\n        timePassed,\n    };\n};\n\nexport const notifyCollision = (playerId, speed, timePassed) => {\n    return {\n        type: actionTypes.NOTIFY_COLLISION,\n        playerId,\n        speed,\n        timePassed,\n    };\n};\n\nexport const setPlayers = (players) => {\n    return {\n        type: actionTypes.SET_PLAYERS,\n        players,\n    };\n};\n\nexport const reduceGrounded = (playerId) => {\n    return {\n        type: actionTypes.REDUCE_GROUNDED,\n        playerId,\n    };\n};\n\nexport const notifyVisitedCheckpoints = (playerId, newCheckpointIndexes) => {\n    return {\n        type: actionTypes.NOTIFY_VISITED_CHECKPOINTS,\n        playerId,\n        newCheckpointIndexes,\n    };\n};\n","import { combineReducers } from 'redux';\nimport { HUMAN } from 'constants/player-types';\nimport {\n    movePlayerTo,\n    crashPlayer,\n    reduceGrounded,\n    addCheckpoints,\n} from 'utils/player';\nimport { actionTypes } from './actions';\n\n/**\n * @type {import('react').Reducer<import('redux').CombinedState<PlayersState>, import('redux').AnyAction>}\n */\nconst players = combineReducers({\n    byId,\n});\n\nconst PLAYER_DEFAULT_INFO = {\n    position: { x: 0, y: 0 },\n    speed: { x: 0, y: 0 },\n    prevPositions: [],\n    turnsGrounded: 0,\n    checkpointsPassed: [false],\n    turnsSpent: 0,\n    realTimeUsed: 0,\n    maxSpeed: 0,\n    crashes: 0,\n    type: HUMAN,\n    levelAI: 0,\n};\n\nfunction byId(state = {}, action) {\n    switch (action.type) {\n        case actionTypes.SET_PLAYERS:\n            return action.players.reduce((accumulator, player) => {\n                return {\n                    ...accumulator,\n                    [player.id]: {\n                        ...PLAYER_DEFAULT_INFO,\n                        ...player,\n                    },\n                };\n            }, {});\n        case actionTypes.MOVE_TO:\n            return {\n                ...state,\n                [action.playerId]: movePlayerTo(\n                    state[action.playerId],\n                    action.position,\n                    action.timePassed,\n                ),\n            };\n        case actionTypes.NOTIFY_COLLISION:\n            return {\n                ...state,\n                [action.playerId]: crashPlayer(\n                    state[action.playerId],\n                    action.speed,\n                    action.timePassed,\n                ),\n            };\n\n        case actionTypes.REDUCE_GROUNDED:\n            return {\n                ...state,\n                [action.playerId]: reduceGrounded(state[action.playerId]),\n            };\n        case actionTypes.NOTIFY_VISITED_CHECKPOINTS:\n            return {\n                ...state,\n                [action.playerId]: addCheckpoints(\n                    state[action.playerId],\n                    action.newCheckpointIndexes,\n                ),\n            };\n        default:\n            return state;\n    }\n}\n\nexport default players;\n","import { combineReducers } from 'redux';\n\nconst zoom = (state = 2, action) => {\n    switch (action.type) {\n        default:\n            return state;\n    }\n};\n\nconst gridSize = (state = 10, action) => {\n    switch (action.type) {\n        default:\n            return state;\n    }\n};\n\n/**\n * @type {import('react').Reducer<import('redux').CombinedState<MapState>, import('redux').AnyAction>}\n */\nconst map = combineReducers({\n    zoom,\n    gridSize,\n});\n\nexport default map;\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const MAIN_MENU = id('MAIN_MENU');\nexport const GAME = id('GAME');\nexport const CIRCUIT_SELECTION = id('CIRCUIT_SELECTION');\nexport const PLAYERS_SELECTION = id('PLAYERS_SELECTION');\nexport const HIGH_SCORES = id('HIGH_SCORES');\nexport const CREDITS = id('CREDITS');\nexport const LOADING_GAME = id('LOADING_GAME');\nexport const REPLAY_GAME = id('REPLAY_GAME');\nexport const TUTORIAL = id('TUTORIAL');\n","/** @type {PlayerStyle} */\nexport const CAR = {\n    id: 'car',\n    name: 'car',\n    dotColor: '#e4223c',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#e4223c',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/car.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const ROCKET = {\n    id: 'rocket',\n    name: 'rocket',\n    dotColor: '#39c3b6',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#39c3b6',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/rocket.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const TURTLE = {\n    id: 'turtle',\n    name: 'turtle',\n    dotColor: '#43c830',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#43c830',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/turtle.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const SKULL = {\n    id: 'skull',\n    name: 'skull',\n    dotColor: '#9a9e9f',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#9a9e9f',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/skull.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const CLOWN = {\n    id: 'clown',\n    name: 'clown',\n    dotColor: '#fdfffc',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#fdfffc',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/clown.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const DANCER = {\n    id: 'dancer',\n    name: 'dancer',\n    dotColor: '#5c0eab',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#5c0eab',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/dancer.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const PANDA = {\n    id: 'panda',\n    name: 'panda',\n    dotColor: '#212121',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#212121',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/panda.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const COFFIN = {\n    id: 'coffin',\n    name: 'coffin',\n    dotColor: '#ad7222',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#ad7222',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/coffin.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const BROOM = {\n    id: 'broom',\n    name: 'broom',\n    dotColor: '#c5db0f',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#c5db0f',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/broom.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const SAILBOAT = {\n    id: 'sailboat',\n    name: 'sailboat',\n    dotColor: '#016fdf',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#016fdf',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/sailboat.png`,\n};\n\nexport const STYLES = {\n    [CAR.id]: CAR,\n    [ROCKET.id]: ROCKET,\n    [TURTLE.id]: TURTLE,\n    [SKULL.id]: SKULL,\n    [CLOWN.id]: CLOWN,\n    [DANCER.id]: DANCER,\n    [PANDA.id]: PANDA,\n    [COFFIN.id]: COFFIN,\n    [BROOM.id]: BROOM,\n    [SAILBOAT.id]: SAILBOAT,\n};\n","export const pickRandomFromArray = (array) => {\n    if (!array || !array.length) {\n        return null;\n    }\n    const randomIndex = Math.floor(Math.random() * array.length);\n    return array[randomIndex];\n};\n\nexport const keepPickingUntilNotInArray = (\n    pickerFn,\n    arrayToAvoid,\n    compareFunction = (a, b) => a === b,\n    maxTries = 10000,\n) => {\n    for (let i = 0; i < maxTries; i += 1) {\n        const newPick = pickerFn();\n        const found = arrayToAvoid.find((el) => compareFunction(el, newPick));\n        if (!found) {\n            return newPick;\n        }\n    }\n    throw new Error(\n        `keepPickingUntilNotInArray: tried ${maxTries} times, no luck`,\n    );\n};\n\nexport const getRandomInRange = (min, max) => {\n    return min + Math.random() * (max - min);\n};\n","import { pickRandomFromArray } from './random';\n\nconst FIRST_NAMES = [\n    'Max',\n    'Carlitros',\n    'Michael',\n    'Fernando',\n    'Lolín',\n    'Esquizo',\n    'Agapito',\n    'Tolomeo',\n];\n\nconst LAST_NAMES = [\n    'Cucaracha',\n    'Aubergine',\n    'Tentacles',\n    'Rex',\n    'Danger',\n    'Senna',\n    'Alonso',\n    'Schumacher',\n    'Jander',\n];\n\nexport const getRandomName = () => {\n    return `${pickRandomFromArray(FIRST_NAMES)} ${pickRandomFromArray(\n        LAST_NAMES,\n    )}`;\n};\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const actionTypes = {\n    CHANGE_SCREEN: id('CHANGE_SCREEN'),\n    SET_SELECTED_CIRCUIT: id('SET_SELECTED_CIRCUIT'),\n    SET_SELECTED_PLAYERS: id('SET_SELECTED_PLAYERS'),\n    REMOVE_PLAYER: id('REMOVE_PLAYER'),\n    UPDATE_PLAYER: id('UPDATE_PLAYER'),\n    TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:\n        'TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START',\n    TOGGLE_PLAY_WITH_TIMER: id('TOGGLE_PLAY_WITH_TIMER'),\n};\nexport const changeScreen = (screenId) => {\n    return {\n        type: actionTypes.CHANGE_SCREEN,\n        screenId,\n    };\n};\nexport const setSelectedCircuit = (circuitId) => {\n    return {\n        type: actionTypes.SET_SELECTED_CIRCUIT,\n        circuitId,\n    };\n};\n\nexport const setSelectedPlayers = (players, playerOrder) => {\n    return {\n        type: actionTypes.SET_SELECTED_PLAYERS,\n        players,\n        playerOrder,\n    };\n};\n\nexport const removePlayer = (playerId) => {\n    return {\n        type: actionTypes.REMOVE_PLAYER,\n        playerId,\n    };\n};\n\nexport const updatePlayer = (playerId, attrsToUpdate) => {\n    return {\n        type: actionTypes.UPDATE_PLAYER,\n        playerId,\n        attrsToUpdate,\n    };\n};\n\nexport const toggleRandomizePlayerOrderOnStart = () => {\n    return {\n        type: actionTypes.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START,\n    };\n};\n\nexport const togglePlayWithTimer = () => {\n    return {\n        type: actionTypes.TOGGLE_PLAY_WITH_TIMER,\n    };\n};\n","import { combineReducers } from 'redux';\nimport { MAIN_MENU } from 'constants/screens';\nimport { STYLES } from 'constants/player-styles';\nimport { getRandomName } from 'utils/getRandomName';\nimport { pickRandomFromArray } from 'utils/random';\nimport { HUMAN } from 'constants/player-types';\nimport { actionTypes } from './actions';\n\nconst currentScreen = (state = MAIN_MENU, action) => {\n    switch (action.type) {\n        case actionTypes.CHANGE_SCREEN:\n            return action.screenId;\n        default:\n            return state;\n    }\n};\n\nconst selectedCircuit = (state = null, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_CIRCUIT:\n            return action.circuitId;\n        default:\n            return state;\n    }\n};\n\n/** @type {Player[]} */\nconst initialPlayers = [\n    {\n        id: 'DEFAULT_PLAYER',\n        name: getRandomName(),\n        style: pickRandomFromArray(Object.values(STYLES)),\n        type: HUMAN,\n        levelAI: 0,\n    },\n];\n\nconst selectedPlayers = (state = initialPlayers, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_PLAYERS:\n            return action.players;\n        case actionTypes.REMOVE_PLAYER:\n            return state.filter((player) => player.id !== action.playerId);\n        case actionTypes.UPDATE_PLAYER:\n            return state.map((player) => {\n                if (player.id !== action.playerId) {\n                    return player;\n                }\n                return {\n                    ...player,\n                    ...action.attrsToUpdate,\n                };\n            });\n        default:\n            return state;\n    }\n};\n\nconst defaultOrder = ['DEFAULT_PLAYER'];\nconst selectedPlayerOrder = (state = defaultOrder, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_PLAYERS:\n            return action.playerOrder;\n        case actionTypes.REMOVE_PLAYER:\n            return state.filter((playerId) => playerId !== action.playerId);\n        default:\n            return state;\n    }\n};\n\nconst randomizePlayerOrderOnStart = (state = true, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:\n            return !state;\n        default:\n            return state;\n    }\n};\n\nconst playWithTimer = (state = false, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_PLAY_WITH_TIMER:\n            return !state;\n        default:\n            return state;\n    }\n};\n\n/**\n * @type {import('react').Reducer<import('redux').CombinedState<MainUIState>, import('redux').AnyAction>}\n */\nconst mainUI = combineReducers({\n    currentScreen,\n    selectedCircuit,\n    selectedPlayerOrder,\n    selectedPlayers,\n    randomizePlayerOrderOnStart,\n    playWithTimer,\n});\n\nexport default mainUI;\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const NOT_STARTED = id('NOT_STARTED');\nexport const START_SCREEN = id('START_SCREEN');\nexport const PLAYER_TURN_START_SCREEN = id('PLAYER_TURN_START_SCREEN');\nexport const WAITING_FOR_PLAYER_INPUT = id('WAITING_FOR_PLAYER_INPUT');\nexport const ANIMATING_PLAYER_MOVEMENT = id('ANIMATING_PLAYER_MOVEMENT');\nexport const ANIMATING_RANDOM_PLAYER_MOVEMENT = id(\n    'ANIMATING_RANDOM_PLAYER_MOVEMENT',\n);\nexport const NOTIFY_COLLISION = id('NOTIFY_COLLISION');\nexport const NOTIFY_AI_COLLISION = id('NOTIFY_AI_COLLISION');\nexport const NOTIFY_GROUNDED = id('NOTIFY_GROUNDED');\nexport const NOTIFY_AI_GROUNDED = id('NOTIFY_AI_GROUNDED');\nexport const NOTIFY_VICTORY = id('NOTIFY_VICTORY');\nexport const NOTIFY_HIGH_SCORE = id('NOTIFY_HIGH_SCORE');\nexport const SHOW_MENU = id('SHOW_MENU');\nexport const AI_THINKING_SCREEN = id('AI_THINKING_SCREEN');\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const actionTypes = {\n    INIT_GAME: id('INIT_GAME'),\n    INIT_REPLAY: id('INIT_REPLAY'),\n    SET_GAME_STATE: id('SET_GAME_STATE'),\n    ADVANCE_PLAYER_TURN: id('ADVANCE_PLAYER_TURN'),\n    SET_CIRCUIT: id('SET_CIRCUIT'),\n    SET_LATEST_HIGH_SCORE: id('SET_LATEST_HIGH_SCORE'),\n    SET_SELECTED_POSITION: id('SET_SELECTED_POSITION'),\n    SET_SELECTED_AI_MOVE: id('SET_SELECTED_AI_MOVE'),\n};\nexport const initGame = (playerOrder, circuitInfo) => {\n    return {\n        type: actionTypes.INIT_GAME,\n        playerOrder,\n        circuitInfo,\n    };\n};\n\nexport const initReplay = (raceHistory, circuitInfo) => {\n    return {\n        type: actionTypes.INIT_REPLAY,\n        raceHistory,\n        circuitInfo,\n    };\n};\n\nexport const setGameState = (newGameState) => {\n    return {\n        type: actionTypes.SET_GAME_STATE,\n        newGameState,\n    };\n};\n\nexport const advancePlayerTurn = () => {\n    return {\n        type: actionTypes.ADVANCE_PLAYER_TURN,\n    };\n};\n\nexport const setLatestHighScore = (highScore) => {\n    return {\n        type: actionTypes.SET_LATEST_HIGH_SCORE,\n        highScore,\n    };\n};\n\nexport const setSelectedPosition = (newPosition) => {\n    return {\n        type: actionTypes.SET_SELECTED_POSITION,\n        newPosition,\n    };\n};\n\nexport const setSelectedAIMove = (newMove) => {\n    return {\n        type: actionTypes.SET_SELECTED_AI_MOVE,\n        newMove,\n    };\n};\n","import * as gameStates from 'constants/game-states';\nimport { actionTypes } from './actions';\n\n/** @type {GameState} */\nconst defaultState = {\n    gameState: gameStates.NOT_STARTED,\n    prevGameState: null, // We store one game state previous to the current so we can go back after pausing\n    players: [],\n    currentTurnPlayerId: null,\n    circuitInfo: null,\n    latestHighScore: null, // If somebody achived a high score, it will be stored here until the next game starts\n    selectedPosition: null, // When we use a touch interface we can store the position that has been selected before confirming the move\n    raceHistory: null, // Used when replaying a game\n    selectedAIMove: null, // When AI selects a move, we show it briefly before moving the player\n};\n\n/**\n *\n * @param {GameState} state\n * @param {import('redux').AnyAction} action\n * @returns {GameState}\n */\nconst game = (state = defaultState, action) => {\n    switch (action.type) {\n        case actionTypes.INIT_GAME:\n            return {\n                ...state,\n                gameState: gameStates.START_SCREEN,\n                currentTurnPlayerId: action.playerOrder[0],\n                players: action.playerOrder.slice(),\n                circuitInfo: { ...action.circuitInfo },\n                latestHighScore: null,\n                selectedPosition: null,\n                selectedAIMove: null,\n            };\n        case actionTypes.INIT_REPLAY:\n            return {\n                ...state,\n                gameState: gameStates.START_SCREEN,\n                circuitInfo: { ...action.circuitInfo },\n                raceHistory: action.raceHistory,\n            };\n        case actionTypes.ADVANCE_PLAYER_TURN:\n            return {\n                ...state,\n                currentTurnPlayerId: getNextTurn(\n                    state.players,\n                    state.currentTurnPlayerId,\n                ),\n                selectedPosition: null,\n                selectedAIMove: null,\n            };\n        case actionTypes.SET_GAME_STATE:\n            return {\n                ...state,\n                gameState: action.newGameState,\n                prevGameState: state.gameState,\n            };\n        case actionTypes.SET_LATEST_HIGH_SCORE:\n            return {\n                ...state,\n                latestHighScore: action.highScore,\n            };\n        case actionTypes.SET_SELECTED_POSITION:\n            return {\n                ...state,\n                selectedPosition: action.newPosition,\n            };\n        case actionTypes.SET_SELECTED_AI_MOVE:\n            return {\n                ...state,\n                selectedAIMove: action.newMove,\n            };\n\n        default:\n            return state;\n    }\n};\n\nexport default game;\n\nfunction getNextTurn(players, currentPlayer) {\n    const currentTurnPlayerId = players.indexOf(currentPlayer);\n    const nextTurn = (currentTurnPlayerId + 1) % players.length;\n    return players[nextTurn];\n}\n","import { combineReducers } from 'redux';\nimport players from './players/reducer';\nimport map from './map/reducer';\nimport mainUI from './main-ui/reducer';\nimport game from './game/reducer';\n\nexport default combineReducers({\n    players,\n    map,\n    mainUI,\n    game,\n});\n","export const storeSavedPlayers = (playerOrder, players) => {\n    if (!window.localStorage) {\n        return;\n    }\n    const playersInfoToStore = {\n        // @ts-ignore\n        version: window.capac_racer_version,\n        playerOrder,\n        players,\n    };\n    try {\n        window.localStorage.setItem(\n            'players',\n            JSON.stringify(playersInfoToStore),\n        );\n    } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn(`Error trying to save localStorage`, e);\n    }\n};\n\nexport const getSavedPlayers = () => {\n    if (!window.localStorage) {\n        return null;\n    }\n    let result;\n    try {\n        result = window.localStorage.getItem('players');\n    } catch (e) {\n        return null;\n    }\n\n    if (!result) {\n        return null;\n    }\n\n    // At some point we may need to check if versions are compatible\n    return JSON.parse(result);\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction Logo({ variant }) {\n    return (\n        <div className={`logo logo-${variant}`}>\n            <div className=\"logo-up\">Capac</div>\n            <div className=\"logo-down\">Racer</div>\n        </div>\n    );\n}\n\nLogo.propTypes = {\n    variant: PropTypes.oneOf(['big', 'small']),\n};\n\nLogo.defaultProps = {\n    variant: 'big',\n};\n\nexport default Logo;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport {\n    CIRCUIT_SELECTION,\n    HIGH_SCORES,\n    CREDITS,\n    TUTORIAL,\n} from 'constants/screens';\nimport Logo from 'components/Logo';\n\nimport './style.css';\n\nconst MainMenu = ({ className }) => {\n    const dispatch = useDispatch();\n    return (\n        <div className={classNames('full-screen', className)}>\n            <div className=\"main-menu-content\">\n                <div className=\"transition-from-left\">\n                    <Logo />\n                </div>\n\n                <div className=\"main-menu-buttons transition-from-right\">\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() =>\n                            dispatch(changeScreen(CIRCUIT_SELECTION))\n                        }\n                    >\n                        Start new game\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(TUTORIAL))}\n                    >\n                        How to play\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(HIGH_SCORES))}\n                    >\n                        High scores\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(CREDITS))}\n                    >\n                        Credits\n                    </button>\n                </div>\n            </div>\n            <div className=\"app-version\">\n                v\n                {\n                    // @ts-ignore\n                    window.capac_racer_version\n                }\n            </div>\n        </div>\n    );\n};\n\nexport default MainMenu;\n","/**\n *\n * @param {Point} worldPosition\n * @param {number} gridSize\n * @param {number} mapZoom\n * @returns {Point}\n */\nexport const getScreenCoordinates = (worldPosition, gridSize, mapZoom) => {\n    const project = (n) => {\n        if (typeof n === 'number') {\n            return n * gridSize * mapZoom;\n        }\n        return n;\n    };\n\n    return {\n        x: project(worldPosition.x),\n        y: project(worldPosition.y),\n        dx: project(worldPosition.dx),\n        dy: project(worldPosition.dy),\n        baseX: project(worldPosition.baseX),\n        baseY: project(worldPosition.baseY),\n    };\n};\n","import { getScreenCoordinates } from 'utils/screenUtils';\n\n/**\n * Gets the current zoom on the map\n *\n * @param {RootState} state\n */\nexport const getZoom = (state) => state.map.zoom;\n\n/**\n * Gets the current grid size on the map\n *\n * @param {RootState} state\n */\nexport const getGridSize = (state) => state.map.gridSize;\n\n/**\n * @param {RootState} state\n * @param {Point} worldPosition\n */\nexport const projectToScreenPosition = (state, worldPosition) => {\n    if (!worldPosition) {\n        return worldPosition;\n    }\n    const mapZoom = state.map.zoom;\n    const mapGridSize = state.map.gridSize;\n    return getScreenCoordinates(worldPosition, mapGridSize, mapZoom);\n};\n","import { isEqual } from 'utils/vector2d';\n\nconst DISTANCE_TO_MOVE = 1;\n\n/**\n * @param {Player} player\n * @param {Player[]} otherPlayers\n * @returns {Point[]}\n */\nexport const getPossibleDestinations = (player, otherPlayers) => {\n    const positionAfterSpeed = {\n        x: player.position.x + player.speed.x,\n        y: player.position.y + player.speed.y,\n    };\n    const positions = [];\n    for (let i = -DISTANCE_TO_MOVE; i <= DISTANCE_TO_MOVE; i += 1) {\n        for (let j = -DISTANCE_TO_MOVE; j <= DISTANCE_TO_MOVE; j += 1) {\n            positions.push({\n                baseX: positionAfterSpeed.x,\n                baseY: positionAfterSpeed.y,\n                x: positionAfterSpeed.x + i,\n                y: positionAfterSpeed.y + j,\n                dx: i,\n                dy: j,\n            });\n        }\n    }\n    return positions.filter(\n        (position) => !isPositionColliding(position, otherPlayers),\n    );\n};\n\nfunction isPositionColliding(position, otherPlayers) {\n    return !!otherPlayers\n        .map((player) => player.position)\n        .find((otherPosition) => isEqual(otherPosition, position));\n}\n","import * as gameStates from 'constants/game-states';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { getPossibleDestinations } from 'store/players/selectors';\n\n/**\n * @param {RootState} state\n */\nexport const isGameStarted = (state) => {\n    return state.game.gameState !== gameStates.NOT_STARTED;\n};\n\n/**\n * @param {RootState} state\n */\nexport const isWaitingForPlayerInput = (state) => {\n    return state.game.gameState === gameStates.WAITING_FOR_PLAYER_INPUT;\n};\n\n/**\n * @param {RootState} state\n */\nexport const isAnimatingRandomSelection = (state) => {\n    return state.game.gameState === gameStates.ANIMATING_RANDOM_PLAYER_MOVEMENT;\n};\n\n/**\n * @param {RootState} state\n */\nexport const isAnimatingAISelection = (state) => {\n    return state.game.gameState === gameStates.AI_THINKING_SCREEN;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getAISelectedMove = (state) => {\n    return state.game.selectedAIMove;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getCurrentPlayer = (state) => {\n    if (!isGameStarted(state)) {\n        return null;\n    }\n    return state.players.byId[state.game.currentTurnPlayerId];\n};\n\n/**\n * @param {RootState} state\n */\nexport const getAllPlayers = (state) => {\n    return state.game.players.map((playerId) => state.players.byId[playerId]);\n};\n\n/**\n * @param {RootState} state\n * @param {string} playerId\n */\nexport const getOtherPlayers = (state, playerId) => {\n    return getAllPlayers(state).filter((player) => player.id !== playerId);\n};\n\n/**\n * @param {RootState} state\n * @param {string} playerId\n */\nexport const getOtherPlayersPositionInScreen = (state, playerId) => {\n    return getOtherPlayers(state, playerId)\n        .map((player) => player.position)\n        .map((position) => projectToScreenPosition(state, position));\n};\n\n/**\n * @param {RootState} state\n */\nexport const getGameState = (state) => {\n    return state.game.gameState;\n};\n\n/**\n * @param {RootState} state\n */\nexport const hasCurrentPlayerWon = (state) => {\n    const currentPlayer = getCurrentPlayer(state);\n    // eslint-disable-next-line no-restricted-syntax\n    for (const checkpointHasPassed of currentPlayer.checkpointsPassed) {\n        if (!checkpointHasPassed) {\n            return false;\n        }\n    }\n    return true;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getOrderedPlayers = (state) => {\n    const playerOrder = state.mainUI.selectedPlayerOrder;\n    const players = state.mainUI.selectedPlayers;\n    return playerOrder.map((playerId) =>\n        players.find((player) => player.id === playerId),\n    );\n};\n\n/**\n * @param {RootState} state\n * @param {Player} player\n */\nexport const getPossibleDestinationsForPlayerInScreen = (state, player) => {\n    const otherPlayers = getAllPlayers(state).filter(\n        (otherPlayer) => otherPlayer.id !== player.id,\n    );\n\n    return getPossibleDestinations(player, otherPlayers).map((eachPosition) => {\n        return {\n            screen: projectToScreenPosition(state, eachPosition),\n            position: eachPosition,\n        };\n    });\n};\n\n/**\n * @param {RootState} state\n * @param {Player} player\n */\nexport const getMovedPixelsSinceLastTurn = (state, player) => {\n    if (!player.prevPositions.length || player.prevPositions.length < 2) {\n        return null;\n    }\n    const lastPosition = player.prevPositions[player.prevPositions.length - 2];\n    const moved = {\n        x: lastPosition.x - player.position.x,\n        y: lastPosition.y - player.position.y,\n    };\n    return projectToScreenPosition(state, moved);\n};\n\n/**\n * @param {RootState} state\n * @param {Player} player\n */\nexport const getPivotForPlayerInScreen = (state, player) => {\n    const positionAfterSpeed = {\n        x: player.position.x + player.speed.x,\n        y: player.position.y + player.speed.y,\n    };\n    return projectToScreenPosition(state, positionAfterSpeed);\n};\n\n/**\n * @param {RootState} state\n */\nexport const getLatestHighScore = (state) => {\n    return state.game.latestHighScore;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getSelectedPosition = (state) => {\n    return state.game.selectedPosition;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getRaceHistory = (state) => {\n    return state.game.raceHistory;\n};\n\n/**\n *\n * @param {RootState} state\n */\nexport const getCircuitInfo = (state) => state.game.circuitInfo;\n","/**\n * @param {RootState} state\n */\nexport const getCurrentScreen = (state) => {\n    return state.mainUI.currentScreen;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getSelectedCircuit = (state) => {\n    return state.mainUI.selectedCircuit;\n};\n\n/**\n * @param {RootState} state\n */\nexport const shouldRandomizePlayerOrderOnStart = (state) => {\n    return state.mainUI.randomizePlayerOrderOnStart;\n};\n/**\n * @param {RootState} state\n */\nexport const shouldPlayWithTimer = (state) => {\n    return state.mainUI.playWithTimer;\n};\n","/** @type {Object.<string, CircuitConfig>} */\nexport const circuits = {\n    mouth: {\n        id: 'mouth',\n        name: 'Mouth',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit1/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit1/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp8.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp9.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 37,\n                y: 22,\n            },\n            {\n                x: 37,\n                y: 23,\n            },\n            {\n                x: 37,\n                y: 24,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: 0,\n        },\n    },\n    heart: {\n        id: 'heart',\n        name: 'Heart',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit2/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit2/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp7.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 37,\n                y: 28,\n            },\n            {\n                x: 36,\n                y: 27,\n            },\n            {\n                x: 35,\n                y: 26,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: -2,\n        },\n    },\n    rosco: {\n        id: 'rosco',\n        name: 'Rosco',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit3/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit3/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp8.png`,\n        ],\n        maxPlayers: 4,\n        startingPositions: [\n            {\n                x: 33,\n                y: 34,\n            },\n            {\n                x: 33,\n                y: 33,\n            },\n            {\n                x: 33,\n                y: 32,\n            },\n            {\n                x: 33,\n                y: 35,\n            },\n        ],\n        initialSpeed: {\n            x: -2,\n            y: 0,\n        },\n    },\n    horse: {\n        id: 'horse',\n        name: 'Horse',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit4/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit4/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp8.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp9.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp10.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp11.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp12.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp13.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp14.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp15.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp16.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp17.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp18.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp19.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 26,\n                y: 31,\n            },\n            {\n                x: 26,\n                y: 32,\n            },\n            {\n                x: 26,\n                y: 33,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: 0,\n        },\n    },\n};\n","export const loadImage = (url) => {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        const onLoad = () => {\n            resolve(img);\n        };\n        const onError = (error) => {\n            reject(error);\n        };\n        img.addEventListener('load', onLoad, { once: true });\n        img.addEventListener('error', onError, { once: true });\n        img.src = url;\n    });\n};\n","/**\n * Creates a pixel geter object that can access pixels of an image\n *\n * @param {HTMLImageElement} img\n * @returns {PixelGetter}\n */\nexport const createFromImage = (img) => {\n    const canvas = document.createElement('canvas');\n    const { width, height } = img;\n\n    canvas.width = width;\n    canvas.height = height;\n    canvas.getContext('2d').drawImage(img, 0, 0, width, height);\n\n    const rawData = canvas.getContext('2d').getImageData(0, 0, width, height)\n        .data;\n\n    return {\n        width,\n        height,\n        getPixel: (x, y) => {\n            const basePosition = 4 * (x + y * width);\n\n            return {\n                r: rawData[basePosition + 0],\n                g: rawData[basePosition + 1],\n                b: rawData[basePosition + 2],\n                a: rawData[basePosition + 3],\n            };\n        },\n    };\n};\n","export const hasContent = ({ r, g, b, a }) => {\n    if (a === 0) {\n        return false;\n    }\n    if (r === 255 && g === 255 && b === 255) {\n        return false;\n    }\n\n    return true;\n};\n","/* eslint-disable no-restricted-syntax */\nimport { loadImage } from 'utils/loadImage';\nimport { createFromImage as createPixelGetterFromImage } from 'utils/imgPixelGetter';\nimport {\n    distance,\n    add,\n    scale,\n    substract,\n    round,\n    isEqual,\n} from 'utils/vector2d';\nimport { range } from 'utils/range';\nimport { hasContent } from 'utils/pixel';\nimport { getScreenCoordinates } from 'utils/screenUtils';\n\n/**\n *\n * @param {CircuitConfig} config\n * @returns {Promise<Circuit>}\n */\nexport const createFromConfig = async (config) => {\n    const collisionImg = await loadImage(config.collisionImg);\n    const collisionPixelGetter = await createPixelGetterFromImage(collisionImg);\n    const loadedCheckpointImages = await Promise.all(\n        config.checkpoints.map((checkpointImg) => loadImage(checkpointImg)),\n    );\n    const checkpointPixelGetters = await Promise.all(\n        loadedCheckpointImages.map((checkpointImage) =>\n            createPixelGetterFromImage(checkpointImage),\n        ),\n    );\n    return {\n        ...config,\n        width: collisionImg.width,\n        height: collisionImg.height,\n        collisionPixelGetter,\n        checkpointPixelGetters,\n        centerOfCheckpoints: checkpointPixelGetters.map(getCenterOfCheckpoint),\n    };\n};\n\n/**\n *\n * @param {Line} line\n * @param {Circuit} circuit\n * @param {Point[]} otherPlayersPosition\n */\nexport const doesLineCollide = (line, circuit, otherPlayersPosition) => {\n    const pixelsToCheck = getPixelsToCheck(line).map(round);\n    if (\n        doesAnyPixelCollideInImage(pixelsToCheck, circuit.collisionPixelGetter)\n    ) {\n        return true;\n    }\n    for (const pixelToCheck of pixelsToCheck) {\n        // eslint-disable-next-line no-loop-func\n        const collidesWithOtherPlayer = otherPlayersPosition.find((position) =>\n            isEqual(position, pixelToCheck),\n        );\n        if (collidesWithOtherPlayer) {\n            return true;\n        }\n    }\n    return false;\n};\n\n/**\n * Checks if a player can move between two points. Will return false if it collides with the circuit or other players, true otherwise\n * @param {Object} params\n * @param {Point} params.from\n * @param {Point} params.to\n * @param {Circuit} params.circuit\n * @param {Player[]} params.otherPlayers\n * @param {number} params.zoom\n * @param {number} params.gridSize\n */\nexport const checkIfPlayerCanMove = ({\n    from,\n    to,\n    circuit,\n    otherPlayers,\n    zoom,\n    gridSize,\n}) => {\n    const movementLine = [\n        getScreenCoordinates(from, gridSize, zoom),\n        getScreenCoordinates(to, gridSize, zoom),\n    ];\n    const otherPlayersPosition = otherPlayers\n        .map((player) => player.position)\n        .map((position) => getScreenCoordinates(position, gridSize, zoom));\n\n    return !doesLineCollide(movementLine, circuit, otherPlayersPosition);\n};\n\n/**\n * Gets the checkpoints visited in a line of movement.\n *\n * @param {Line} line\n * @param {Circuit} circuit\n * @returns {number[]} The indexes of checkpoints that have been visited\n */\nexport const getCheckpointsVisitedInLine = (line, circuit) => {\n    const pixelsToCheck = getPixelsToCheck(line).map(round);\n    return circuit.checkpointPixelGetters\n        .map((checkpointPixelGetter) =>\n            doesAnyPixelCollideInImage(pixelsToCheck, checkpointPixelGetter),\n        )\n        .map((doesItCollide, index) => ({ doesItCollide, index }))\n        .filter(({ doesItCollide }) => !!doesItCollide)\n        .map(({ index }) => index);\n};\n\n/**\n *\n * @param {Object} params\n * @param {Point} params.from\n * @param {Point} params.to\n * @param {Circuit} params.circuit\n * @param {number} params.zoom\n * @param {number} params.gridSize\n * @returns {number[]} The indexes of checkpoints that have been visited\n */\nexport const getCheckpointsInMovement = ({\n    from,\n    to,\n    circuit,\n    zoom,\n    gridSize,\n}) => {\n    const movementLine = [\n        getScreenCoordinates(from, gridSize, zoom),\n        getScreenCoordinates(to, gridSize, zoom),\n    ];\n    return getCheckpointsVisitedInLine(movementLine, circuit);\n};\n\n/**\n * Gets the distance from a player to the next checkpoint\n * @param {Object} params\n * @param {Player} params.player\n * @param {Circuit} params.circuit\n * @param {number} params.gridSize\n * @param {number} params.zoom\n */\nexport const getDistanceToNextCheckpoint = ({\n    player,\n    circuit,\n    gridSize,\n    zoom,\n}) => {\n    for (let i = 0; i < player.checkpointsPassed.length; i += 1) {\n        if (!player.checkpointsPassed[i]) {\n            const playerPositionScreen = getScreenCoordinates(\n                player.position,\n                gridSize,\n                zoom,\n            );\n            return distance(\n                playerPositionScreen,\n                circuit.centerOfCheckpoints[i],\n            );\n        }\n    }\n    // All have been visited, so no distance\n    return 0;\n};\n\n/**\n * Gets the maximum distance between two consecutive checkpoints in a circuit\n * @param {Circuit} circuit\n */\nexport const getMaxCheckpointDistance = (circuit) => {\n    const checkpoints = circuit.centerOfCheckpoints;\n    const distances = checkpoints.map((cp, index) => {\n        return distance(cp, checkpoints[(index + 1) % checkpoints.length]);\n    });\n    return distances.reduce((acc, eachDistance) => {\n        return Math.max(acc, eachDistance);\n    }, 0);\n};\n\n/**\n * @param {Point[]} pixelsToCheck\n * @param {PixelGetter} imagePixelGetter\n */\nfunction doesAnyPixelCollideInImage(pixelsToCheck, imagePixelGetter) {\n    for (const pixelToCheck of pixelsToCheck) {\n        const pixelInCollisionMap = imagePixelGetter.getPixel(\n            pixelToCheck.x,\n            pixelToCheck.y,\n        );\n        if (hasContent(pixelInCollisionMap)) {\n            return true;\n        }\n    }\n    return false;\n}\n\n/**\n * @param {Line} line\n */\nfunction getPixelsToCheck([start, end]) {\n    const lineLength = distance(start, end);\n    const nPixelsToCheck = Math.ceil(lineLength * 2);\n    if (nPixelsToCheck < 2) {\n        return [];\n    }\n    const diffVector = substract(end, start);\n    const result = range(nPixelsToCheck).map((index) => {\n        const factor = index / (nPixelsToCheck - 1);\n        return add(start, scale(diffVector, factor));\n    });\n\n    return result;\n}\n\n/**\n * @param {PixelGetter} checkpoint\n * @returns {Point}\n */\nfunction getCenterOfCheckpoint(checkpoint) {\n    const pixelsToCheck = [];\n    for (let i = 0; i < checkpoint.width; i += 1) {\n        for (let j = 0; j < checkpoint.height; j += 1) {\n            if (hasContent(checkpoint.getPixel(i, j))) {\n                pixelsToCheck.push([i, j]);\n            }\n        }\n    }\n    if (!pixelsToCheck.length) {\n        return null;\n    }\n\n    const resultArray = pixelsToCheck.reduce(\n        (acc, pixel) => {\n            return [\n                acc[0] + pixel[0] / pixelsToCheck.length,\n                acc[1] + pixel[1] / pixelsToCheck.length,\n            ];\n        },\n        [0, 0],\n    );\n\n    return { x: resultArray[0], y: resultArray[1] };\n}\n","export const range = (size) => {\n    return [...Array(size).keys()];\n};\n","import Counter from 'utils/Counter';\nimport {\n    addToUpdate as addToGameLoopUpdate,\n    removeFromUpdate as removeFromGameLoopUpdate,\n} from 'utils/gameLoop';\n\nexport const timeout = (timeMs = 1000) => {\n    return new Promise((resolve) => {\n        const counter = new Counter({ timeToWait: timeMs });\n        const notifyPassOfTime = (time) => {\n            counter.notifyTimePassed(time);\n        };\n        addToGameLoopUpdate(notifyPassOfTime);\n        counter.restart({\n            callbackOnEnd: () => {\n                removeFromGameLoopUpdate(notifyPassOfTime);\n                counter.stop();\n                resolve();\n            },\n        });\n    });\n};\n","import { v4 } from 'uuid';\nimport { AI } from 'constants/player-types';\n\nconst LOCAL_STORAGE_ID = 'high-scores';\nconst MAX_SCORES_PER_CIRCUIT = 5;\n\nexport const getAll = () => {\n    try {\n        const all = JSON.parse(localStorage.getItem(LOCAL_STORAGE_ID));\n        return all || {};\n    } catch (e) {\n        return {};\n    }\n};\n\nexport const getByCircuitId = (circuitId) => {\n    const all = getAll();\n    return (all[circuitId] || []).map((score) => ({\n        ...score,\n        date: new Date(score.date),\n    }));\n};\n\nexport const shouldScoreBeAdded = (score, circuit, player) => {\n    if (player.type === AI) {\n        return false;\n    }\n    const circuitScores = getByCircuitId(circuit.id);\n    if (circuitScores.length < MAX_SCORES_PER_CIRCUIT) {\n        return true;\n    }\n    const lastScore = circuitScores[circuitScores.length - 1];\n    if (isBetterScore(score, lastScore)) {\n        return true;\n    }\n\n    return false;\n};\n\nexport const addScore = (score, circuit, player) => {\n    if (!shouldScoreBeAdded(score, circuit, player)) {\n        return null;\n    }\n    const circuitScores = getByCircuitId(circuit.id);\n    let insertBefore;\n    for (let i = 0; i < circuitScores.length; i += 1) {\n        if (isBetterScore(score, circuitScores[i])) {\n            insertBefore = i;\n            break;\n        }\n    }\n    const scoreToAdd = {\n        ...score,\n        id: v4(),\n    };\n    let newScores = circuitScores.slice();\n    if (typeof insertBefore === 'number') {\n        newScores.splice(insertBefore, 0, scoreToAdd);\n    } else {\n        newScores.push(scoreToAdd);\n    }\n    newScores = newScores.slice(0, MAX_SCORES_PER_CIRCUIT);\n    updateCircuitScores(circuit, newScores);\n    return scoreToAdd;\n};\n\nfunction isBetterScore(score, otherScore) {\n    if (score.turns > otherScore.turns) {\n        return false;\n    }\n    if (score.turns < otherScore.turns) {\n        return true;\n    }\n\n    // Same turns, choose the one with better real time:\n    return score.realTimeUsed < otherScore.realTimeUsed;\n}\n\nfunction updateCircuitScores(circuit, newScores) {\n    const all = getAll();\n    const newAll = {\n        ...all,\n        [circuit.id]: newScores,\n    };\n    try {\n        localStorage.setItem(\n            LOCAL_STORAGE_ID,\n            JSON.stringify(newAll, undefined, 2),\n        );\n    } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn('error saving high score', e);\n    }\n}\n","/** @type {AILevel[]} */\nconst levels = [\n    {\n        // level 0\n        randomSolutionChance: 20 / 100,\n        maxIterations: 50,\n        maxThinkingDepth: 5,\n        timeThinking: {\n            min: 2500,\n            max: 3500,\n        },\n    },\n    {\n        // level 1\n        randomSolutionChance: 15 / 100,\n        maxIterations: 200,\n        maxThinkingDepth: 10,\n        timeThinking: {\n            min: 1500,\n            max: 2500,\n        },\n    },\n    {\n        // level 2\n        randomSolutionChance: 7 / 100,\n        maxIterations: 700,\n        maxThinkingDepth: 30,\n        timeThinking: {\n            min: 700,\n            max: 2000,\n        },\n    },\n    {\n        // level 3\n        randomSolutionChance: 0,\n        maxIterations: 1500,\n        maxThinkingDepth: 99999,\n        timeThinking: {\n            min: 100,\n            max: 300,\n        },\n    },\n];\n\nexport default levels;\n","import { getPossibleDestinations } from 'store/players/selectors';\nimport {\n    checkIfPlayerCanMove,\n    getCheckpointsInMovement,\n    getDistanceToNextCheckpoint,\n    getMaxCheckpointDistance,\n} from 'utils/circuit';\nimport {\n    movePlayerTo,\n    addCheckpoints,\n    doesPlayerHaveRepeatedPositions,\n    getAverageSpeed,\n    getCheckpointsPassed,\n    hasPlayerFinishedRace,\n} from 'utils/player';\n\nexport default class PartialCircuitSolution {\n    constructor(playerInfo, currentIteration, circuit, mapZoom, mapGridSize) {\n        this.playerInfo = {\n            ...playerInfo,\n            prevPositions: playerInfo.prevPositions.slice(),\n            checkpointsPassed: playerInfo.checkpointsPassed.slice(),\n        };\n        this.currentIteration = currentIteration;\n        this.circuit = circuit;\n        this.mapZoom = mapZoom;\n        this.mapGridSize = mapGridSize;\n\n        this._updatePartialScore();\n    }\n\n    /**\n     * Returns an array of all possible solutions from this one\n     *\n     * @returns {PartialCircuitSolution[]}\n     */\n    expand(otherPlayers, maxDepthForSolutions) {\n        if (this.currentIteration >= maxDepthForSolutions) {\n            return [];\n        }\n        const otherPlayersToConsider =\n            this.currentIteration === 1 ? otherPlayers : [];\n\n        const canMoveThere = (position) =>\n            checkIfPlayerCanMove({\n                from: this.playerInfo.position,\n                to: position,\n                zoom: this.mapZoom,\n                gridSize: this.mapGridSize,\n                circuit: this.circuit,\n                otherPlayers: [],\n            });\n\n        const possiblePositions = getPossibleDestinations(\n            this.playerInfo,\n            otherPlayersToConsider,\n        ).filter((position) => canMoveThere(position));\n\n        const resultingPlayers = possiblePositions.map((position) => {\n            const visitedCheckpointsInTurn = getCheckpointsInMovement({\n                from: this.playerInfo.position,\n                to: position,\n                zoom: this.mapZoom,\n                gridSize: this.mapGridSize,\n                circuit: this.circuit,\n            });\n\n            const player = movePlayerTo(this.playerInfo, position, 0);\n            return addCheckpoints(player, visitedCheckpointsInTurn);\n        });\n\n        return resultingPlayers.map((player) => {\n            return new PartialCircuitSolution(\n                player,\n                this.currentIteration + 1,\n                this.circuit,\n                this.mapZoom,\n                this.mapGridSize,\n            );\n        });\n    }\n\n    updateScoreWithTotals({\n        maxAvgSpeed,\n        maxCheckpointsCoveredPerTurn,\n        maxCheckpointsCovered,\n    }) {\n        this.avgSpeedScore = (this.avgSpeed + 1) / (maxAvgSpeed + 1);\n        this.checkpointsCoveredPerTurnScore =\n            (this.checkpointsCoveredPerTurn + 1) /\n            (maxCheckpointsCoveredPerTurn + 1);\n        this.checkpointsCoveredScore =\n            (this.checkpointsCovered + 1) / (maxCheckpointsCovered + 1);\n\n        this.score =\n            this.avgSpeedScore * 0.1 +\n            this.checkpointsCoveredPerTurnScore * 0.3 +\n            this.checkpointsCoveredScore * 0.6;\n\n        this.summary = {\n            avgSpeedScore: this.avgSpeedScore.toFixed(2),\n            checkpointsCoveredPerTurnScore: this.checkpointsCoveredPerTurnScore.toFixed(\n                2,\n            ),\n            checkpointsCoveredScore: this.checkpointsCoveredScore.toFixed(2),\n        };\n    }\n\n    _updatePartialScore() {\n        if (!this.playerInfo.prevPositions.length) {\n            this.score = -1;\n            return;\n        }\n        if (doesPlayerHaveRepeatedPositions(this.playerInfo)) {\n            // we really don't want a path going to the same point again\n            this.score = -1000;\n            return;\n        }\n\n        this.avgSpeed = getAverageSpeed(this.playerInfo);\n        const checkpoints = getCheckpointsPassed(this.playerInfo);\n        const nextCheckpoint = 1 - this._getPercentageToNextCheckpoint();\n        this.checkpointsCovered = checkpoints + nextCheckpoint;\n        this.checkpointsCoveredPerTurn =\n            this.checkpointsCovered / this.getTurns();\n\n        this.score = 1; // temp until all scores are calculated\n    }\n\n    getScore() {\n        return this.score;\n    }\n\n    getFirstMove() {\n        const indexWithFirstPosition =\n            this.playerInfo.prevPositions.length - this.currentIteration + 1;\n        return this.playerInfo.prevPositions[indexWithFirstPosition];\n    }\n\n    getTurns() {\n        return this.playerInfo.prevPositions.length;\n    }\n\n    isFinished() {\n        return hasPlayerFinishedRace(this.playerInfo);\n    }\n\n    _getPercentageToNextCheckpoint() {\n        const distanceToNext = getDistanceToNextCheckpoint({\n            player: this.playerInfo,\n            zoom: this.mapZoom,\n            gridSize: this.mapGridSize,\n            circuit: this.circuit,\n        });\n        const maxCPDistance = getMaxCheckpointDistance(this.circuit);\n        return (distanceToNext + 1) / (maxCPDistance + 1);\n    }\n}\n","/* eslint-disable no-loop-func */\nimport { getPossibleDestinations } from 'store/players/selectors';\nimport { pickRandomFromArray } from 'utils/random';\nimport { checkIfPlayerCanMove } from 'utils/circuit';\nimport aiLevels from 'constants/ai-levels';\nimport PartialCircuitSolution from './PartialCircuitSolution';\nimport { waitForNextAnimationFrame } from './request-animation-frame';\n\n/**\n * @param {Player} player\n * @param {Player[]} otherPlayers\n * @param {Circuit} circuit\n * @param {number} zoom\n * @param {number} gridSize\n * @returns {Promise<Point>}\n */\nexport const chooseNextMovement = (\n    player,\n    otherPlayers,\n    circuit,\n    zoom,\n    gridSize,\n) => {\n    return new Promise((resolve) => {\n        if (shouldGetRandomSolution(player)) {\n            resolve(\n                returnRandomNonCrashingMove({\n                    player,\n                    otherPlayers,\n                    zoom,\n                    circuit,\n                    gridSize,\n                }),\n            );\n            return;\n        }\n\n        const solutionsGenerator = createSolutionsGenerator({\n            player,\n            otherPlayers,\n            circuit,\n            zoom,\n            gridSize,\n        });\n\n        (async () => {\n            // eslint-disable-next-line no-restricted-syntax\n            for await (const solution of solutionsGenerator) {\n                await waitForNextAnimationFrame();\n                if (solution.isFinished) {\n                    resolve(solution.move);\n                    break;\n                }\n            }\n        })();\n    });\n};\n\n/**\n * Generate numbers in the Fibonacci sequence.\n *\n * @generator\n * @function createSolutionsGenerator\n * @yields {AINextMoveSolution}\n */\nasync function* createSolutionsGenerator({\n    player,\n    otherPlayers,\n    circuit,\n    zoom,\n    gridSize,\n}) {\n    let openSolutions = [\n        new PartialCircuitSolution(player, 1, circuit, zoom, gridSize),\n    ];\n    /** @type {PartialCircuitSolution[]} */\n    let finishedSolutions = [];\n    let bestFinishedSolution = null;\n\n    const { maxIterations } = aiLevels[player.levelAI];\n    const { maxThinkingDepth } = aiLevels[player.levelAI];\n\n    let currentIteration = 1;\n    const yieldEvery = 50;\n\n    while (openSolutions.length && currentIteration <= maxIterations) {\n        currentIteration += 1;\n        const solutionToExpand = getMostPromisingSolution(openSolutions);\n        openSolutions = openSolutions.filter(\n            (solution) => solution !== solutionToExpand,\n        );\n        const newSolutions = solutionToExpand.expand(\n            otherPlayers,\n            maxThinkingDepth,\n        );\n        const newFinishedSolutions = newSolutions.filter((solution) =>\n            solution.isFinished(),\n        );\n\n        // eslint-disable-next-line no-restricted-syntax\n        for (const solution of newFinishedSolutions) {\n            if (\n                !bestFinishedSolution ||\n                solution.getTurns() < bestFinishedSolution.getTurns()\n            ) {\n                bestFinishedSolution = solution;\n            }\n        }\n        finishedSolutions = finishedSolutions.concat(newFinishedSolutions);\n        const newOpenSolutions = newSolutions\n            .filter((solution) => !solution.isFinished())\n            .filter((solution) => solution.getScore() >= 0)\n            .filter(\n                // removing solutions with more turns than already found ones\n                (solution) =>\n                    !bestFinishedSolution ||\n                    solution.getTurns() < bestFinishedSolution.getTurns(),\n            );\n\n        openSolutions = openSolutions.concat(newOpenSolutions);\n\n        const maxAvgSpeed = openSolutions.reduce(\n            (acc, solution) => Math.max(acc, solution.avgSpeed),\n            0,\n        );\n        const maxCheckpointsCoveredPerTurn = openSolutions.reduce(\n            (acc, solution) =>\n                Math.max(acc, solution.checkpointsCoveredPerTurn),\n            0,\n        );\n        const maxCheckpointsCovered = openSolutions.reduce(\n            (acc, solution) => Math.max(acc, solution.checkpointsCovered),\n            0,\n        );\n        openSolutions.forEach((solution) => {\n            solution.updateScoreWithTotals({\n                maxAvgSpeed,\n                maxCheckpointsCoveredPerTurn,\n                maxCheckpointsCovered,\n            });\n        });\n\n        if (currentIteration % yieldEvery === 0) {\n            yield {\n                isFinished: false,\n            };\n        }\n    }\n\n    /** @type {Point} */\n    let move;\n    if (bestFinishedSolution) {\n        move = bestFinishedSolution.getFirstMove();\n    } else if (openSolutions.length) {\n        move = getMostPromisingSolution(openSolutions).getFirstMove();\n    } else {\n        move = returnRandomMove(player, otherPlayers);\n    }\n    yield {\n        isFinished: true,\n        move,\n    };\n}\n\n/**\n * @param {Player} player\n */\nfunction shouldGetRandomSolution(player) {\n    const chance = aiLevels[player.levelAI].randomSolutionChance;\n    return Math.random() < chance;\n}\n\n/**\n * @param {Player} player\n * @param {Player[]} otherPlayers\n * @returns {Point}\n */\nfunction returnRandomMove(player, otherPlayers) {\n    const positions = getPossibleDestinations(player, otherPlayers);\n    return pickRandomFromArray(positions);\n}\n\nfunction returnRandomNonCrashingMove({\n    player,\n    otherPlayers,\n    zoom,\n    circuit,\n    gridSize,\n}) {\n    const canMoveThere = (position) =>\n        checkIfPlayerCanMove({\n            from: player.position,\n            to: position,\n            zoom,\n            gridSize,\n            circuit,\n            otherPlayers: [],\n        });\n\n    let possiblePositions = getPossibleDestinations(\n        player,\n        otherPlayers,\n    ).filter((position) => canMoveThere(position));\n\n    if (!possiblePositions.length) {\n        // If we don't have other option other than crashing\n        possiblePositions = getPossibleDestinations(player, otherPlayers);\n    }\n\n    return pickRandomFromArray(possiblePositions);\n}\n\n/**\n *\n * @param {PartialCircuitSolution[]} solutions\n */\nfunction getMostPromisingSolution(solutions) {\n    return solutions.reduce((best, solution) => {\n        if (solution.getScore() > best.getScore()) {\n            return solution;\n        }\n        return best;\n    }, solutions[0]);\n}\n","export const waitForNextAnimationFrame = () => {\n    return new Promise((resolve) => {\n        requestAnimationFrame(resolve);\n    });\n};\n","/* eslint-disable no-undef */\n// Based on https://stackoverflow.com/a/4819886/3493388\nfunction checkTouchDevice() {\n    const prefixes = ' -webkit- -moz- -o- -ms- '.split(' ');\n\n    const mq = (query) => {\n        return window.matchMedia(query).matches;\n    };\n\n    if (\n        'ontouchstart' in window ||\n        // @ts-ignore\n        (window.DocumentTouch && document instanceof DocumentTouch)\n    ) {\n        return true;\n    }\n\n    // include the 'heartz' as a way to have a non matching MQ to help terminate the join\n    // https://git.io/vznFH\n    const query = ['(', prefixes.join('touch-enabled),('), 'heartz', ')'].join(\n        '',\n    );\n    return mq(query);\n}\n\nexport const isTouchDevice = checkTouchDevice();\n","const log = process.env.NODE_ENV === 'development';\n\n/**\n * Tracks a google analytics event\n *\n * @param {string} action\n * @param {object} [params = {}]\n * @param {string} [params.category]\n * @param {string} [params.label]\n * @param {any} [params.value]\n */\nexport const track = (action, { category, label, value } = {}) => {\n    if (log) {\n        // eslint-disable-next-line no-console\n        console.log('track', action, category, label, value);\n    }\n    // @ts-ignore\n    if (!window.gtag) {\n        return;\n    }\n    if (process.env.NODE_ENV === 'development') {\n        return;\n    }\n    // @ts-ignore\n    window.gtag('event', action, {\n        event_category: category,\n        event_label: label,\n        value,\n    });\n};\n","import shuffle from 'lodash.shuffle';\nimport * as gameStates from 'constants/game-states';\nimport { circuits } from 'constants/circuits';\nimport {\n    setPlayers,\n    moveTo,\n    notifyCollision,\n    reduceGrounded,\n    notifyVisitedCheckpoints,\n} from 'store/players/actions';\nimport { changeScreen } from 'store/main-ui/actions';\nimport {\n    initGame,\n    setGameState,\n    advancePlayerTurn,\n    setLatestHighScore,\n    setSelectedPosition,\n    initReplay,\n    setSelectedAIMove,\n} from 'store/game/actions';\nimport {\n    getAllPlayers,\n    getCurrentPlayer,\n    hasCurrentPlayerWon,\n    getOtherPlayers,\n    getSelectedPosition,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport { GAME, MAIN_MENU, LOADING_GAME, REPLAY_GAME } from 'constants/screens';\nimport {\n    TIME_SHOWING_RANDOM_SELECTOR,\n    WAIT_AFTER_AI_GROUNDED,\n    WAIT_AFTER_AI_COLLISION,\n} from 'constants/ux';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport {\n    createFromConfig,\n    getCheckpointsVisitedInLine,\n    checkIfPlayerCanMove,\n} from 'utils/circuit';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { distance } from 'utils/vector2d';\nimport { getPossibleDestinations } from 'store/players/selectors';\nimport { pickRandomFromArray, getRandomInRange } from 'utils/random';\nimport { timeout } from 'utils/gameLoopTimeout';\nimport { shouldScoreBeAdded, addScore } from 'utils/highScoresStorage';\nimport { AI, HUMAN } from 'constants/player-types';\nimport { chooseNextMovement } from 'utils/ai';\nimport aiLevels from 'constants/ai-levels';\nimport { isTouchDevice } from 'utils/is-touch-device';\nimport { storeSavedPlayers } from 'utils/playersStorage';\nimport { track } from 'utils/analytics';\n\n/**\n * @param {Player} nextPlayer\n */\nconst notifyGrounded = (nextPlayer) => {\n    return (dispatch) => {\n        if (nextPlayer.type === HUMAN) {\n            dispatch(setGameState(gameStates.NOTIFY_GROUNDED));\n            return;\n        }\n        dispatch(setGameState(gameStates.NOTIFY_AI_GROUNDED));\n        setTimeout(() => {\n            dispatch(reduceGroundedAndNextTurn());\n        }, WAIT_AFTER_AI_GROUNDED);\n    };\n};\n\nexport const startTurn = () => {\n    return (dispatch, getState) => {\n        const nextPlayer = getCurrentPlayer(getState());\n        if (nextPlayer.turnsGrounded) {\n            dispatch(notifyGrounded(nextPlayer));\n            return;\n        }\n\n        if (nextPlayer.type === AI) {\n            dispatch(handleAITurn(nextPlayer));\n            return;\n        }\n\n        if (getState().mainUI.playWithTimer) {\n            dispatch(setGameState(gameStates.PLAYER_TURN_START_SCREEN));\n        } else {\n            dispatch(startWaitingForPlayerInput());\n        }\n    };\n};\n\nexport const nextTurn = () => {\n    return (dispatch) => {\n        dispatch(advancePlayerTurn());\n        dispatch(startTurn());\n    };\n};\n\nexport const reduceGroundedAndNextTurn = () => {\n    return (dispatch, getState) => {\n        const currentPlayer = getCurrentPlayer(getState());\n        dispatch(reduceGrounded(currentPlayer.id));\n        dispatch(nextTurn());\n    };\n};\n\n/**\n * Inits the game with a certain config\n *\n * @param {Object} config\n * @param {Player[]} config.players\n * @param {string[]} config.playerOrder\n * @param {CircuitConfig} config.circuit\n * @returns {(dispatch: any, getState: any) => void}\n */\nexport const initGameWithConfig = ({ players, playerOrder, circuit }) => {\n    return (dispatch, getState) => {\n        dispatch(changeScreen(LOADING_GAME));\n        const playersWithMapPosition = initMapPositionForPlayers({\n            players,\n            playerOrder,\n            circuit,\n        }).map(fixPlayersWithoutName);\n\n        dispatch(setPlayers(playersWithMapPosition));\n\n        track('init_game', { category: 'game', label: circuit?.id });\n        track('total_players', {\n            category: 'game',\n            value: players.length,\n            label: circuit?.id,\n        });\n        track('human_players', {\n            category: 'game',\n            value: players.filter((player) => player.type === HUMAN).length,\n            label: circuit?.id,\n        });\n        track('ai_players', {\n            category: 'game',\n            value: players.filter((player) => player.type === AI).length,\n            label: circuit?.id,\n        });\n\n        // if we don't want timer, set infinite time\n        if (!getState().mainUI.playWithTimer) {\n            waitingForPlayerCounter.setTimeToWait(-1);\n        }\n\n        createFromConfig(circuit).then((circuitInfo) => {\n            dispatch(initGame(playerOrder, circuitInfo));\n            dispatch(changeScreen(GAME));\n        });\n    };\n};\n\nexport const initGameWithSavedConfig = () => {\n    return (dispatch, getState) => {\n        /** @type {RootState} */\n        const state = getState();\n        const { randomizePlayerOrderOnStart } = state.mainUI;\n        const playerOrder = randomizePlayerOrderOnStart\n            ? shuffle(state.mainUI.selectedPlayerOrder)\n            : state.mainUI.selectedPlayerOrder;\n\n        storeSavedPlayers(\n            state.mainUI.selectedPlayerOrder,\n            state.mainUI.selectedPlayers,\n        );\n\n        dispatch(\n            initGameWithConfig({\n                players: state.mainUI.selectedPlayers,\n                playerOrder,\n                circuit: circuits[state.mainUI.selectedCircuit],\n            }),\n        );\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n * @param {number} timePassed\n */\nexport const handlePlayerCollision = (\n    player,\n    newIntendedPosition,\n    timePassed,\n) => {\n    return (dispatch) => {\n        const speed = distance(player.position, newIntendedPosition);\n        track('collision', {\n            category: 'game',\n            label: player?.type === AI ? 'ai' : 'human',\n            value: speed,\n        });\n        dispatch(notifyCollision(player.id, speed, timePassed));\n        if (player.type === AI) {\n            dispatch(setGameState(gameStates.NOTIFY_AI_COLLISION));\n            setTimeout(() => {\n                dispatch(nextTurn());\n            }, WAIT_AFTER_AI_COLLISION);\n            return;\n        }\n        dispatch(setGameState(gameStates.NOTIFY_COLLISION));\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n * @param {number} timePassed\n * @param {Line} movementLine\n * @param {Circuit} circuit\n */\nexport const handleCorrectMovement = (\n    player,\n    newIntendedPosition,\n    timePassed,\n    movementLine,\n    circuit,\n) => {\n    return (dispatch, getState) => {\n        dispatch(detectAndStoreCheckpoints(movementLine, circuit));\n        const hasPlayerWon = hasCurrentPlayerWon(getState());\n        dispatch(moveTo(player.id, newIntendedPosition, timePassed));\n        if (hasPlayerWon) {\n            dispatch(handleVictory(getCurrentPlayer(getState()), circuit));\n            return;\n        }\n        dispatch(nextTurn());\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Circuit} circuit\n */\nfunction handleVictory(player, circuit) {\n    return (dispatch) => {\n        track('victory', { category: 'game' });\n        const score = {\n            name: player.name,\n            date: new Date(),\n            turns: player.turnsSpent,\n            realTimeUsed: player.realTimeUsed,\n            maxSpeed: player.maxSpeed,\n            crashes: player.crashes,\n            path: player.prevPositions,\n            playerStyle: player.style,\n        };\n\n        if (shouldScoreBeAdded(score, circuit, player)) {\n            const newScore = addScore(score, circuit, player);\n            track('high_score', {\n                category: 'game',\n                label: circuit?.id,\n                value: newScore?.turns,\n            });\n            dispatch(setLatestHighScore(newScore));\n            dispatch(setGameState(gameStates.NOTIFY_HIGH_SCORE));\n        } else {\n            dispatch(setGameState(gameStates.NOTIFY_VICTORY));\n        }\n    };\n}\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n */\nconst handlePlayerMovement = (player, newIntendedPosition) => {\n    return (dispatch, getState) => {\n        const timePassed = waitingForPlayerCounter.getTimePassed();\n        waitingForPlayerCounter.stop();\n        const state = getState();\n        const circuit = getCircuitInfo(state);\n        const mapZoom = state.map.zoom;\n        const mapGridSize = state.map.gridSize;\n        const canMoveThere = checkIfPlayerCanMove({\n            from: player.position,\n            to: newIntendedPosition,\n            zoom: mapZoom,\n            gridSize: mapGridSize,\n            circuit,\n            otherPlayers: getOtherPlayers(state, player.id),\n        });\n\n        if (!canMoveThere) {\n            dispatch(\n                handlePlayerCollision(player, newIntendedPosition, timePassed),\n            );\n            return;\n        }\n\n        const movementLine = [\n            projectToScreenPosition(state, player.position),\n            projectToScreenPosition(state, newIntendedPosition),\n        ];\n\n        dispatch(\n            handleCorrectMovement(\n                player,\n                newIntendedPosition,\n                timePassed,\n                movementLine,\n                circuit,\n            ),\n        );\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n */\nexport const handlePlayerPositionSelection = (player, newIntendedPosition) => {\n    return (dispatch) => {\n        if (isTouchDevice) {\n            dispatch(setSelectedPosition(newIntendedPosition));\n            return;\n        }\n        dispatch(handlePlayerMovement(player, newIntendedPosition));\n    };\n};\n\n/**\n * @param {Player} player\n */\nexport const confirmPositionSelection = (player) => {\n    return (dispatch, getState) => {\n        const selectedPosition = getSelectedPosition(getState());\n        dispatch(handlePlayerMovement(player, selectedPosition));\n    };\n};\n\nexport const startWaitingForPlayerInput = () => {\n    return (dispatch, getState) => {\n        dispatch(setGameState(gameStates.WAITING_FOR_PLAYER_INPUT));\n        let callbackOnEnd = () => {};\n\n        if (getState().mainUI.playWithTimer) {\n            callbackOnEnd = () => {\n                const selectedPosition = getSelectedPosition(getState());\n                if (selectedPosition) {\n                    // If a position was already selected we choose that one\n                    const player = getCurrentPlayer(getState());\n                    dispatch(handlePlayerMovement(player, selectedPosition));\n                    return;\n                }\n                dispatch(showRandomSelectorAndMovePlayer());\n            };\n        }\n\n        waitingForPlayerCounter.restart({ callbackOnEnd });\n    };\n};\n\n/**\n * @param {Player} player\n */\nexport const handleAITurn = (player) => {\n    return async (dispatch, getState) => {\n        dispatch(setGameState(gameStates.AI_THINKING_SCREEN));\n        const state = getState();\n        const circuit = getCircuitInfo(state);\n        const otherPlayers = getAllPlayers(getState()).filter(\n            (otherPlayer) => otherPlayer.id !== player.id,\n        );\n        const mapZoom = state.map.zoom;\n        const mapGridSize = state.map.gridSize;\n        const nextMovementPromise = chooseNextMovement(\n            player,\n            otherPlayers,\n            circuit,\n            mapZoom,\n            mapGridSize,\n        );\n\n        const minTimeToWaitForPlayer = getMinTimeToWaitForPlayer(player);\n        // eslint-disable-next-line no-unused-vars\n        const result = await Promise.all([\n            timeout(minTimeToWaitForPlayer),\n            nextMovementPromise,\n        ]);\n        const nextMovement = result[1];\n        dispatch(setSelectedAIMove(nextMovement));\n        await timeout(1000);\n        dispatch(handlePlayerMovement(player, nextMovement));\n    };\n};\n\n/**\n * @param {Player} player\n */\nfunction getMinTimeToWaitForPlayer(player) {\n    const { timeThinking } = aiLevels[player.levelAI];\n    return getRandomInRange(timeThinking.min, timeThinking.max);\n}\n\nfunction showRandomSelectorAndMovePlayer() {\n    return (dispatch, getState) => {\n        dispatch(setGameState(gameStates.ANIMATING_RANDOM_PLAYER_MOVEMENT));\n        timeout(TIME_SHOWING_RANDOM_SELECTOR).then(() => {\n            const player = getCurrentPlayer(getState());\n            const otherPlayers = getAllPlayers(getState()).filter(\n                (otherPlayer) => otherPlayer.id !== player.id,\n            );\n            const positions = getPossibleDestinations(player, otherPlayers);\n            const nextPosition = pickRandomFromArray(positions);\n            dispatch(handlePlayerMovement(player, nextPosition));\n        });\n    };\n}\n\n/**\n * @param {Line} movementLine\n * @param {Circuit} circuit\n */\nexport const detectAndStoreCheckpoints = (movementLine, circuit) => {\n    return (dispatch, getState) => {\n        const visitedCheckpointsInTurn = getCheckpointsVisitedInLine(\n            movementLine,\n            circuit,\n        );\n        if (!visitedCheckpointsInTurn.length) {\n            return;\n        }\n        const currentPlayer = getCurrentPlayer(getState());\n        dispatch(\n            notifyVisitedCheckpoints(\n                currentPlayer.id,\n                visitedCheckpointsInTurn,\n            ),\n        );\n    };\n};\n\nexport const finishGame = () => {\n    return (dispatch) => {\n        track('finish_game', { category: 'game' });\n        dispatch(changeScreen(MAIN_MENU));\n        waitingForPlayerCounter.reset();\n    };\n};\n\n/**\n * @param {Object} params\n * @param {Player[]} params.players\n * @param {string[]} params.playerOrder\n * @param {CircuitConfig} params.circuit\n */\nfunction initMapPositionForPlayers({ players, playerOrder, circuit }) {\n    const orderedPlayers = playerOrder.map((playerId) =>\n        players.find((player) => player.id === playerId),\n    );\n\n    return orderedPlayers.map((player, index) => {\n        const initialPosition = circuit.startingPositions[index];\n        return {\n            ...player,\n            position: { ...initialPosition },\n            prevPositions: [{ ...initialPosition }],\n            speed: { ...circuit.initialSpeed },\n            checkpointsPassed: circuit.checkpoints.map(() => false),\n        };\n    });\n}\n\nexport const pause = () => {\n    return (dispatch) => {\n        dispatch(setGameState(gameStates.SHOW_MENU));\n        waitingForPlayerCounter.pause();\n    };\n};\n\nexport const unpause = () => {\n    return (dispatch, getState) => {\n        const lastState = getState().game.prevGameState;\n        dispatch(setGameState(lastState));\n        waitingForPlayerCounter.unpause();\n    };\n};\n\nexport const tryToToggleInGameMenu = () => {\n    return (dispatch, getState) => {\n        const { gameState } = getState().game;\n        switch (gameState) {\n            case gameStates.SHOW_MENU:\n                dispatch(unpause());\n                break;\n            case gameStates.WAITING_FOR_PLAYER_INPUT:\n                dispatch(pause());\n                break;\n            default:\n        }\n    };\n};\n\nexport const tryToShowInGameMenu = () => {\n    return (dispatch, getState) => {\n        const { gameState } = getState().game;\n        switch (gameState) {\n            case gameStates.WAITING_FOR_PLAYER_INPUT:\n                dispatch(pause());\n                break;\n            default:\n        }\n    };\n};\n\n/**\n * @param {Player} player\n * @param {number} index\n */\nfunction fixPlayersWithoutName(player, index) {\n    if (player.name) {\n        return player;\n    }\n    return {\n        ...player,\n        name: getNameForPlayerWithoutName(index),\n    };\n}\n\n/**\n * @param {number} index\n */\nfunction getNameForPlayerWithoutName(index) {\n    switch (index) {\n        case 0:\n            return 'Anonymous';\n        case 1:\n            return 'Mistery racer';\n        case 2:\n            return 'Shy runner';\n        case 3:\n            return 'Jane Doe';\n        default:\n            return 'John Doe';\n    }\n}\n\n/**\n * @param {*} score\n * @param {Circuit} circuit\n */\nexport const showReplay = (score, circuit) => {\n    return (dispatch) => {\n        track('show_replay', { category: 'replay' });\n        createFromConfig(circuit).then((circuitInfo) => {\n            dispatch(initReplay(score, circuitInfo));\n            dispatch(changeScreen(REPLAY_GAME));\n        });\n    };\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nclass CounterDisplay extends React.Component {\n    state = {\n        timeLeft: 0,\n    };\n\n    /** @type {number} */\n    requestRef = null;\n\n    componentDidMount() {\n        this.animate();\n    }\n\n    componentWillUnmount() {\n        if (this.requestRef) {\n            cancelAnimationFrame(this.requestRef);\n        }\n    }\n\n    animate = () => {\n        this.setState({\n            timeLeft: this.props.counterObject.getTimeLeft(),\n        });\n        this.requestRef = requestAnimationFrame(this.animate);\n    };\n\n    render() {\n        return (\n            <div className=\"counter-display\">\n                <div className=\"counter-display-text\">Time left:</div>\n                <div className=\"counter-display-number\">\n                    {(this.state.timeLeft / 1000).toFixed(3)}\n                </div>\n            </div>\n        );\n    }\n}\n\nCounterDisplay.propTypes = {\n    counterObject: PropTypes.shape({\n        getTimeLeft: PropTypes.func,\n    }).isRequired,\n};\n\nexport default CounterDisplay;\n","import PropTypes from 'prop-types';\n\nexport const playerStyle = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n    dotColor: PropTypes.string,\n    dotSize: PropTypes.number,\n    round: PropTypes.string,\n    trailColor: PropTypes.string,\n    trailDotsSize: PropTypes.number,\n    trailWidth: PropTypes.number,\n    icon: PropTypes.string,\n});\n\nexport const vector2d = PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n});\n\nexport const selectablePlayer = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n});\n\nexport const player = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n    position: vector2d.isRequired,\n    speed: vector2d.isRequired,\n    prevPositions: PropTypes.arrayOf(vector2d),\n});\n\nexport const raceHistory = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n    path: PropTypes.arrayOf(vector2d),\n});\n\nexport const Score = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n    turns: PropTypes.number,\n    time: PropTypes.number,\n});\n\nexport const Circuit = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n});\n\nexport const Move = PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n    dx: PropTypes.number,\n    yy: PropTypes.number,\n    baseX: PropTypes.number,\n    baseY: PropTypes.number,\n});\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactResizeDetector from 'react-resize-detector';\nimport classNames from 'classnames';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    player as playerProp,\n    Circuit as circuitProp,\n    vector2d as vector2dProp,\n} from 'components/propTypes';\nimport { connect } from 'react-redux';\nimport {\n    substract,\n    add,\n    isInsideViewport,\n    getClosestPointInsideViewport,\n} from 'utils/vector2d';\nimport { getCircuitInfo, getCurrentPlayer } from 'store/game/selectors';\nimport './style.css';\n\nconst PADDING_FOR_VIEWPORT = { x: 120, y: 100 };\n\n/**\n * @typedef {object} GameBoardCameraHandlerProps\n * @property {Player} currentPlayer\n * @property {*} children\n * @property {Circuit} circuitInfo\n * @property {Point} playerScreenPosition\n */\n\nclass GameBoardCameraHandler extends React.Component {\n    state = {\n        /** @type {Point} */\n        cameraPosition: { x: 0, y: 0 },\n        /** @type {{width: number, height: number}} */\n        boardSize: null,\n        isDragging: false,\n        /** @type {Point} */\n        dragStart: null,\n    };\n\n    /**\n     * @type {GameBoardCameraHandlerProps}\n     */\n    props;\n\n    componentDidMount() {\n        this.moveCurrentPlayerIntoView();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.currentPlayer !== prevProps.currentPlayer) {\n            this.moveCurrentPlayerIntoView();\n        }\n    }\n\n    moveCurrentPlayerIntoView = () => {\n        if (\n            !this.state.boardSize ||\n            !this.props.currentPlayer ||\n            !this.props.currentPlayer.position\n        ) {\n            return;\n        }\n        const viewport = {\n            topLeft: substract({ x: 0, y: 0 }, this.state.cameraPosition),\n            size: this.state.boardSize,\n        };\n        if (\n            isInsideViewport(\n                this.props.playerScreenPosition,\n                viewport,\n                PADDING_FOR_VIEWPORT,\n            )\n        ) {\n            return;\n        }\n        const closestPointInViewport = getClosestPointInsideViewport(\n            this.props.playerScreenPosition,\n            viewport,\n            PADDING_FOR_VIEWPORT,\n        );\n        const newCameraMovement = substract(\n            closestPointInViewport,\n            this.props.playerScreenPosition,\n        );\n\n        const oldCameraPosition = this.state.cameraPosition;\n\n        // TODO find a way of not doing state changes on prop update\n        // eslint-disable-next-line react/no-did-update-set-state\n        this.setState({\n            cameraPosition: add(oldCameraPosition, newCameraMovement),\n        });\n    };\n\n    handlePointerDown = (event) => {\n        const coordinates = getCoordinatesFromPointerEvent(event);\n        this.setState({\n            isDragging: true,\n            dragStart: coordinates,\n        });\n    };\n\n    handlePointerUp = () => {\n        this.setState({\n            isDragging: false,\n            dragStart: null,\n        });\n    };\n\n    handlePointerMove = (event) => {\n        if (!this.state.isDragging || !this.state.dragStart) {\n            return;\n        }\n        const cursorPosition = getCoordinatesFromPointerEvent(event);\n        const movement = substract(cursorPosition, this.state.dragStart);\n        const oldCameraPosition = this.state.cameraPosition;\n\n        this.setState({\n            dragStart: cursorPosition,\n            cameraPosition: add(oldCameraPosition, movement),\n        });\n    };\n\n    render() {\n        return (\n            <div className=\"game-board\">\n                <ReactResizeDetector\n                    handleHeight\n                    handleWidth\n                    onResize={(width, height) => {\n                        this.setState(\n                            {\n                                boardSize: { width, height },\n                            },\n                            this.moveCurrentPlayerIntoView,\n                        );\n                    }}\n                >\n                    <div\n                        className={classNames('game-board-content', {\n                            'is-dragging': this.state.isDragging,\n                        })}\n                        style={{\n                            width: this.props.circuitInfo.width,\n                            height: this.props.circuitInfo.height,\n                            transform: `translate(${this.state.cameraPosition.x}px, ${this.state.cameraPosition.y}px)`,\n                        }}\n                        onMouseDown={this.handlePointerDown}\n                        onMouseUp={this.handlePointerUp}\n                        onMouseMove={this.handlePointerMove}\n                        onTouchStart={this.handlePointerDown}\n                        onTouchEnd={this.handlePointerUp}\n                        onTouchMove={this.handlePointerMove}\n                        onTouchCancel={this.handlePointerUp}\n                    >\n                        {this.props.children}\n                    </div>\n                </ReactResizeDetector>\n            </div>\n        );\n    }\n}\n\nGameBoardCameraHandler.propTypes = {\n    currentPlayer: playerProp,\n    children: PropTypes.node,\n    circuitInfo: circuitProp,\n    playerScreenPosition: vector2dProp,\n};\n\nGameBoardCameraHandler.defaultProps = {\n    currentPlayer: null,\n    children: <></>,\n    circuitInfo: null,\n    playerScreenPosition: null,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n    const currentPlayer = getCurrentPlayer(state);\n    return {\n        ...ownProps,\n        circuitInfo: getCircuitInfo(state),\n        playerScreenPosition: projectToScreenPosition(\n            state,\n            currentPlayer?.position,\n        ),\n        currentPlayer,\n    };\n};\n\nexport default connect(mapStateToProps)(GameBoardCameraHandler);\n\nfunction getCoordinatesFromPointerEvent(event) {\n    let eventToUse = event;\n\n    if (event.type === 'touchstart' || event.type === 'touchmove') {\n        // eslint-disable-next-line prefer-destructuring\n        eventToUse = event.touches[0];\n    }\n    return {\n        x: eventToUse.clientX,\n        y: eventToUse.clientY,\n    };\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport gridImg from './grid.png';\nimport './style.css';\n\nconst GRID_IMAGE_SIZE = 60; // px\n\nconst Grid = ({ zoom, cellSize }) => {\n    const GRID_IMG_DENSITY = GRID_IMAGE_SIZE / cellSize;\n    const backgroundSize = (zoom * GRID_IMAGE_SIZE) / GRID_IMG_DENSITY;\n    return (\n        <div\n            className=\"grid\"\n            style={{\n                backgroundImage: `url(${gridImg})`,\n                backgroundSize: `${backgroundSize}px ${backgroundSize}px`,\n            }}\n        />\n    );\n};\n\nGrid.propTypes = {\n    zoom: PropTypes.number.isRequired,\n    cellSize: PropTypes.number.isRequired,\n};\n\nGrid.defaultProps = {};\n\nexport default Grid;\n","import React from 'react';\nimport { playerStyle as playerStyleProp } from 'components/propTypes';\nimport './style.css';\n\nfunction PlayerIcon({ playerStyle }) {\n    return (\n        <div\n            className=\"player-icon\"\n            style={{\n                backgroundImage: `url(${playerStyle.icon})`,\n            }}\n        />\n    );\n}\n\nPlayerIcon.propTypes = {\n    playerStyle: playerStyleProp.isRequired,\n};\n\nexport default PlayerIcon;\n","import { doesLineCollide } from 'utils/circuit';\n\n/**\n *\n * @param {any} player\n * @returns {React.CSSProperties}\n */\nexport const getPlayerStyleCSS = (player) => {\n    if (!player) {\n        return {};\n    }\n    // TODO this function can receive raceHistory or player. Player should be am attribute of raceHistory to avoid having this two different input types\n    const style = player.style || player.playerStyle || {};\n\n    return {\n        // @ts-ignore\n        '--player-color': style.dotColor,\n        '--player-border-radius': style.round,\n        '--player-trail-border-radius': style.round,\n        '--player-size': `${style.dotSize + 2}px`,\n        '--movement-picker-size': `${style.dotSize - 1}px`,\n        '--movement-picker-size-center': `${style.dotSize + 2}px`,\n        '--player-trail-color': style.dotColor,\n        '--player-trail-size': `${style.dotSize}px`,\n    };\n};\n\nexport const getColorForTempLine = (\n    player,\n    points,\n    circuit,\n    otherPlayersPosition,\n) => {\n    if (doesLineCollide(points, circuit, otherPlayersPosition)) {\n        return 'red';\n    }\n    return player.style.trailColor;\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport PlayerIcon from 'components/PlayerIcon';\nimport { getPlayerStyleCSS } from 'utils/playerPainter';\nimport './style.css';\n\nconst Player = ({ player, isActive }) => {\n    const playerScreenPosition = useSelector((state) =>\n        // @ts-ignore\n        projectToScreenPosition(state, player.position),\n    );\n    return (\n        <div\n            className={classNames('player', {\n                'is-active': isActive,\n            })}\n            style={{\n                ...getPlayerStyleCSS(player),\n                left: playerScreenPosition.x,\n                top: playerScreenPosition.y,\n            }}\n        >\n            <PlayerIcon playerStyle={player.style} />\n\n            {isActive && <div className=\"player-active-indicator\" />}\n        </div>\n    );\n};\n\nPlayer.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default Player;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { motion } from 'framer-motion';\nimport { player as playerProp } from 'components/propTypes';\n\nfunction PossibleDestinations(props) {\n    return (\n        <>\n            {props.possiblePositions.map((eachPosition, index) => (\n                // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n                <motion.div\n                    key={`${props.player.id}_${eachPosition.position.x}_${eachPosition.position.y}`}\n                    className={classNames('movement-picker', {\n                        'movement-picker-center':\n                            !eachPosition.screen.dx && !eachPosition.screen.dy,\n                    })}\n                    style={{\n                        left: eachPosition.screen.baseX,\n                        top: eachPosition.screen.baseY,\n                    }}\n                    animate={{\n                        x: eachPosition.screen.dx,\n                        y: eachPosition.screen.dy,\n                    }}\n                    initial={{\n                        x: 0,\n                        y: 0,\n                    }}\n                    transition={{\n                        ease: 'easeInOut',\n                        duration: 0.3,\n                        delay: 0.2 + index * 0.1,\n                    }}\n                    onClick={() =>\n                        props.onPositionSelected(eachPosition.position)\n                    }\n                    onMouseEnter={() =>\n                        props.onPositionHover(eachPosition.screen)\n                    }\n                    onMouseLeave={props.onPositionHoverEnd}\n                />\n            ))}\n        </>\n    );\n}\n\nPossibleDestinations.propTypes = {\n    onPositionSelected: PropTypes.func.isRequired,\n    onPositionHover: PropTypes.func.isRequired,\n    onPositionHoverEnd: PropTypes.func.isRequired,\n    player: playerProp.isRequired,\n    possiblePositions: PropTypes.arrayOf(PropTypes.any).isRequired,\n};\nPossibleDestinations.defaultProps = {};\n\nexport default PossibleDestinations;\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { PathLine } from 'react-svg-pathline';\nimport { motion } from 'framer-motion';\nimport {\n    player as playerProp,\n    vector2d as vector2dProp,\n    Circuit as circuitProp,\n} from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    getOtherPlayersPositionInScreen,\n    getPossibleDestinationsForPlayerInScreen,\n    getSelectedPosition,\n    getMovedPixelsSinceLastTurn,\n    getPivotForPlayerInScreen,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport { doesLineCollide } from 'utils/circuit';\nimport { getColorForTempLine, getPlayerStyleCSS } from 'utils/playerPainter';\nimport { isTouchDevice } from 'utils/is-touch-device';\nimport PossibleDestinations from './PossibleDestinations';\n\nimport './style.css';\n\nclass MovementPicker extends React.Component {\n    state = {\n        tempLine: null,\n    };\n\n    render() {\n        const selectButtonPosition = getSelectButtonPosition(\n            this.props.possiblePositions,\n        );\n\n        const lineToPaint =\n            this.state.tempLine || this.props.selectedPositionScreen;\n\n        const wouldCollide =\n            lineToPaint &&\n            doesLineCollide(\n                [this.props.originalPlayerScreenPosition, lineToPaint],\n                this.props.circuit,\n                this.props.otherPlayersPosition,\n            );\n        return (\n            <motion.div\n                className=\"movement-picker-container\"\n                animate={{\n                    x: 0,\n                    y: 0,\n                }}\n                initial={{\n                    x: this.props.lastMovement.x,\n                    y: this.props.lastMovement.y,\n                }}\n                transition={{ ease: 'easeIn', duration: 0.3 }}\n                style={{\n                    ...getPlayerStyleCSS(this.props.player),\n                }}\n            >\n                <PossibleDestinations\n                    onPositionSelected={this.props.onPositionSelected}\n                    onPositionHover={(screenPosition) =>\n                        this.setState({ tempLine: screenPosition })\n                    }\n                    onPositionHoverEnd={() => this.setState({ tempLine: null })}\n                    player={this.props.player}\n                    possiblePositions={this.props.possiblePositions}\n                />\n                {isTouchDevice && this.props.selectedPosition && (\n                    // eslint-disable-next-line react/button-has-type\n                    <button\n                        className=\"button button-bg movement-picker-select-button\"\n                        style={{\n                            left: selectButtonPosition.x,\n                            top: selectButtonPosition.y,\n                        }}\n                        onClick={this.props.onConfirmSelection}\n                    >\n                        Select\n                    </button>\n                )}\n                {lineToPaint && (\n                    <svg className=\"movement-picker-temp-line\">\n                        <PathLine\n                            points={[\n                                this.props.originalPlayerScreenPosition,\n                                lineToPaint,\n                            ]}\n                            // @ts-ignore\n                            stroke={getColorForTempLine(\n                                this.props.player,\n                                [\n                                    this.props.originalPlayerScreenPosition,\n                                    lineToPaint,\n                                ],\n                                this.props.circuit,\n                                this.props.otherPlayersPosition,\n                            )}\n                            strokeWidth={this.props.player.style.trailWidth}\n                            strokeDasharray=\"2\"\n                            fill=\"none\"\n                            r={2}\n                        />\n                    </svg>\n                )}\n                <svg className=\"movement-picker-ghost-line\">\n                    <PathLine\n                        points={[\n                            this.props.originalPlayerScreenPosition,\n                            this.props.nextPivot,\n                        ]}\n                        // @ts-ignore\n                        stroke={this.props.player.style.trailColor}\n                        strokeWidth={this.props.player.style.trailWidth}\n                        strokeDasharray=\"1\"\n                        fill=\"none\"\n                        r={2}\n                    />\n                </svg>\n\n                {lineToPaint && wouldCollide && (\n                    <div\n                        className=\"movement-picker-crash\"\n                        style={{\n                            left: lineToPaint.x,\n                            top: lineToPaint.y,\n                        }}\n                    />\n                )}\n            </motion.div>\n        );\n    }\n}\n\nMovementPicker.propTypes = {\n    player: playerProp.isRequired,\n    onPositionSelected: PropTypes.func.isRequired,\n    onConfirmSelection: PropTypes.func.isRequired,\n    lastMovement: vector2dProp,\n    circuit: circuitProp.isRequired,\n    originalPlayerScreenPosition: circuitProp.isRequired,\n    possiblePositions: PropTypes.arrayOf(vector2dProp).isRequired,\n    nextPivot: vector2dProp.isRequired,\n    otherPlayersPosition: PropTypes.arrayOf(vector2dProp),\n    selectedPosition: vector2dProp,\n    selectedPositionScreen: vector2dProp,\n};\n\nMovementPicker.defaultProps = {\n    lastMovement: {\n        x: 0,\n        y: 0,\n    },\n    otherPlayersPosition: [],\n    selectedPosition: null,\n    selectedPositionScreen: null,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n    const selectedPosition = getSelectedPosition(state);\n    return {\n        ...ownProps,\n        lastMovement: getMovedPixelsSinceLastTurn(state, ownProps.player) || {\n            x: 0,\n            y: 0,\n        },\n        circuit: getCircuitInfo(state),\n        originalPlayerScreenPosition: projectToScreenPosition(\n            state,\n            ownProps.player.position,\n        ),\n        possiblePositions: getPossibleDestinationsForPlayerInScreen(\n            state,\n            ownProps.player,\n        ),\n        nextPivot: getPivotForPlayerInScreen(state, ownProps.player),\n        otherPlayersPosition: getOtherPlayersPositionInScreen(\n            state,\n            ownProps.player.id,\n        ),\n        selectedPosition,\n        selectedPositionScreen: projectToScreenPosition(\n            state,\n            selectedPosition,\n        ),\n    };\n};\n\nexport default connect(mapStateToProps)(MovementPicker);\n\n/**\n * Gets the position to put the button to select (only used for touch devices)\n * Will get the highest y and the mean x\n *\n * @param {Array} possiblePlayerPositions\n * @returns {Point}\n */\nfunction getSelectButtonPosition(possiblePlayerPositions) {\n    if (!possiblePlayerPositions || !possiblePlayerPositions.length) {\n        return { x: 0, y: 0 };\n    }\n    const maxY = possiblePlayerPositions.reduce((acc, position) => {\n        return Math.max(acc, position.screen.y);\n    }, Number.MIN_VALUE);\n\n    const totalX = possiblePlayerPositions.reduce((acc, position) => {\n        return position.screen.x + acc;\n    }, 0);\n\n    return {\n        x: totalX / possiblePlayerPositions.length,\n        y: maxY,\n    };\n}\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { PathLine } from 'react-svg-pathline';\nimport { player as playerProp, Move } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    getOtherPlayersPositionInScreen,\n    getPossibleDestinationsForPlayerInScreen,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport { getPlayerStyleCSS, getColorForTempLine } from 'utils/playerPainter';\nimport { pickRandomFromArray } from 'utils/random';\nimport { SWITCH_RANDOM_SELECTION_EVERY } from 'constants/ux.js';\nimport './style.css';\n\nfunction RandomSelectionAnimation({\n    player,\n    children,\n    switchRandomEvery,\n    highlightMove,\n}) {\n    const [tempLine, setTempLine] = useState(null);\n    const [highlightedPosition, setHighlightedPosition] = useState(null);\n\n    useEffect(() => {\n        setTempLine(null);\n        return () => setTempLine(null);\n    }, [player]);\n\n    const circuit = useSelector(getCircuitInfo);\n    const originalPlayerScreenPosition = useSelector((state) =>\n        projectToScreenPosition(state, player.position),\n    );\n    const possiblePositions = useSelector((state) =>\n        getPossibleDestinationsForPlayerInScreen(state, player),\n    );\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const randomPosition = pickRandomFromArray(possiblePositions);\n            setHighlightedPosition(randomPosition);\n            setTempLine(randomPosition.screen);\n        }, switchRandomEvery);\n        return () => {\n            clearInterval(interval);\n        };\n    }, [player, possiblePositions, switchRandomEvery]);\n    const otherPlayersPosition = useSelector((state) =>\n        getOtherPlayersPositionInScreen(state, player.id),\n    );\n    const moveToHighlight = useSelector((state) =>\n        projectToScreenPosition(state, highlightMove),\n    );\n\n    return (\n        <div style={getPlayerStyleCSS(player)}>\n            {children && (\n                <div\n                    className=\"random-selection-animation-warning\"\n                    style={{\n                        top: originalPlayerScreenPosition.y,\n                        left: originalPlayerScreenPosition.x,\n                    }}\n                >\n                    {children}\n                </div>\n            )}\n            {possiblePositions.map((eachPosition) => {\n                const key = getKey(player, eachPosition);\n                return (\n                    <div\n                        key={key}\n                        className={classNames('random-selection-animation', {\n                            'is-highlighted':\n                                !moveToHighlight &&\n                                highlightedPosition &&\n                                getKey(player, highlightedPosition) === key,\n                        })}\n                        style={{\n                            left: eachPosition.screen.x,\n                            top: eachPosition.screen.y,\n                        }}\n                    />\n                );\n            })}\n\n            {moveToHighlight && (\n                <div\n                    className=\"random-selection-animation-highlighted-move\"\n                    style={{\n                        left: moveToHighlight.x,\n                        top: moveToHighlight.y,\n                    }}\n                />\n            )}\n\n            {!moveToHighlight && tempLine && (\n                <svg className=\"random-selection-animation-temp-line\">\n                    <PathLine\n                        points={[originalPlayerScreenPosition, tempLine]}\n                        stroke={getColorForTempLine(\n                            player,\n                            [originalPlayerScreenPosition, tempLine],\n                            circuit,\n                            otherPlayersPosition,\n                        )}\n                        strokeWidth={player.style.trailWidth}\n                        strokeDasharray=\"2\"\n                        fill=\"none\"\n                        r={2}\n                    />\n                </svg>\n            )}\n        </div>\n    );\n}\n\nfunction getKey(player, position) {\n    return `${player.id}_${position.position.x}_${position.position.y}`;\n}\n\nRandomSelectionAnimation.propTypes = {\n    player: playerProp.isRequired,\n    children: PropTypes.node,\n    switchRandomEvery: PropTypes.number,\n    highlightMove: Move,\n};\n\nRandomSelectionAnimation.defaultProps = {\n    children: null,\n    switchRandomEvery: SWITCH_RANDOM_SELECTION_EVERY,\n    highlightMove: null,\n};\n\nexport default RandomSelectionAnimation;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { PathLine } from 'react-svg-pathline';\nimport { getPlayerStyleCSS } from 'utils/playerPainter';\nimport './style.css';\n\nconst PlayerTrail = ({ player, isActive }) => {\n    const storeState = useSelector((state) => state);\n    if (!player.prevPositions.length) {\n        return <></>;\n    }\n    const points = player.prevPositions.map((position) =>\n        // @ts-ignore\n        projectToScreenPosition(storeState, position),\n    );\n    const pointsWithoutLast = points.slice(0, points.length - 1);\n    return (\n        <div\n            className={classNames('player-trail-container', {\n                'is-active': isActive,\n            })}\n            style={getPlayerStyleCSS(player)}\n        >\n            <svg className=\"player-trail\">\n                <PathLine\n                    points={points}\n                    // @ts-ignore\n                    stroke={player.style.trailColor}\n                    strokeWidth={player.style.trailWidth}\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n            {pointsWithoutLast\n                .map((point, index) => {\n                    return { ...point, turn: index + 1 };\n                })\n                .map((point) => (\n                    <div\n                        key={`${player.id}_${point.x}_${point.y}_${point.turn}`}\n                        className=\"player-trail-point\"\n                        style={{\n                            left: point.x,\n                            top: point.y,\n                        }}\n                    />\n                ))}\n        </div>\n    );\n};\n\nPlayerTrail.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default PlayerTrail;\n","import React from 'react';\nimport Grid from 'components/Grid';\nimport Player from 'components/Player';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n    handlePlayerPositionSelection,\n    confirmPositionSelection,\n} from 'store/game/async-actions';\nimport {\n    getCurrentPlayer,\n    getAllPlayers,\n    isWaitingForPlayerInput,\n    isAnimatingRandomSelection,\n    isAnimatingAISelection,\n    getAISelectedMove,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport MovementPicker from 'components/MovementPicker';\nimport RandomSelectionAnimation from 'components/RandomSelectionAnimation';\nimport PlayerTrail from 'components/PlayerTrail';\nimport { getZoom, getGridSize } from 'store/map/selectors';\nimport './style.css';\n\nconst GameBoardContents = () => {\n    const dispatch = useDispatch();\n    const players = useSelector(getAllPlayers);\n    const currentPlayer = useSelector(getCurrentPlayer);\n    const mapZoom = useSelector(getZoom);\n    const gridSize = useSelector(getGridSize);\n    const circuitInfo = useSelector(getCircuitInfo);\n    const waitingForPlayerInput = useSelector(isWaitingForPlayerInput);\n    const animatingRandomSelection = useSelector(isAnimatingRandomSelection);\n    const animatingAISelection = useSelector(isAnimatingAISelection);\n    const AIMove = useSelector(getAISelectedMove);\n\n    return (\n        <>\n            <div\n                className=\"game-board-circuit-bg\"\n                style={{\n                    backgroundImage: `url(${circuitInfo.bgImg})`,\n                    backgroundSize: `${circuitInfo.width}px ${circuitInfo.height}px`,\n                }}\n            />\n            <Grid zoom={mapZoom} cellSize={gridSize} />\n            {players.map((player) => (\n                <div key={player.id}>\n                    <Player\n                        player={player}\n                        isActive={player === currentPlayer}\n                    />\n                    <PlayerTrail\n                        player={player}\n                        isActive={player === currentPlayer}\n                    />\n                </div>\n            ))}\n            {currentPlayer && waitingForPlayerInput && (\n                <>\n                    <MovementPicker\n                        key={currentPlayer?.id}\n                        player={currentPlayer}\n                        onPositionSelected={(position) =>\n                            dispatch(\n                                handlePlayerPositionSelection(\n                                    currentPlayer,\n                                    position,\n                                ),\n                            )\n                        }\n                        onConfirmSelection={() => {\n                            dispatch(confirmPositionSelection(currentPlayer));\n                        }}\n                    />\n                </>\n            )}\n            {currentPlayer && animatingRandomSelection && (\n                <>\n                    <RandomSelectionAnimation player={currentPlayer}>\n                        Too late!\n                        <br /> Choosing a random move for you...\n                    </RandomSelectionAnimation>\n                </>\n            )}\n            {currentPlayer && animatingAISelection && (\n                <>\n                    <RandomSelectionAnimation\n                        player={currentPlayer}\n                        switchRandomEvery={getRandomSpeedForAI(currentPlayer)}\n                        highlightMove={AIMove}\n                    />\n                </>\n            )}\n        </>\n    );\n};\n\nfunction getRandomSpeedForAI(player) {\n    switch (player.levelAI) {\n        case 0:\n            return 800;\n        case 1:\n            return 400;\n        case 2:\n            return 200;\n        case 3:\n            return 100;\n        default:\n            return 75;\n    }\n}\n\nGameBoardContents.propTypes = {};\n\nGameBoardContents.defaultProps = {};\n\nexport default GameBoardContents;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport {\n    getCurrentPlayer,\n    isWaitingForPlayerInput,\n} from 'store/game/selectors';\nimport { shouldPlayWithTimer } from 'store/main-ui/selectors';\nimport { pause } from 'store/game/async-actions';\nimport CounterDisplay from 'components/CounterDisplay';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport { HUMAN } from 'constants/player-types';\nimport GameBoardCameraHandler from './GameBoardCameraHandler';\nimport GameBoardContents from './GameBoardContents';\nimport './style.css';\n\nconst GameBoard = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    const waitingForPlayerInput = useSelector(isWaitingForPlayerInput);\n    const playWithTimer = useSelector(shouldPlayWithTimer);\n    const shouldShowPauseButton =\n        !currentPlayer || currentPlayer.type === HUMAN;\n\n    return (\n        <div className=\"game-board-container\">\n            <GameBoardCameraHandler>\n                <GameBoardContents />\n            </GameBoardCameraHandler>\n            {waitingForPlayerInput && playWithTimer && (\n                <CounterDisplay counterObject={waitingForPlayerCounter} />\n            )}\n            {shouldShowPauseButton && (\n                <div className=\"pause-button-container\">\n                    <button\n                        type=\"button\"\n                        className=\"button button-small\"\n                        onClick={() => dispatch(pause())}\n                    >\n                        Pause\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n};\n\nGameBoard.propTypes = {};\n\nGameBoard.defaultProps = {};\n\nexport default GameBoard;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { player as playerProp } from 'components/propTypes';\nimport PlayerIcon from 'components/PlayerIcon';\n\nconst PlayerListItem = ({ player, isActive }) => {\n    return (\n        <li\n            className={classNames('player-list-item', {\n                'is-active': isActive,\n            })}\n        >\n            <div className=\"player-list-item-decorator-container\">\n                <div className=\"player-list-item-decorator\" />\n                <PlayerIcon playerStyle={player.style} />\n            </div>\n            <div>{player.name}</div>\n        </li>\n    );\n};\n\nPlayerListItem.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default PlayerListItem;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer, getAllPlayers } from 'store/game/selectors';\nimport PlayerListItem from './PlayerListItem';\nimport './style.css';\n\nconst PlayerList = () => {\n    const players = useSelector((state) => getAllPlayers(state));\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        <ul className=\"player-list\">\n            {players.map((player) => (\n                <PlayerListItem\n                    key={player.id}\n                    player={player}\n                    isActive={player === currentPlayer}\n                />\n            ))}\n        </ul>\n    );\n};\n\nexport default PlayerList;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { startTurn } from 'store/game/async-actions';\n\nconst StartGameModal = () => {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(startTurn())}\n        >\n            <div className=\"game-screen-modal-content\">\n                Everybody ready?\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Start game!\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default StartGameModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport { startWaitingForPlayerInput } from 'store/game/async-actions';\n\nconst StartTurnModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(startWaitingForPlayerInput())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>,\n                    it is your turn\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Start my turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default StartTurnModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport pluralize from 'pluralize';\nimport { nextTurn } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyCollisionModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal\" onClick={() => dispatch(nextTurn())}>\n            <div className=\"game-screen-modal-content\">\n                <div>You crashed!</div>\n                <div className=\"secondary-text mt-s\">\n                    (grounded for {currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)})\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Next turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyCollisionModal;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass ShowContentAfter extends React.Component {\n    /** @type {number} */\n    timeout;\n\n    state = {\n        showContent: false,\n    };\n\n    componentDidMount() {\n        this.timeout = window.setTimeout(\n            () => this.setState({ showContent: true }),\n            this.props.showAfter,\n        );\n    }\n\n    componentWillUnmount() {\n        if (this.timeout) {\n            window.clearTimeout(this.timeout);\n            this.timeout = null;\n        }\n    }\n\n    render() {\n        return <>{this.props.render(this.state.showContent)}</>;\n    }\n}\n\nShowContentAfter.propTypes = {\n    showAfter: PropTypes.number,\n    render: PropTypes.func,\n};\n\nShowContentAfter.defaultProps = {\n    showAfter: 100, // ms\n    render: () => {},\n};\n\nexport default ShowContentAfter;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport ShowContentAfter from 'components/ShowContentAfter';\n\nconst NotifyAICollisionModal = () => {\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <ShowContentAfter\n            render={(showContent) => (\n                <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n                    <div\n                        className={classNames('game-screen-modal-content', {\n                            'is-hidden': !showContent,\n                        })}\n                    >\n                        <div>\n                            <span className=\"player-name\">\n                                {currentPlayer.name}\n                            </span>{' '}\n                            has crashed :(\n                        </div>\n                    </div>\n                </div>\n            )}\n        />\n    );\n};\n\nexport default NotifyAICollisionModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { reduceGroundedAndNextTurn } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport pluralize from 'pluralize';\n\nconst NotifyGroundedModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(reduceGroundedAndNextTurn())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>,\n                    you are grounded because you crashed!\n                </div>\n                <div className=\"secondary-text mt-s\">\n                    ({currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)} left)\n                </div>\n\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Next turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyGroundedModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport pluralize from 'pluralize';\nimport ShowContentAfter from 'components/ShowContentAfter';\n\nconst NotifyAIGroundedModal = () => {\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <ShowContentAfter\n            render={(showContent) => (\n                <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n                    <div\n                        className={classNames('game-screen-modal-content', {\n                            'is-hidden': !showContent,\n                        })}\n                    >\n                        <div>\n                            <span className=\"player-name\">\n                                {currentPlayer.name}\n                            </span>{' '}\n                            is grounded after a crash.\n                        </div>\n                        <div className=\"secondary-text\">\n                            ({currentPlayer.turnsGrounded}{' '}\n                            {pluralize('turn', currentPlayer.turnsGrounded)}{' '}\n                            left)\n                        </div>\n                    </div>\n                </div>\n            )}\n        />\n    );\n};\n\nexport default NotifyAIGroundedModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { finishGame } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyVictoryModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(finishGame())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    won!\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Yay!\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyVictoryModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { unpause, finishGame } from 'store/game/async-actions';\n\nconst InGameMenuModal = () => {\n    const dispatch = useDispatch();\n\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal\" onClick={() => dispatch(unpause())}>\n            <div className=\"game-screen-modal-content\">\n                <div>Paused</div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Continue!\n                </button>\n\n                <button\n                    className=\"button game-screen-modal-button game-screen-modal-button-secondary \"\n                    type=\"button\"\n                    onClick={(event) => {\n                        event.stopPropagation();\n                        dispatch(finishGame());\n                    }}\n                >\n                    Exit game\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default InGameMenuModal;\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { Score, Circuit } from 'components/propTypes';\nimport { useDispatch } from 'react-redux';\nimport { showReplay } from 'store/game/async-actions';\nimport './style.css';\n\nfunction ScoreBoard({ scores, highlightedScore, canReplay, circuit }) {\n    const dispatch = useDispatch();\n\n    const onScoreClicked = (score) => {\n        if (!canReplay) {\n            return;\n        }\n        dispatch(showReplay(score, circuit));\n    };\n    return (\n        <div className=\"score-board\">\n            {!!scores.length &&\n                scores.map((score, index) => (\n                    // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n                    <div\n                        onClick={() => onScoreClicked(score)}\n                        className={classNames('score-board-item', {\n                            'is-highlighted':\n                                highlightedScore &&\n                                highlightedScore.id === score.id,\n                            'is-clickable': canReplay,\n                        })}\n                        key={`score-board-item-${score.id}`}\n                    >\n                        <div className=\"score-board-item-index\">\n                            {index + 1}\n                        </div>\n                        <div className=\"score-board-item-name\">\n                            {score.name}\n                        </div>\n                        <div className=\"score-board-item-turns\">\n                            <span className=\"score-board-item-value\">\n                                {score.turns}\n                            </span>\n                            <span className=\"score-board-item-text\">\n                                {' '}\n                                turns\n                            </span>\n                        </div>\n                        <div className=\"score-board-item-turns\">\n                            <span className=\"score-board-item-value\">\n                                {score.date?.toLocaleDateString()}\n                            </span>\n                        </div>\n\n                        <div className=\"score-board-item-time\">\n                            (\n                            <span className=\"score-board-item-value\">\n                                {(score.realTimeUsed / 1000).toFixed(2)}{' '}\n                            </span>\n                            <span className=\"score-board-item-text\">\n                                seconds\n                            </span>\n                            )\n                        </div>\n                    </div>\n                ))}\n\n            {!scores.length && (\n                <div className=\"score-board-empty\">No high scores yet!</div>\n            )}\n        </div>\n    );\n}\n\nScoreBoard.propTypes = {\n    scores: PropTypes.arrayOf(Score).isRequired,\n    highlightedScore: Score,\n    canReplay: PropTypes.bool,\n    circuit: Circuit.isRequired,\n};\n\nScoreBoard.defaultProps = {\n    highlightedScore: null,\n    canReplay: false,\n};\n\nexport default ScoreBoard;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { finishGame } from 'store/game/async-actions';\nimport {\n    getCurrentPlayer,\n    getLatestHighScore,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport ScoreBoard from 'components/ScoreBoard';\nimport { getByCircuitId } from 'utils/highScoresStorage';\n\nconst NotifyHighScoreModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    const highScore = useSelector(getLatestHighScore);\n    const circuit = useSelector(getCircuitInfo);\n    const highScoresForCircuit = getByCircuitId(circuit.id);\n\n    return (\n        <div className=\"game-screen-modal\">\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    won, and set a high score for this circuit!\n                </div>\n                <div className=\"notify-high-scores-circuit\">\n                    <ScoreBoard\n                        circuit={circuit}\n                        scores={highScoresForCircuit}\n                        highlightedScore={highScore}\n                    />\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                    onClick={() => dispatch(finishGame())}\n                >\n                    Back to main menu\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyHighScoreModal;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport ShowContentAfter from 'components/ShowContentAfter';\n\nconst AIThinkingModal = () => {\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <ShowContentAfter\n            showAfter={1000}\n            render={(showContent) => (\n                <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n                    <div\n                        className={classNames('game-screen-modal-content', {\n                            'is-hidden': !showContent,\n                        })}\n                    >\n                        <div>\n                            <span className=\"player-name\">\n                                {currentPlayer.name}\n                            </span>{' '}\n                            is choosing its next move...\n                        </div>\n                    </div>\n                </div>\n            )}\n        />\n    );\n};\n\nexport default AIThinkingModal;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport * as gameStates from 'constants/game-states';\nimport { getGameState } from 'store/game/selectors';\nimport StartGameModal from './StartGameModal';\nimport StartTurnModal from './StartTurnModal';\nimport NotifyCollisionModal from './NotifyCollisionModal';\nimport NotifyAICollisionModal from './NotifyAICollisionModal';\nimport NotifyGroundedModal from './NotifyGroundedModal';\nimport NotifyAIGroundedModal from './NotifyAIGroundedModal';\nimport NotifyVictoryModal from './NotifyVictoryModal';\nimport InGameMenuModal from './InGameMenuModal';\nimport NotifyHighScoreModal from './NotifyHighScoreModal';\nimport AIThinkingModal from './AIThinkingModal';\nimport './style.css';\n\nconst GameScreenModals = () => {\n    const gameState = useSelector(getGameState);\n\n    switch (gameState) {\n        case gameStates.START_SCREEN:\n            return <StartGameModal />;\n        case gameStates.PLAYER_TURN_START_SCREEN:\n            return <StartTurnModal />;\n        case gameStates.NOTIFY_COLLISION:\n            return <NotifyCollisionModal />;\n        case gameStates.NOTIFY_AI_COLLISION:\n            return <NotifyAICollisionModal />;\n        case gameStates.NOTIFY_GROUNDED:\n            return <NotifyGroundedModal />;\n        case gameStates.NOTIFY_AI_GROUNDED:\n            return <NotifyAIGroundedModal />;\n        case gameStates.NOTIFY_VICTORY:\n            return <NotifyVictoryModal />;\n        case gameStates.NOTIFY_HIGH_SCORE:\n            return <NotifyHighScoreModal />;\n        case gameStates.SHOW_MENU:\n            return <InGameMenuModal />;\n        case gameStates.AI_THINKING_SCREEN:\n            return <AIThinkingModal />;\n        default:\n            return <></>;\n    }\n};\n\nGameScreenModals.propTypes = {};\n\nGameScreenModals.defaultProps = {};\n\nexport default GameScreenModals;\n","import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\nfunction KeyPressListener({ keys }) {\n    useEffect(() => {\n        const onKeyPress = (event) => {\n            if (keys[event.code]) {\n                keys[event.code]();\n            }\n        };\n        window.document.addEventListener('keyup', onKeyPress);\n\n        return () => {\n            window.document.removeEventListener('keyup', onKeyPress);\n        };\n    }, [keys]);\n    return <></>;\n}\n\nKeyPressListener.propTypes = {\n    keys: PropTypes.objectOf(PropTypes.func).isRequired,\n};\n\nexport default KeyPressListener;\n","import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n// Set the name of the hidden property and the change event for visibility\nlet hidden;\nlet visibilityChange;\nif (typeof document.hidden !== 'undefined') {\n    // Opera 12.10 and Firefox 18 and later support\n    hidden = 'hidden';\n    visibilityChange = 'visibilitychange';\n    // @ts-ignore\n} else if (typeof document.msHidden !== 'undefined') {\n    hidden = 'msHidden';\n    visibilityChange = 'msvisibilitychange';\n    // @ts-ignore\n} else if (typeof document.webkitHidden !== 'undefined') {\n    hidden = 'webkitHidden';\n    visibilityChange = 'webkitvisibilitychange';\n}\n\nfunction WindowBlurListener({ onBlur }) {\n    useEffect(() => {\n        // Warn if the browser doesn't support addEventListener or the Page Visibility API\n        if (\n            typeof document.addEventListener === 'undefined' ||\n            hidden === undefined\n        ) {\n            return () => {}; // not supported\n        }\n\n        const handleVisibilityChange = () => {\n            if (document[hidden]) {\n                onBlur();\n            }\n        };\n        document.addEventListener(\n            visibilityChange,\n            handleVisibilityChange,\n            false,\n        );\n        return () => {\n            document.removeEventListener(\n                visibilityChange,\n                handleVisibilityChange,\n                false,\n            );\n        };\n    }, [onBlur]);\n    return <></>;\n}\n\nWindowBlurListener.propTypes = {\n    onBlur: PropTypes.func.isRequired,\n};\n\nexport default WindowBlurListener;\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport GameBoard from 'components/GameBoard';\nimport PlayerList from 'components/PlayerList';\nimport GameScreenModals from 'components/GameScreenModals';\nimport KeyPressListener from 'components/KeyPressListener';\nimport WindowBlurListener from 'components/WindowBlurListener';\nimport {\n    tryToToggleInGameMenu,\n    tryToShowInGameMenu,\n} from 'store/game/async-actions';\n\nimport './style.css';\n\nconst Game = () => {\n    const dispatch = useDispatch();\n    return (\n        <div className=\"transition-opacity\">\n            <KeyPressListener\n                keys={{\n                    Escape: () => dispatch(tryToToggleInGameMenu()),\n                    Space: () => dispatch(tryToToggleInGameMenu()),\n                }}\n            />\n            <WindowBlurListener\n                onBlur={() => dispatch(tryToShowInGameMenu())}\n            />\n            <GameBoard />\n            <PlayerList />\n            <GameScreenModals />\n        </div>\n    );\n};\n\nexport default Game;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction CircuitSelector({ circuit, onClick }) {\n    return (\n        <div className=\"circuit-selector\" onClick={onClick}>\n            <img\n                className=\"circuit-selector-img\"\n                src={circuit.bgImg}\n                alt={circuit.name}\n            />\n            <div className=\"circuit-selector-footer\">\n                <div className=\"circuit-selector-name\">{circuit.name}</div>\n                <div className=\"circuit-selector-players\">\n                    {circuit.maxPlayers} players\n                </div>\n            </div>\n        </div>\n    );\n}\n\nCircuitSelector.propTypes = {\n    circuit: PropTypes.shape({\n        name: PropTypes.string,\n        bgImg: PropTypes.string,\n        maxPlayers: PropTypes.number,\n    }).isRequired,\n    onClick: PropTypes.func.isRequired,\n};\n\nexport default CircuitSelector;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen, setSelectedCircuit } from 'store/main-ui/actions';\nimport { MAIN_MENU, PLAYERS_SELECTION } from 'constants/screens';\nimport { circuits } from 'constants/circuits';\nimport CircuitSelector from 'components/CircuitSelector';\nimport Logo from 'components/Logo';\nimport './style.css';\n\nconst circuitsArray = Object.values(circuits);\n\nfunction CircuitSelection({ className }) {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer circuit-selection',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-top\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Select circuit</h1>\n            </div>\n            <div className=\"menu-content circuit-selection-content transition-from-bottom\">\n                <div className=\"circuit-selection-list\">\n                    {circuitsArray.map((circuit) => (\n                        <CircuitSelector\n                            key={circuit.id}\n                            onClick={() => {\n                                dispatch(setSelectedCircuit(circuit.id));\n                                dispatch(changeScreen(PLAYERS_SELECTION));\n                            }}\n                            circuit={circuit}\n                        />\n                    ))}\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-bottom\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default CircuitSelection;\n","import { v4 as uuid } from 'uuid';\nimport { getRandomName } from 'utils/getRandomName';\nimport { pickRandomFromArray, keepPickingUntilNotInArray } from 'utils/random';\nimport { STYLES } from 'constants/player-styles';\nimport { HUMAN } from 'constants/player-types';\nimport { getPlayersOrderedBy } from 'utils/players-order';\nimport { setSelectedPlayers, updatePlayer } from './actions';\n\nexport const addRandomPlayer = () => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const playerOrder = state.mainUI.selectedPlayerOrder;\n        const players = state.mainUI.selectedPlayers;\n        const allStyles = Object.values(STYLES);\n        const currentNames = players.map((player) => player.name);\n        const currentStyles = players.map((player) => player.style);\n        const newStyle = keepPickingUntilNotInArray(\n            () => pickRandomFromArray(allStyles),\n            currentStyles,\n            (a, b) => a.id === b.id,\n        );\n        const newName = keepPickingUntilNotInArray(getRandomName, currentNames);\n\n        const newPlayer = {\n            id: uuid(),\n            name: newName,\n            style: newStyle,\n            type: HUMAN,\n            levelAI: 0,\n        };\n\n        dispatch(\n            setSelectedPlayers(\n                players.concat(newPlayer),\n                playerOrder.concat(newPlayer.id),\n            ),\n        );\n    };\n};\n\nexport const selectNewStyleForPlayer = (player) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const players = state.mainUI.selectedPlayers;\n        const allStyles = Object.values(STYLES);\n        const otherPlayers = players.filter(\n            (otherPlayer) => otherPlayer.id !== player.id,\n        );\n\n        const stylesToUse = allStyles.reduce((acc, style) => {\n            if (isStyleUsedByPlayers(style, otherPlayers)) {\n                return acc;\n            }\n            return acc.concat([style]);\n        }, []);\n\n        const currentIndex = stylesToUse.findIndex(\n            (style) => style.id === player.style.id,\n        );\n\n        const nextStyleIndex = (currentIndex + 1) % stylesToUse.length;\n\n        dispatch(\n            updatePlayer(player.id, {\n                style: stylesToUse[nextStyleIndex],\n            }),\n        );\n    };\n};\n\nfunction isStyleUsedByPlayers(style, players) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const player of players) {\n        if (player.style.id === style.id) {\n            return true;\n        }\n    }\n    return false;\n}\n\nexport const limitPlayersTo = (numberOfPlayers) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const players = state.mainUI.selectedPlayers;\n        const order = state.mainUI.selectedPlayerOrder;\n        const orderedPlayers = getPlayersOrderedBy(players, order);\n        dispatch(\n            setSelectedPlayers(\n                orderedPlayers.slice(0, numberOfPlayers),\n                order.slice(0, numberOfPlayers),\n            ),\n        );\n    };\n};\n","import React from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { selectablePlayer } from 'components/propTypes';\nimport PlayerIcon from 'components/PlayerIcon';\nimport { HUMAN, AI } from 'constants/player-types';\nimport './style.css';\n\nfunction PlayerSelector({\n    player,\n    onRemove,\n    canBeRemoved,\n    onNameChange,\n    onTypeChange,\n    onLevelAIChange,\n    onSelectNewStyle,\n}) {\n    return (\n        <div className=\"player-selector\">\n            <div className=\"player-selector-top\">\n                <input\n                    className=\"player-selector-input\"\n                    type=\"text\"\n                    value={player.name}\n                    onChange={(event) => onNameChange(event.target.value)}\n                />\n                <button\n                    type=\"button\"\n                    className=\"player-selector-style-container\"\n                    onClick={onSelectNewStyle}\n                >\n                    <PlayerIcon playerStyle={player.style} />\n                </button>\n                <button\n                    type=\"button\"\n                    className=\"button button-small\"\n                    onClick={onRemove}\n                    disabled={!canBeRemoved}\n                    style={{\n                        opacity: canBeRemoved ? 1 : 0,\n                    }}\n                >\n                    Delete\n                </button>\n            </div>\n            <div className=\"player-selector-bottom\">\n                <button\n                    type=\"button\"\n                    className={classNames('player-selector-toggle', {\n                        'is-selected': player.type === HUMAN,\n                    })}\n                    onClick={() => onTypeChange(HUMAN)}\n                >\n                    Human\n                </button>\n                <button\n                    type=\"button\"\n                    className={classNames('player-selector-toggle', {\n                        'is-selected': player.type === AI,\n                    })}\n                    onClick={() => onTypeChange(AI)}\n                >\n                    AI\n                </button>\n\n                {player.type === AI && (\n                    <div className=\"player-selector-ai-level\">\n                        <input\n                            value={player.levelAI}\n                            type=\"range\"\n                            min=\"1\"\n                            max=\"3\"\n                            step=\"1\"\n                            onChange={(event) =>\n                                onLevelAIChange(\n                                    parseInt(event.target.value, 10),\n                                )\n                            }\n                        />\n                        <div className=\"player-selector-ai-level-text\">\n                            {getRobotNameByLevel(player.levelAI)}\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nfunction getRobotNameByLevel(level) {\n    switch (level) {\n        case 0:\n            return 'Super Easy';\n        case 1:\n            return 'Very Easy';\n        case 2:\n            return 'Easy';\n        case 3:\n            return 'Normal';\n        default:\n            return 'Normal';\n    }\n}\n\nPlayerSelector.propTypes = {\n    player: selectablePlayer.isRequired,\n    onRemove: PropTypes.func.isRequired,\n    onNameChange: PropTypes.func.isRequired,\n    onTypeChange: PropTypes.func.isRequired,\n    onSelectNewStyle: PropTypes.func.isRequired,\n    canBeRemoved: PropTypes.bool.isRequired,\n};\n\nexport default PlayerSelector;\n","/* eslint-disable jsx-a11y/label-has-for */\n/* eslint-disable jsx-a11y/label-has-associated-control */\nimport React, { useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n    changeScreen,\n    removePlayer,\n    updatePlayer,\n    toggleRandomizePlayerOrderOnStart,\n    togglePlayWithTimer,\n} from 'store/main-ui/actions';\nimport {\n    addRandomPlayer,\n    selectNewStyleForPlayer,\n    limitPlayersTo,\n} from 'store/main-ui/async-actions';\nimport { initGameWithSavedConfig } from 'store/game/async-actions';\nimport { circuits } from 'constants/circuits';\nimport { CIRCUIT_SELECTION } from 'constants/screens';\nimport { getOrderedPlayers } from 'store/game/selectors';\nimport PlayerSelector from 'components/PlayerSelector';\nimport Logo from 'components/Logo';\nimport {\n    getSelectedCircuit,\n    shouldRandomizePlayerOrderOnStart,\n    shouldPlayWithTimer,\n} from 'store/main-ui/selectors';\nimport './style.css';\n\nfunction PlayersSelection({ className }) {\n    const dispatch = useDispatch();\n    const players = useSelector(getOrderedPlayers);\n    const circuitId = useSelector(getSelectedCircuit);\n    const circuit = circuits[circuitId];\n\n    useEffect(() => {\n        if (players.length && players.length > circuit.maxPlayers) {\n            dispatch(limitPlayersTo(circuit.maxPlayers));\n        }\n    }, [players, circuit, dispatch]);\n\n    const randomizePlayerOrderOnStart = useSelector(\n        shouldRandomizePlayerOrderOnStart,\n    );\n\n    const playWithTimer = useSelector(shouldPlayWithTimer);\n\n    const canBeRemoved = players.length > 1;\n\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Choose players</h1>\n            </div>\n            <div className=\"menu-content player-selection-content transition-from-right\">\n                <div className=\"player-selection-content-inner\">\n                    {players.map((player) => (\n                        <PlayerSelector\n                            key={player.id}\n                            player={player}\n                            onRemove={() => {\n                                if (!canBeRemoved) {\n                                    return;\n                                }\n                                dispatch(removePlayer(player.id));\n                            }}\n                            canBeRemoved={canBeRemoved}\n                            onNameChange={(newName) =>\n                                dispatch(\n                                    updatePlayer(player.id, { name: newName }),\n                                )\n                            }\n                            onTypeChange={(newType) =>\n                                dispatch(\n                                    updatePlayer(player.id, { type: newType }),\n                                )\n                            }\n                            onSelectNewStyle={() =>\n                                dispatch(selectNewStyleForPlayer(player))\n                            }\n                            onLevelAIChange={(newLevelAI) =>\n                                dispatch(\n                                    updatePlayer(player.id, {\n                                        levelAI: newLevelAI,\n                                    }),\n                                )\n                            }\n                        />\n                    ))}\n                    {players.length < circuit.maxPlayers && (\n                        <button\n                            type=\"button\"\n                            className=\"button player-selection-add-player-button\"\n                            onClick={() => dispatch(addRandomPlayer())}\n                        >\n                            Add Player\n                        </button>\n                    )}\n\n                    {players.length > 1 && (\n                        <div className=\"transition-from-right\">\n                            <label className=\"player-selection-checkbox\">\n                                <input\n                                    type=\"checkbox\"\n                                    checked={randomizePlayerOrderOnStart}\n                                    onChange={() =>\n                                        dispatch(\n                                            toggleRandomizePlayerOrderOnStart(),\n                                        )\n                                    }\n                                />\n                                Randomize player order when race starts\n                            </label>\n                        </div>\n                    )}\n                    <div className=\"transition-from-right\">\n                        <label className=\"player-selection-checkbox player-selection-checkbox-last\">\n                            <input\n                                type=\"checkbox\"\n                                checked={playWithTimer}\n                                onChange={() => dispatch(togglePlayWithTimer())}\n                            />\n                            Play with timer\n                        </label>\n                    </div>\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(CIRCUIT_SELECTION));\n                    }}\n                >\n                    Back\n                </button>\n                <div className=\"menu-footer-filler\" />\n                <button\n                    className=\"button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(initGameWithSavedConfig());\n                    }}\n                >\n                    Start game!\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default PlayersSelection;\n","export const getPlayersOrderedBy = (players, order) => {\n    return order.map((playerId) => {\n        return players.find((player) => player.id === playerId);\n    });\n};\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport { circuits } from 'constants/circuits';\nimport Logo from 'components/Logo';\nimport ScoreBoard from 'components/ScoreBoard';\nimport { getByCircuitId } from 'utils/highScoresStorage';\nimport './style.css';\n\nconst circuitsArray = Object.values(circuits);\n\nfunction HighScores() {\n    const [scoresForCurrentCircuit, setScoresForCurrentCircuit] = useState([]);\n    const [activeCircuit, setActiveCircuit] = useState(circuitsArray[0]);\n    useEffect(() => {\n        if (activeCircuit.id) {\n            setScoresForCurrentCircuit(getByCircuitId(activeCircuit.id));\n        }\n    }, [activeCircuit]);\n\n    const dispatch = useDispatch();\n\n    return (\n        <div className=\"full-screen full-screen-with-header-and-footer high-scores\">\n            <div className=\"menu-header transition-from-top\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">High scores</h1>\n            </div>\n            <div className=\"menu-content transition-from-bottom\">\n                <div className=\"high-scores-circuit-tabs-container\">\n                    <div className=\"high-scores-circuit-tabs\">\n                        {circuitsArray.map((circuit) => (\n                            <div\n                                key={circuit.id}\n                                className={classNames(\n                                    'high-scores-circuit-tab',\n                                    {\n                                        'is-active':\n                                            circuit.id === activeCircuit.id,\n                                    },\n                                )}\n                            >\n                                <div onClick={() => setActiveCircuit(circuit)}>\n                                    {circuit.name}\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n\n                <div className=\"high-scores-circuit\">\n                    <ScoreBoard\n                        circuit={activeCircuit}\n                        scores={scoresForCurrentCircuit}\n                        canReplay\n                    />\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-bottom\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default HighScores;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport Logo from 'components/Logo';\n\nimport './style.css';\n\nconst Credits = ({ className }) => {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className={classNames(\n                'full-screen',\n                'full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Credits</h1>\n            </div>\n            <div className=\"menu-content transition-from-right credits-content\">\n                <div className=\"credits-content-item\">\n                    <p>Created by Paco Gómez Granados</p>\n                    <p>\n                        <a\n                            href=\"https://pacog.github.io/portfolio/\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            https://pacog.github.io/portfolio/\n                        </a>\n                    </p>\n                    <p>\n                        <a\n                            href=\"https://twitter.com/PacoGomezGrana\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            @PacoGomezGrana\n                        </a>\n                    </p>\n                </div>\n\n                <div className=\"credits-content-item\">\n                    <p>Based on an original idea by</p>\n                    <p>\n                        <a\n                            href=\"https://twitter.com/esqizo\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            @esqizo\n                        </a>{' '}\n                        and cousins\n                    </p>\n                </div>\n\n                <div className=\"credits-content-item\">\n                    <p>Circuit graphics inspired by</p>\n                    <p>\n                        <a\n                            href=\"https://codepen.io/ste-vg\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Steve Gardner\n                        </a>\n                        ´s{' '}\n                        <a\n                            href=\"https://codepen.io/ste-vg/full/BaaQamG\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Race Car Island\n                        </a>\n                    </p>\n                </div>\n            </div>\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n};\n\nexport default Credits;\n","import React from 'react';\nimport classNames from 'classnames';\n// import Logo from 'components/Logo';\n\nimport './style.css';\n\nconst LoadingGame = ({ className }) => {\n    return (\n        <div className={classNames('full-screen', className)}>\n            <div className=\"loading-game\">\n                <div className=\"lds-ellipsis\">\n                    <div />\n                    <div />\n                    <div />\n                    <div />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default LoadingGame;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { raceHistory as raceHistoryProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { PathLine } from 'react-svg-pathline';\nimport { CAR } from 'constants/player-styles';\nimport { getPlayerStyleCSS } from 'utils/playerPainter';\n\nimport './style.css';\n\nconst defaultStyle = CAR;\n\nconst ReplayPlayerTrail = ({ raceHistory, isActive }) => {\n    const storeState = useSelector((state) => state);\n\n    if (!raceHistory.path.length) {\n        return <></>;\n    }\n    const points = raceHistory.path.map((position) =>\n        projectToScreenPosition(storeState, position),\n    );\n\n    return (\n        <div\n            className={classNames('player-trail-container', {\n                'is-active': isActive,\n            })}\n            style={getPlayerStyleCSS(raceHistory)}\n        >\n            <svg className=\"player-trail\">\n                <PathLine\n                    points={points}\n                    stroke={defaultStyle.trailColor}\n                    strokeWidth={defaultStyle.trailWidth}\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n            {points\n                .map((point, index) => {\n                    return { ...point, turn: index + 1 };\n                })\n                .map((point) => (\n                    <div\n                        key={`${point.x}_${point.y}_${point.turn}`}\n                        className=\"player-trail-point\"\n                        style={{\n                            left: point.x,\n                            top: point.y,\n                        }}\n                    />\n                ))}\n        </div>\n    );\n};\n\nReplayPlayerTrail.propTypes = {\n    raceHistory: raceHistoryProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default ReplayPlayerTrail;\n","import React from 'react';\nimport Grid from 'components/Grid';\nimport { useSelector } from 'react-redux';\nimport { getRaceHistory, getCircuitInfo } from 'store/game/selectors';\nimport ReplayPlayerTrail from 'components/ReplayPlayerTrail';\nimport Player from 'components/Player';\nimport { player as playerProp } from 'components/propTypes';\n\nconst ReplayGameBoardContents = ({ playerInPosition }) => {\n    const raceHistory = useSelector((state) => getRaceHistory(state));\n    const mapZoom = useSelector((state) => state.map.zoom);\n    const gridSize = useSelector((state) => state.map.gridSize);\n    const circuitInfo = useSelector(getCircuitInfo);\n\n    return (\n        <>\n            <div\n                className=\"replay-game-board-circuit-bg\"\n                style={{\n                    backgroundImage: `url(${circuitInfo.bgImg})`,\n                    backgroundSize: `${circuitInfo.width}px ${circuitInfo.height}px`,\n                }}\n            />\n            <Grid zoom={mapZoom} cellSize={gridSize} />\n            <Player player={playerInPosition} isActive />\n            <ReplayPlayerTrail raceHistory={raceHistory} isActive />\n        </>\n    );\n};\n\nReplayGameBoardContents.propTypes = {\n    playerInPosition: playerProp.isRequired,\n};\n\nReplayGameBoardContents.defaultProps = {};\n\nexport default ReplayGameBoardContents;\n","import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getRaceHistory } from 'store/game/selectors';\nimport GameBoardCameraHandler from 'components/GameBoard/GameBoardCameraHandler';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport ReplayGameBoardContents from './ReplayGameBoardContents';\nimport './style.css';\n\nconst ReplayGameBoard = () => {\n    const raceHistory = useSelector((state) => getRaceHistory(state));\n    const [playerInPosition, setPlayerInPosition] = useState(null);\n    const [currentTurn, setCurrentTurn] = useState(0);\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if (!raceHistory) {\n            return;\n        }\n        setPlayerInPosition({\n            id: raceHistory.id,\n            name: raceHistory.name,\n            style: raceHistory.playerStyle,\n            position: raceHistory.path[currentTurn],\n            speed: { x: 0, y: 0 },\n            prevPositions: [],\n        });\n    }, [raceHistory, currentTurn]);\n\n    return (\n        <div className=\"game-board-container\">\n            {playerInPosition && (\n                <GameBoardCameraHandler currentPlayer={playerInPosition}>\n                    <ReplayGameBoardContents\n                        playerInPosition={playerInPosition}\n                    />\n                </GameBoardCameraHandler>\n            )}\n            <div className=\"game-board-back-button-container\">\n                <button\n                    type=\"button\"\n                    className=\"button button-small\"\n                    onClick={() => dispatch(changeScreen(MAIN_MENU))}\n                >\n                    Back\n                </button>\n            </div>\n            {raceHistory && raceHistory.path.length && (\n                <div className=\"replay-game-board-turn-selector\">\n                    <span className=\"replay-game-board-turn-selector-label\">\n                        Turn:{' '}\n                    </span>\n                    <input\n                        type=\"range\"\n                        value={currentTurn}\n                        max={raceHistory.path.length - 1}\n                        onChange={(e) =>\n                            setCurrentTurn(parseFloat(e.target.value))\n                        }\n                    />\n                    <span className=\"replay-game-board-turn-selector-value\">\n                        {currentTurn + 1}\n                    </span>\n                </div>\n            )}\n        </div>\n    );\n};\n\nReplayGameBoard.propTypes = {};\n\nReplayGameBoard.defaultProps = {};\n\nexport default ReplayGameBoard;\n","import React from 'react';\nimport ReplayGameBoard from 'components/ReplayGameBoard';\nimport './style.css';\n\nconst ReplayGame = () => {\n    return (\n        <div className=\"transition-opacity\">\n            <ReplayGameBoard />\n        </div>\n    );\n};\n\nexport default ReplayGame;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen0({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-0\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>This is your car.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen0.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen0;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen1({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-1\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>You can move it by clicking in of the 9 buttons.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen1.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen1;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen2({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-2\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>\n                        Your next move will depend on your previous move, so be\n                        careful!\n                    </p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen2.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen2;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen3({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-3\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>If you go too fast, you may crash and be penalised.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Done!\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen3.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen3;\n","import React, { useState } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { MAIN_MENU } from 'constants/screens';\nimport Logo from 'components/Logo';\nimport { changeScreen } from 'store/main-ui/actions';\nimport TutorialScreen0 from './TutorialScreen0';\nimport TutorialScreen1 from './TutorialScreen1';\nimport TutorialScreen2 from './TutorialScreen2';\nimport TutorialScreen3 from './TutorialScreen3';\nimport './style.css';\n\nfunction Tutorial({ className }) {\n    const dispatch = useDispatch();\n    const [currentScreen, setCurrentScreen] = useState(0);\n    const goToNextScreen = () => {\n        setCurrentScreen(currentScreen + 1);\n    };\n\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">How to play</h1>\n            </div>\n            <div className=\"menu-content transition-from-right tutorial-screen-container\">\n                {currentScreen === 0 && (\n                    <TutorialScreen0 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 1 && (\n                    <TutorialScreen1 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 2 && (\n                    <TutorialScreen2 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 3 && (\n                    <TutorialScreen3\n                        onNext={() => {\n                            dispatch(changeScreen(MAIN_MENU));\n                        }}\n                    />\n                )}\n            </div>\n\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n                <div className=\"menu-footer-filler\" />\n            </footer>\n        </div>\n    );\n}\n\nexport default Tutorial;\n","import React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { TransitionGroup, CSSTransition } from 'react-transition-group';\nimport * as screens from 'constants/screens';\nimport MainMenu from 'screens/MainMenu';\nimport Game from 'screens/Game';\nimport CircuitSelection from 'screens/CircuitSelection';\nimport PlayersSelection from 'screens/PlayersSelection';\nimport HighScores from 'screens/HighScores';\nimport Credits from 'screens/Credits';\nimport LoadingGame from 'screens/LoadingGame';\nimport ReplayGame from 'screens/ReplayGame';\nimport Tutorial from 'screens/Tutorial';\nimport { getCurrentScreen } from 'store/main-ui/selectors';\n\nconst TIME_TO_SHOW_FIRST_SCREEN = 500; // ms\nconst STATE_CHANGE_TRANSITION_TIME = 300; // ms\n\nfunction Router() {\n    const [gameReady, setGameReady] = useState(false);\n    const currentScreenName = useSelector(getCurrentScreen);\n    useEffect(() => {\n        const timeout = setTimeout(() => {\n            setGameReady(true);\n        }, TIME_TO_SHOW_FIRST_SCREEN);\n        return () => clearTimeout(timeout);\n    }, []);\n\n    const allScreens = [\n        {\n            screenName: screens.MAIN_MENU,\n            Component: MainMenu,\n        },\n        {\n            screenName: screens.CIRCUIT_SELECTION,\n            Component: CircuitSelection,\n        },\n        {\n            screenName: screens.PLAYERS_SELECTION,\n            Component: PlayersSelection,\n        },\n        {\n            screenName: screens.HIGH_SCORES,\n            Component: HighScores,\n        },\n        {\n            screenName: screens.GAME,\n            Component: Game,\n        },\n        {\n            screenName: screens.CREDITS,\n            Component: Credits,\n        },\n        {\n            screenName: screens.LOADING_GAME,\n            Component: LoadingGame,\n        },\n        {\n            screenName: screens.REPLAY_GAME,\n            Component: ReplayGame,\n        },\n        {\n            screenName: screens.TUTORIAL,\n            Component: Tutorial,\n        },\n    ];\n\n    return (\n        <TransitionGroup className=\"menu-screen\">\n            {allScreens\n                .filter(\n                    ({ screenName }) =>\n                        gameReady &&\n                        currentScreenName === screenName.toString(),\n                )\n                .map(({ screenName, Component }) => (\n                    <CSSTransition\n                        key={screenName.toString()}\n                        timeout={STATE_CHANGE_TRANSITION_TIME}\n                        classNames=\"fade\"\n                    >\n                        <Component className=\"\" />\n                    </CSSTransition>\n                ))}\n        </TransitionGroup>\n    );\n}\n\nexport default Router;\n","import React, { useEffect } from 'react';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware } from 'redux';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport thunk from 'redux-thunk';\nimport rootReducer from 'store/rootReducer';\nimport { getSavedPlayers } from 'utils/playersStorage';\nimport { setSelectedPlayers } from 'store/main-ui/actions';\nimport Router from './Router';\nimport './App.css';\n\nconst store = createStore(\n    rootReducer,\n    composeWithDevTools(applyMiddleware(thunk)),\n);\n\nfunction App() {\n    useEffect(() => {\n        restoreSavedConfig({ players: getSavedPlayers() });\n    }, []);\n    return (\n        <Provider store={store}>\n            <Router />\n        </Provider>\n    );\n}\n\nfunction restoreSavedConfig({ players }) {\n    if (players) {\n        store.dispatch(\n            setSelectedPlayers(players.players, players.playerOrder),\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'type-defs';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport {\n    init as initGameLoop,\n    addToUpdate as addToGameLoopUpdate,\n} from 'utils/gameLoop';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport addVHCSSVar from './utils/addVhCssVar';\n\n// @ts-ignore\nwindow.capac_racer_version = process.env.REACT_APP_VERSION;\n\nReactDOM.render(<App />, document.getElementById('root'));\n\ninitGameLoop();\naddToGameLoopUpdate((time) => {\n    waitingForPlayerCounter.notifyTimePassed(time);\n});\n\naddVHCSSVar();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import debounce from 'lodash.debounce';\n\nexport default function() {\n    const setVH = () => {\n        const vh = window.innerHeight * 0.01;\n        document.documentElement.style.setProperty('--vh', `${vh}px`);\n    };\n\n    window.addEventListener('resize', debounce(setVH, 200));\n    setVH();\n}\n"],"sourceRoot":""}