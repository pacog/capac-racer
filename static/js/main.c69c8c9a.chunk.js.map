{"version":3,"sources":["assets/grid.png","utils/Counter.js","utils/waitingForPlayerCounter.js","constants/ux.js","utils/gameLoop.js","constants/player-types.js","utils/clamp.js","utils/vector2d.js","utils/player.js","store/players/actions.js","store/players/reducer.js","store/map/reducer.js","constants/screens.js","constants/player-styles.js","utils/random.js","utils/getRandomName.js","store/main-ui/actions.js","store/main-ui/reducer.js","constants/game-states.js","store/game/actions.js","store/game/reducer.js","store/rootReducer.js","utils/playersStorage.js","components/Logo/index.jsx","screens/MainMenu/index.jsx","utils/screenUtils.js","store/map/selectors.js","store/players/selectors.js","store/game/selectors.js","constants/circuits.js","utils/loadImage.js","utils/imgPixelGetter.js","utils/pixel.js","utils/circuit.js","utils/range.js","utils/gameLoopTimeout.js","utils/highScoresStorage.js","constants/ai-levels.js","utils/PartialCircuitSolution.js","utils/ai.js","utils/request-animation-frame.js","utils/is-touch-device.js","utils/analytics.js","store/game/async-actions.js","components/CounterDisplay/index.jsx","components/propTypes.js","components/GameBoard/GameBoardCameraHandler.jsx","components/Grid/index.jsx","components/PlayerIcon/index.jsx","components/Player/index.jsx","utils/playerPainter.js","components/MovementPicker/index.jsx","components/RandomSelectionAnimation/index.jsx","components/PlayerTrail/index.jsx","components/GameBoard/GameBoardContents.jsx","components/GameBoard/index.jsx","components/PlayerList/PlayerListItem.jsx","components/PlayerList/index.jsx","components/GameScreenModals/StartGameModal.jsx","components/GameScreenModals/StartTurnModal.jsx","components/GameScreenModals/NotifyCollisionModal.jsx","components/GameScreenModals/NotifyAICollisionModal.jsx","components/GameScreenModals/NotifyGroundedModal.jsx","components/GameScreenModals/NotifyAIGroundedModal.jsx","components/GameScreenModals/NotifyVictoryModal.jsx","components/GameScreenModals/InGameMenuModal.jsx","components/ScoreBoard/index.jsx","components/GameScreenModals/NotifyHighScoreModal.jsx","components/GameScreenModals/AIThinkingModal.jsx","components/GameScreenModals/index.jsx","components/KeyPressListener/index.jsx","components/WindowBlurListener/index.jsx","screens/Game/index.jsx","components/CircuitSelector/index.jsx","screens/CircuitSelection/index.jsx","store/main-ui/async-actions.js","components/PlayerSelector/index.jsx","screens/PlayersSelection/index.jsx","utils/players-order.js","screens/HighScores/index.jsx","screens/Credits/index.jsx","screens/LoadingGame/index.jsx","components/ReplayPlayerTrail/index.jsx","components/ReplayGameBoard/ReplayGameBoardContents.jsx","components/ReplayGameBoard/index.jsx","screens/ReplayGame/index.jsx","screens/Tutorial/TutorialScreen0.jsx","screens/Tutorial/TutorialScreen1.jsx","screens/Tutorial/TutorialScreen2.jsx","screens/Tutorial/TutorialScreen3.jsx","screens/Tutorial/index.jsx","Router.jsx","App.js","serviceWorker.js","index.js","utils/add-vh-css-var.js"],"names":["module","exports","timeToWait","started","this","_timeToWait","_isRunning","_elapsedTime","Number","MAX_VALUE","time","_callbackOnEnd","callbackOnEnd","Math","max","counter","Counter","initted","delta","lastFrameTimeMs","gameLoop","timestamp","update","requestAnimationFrame","callbacksToUpdate","timeDiff","forEach","callback","removeFromUpdate","filter","eachCallback","addToUpdate","concat","HUMAN","AI","clamp","x","min","add","v1","v2","y","substract","isEqual","magnitude","v","sqrt","distance","round","movePlayerTo","player","position","timePassed","newSpeed","speedMagnitude","speed","prevPositions","turnsSpent","maxSpeed","realTimeUsed","crashPlayer","turnsGrounded","floor","crashes","reduceGrounded","addCheckpoints","newIndexes","newCheckpoints","checkpointsPassed","slice","sort","newIndex","actionTypes","players","combineReducers","byId","state","action","type","reduce","accumulator","id","PLAYER_DEFAULT_INFO","playerId","newCheckpointIndexes","levelAI","map","zoom","gridSize","MAIN_MENU","Symbol","GAME","CIRCUIT_SELECTION","PLAYERS_SELECTION","HIGH_SCORES","CREDITS","LOADING_GAME","REPLAY_GAME","TUTORIAL","CAR","name","dotColor","dotSize","trailColor","trailDotsSize","trailWidth","icon","process","ROCKET","TURTLE","SKULL","CLOWN","DANCER","PANDA","COFFIN","BROOM","SAILBOAT","STYLES","pickRandomFromArray","array","length","random","keepPickingUntilNotInArray","pickerFn","arrayToAvoid","maxTries","i","newPick","indexOf","Error","FIRST_NAMES","LAST_NAMES","getRandomName","changeScreen","screenId","setSelectedPlayers","playerOrder","updatePlayer","attrsToUpdate","initialPlayers","style","Object","values","defaultOrder","mainUI","currentScreen","selectedCircuit","circuitId","selectedPlayerOrder","selectedPlayers","randomizePlayerOrderOnStart","playWithTimer","NOT_STARTED","START_SCREEN","PLAYER_TURN_START_SCREEN","WAITING_FOR_PLAYER_INPUT","ANIMATING_RANDOM_PLAYER_MOVEMENT","NOTIFY_COLLISION","NOTIFY_AI_COLLISION","NOTIFY_GROUNDED","NOTIFY_AI_GROUNDED","NOTIFY_VICTORY","NOTIFY_HIGH_SCORE","SHOW_MENU","AI_THINKING_SCREEN","setGameState","newGameState","defaultState","gameState","gameStates","prevGameState","currentTurnPlayerId","circuitInfo","latestHighScore","selectedPosition","raceHistory","selectedAIMove","game","getNextTurn","highScore","newPosition","newMove","currentPlayer","getSavedPlayers","window","localStorage","result","getItem","e","JSON","parse","Logo","variant","className","defaultProps","MainMenu","dispatch","useDispatch","classNames","onClick","capac_racer_version","getScreenCoordinates","worldPosition","mapZoom","project","n","dx","dy","baseX","baseY","projectToScreenPosition","mapGridSize","getPossibleDestinations","otherPlayers","positionAfterSpeed","positions","j","push","find","otherPosition","isPositionColliding","isWaitingForPlayerInput","isAnimatingRandomSelection","isAnimatingAISelection","getAISelectedMove","getCurrentPlayer","isGameStarted","getAllPlayers","getOtherPlayers","getOtherPlayersPositionInScreen","getOrderedPlayers","getPossibleDestinationsForPlayerInScreen","otherPlayer","eachPosition","screen","getSelectedPosition","getRaceHistory","circuits","mouth","collisionImg","bgImg","checkpoints","maxPlayers","startingPositions","initialSpeed","heart","rosco","horse","loadImage","url","Promise","resolve","reject","img","Image","addEventListener","once","error","src","createFromImage","canvas","document","createElement","width","height","getContext","drawImage","rawData","getImageData","data","getPixel","basePosition","r","g","b","a","hasContent","createFromConfig","config","then","createPixelGetterFromImage","collisionPixelGetter","all","checkpointImg","loadedCheckpointImages","checkpointImage","checkpointPixelGetters","centerOfCheckpoints","cp","checkpoint","pixelsToCheck","resultArray","acc","pixel","getCenterOfCheckpoint","doesLineCollide","line","circuit","otherPlayersPosition","getPixelsToCheck","doesAnyPixelCollideInImage","pixelToCheck","checkIfPlayerCanMove","from","to","movementLine","getCheckpointsVisitedInLine","checkpointPixelGetter","doesItCollide","index","imagePixelGetter","pixelInCollisionMap","start","end","lineLength","nPixelsToCheck","ceil","size","diffVector","Array","keys","factor","scale","timeout","timeMs","notifyPassOfTime","notifyTimePassed","addToGameLoopUpdate","restart","removeFromGameLoopUpdate","stop","getAll","getByCircuitId","score","date","Date","shouldScoreBeAdded","circuitScores","isBetterScore","addScore","insertBefore","scoreToAdd","v4","newScores","splice","newAll","setItem","stringify","console","warn","updateCircuitScores","otherScore","turns","levels","randomSolutionChance","maxIterations","maxThinkingDepth","timeThinking","PartialCircuitSolution","playerInfo","currentIteration","_updatePartialScore","maxDepthForSolutions","otherPlayersToConsider","canMoveThere","visitedCheckpointsInTurn","getCheckpointsInMovement","maxAvgSpeed","maxCheckpointsCoveredPerTurn","maxCheckpointsCovered","avgSpeedScore","avgSpeed","checkpointsCoveredPerTurnScore","checkpointsCoveredPerTurn","checkpointsCoveredScore","checkpointsCovered","summary","toFixed","positionHash","doesPlayerHaveRepeatedPositions","totalDistance","point","nextPoint","getAverageSpeed","getCheckpointsPassed","nextCheckpoint","_getPercentageToNextCheckpoint","getTurns","indexWithFirstPosition","hasPlayerFinishedRace","playerPositionScreen","getDistanceToNextCheckpoint","eachDistance","getMaxCheckpointDistance","chooseNextMovement","chance","aiLevels","shouldGetRandomSolution","possiblePositions","returnRandomNonCrashingMove","solutionsGenerator","createSolutionsGenerator","async","solution","isFinished","move","openSolutions","finishedSolutions","bestFinishedSolution","solutionToExpand","getMostPromisingSolution","newSolutions","expand","newFinishedSolutions","newOpenSolutions","getScore","updateScoreWithTotals","getFirstMove","returnRandomMove","solutions","best","isTouchDevice","prefixes","split","DocumentTouch","query","matchMedia","matches","mq","join","checkTouchDevice","track","category","label","value","log","gtag","event_category","event_label","startTurn","getState","nextPlayer","setTimeout","reduceGroundedAndNextTurn","notifyGrounded","startWaitingForPlayerInput","handleAITurn","nextTurn","initGameWithConfig","playersWithMapPosition","initialPosition","initMapPositionForPlayers","fixPlayersWithoutName","setPlayers","waitingForPlayerCounter","setTimeToWait","initGame","initGameWithSavedConfig","shuffle","playersInfoToStore","version","storeSavedPlayers","handlePlayerCollision","newIntendedPosition","notifyCollision","handleCorrectMovement","detectAndStoreCheckpoints","hasPlayerWon","hasCurrentPlayerWon","moveTo","path","playerStyle","newScore","handleVictory","handlePlayerMovement","getTimePassed","handlePlayerPositionSelection","nextPosition","nextMovementPromise","minTimeToWaitForPlayer","getMinTimeToWaitForPlayer","nextMovement","finishGame","reset","pause","unpause","lastState","tryToToggleInGameMenu","getNameForPlayerWithoutName","showReplay","initReplay","CounterDisplay","counterObject","React","useState","timeLeft","setTimeLeft","requestRef","useRef","animate","getTimeLeft","current","useEffect","cancelAnimationFrame","PropTypes","shape","string","number","vector2d","PADDING_FOR_VIEWPORT","isRequired","arrayOf","yy","GameBoardCameraHandler","children","cameraPosition","setCameraPosition","boardSize","setBoardSize","isDragging","setIsDragging","dragStart","setDragStart","useSelector","playerScreenPosition","viewport","topLeft","vector","padding","isInsideViewport","closestPointInViewport","minX","maxX","minY","maxY","getClosestPointInsideViewport","newCameraMovement","handlePointerDown","event","coordinates","getCoordinatesFromPointerEvent","handlePointerUp","handlePointerMove","cursorPosition","movement","handleHeight","handleWidth","onResize","transform","onMouseDown","onMouseUp","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","eventToUse","touches","clientX","clientY","Grid","backgroundSize","cellSize","backgroundImage","gridImg","PlayerIcon","Player","isActive","rootElement","element","setProperty","setCSSVars","ref","left","top","setPlayerCSSVars","getColorForTempLine","points","MovementPicker","onPositionSelected","onConfirmSelection","tempLine","setTempLine","animatePoints","setAnimatePoints","lastMovement","lastPosition","moved","getMovedPixelsSinceLastTurn","translate","setTranslate","clearTimeout","originalPlayerScreenPosition","nextPivot","getPivotForPlayerInScreen","selectedPositionScreen","selectButtonPosition","possiblePlayerPositions","MIN_VALUE","getSelectButtonPosition","lineToPaint","wouldCollide","key","onMouseEnter","onMouseLeave","stroke","strokeWidth","strokeDasharray","fill","RandomSelectionAnimation","switchRandomEvery","highlightMove","highlightedPosition","setHighlightedPosition","interval","setInterval","randomPosition","clearInterval","moveToHighlight","getKey","PlayerTrail","storeState","pointsWithoutLast","turn","GameBoardContents","waitingForPlayerInput","animatingRandomSelection","animatingAISelection","AIMove","getRandomSpeedForAI","GameBoard","shouldShowPauseButton","PlayerListItem","PlayerList","StartGameModal","StartTurnModal","NotifyCollisionModal","pluralize","NotifyAICollisionModal","showContent","setShowContent","NotifyGroundedModal","NotifyAIGroundedModal","NotifyVictoryModal","InGameMenuModal","stopPropagation","ScoreBoard","scores","highlightedScore","canReplay","onScoreClicked","toLocaleDateString","NotifyHighScoreModal","getLatestHighScore","highScoresForCircuit","AIThinkingModal","GameScreenModals","getGameState","KeyPressListener","onKeyPress","code","removeEventListener","propTypes","objectOf","func","hidden","visibilityChange","WindowBlurListener","onBlur","undefined","handleVisibilityChange","msHidden","webkitHidden","Game","Escape","Space","CircuitSelector","alt","circuitsArray","CircuitSelection","selectNewStyleForPlayer","allStyles","stylesToUse","isStyleUsedByPlayers","nextStyleIndex","findIndex","PlayerSelector","onRemove","canBeRemoved","onNameChange","onTypeChange","onLevelAIChange","onSelectNewStyle","onChange","target","disabled","opacity","step","parseInt","level","getRobotNameByLevel","PlayersSelection","numberOfPlayers","order","orderedPlayers","getPlayersOrderedBy","newName","newType","newLevelAI","currentNames","currentStyles","newStyle","newPlayer","uuid","checked","HighScores","scoresForCurrentCircuit","setScoresForCurrentCircuit","activeCircuit","setActiveCircuit","Credits","href","rel","LoadingGame","defaultStyle","ReplayPlayerTrail","ReplayGameBoardContents","playerInPosition","ReplayGameBoard","setPlayerInPosition","currentTurn","setCurrentTurn","parseFloat","ReplayGame","TutorialScreen0","onNext","TutorialScreen1","TutorialScreen2","TutorialScreen3","Tutorial","setCurrentScreen","goToNextScreen","Router","gameReady","setGameReady","currentScreenName","allScreens","screenName","screens","Component","TransitionGroup","CSSTransition","toString","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","App","restoreSavedConfig","Boolean","location","hostname","match","ReactDOM","render","getElementById","setVH","vh","innerHeight","documentElement","debounce","addVHCSSVar","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.c69c8c9a.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFYWFhAAAAQQerqwAAAAJ0Uk5T/wDltzBKAAAAFklEQVR4nGNggIH6/2DwYJQx0hkwAABHzKo6mLcE9gAAAABJRU5ErkJggg==\"","export default class {\n    constructor({ timeToWait = 10000, started = false }) {\n        this._timeToWait = timeToWait;\n        this._isRunning = started;\n        this._elapsedTime = 0;\n    }\n\n    setTimeToWait(timeToWait = 10000) {\n        if (timeToWait <= 0) {\n            this._timeToWait = Number.MAX_VALUE;\n        }\n    }\n\n    notifyTimePassed(time) {\n        if (!this._isRunning) {\n            return;\n        }\n        this._elapsedTime += time;\n        if (this._elapsedTime >= this._timeToWait) {\n            this._callbackOnEnd(this._timeToWait - this._elapsedTime);\n            this._isRunning = false;\n        }\n    }\n\n    restart({ callbackOnEnd = () => {} }) {\n        this._elapsedTime = 0;\n        this._isRunning = true;\n        this._callbackOnEnd = callbackOnEnd;\n    }\n\n    pause() {\n        this._isRunning = false;\n    }\n\n    unpause() {\n        this._isRunning = true;\n    }\n\n    stop() {\n        this._isRunning = false;\n        this._callbackOnEnd = null;\n    }\n\n    reset() {\n        this._elapsedTime = 0;\n        this._isRunning = false;\n        this._callbackOnEnd = null;\n    }\n\n    getTimeLeft() {\n        return Math.max(this._timeToWait - this._elapsedTime, 0);\n    }\n\n    getTimePassed() {\n        return this._elapsedTime;\n    }\n}\n","import { TIME_FOR_USER_TO_PICK_POSITION } from 'constants/ux';\nimport Counter from './Counter';\n\nconst counter = new Counter({ timeToWait: TIME_FOR_USER_TO_PICK_POSITION });\n\nexport default counter;\n","export const TIME_FOR_USER_TO_PICK_POSITION = 30999; // ms\nexport const TIME_SHOWING_RANDOM_SELECTOR = 3000; // ms\nexport const SWITCH_RANDOM_SELECTION_EVERY = 100; // ms\nexport const WAIT_AFTER_AI_COLLISION = 2000;\nexport const WAIT_AFTER_AI_GROUNDED = 2000;\n","let initted = false;\nlet delta = 0;\nlet lastFrameTimeMs = 0;\n// We want to simulate 1000 ms / 60 FPS = 16.667 ms per frame every time we run update()\nconst timestep = 1000 / 60;\n\nfunction gameLoop(timestamp) {\n    delta += timestamp - lastFrameTimeMs;\n    lastFrameTimeMs = timestamp;\n\n    // Simulate the total elapsed time in fixed-size chunks\n    while (delta >= timestep) {\n        update(timestep);\n        delta -= timestep;\n    }\n    requestAnimationFrame(gameLoop);\n}\n\nlet callbacksToUpdate = [];\n\nfunction update(timeDiff) {\n    callbacksToUpdate.forEach((callback) => callback(timeDiff));\n}\n\nexport const init = () => {\n    if (!initted) {\n        requestAnimationFrame(gameLoop);\n        initted = true;\n    }\n};\n\nexport const removeFromUpdate = (callback) => {\n    callbacksToUpdate = callbacksToUpdate.filter(\n        (eachCallback) => callback !== eachCallback,\n    );\n};\n\nexport const addToUpdate = (callback) => {\n    callbacksToUpdate = callbacksToUpdate.concat([callback]);\n    return () => {\n        removeFromUpdate(callback);\n    };\n};\n","export const HUMAN = 'HUMAN';\nexport const AI = 'AI';\n","export const clamp = (x, min = 0, max = 1) => {\n    return Math.max(Math.min(x, max), min);\n};\n","import { clamp } from './clamp';\n\nexport const add = (v1, v2) => {\n    return { x: v1.x + v2.x, y: v1.y + v2.y };\n};\n\nexport const substract = (v1, v2) => {\n    return { x: v1.x - v2.x, y: v1.y - v2.y };\n};\n\nexport const scale = (v1, factor) => {\n    return { x: v1.x * factor, y: v1.y * factor };\n};\n\nexport const isEqual = (v1, v2) => {\n    return v1.x === v2.x && v1.y === v2.y;\n};\n\nexport const magnitude = (v) => {\n    return Math.sqrt(v.x ** 2 + v.y ** 2);\n};\n\nexport const distance = (v1, v2) => {\n    return magnitude(substract(v1, v2));\n};\n\nexport const round = (v1) => {\n    return { x: Math.round(v1.x), y: Math.round(v1.y) };\n};\n\nexport const isInsideViewport = (vector, viewport, padding) => {\n    return (\n        vector.x >= viewport.topLeft.x + padding.x &&\n        vector.x <= viewport.topLeft.x + viewport.size.width - padding.x &&\n        vector.y >= viewport.topLeft.y + padding.y &&\n        vector.y <= viewport.topLeft.y + viewport.size.height - padding.y\n    );\n};\n\nexport const getClosestPointInsideViewport = (vector, viewport, padding) => {\n    const minX = viewport.topLeft.x + padding.x;\n    const maxX = viewport.topLeft.x + viewport.size.width - padding.x;\n    const minY = viewport.topLeft.y + padding.y;\n    const maxY = viewport.topLeft.y + viewport.size.height - padding.y;\n    return {\n        x: clamp(vector.x, minX, maxX),\n        y: clamp(vector.y, minY, maxY),\n    };\n};\n","import { substract, magnitude, distance } from 'utils/vector2d';\n\nexport const movePlayerTo = (player, position, timePassed) => {\n    const newSpeed = substract(position, player.position);\n    const speedMagnitude = magnitude(newSpeed);\n\n    return {\n        ...player,\n        position,\n        speed: newSpeed,\n        prevPositions: player.prevPositions.concat(position),\n        turnsSpent: player.turnsSpent + 1,\n        maxSpeed: Math.max(speedMagnitude, player.maxSpeed),\n        realTimeUsed: player.realTimeUsed + timePassed,\n    };\n};\n\nexport const crashPlayer = (player, speed, timePassed) => {\n    const newSpeed = { x: 0, y: 0 };\n    const turnsGrounded = Math.floor(speed / 3);\n    return {\n        ...player,\n        speed: newSpeed,\n        turnsGrounded,\n        crashes: player.crashes + 1,\n        turnsSpent: player.turnsSpent + 1,\n        realTimeUsed: player.realTimeUsed + timePassed,\n    };\n};\n\nexport const reduceGrounded = (player) => {\n    return {\n        ...player,\n        turnsGrounded: Math.max(0, player.turnsGrounded - 1),\n        turnsSpent: player.turnsSpent + 1,\n    };\n};\n\nexport const addCheckpoints = (player, newIndexes) => {\n    const newCheckpoints = player.checkpointsPassed.slice();\n    newIndexes.sort().forEach((newIndex) => {\n        // Only do checkpoints in correct order.\n        if (newIndex === 0 || newCheckpoints[newIndex - 1]) {\n            newCheckpoints[newIndex] = true;\n        }\n    });\n    return {\n        ...player,\n        checkpointsPassed: newCheckpoints,\n    };\n};\n\nexport const doesPlayerHaveRepeatedPositions = (player) => {\n    const positionHash = {};\n    // eslint-disable-next-line no-restricted-syntax\n    for (const position of player.prevPositions) {\n        const id = `${position.x}_${position.y}`;\n        if (positionHash[id]) {\n            return true;\n        }\n        positionHash[id] = true;\n    }\n    return false;\n};\n\nexport const getAverageSpeed = (player) => {\n    if (!player.prevPositions.length) {\n        return 0;\n    }\n    let totalDistance = 0;\n    for (let i = 0; i < player.prevPositions.length - 1; i += 1) {\n        const point = player.prevPositions[i];\n        const nextPoint = player.prevPositions[i + 1];\n        totalDistance += distance(point, nextPoint);\n    }\n    return totalDistance / player.prevPositions.length;\n};\n\nexport const getCheckpointsPassed = (player) => {\n    let result = 0;\n    for (let i = 0; i < player.checkpointsPassed.length - 1; i += 1) {\n        if (!player.checkpointsPassed[i]) {\n            break;\n        }\n        result += 1;\n    }\n    return result;\n};\n\nexport const hasPlayerFinishedRace = (player) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const checkpoint of player.checkpointsPassed) {\n        if (!checkpoint) {\n            return false;\n        }\n    }\n    return true;\n};\n","export const actionTypes = {\n    MOVE_TO: 'MOVE_TO',\n    SET_PLAYERS: 'SET_PLAYERS',\n    NOTIFY_COLLISION: 'NOTIFY_COLLISION',\n    REDUCE_GROUNDED: 'REDUCE_GROUNDED',\n    NOTIFY_VISITED_CHECKPOINTS: 'NOTIFY_VISITED_CHECKPOINTS',\n};\n\nexport const moveTo = (playerId, position, timePassed) => {\n    return {\n        type: actionTypes.MOVE_TO,\n        playerId,\n        position,\n        timePassed,\n    };\n};\n\nexport const notifyCollision = (playerId, speed, timePassed) => {\n    return {\n        type: actionTypes.NOTIFY_COLLISION,\n        playerId,\n        speed,\n        timePassed,\n    };\n};\n\nexport const setPlayers = (players) => {\n    return {\n        type: actionTypes.SET_PLAYERS,\n        players,\n    };\n};\n\nexport const reduceGrounded = (playerId) => {\n    return {\n        type: actionTypes.REDUCE_GROUNDED,\n        playerId,\n    };\n};\n\nexport const notifyVisitedCheckpoints = (playerId, newCheckpointIndexes) => {\n    return {\n        type: actionTypes.NOTIFY_VISITED_CHECKPOINTS,\n        playerId,\n        newCheckpointIndexes,\n    };\n};\n","import { combineReducers } from 'redux';\nimport { HUMAN } from 'constants/player-types';\nimport {\n    movePlayerTo,\n    crashPlayer,\n    reduceGrounded,\n    addCheckpoints,\n} from 'utils/player';\nimport { actionTypes } from './actions';\n\nconst players = combineReducers({\n    byId,\n});\n\nconst PLAYER_DEFAULT_INFO = {\n    position: { x: 0, y: 0 },\n    speed: { x: 0, y: 0 },\n    prevPositions: [],\n    turnsGrounded: 0,\n    checkpointsPassed: [false],\n    turnsSpent: 0,\n    realTimeUsed: 0,\n    maxSpeed: 0,\n    crashes: 0,\n    type: HUMAN,\n    levelAI: 0,\n};\n\nfunction byId(state = {}, action) {\n    switch (action.type) {\n        case actionTypes.SET_PLAYERS:\n            return action.players.reduce((accumulator, player) => {\n                return {\n                    ...accumulator,\n                    [player.id]: {\n                        ...PLAYER_DEFAULT_INFO,\n                        ...player,\n                    },\n                };\n            }, {});\n        case actionTypes.MOVE_TO:\n            return {\n                ...state,\n                [action.playerId]: movePlayerTo(\n                    state[action.playerId],\n                    action.position,\n                    action.timePassed,\n                ),\n            };\n        case actionTypes.NOTIFY_COLLISION:\n            return {\n                ...state,\n                [action.playerId]: crashPlayer(\n                    state[action.playerId],\n                    action.speed,\n                    action.timePassed,\n                ),\n            };\n\n        case actionTypes.REDUCE_GROUNDED:\n            return {\n                ...state,\n                [action.playerId]: reduceGrounded(state[action.playerId]),\n            };\n        case actionTypes.NOTIFY_VISITED_CHECKPOINTS:\n            return {\n                ...state,\n                [action.playerId]: addCheckpoints(\n                    state[action.playerId],\n                    action.newCheckpointIndexes,\n                ),\n            };\n        default:\n            return state;\n    }\n}\n\nexport default players;\n","import { combineReducers } from 'redux';\n\nconst zoom = (state = 2, action) => {\n    switch (action.type) {\n        default:\n            return state;\n    }\n};\n\nconst gridSize = (state = 10, action) => {\n    switch (action.type) {\n        default:\n            return state;\n    }\n};\n\nconst map = combineReducers({\n    zoom,\n    gridSize,\n});\n\nexport default map;\n","export const MAIN_MENU = Symbol('MAIN_MENU');\nexport const GAME = Symbol('GAME');\nexport const CIRCUIT_SELECTION = Symbol('CIRCUIT_SELECTION');\nexport const PLAYERS_SELECTION = Symbol('PLAYERS_SELECTION');\nexport const HIGH_SCORES = Symbol('HIGH_SCORES');\nexport const CREDITS = Symbol('CREDITS');\nexport const LOADING_GAME = Symbol('LOADING_GAME');\nexport const REPLAY_GAME = Symbol('REPLAY_GAME');\nexport const TUTORIAL = Symbol('TUTORIAL');\n","export const CAR = {\n    id: 'car',\n    name: 'car',\n    dotColor: '#e4223c',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#e4223c',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/car.png`,\n};\n\nexport const ROCKET = {\n    id: 'rocket',\n    name: 'rocket',\n    dotColor: '#39c3b6',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#39c3b6',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/rocket.png`,\n};\n\nexport const TURTLE = {\n    id: 'turtle',\n    name: 'turtle',\n    dotColor: '#43c830',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#43c830',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/turtle.png`,\n};\n\nexport const SKULL = {\n    id: 'skull',\n    name: 'skull',\n    dotColor: '#9a9e9f',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#9a9e9f',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/skull.png`,\n};\n\nexport const CLOWN = {\n    id: 'clown',\n    name: 'clown',\n    dotColor: '#fdfffc',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#fdfffc',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/clown.png`,\n};\n\nexport const DANCER = {\n    id: 'dancer',\n    name: 'dancer',\n    dotColor: '#5c0eab',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#5c0eab',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/dancer.png`,\n};\n\nexport const PANDA = {\n    id: 'panda',\n    name: 'panda',\n    dotColor: '#212121',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#212121',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/panda.png`,\n};\n\nexport const COFFIN = {\n    id: 'coffin',\n    name: 'coffin',\n    dotColor: '#ad7222',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#ad7222',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/coffin.png`,\n};\n\nexport const BROOM = {\n    id: 'broom',\n    name: 'broom',\n    dotColor: '#c5db0f',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#c5db0f',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/broom.png`,\n};\n\nexport const SAILBOAT = {\n    id: 'sailboat',\n    name: 'sailboat',\n    dotColor: '#016fdf',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#016fdf',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/sailboat.png`,\n};\n\nexport const STYLES = {\n    [CAR.id]: CAR,\n    [ROCKET.id]: ROCKET,\n    [TURTLE.id]: TURTLE,\n    [SKULL.id]: SKULL,\n    [CLOWN.id]: CLOWN,\n    [DANCER.id]: DANCER,\n    [PANDA.id]: PANDA,\n    [COFFIN.id]: COFFIN,\n    [BROOM.id]: BROOM,\n    [SAILBOAT.id]: SAILBOAT,\n};\n","export const pickRandomFromArray = (array) => {\n    if (!array || !array.length) {\n        return null;\n    }\n    const randomIndex = Math.floor(Math.random() * array.length);\n    return array[randomIndex];\n};\n\nexport const keepPickingUntilNotInArray = (\n    pickerFn,\n    arrayToAvoid,\n    maxTries = 10000,\n) => {\n    for (let i = 0; i < maxTries; i += 1) {\n        const newPick = pickerFn();\n        if (arrayToAvoid.indexOf(newPick) === -1) {\n            return newPick;\n        }\n    }\n    throw new Error(\n        `keepPickingUntilNotInArray: tried ${maxTries} times, no luck`,\n    );\n};\n\nexport const getRandomInRange = (min, max) => {\n    return min + Math.random() * (max - min);\n};\n","import { pickRandomFromArray } from './random';\n\nconst FIRST_NAMES = [\n    'Max',\n    'Carlitros',\n    'Michael',\n    'Fernando',\n    'Lolín',\n    'Esquizo',\n    'Agapito',\n    'Tolomeo',\n];\n\nconst LAST_NAMES = [\n    'Cucaracha',\n    'Aubergine',\n    'Tentacles',\n    'Rex',\n    'Danger',\n    'Senna',\n    'Alonso',\n    'Schumacher',\n    'Jander',\n];\n\nexport const getRandomName = () => {\n    return `${pickRandomFromArray(FIRST_NAMES)} ${pickRandomFromArray(\n        LAST_NAMES,\n    )}`;\n};\n","export const actionTypes = {\n    CHANGE_SCREEN: 'CHANGE_SCREEN',\n    SET_SELECTED_CIRCUIT: 'SET_SELECTED_CIRCUIT',\n    SET_SELECTED_PLAYERS: 'SET_SELECTED_PLAYERS',\n    REMOVE_PLAYER: 'REMOVE_PLAYER',\n    UPDATE_PLAYER: 'UPDATE_PLAYER',\n    TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:\n        'TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START',\n    TOGGLE_PLAY_WITH_TIMER: 'TOGGLE_PLAY_WITH_TIMER',\n};\nexport const changeScreen = (screenId) => {\n    return {\n        type: actionTypes.CHANGE_SCREEN,\n        screenId,\n    };\n};\nexport const setSelectedCircuit = (circuitId) => {\n    return {\n        type: actionTypes.SET_SELECTED_CIRCUIT,\n        circuitId,\n    };\n};\n\nexport const setSelectedPlayers = (players, playerOrder) => {\n    return {\n        type: actionTypes.SET_SELECTED_PLAYERS,\n        players,\n        playerOrder,\n    };\n};\n\nexport const removePlayer = (playerId) => {\n    return {\n        type: actionTypes.REMOVE_PLAYER,\n        playerId,\n    };\n};\n\nexport const updatePlayer = (playerId, attrsToUpdate) => {\n    return {\n        type: actionTypes.UPDATE_PLAYER,\n        playerId,\n        attrsToUpdate,\n    };\n};\n\nexport const toggleRandomizePlayerOrderOnStart = () => {\n    return {\n        type: actionTypes.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START,\n    };\n};\n\nexport const togglePlayWithTimer = () => {\n    return {\n        type: actionTypes.TOGGLE_PLAY_WITH_TIMER,\n    };\n};\n","import { combineReducers } from 'redux';\nimport { MAIN_MENU } from 'constants/screens';\nimport { STYLES } from 'constants/player-styles';\nimport { getRandomName } from 'utils/getRandomName';\nimport { pickRandomFromArray } from 'utils/random';\nimport { HUMAN } from 'constants/player-types';\nimport { actionTypes } from './actions';\n\nconst currentScreen = (state = MAIN_MENU, action) => {\n    switch (action.type) {\n        case actionTypes.CHANGE_SCREEN:\n            return action.screenId;\n        default:\n            return state;\n    }\n};\n\nconst selectedCircuit = (state = null, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_CIRCUIT:\n            return action.circuitId;\n        default:\n            return state;\n    }\n};\n\nconst initialPlayers = [\n    {\n        id: 'DEFAULT_PLAYER',\n        name: getRandomName(),\n        style: pickRandomFromArray(Object.values(STYLES)),\n        type: HUMAN,\n        levelAI: 0,\n    },\n];\n\nconst selectedPlayers = (state = initialPlayers, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_PLAYERS:\n            return action.players;\n        case actionTypes.REMOVE_PLAYER:\n            return state.filter((player) => player.id !== action.playerId);\n        case actionTypes.UPDATE_PLAYER:\n            return state.map((player) => {\n                if (player.id !== action.playerId) {\n                    return player;\n                }\n                return {\n                    ...player,\n                    ...action.attrsToUpdate,\n                };\n            });\n        default:\n            return state;\n    }\n};\n\nconst defaultOrder = ['DEFAULT_PLAYER'];\nconst selectedPlayerOrder = (state = defaultOrder, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_PLAYERS:\n            return action.playerOrder;\n        case actionTypes.REMOVE_PLAYER:\n            return state.filter((playerId) => playerId !== action.playerId);\n        default:\n            return state;\n    }\n};\n\nconst randomizePlayerOrderOnStart = (state = true, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:\n            return !state;\n        default:\n            return state;\n    }\n};\n\nconst playWithTimer = (state = false, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_PLAY_WITH_TIMER:\n            return !state;\n        default:\n            return state;\n    }\n};\n\nconst mainUI = combineReducers({\n    currentScreen,\n    selectedCircuit,\n    selectedPlayerOrder,\n    selectedPlayers,\n    randomizePlayerOrderOnStart,\n    playWithTimer,\n});\n\nexport default mainUI;\n","export const NOT_STARTED = Symbol('NOT_STARTED');\nexport const START_SCREEN = Symbol('START_SCREEN');\nexport const PLAYER_TURN_START_SCREEN = Symbol('PLAYER_TURN_START_SCREEN');\nexport const WAITING_FOR_PLAYER_INPUT = Symbol('WAITING_FOR_PLAYER_INPUT');\nexport const ANIMATING_PLAYER_MOVEMENT = Symbol('ANIMATING_PLAYER_MOVEMENT');\nexport const ANIMATING_RANDOM_PLAYER_MOVEMENT = Symbol(\n    'ANIMATING_RANDOM_PLAYER_MOVEMENT',\n);\nexport const NOTIFY_COLLISION = Symbol('NOTIFY_COLLISION');\nexport const NOTIFY_AI_COLLISION = Symbol('NOTIFY_AI_COLLISION');\nexport const NOTIFY_GROUNDED = Symbol('NOTIFY_GROUNDED');\nexport const NOTIFY_AI_GROUNDED = Symbol('NOTIFY_AI_GROUNDED');\nexport const NOTIFY_VICTORY = Symbol('NOTIFY_VICTORY');\nexport const NOTIFY_HIGH_SCORE = Symbol('NOTIFY_HIGH_SCORE');\nexport const SHOW_MENU = Symbol('SHOW_MENU');\nexport const AI_THINKING_SCREEN = Symbol('AI_THINKING_SCREEN');\n","export const actionTypes = {\n    INIT_GAME: 'INIT_GAME',\n    INIT_REPLAY: 'INIT_REPLAY',\n    SET_GAME_STATE: 'SET_GAME_STATE',\n    ADVANCE_PLAYER_TURN: 'ADVANCE_PLAYER_TURN',\n    SET_CIRCUIT: 'SET_CIRCUIT',\n    SET_LATEST_HIGH_SCORE: 'SET_LATEST_HIGH_SCORE',\n    SET_SELECTED_POSITION: 'SET_SELECTED_POSITION',\n    SET_SELECTED_AI_MOVE: 'SET_SELECTED_AI_MOVE',\n};\nexport const initGame = (playerOrder, circuitInfo) => {\n    return {\n        type: actionTypes.INIT_GAME,\n        playerOrder,\n        circuitInfo,\n    };\n};\n\nexport const initReplay = (raceHistory, circuitInfo) => {\n    return {\n        type: actionTypes.INIT_REPLAY,\n        raceHistory,\n        circuitInfo,\n    };\n};\n\nexport const setGameState = (newGameState) => {\n    return {\n        type: actionTypes.SET_GAME_STATE,\n        newGameState,\n    };\n};\n\nexport const advancePlayerTurn = () => {\n    return {\n        type: actionTypes.ADVANCE_PLAYER_TURN,\n    };\n};\n\nexport const setLatestHighScore = (highScore) => {\n    return {\n        type: actionTypes.SET_LATEST_HIGH_SCORE,\n        highScore,\n    };\n};\n\nexport const setSelectedPosition = (newPosition) => {\n    return {\n        type: actionTypes.SET_SELECTED_POSITION,\n        newPosition,\n    };\n};\n\nexport const setSelectedAIMove = (newMove) => {\n    return {\n        type: actionTypes.SET_SELECTED_AI_MOVE,\n        newMove,\n    };\n};\n","import * as gameStates from 'constants/game-states';\nimport { actionTypes } from './actions';\n\nconst defaultState = {\n    gameState: gameStates.NOT_STARTED,\n    prevGameState: null, // We store one game state previous to the current so we can go back after pausing\n    players: [],\n    currentTurnPlayerId: null,\n    circuitInfo: null,\n    latestHighScore: null, // If somebody achived a high score, it will be stored here until the next game starts\n    selectedPosition: null, // When we use a touch interface we can store the position that has been selected before confirming the move\n    raceHistory: null, // Used when replaying a game\n    selectedAIMove: null, // When AI selects a move, we show it briefly before moving the player\n};\n\nconst game = (state = defaultState, action) => {\n    switch (action.type) {\n        case actionTypes.INIT_GAME:\n            return {\n                ...state,\n                gameState: gameStates.START_SCREEN,\n                currentTurnPlayerId: action.playerOrder[0],\n                players: action.playerOrder.slice(),\n                circuitInfo: { ...action.circuitInfo },\n                latestHighScore: null,\n                selectedPosition: null,\n                selectedAIMove: null,\n            };\n        case actionTypes.INIT_REPLAY:\n            return {\n                ...state,\n                gameState: gameStates.START_SCREEN,\n                circuitInfo: { ...action.circuitInfo },\n                raceHistory: action.raceHistory,\n            };\n        case actionTypes.ADVANCE_PLAYER_TURN:\n            return {\n                ...state,\n                currentTurnPlayerId: getNextTurn(\n                    state.players,\n                    state.currentTurnPlayerId,\n                ),\n                selectedPosition: null,\n                selectedAIMove: null,\n            };\n        case actionTypes.SET_GAME_STATE:\n            return {\n                ...state,\n                gameState: action.newGameState,\n                prevGameState: state.gameState,\n            };\n        case actionTypes.SET_LATEST_HIGH_SCORE:\n            return {\n                ...state,\n                latestHighScore: action.highScore,\n            };\n        case actionTypes.SET_SELECTED_POSITION:\n            return {\n                ...state,\n                selectedPosition: action.newPosition,\n            };\n        case actionTypes.SET_SELECTED_AI_MOVE:\n            return {\n                ...state,\n                selectedAIMove: action.newMove,\n            };\n\n        default:\n            return state;\n    }\n};\n\nexport default game;\n\nfunction getNextTurn(players, currentPlayer) {\n    const currentTurnPlayerId = players.indexOf(currentPlayer);\n    const nextTurn = (currentTurnPlayerId + 1) % players.length;\n    return players[nextTurn];\n}\n","import { combineReducers } from 'redux';\nimport players from './players/reducer';\nimport map from './map/reducer';\nimport mainUI from './main-ui/reducer';\nimport game from './game/reducer';\n\nexport default combineReducers({\n    players,\n    map,\n    mainUI,\n    game,\n});\n","export const storeSavedPlayers = (playerOrder, players) => {\n    if (!window.localStorage) {\n        return;\n    }\n    const playersInfoToStore = {\n        version: window.capac_racer_version,\n        playerOrder,\n        players,\n    };\n    try {\n        window.localStorage.setItem(\n            'players',\n            JSON.stringify(playersInfoToStore),\n        );\n    } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn(`Error trying to save localStorage`, e);\n    }\n};\n\nexport const getSavedPlayers = () => {\n    if (!window.localStorage) {\n        return null;\n    }\n    let result;\n    try {\n        result = window.localStorage.getItem('players');\n    } catch (e) {\n        return null;\n    }\n\n    if (!result) {\n        return null;\n    }\n\n    // At some point we may need to check if versions are compatible\n    return JSON.parse(result);\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction Logo({ variant }) {\n    return (\n        <div className={`logo logo-${variant}`}>\n            <div className=\"logo-up\">Capac</div>\n            <div className=\"logo-down\">Racer</div>\n        </div>\n    );\n}\n\nLogo.propTypes = {\n    variant: PropTypes.oneOf(['big', 'small']),\n};\n\nLogo.defaultProps = {\n    variant: 'big',\n};\n\nexport default Logo;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport {\n    CIRCUIT_SELECTION,\n    HIGH_SCORES,\n    CREDITS,\n    TUTORIAL,\n} from 'constants/screens';\nimport Logo from 'components/Logo';\n\nimport './style.css';\n\nconst MainMenu = ({ className }) => {\n    const dispatch = useDispatch();\n    return (\n        <div className={classNames('full-screen', className)}>\n            <div className=\"main-menu-content\">\n                <div className=\"transition-from-left\">\n                    <Logo />\n                </div>\n\n                <div className=\"main-menu-buttons transition-from-right\">\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() =>\n                            dispatch(changeScreen(CIRCUIT_SELECTION))\n                        }\n                    >\n                        Start new game\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(TUTORIAL))}\n                    >\n                        How to play\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(HIGH_SCORES))}\n                    >\n                        High scores\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(CREDITS))}\n                    >\n                        Credits\n                    </button>\n                </div>\n            </div>\n            <div className=\"app-version\">v{window.capac_racer_version}</div>\n        </div>\n    );\n};\n\nexport default MainMenu;\n","export const getScreenCoordinates = (worldPosition, gridSize, mapZoom) => {\n    const project = (n) => {\n        if (typeof n === 'number') {\n            return n * gridSize * mapZoom;\n        }\n        return n;\n    };\n\n    return {\n        x: project(worldPosition.x),\n        y: project(worldPosition.y),\n        dx: project(worldPosition.dx),\n        dy: project(worldPosition.dy),\n        baseX: project(worldPosition.baseX),\n        baseY: project(worldPosition.baseY),\n    };\n};\n","import { getScreenCoordinates } from 'utils/screenUtils';\n\nexport const projectToScreenPosition = (state, worldPosition) => {\n    if (!worldPosition) {\n        return worldPosition;\n    }\n    const mapZoom = state.map.zoom;\n    const mapGridSize = state.map.gridSize;\n    return getScreenCoordinates(worldPosition, mapGridSize, mapZoom);\n};\n","import { isEqual } from 'utils/vector2d';\n\nconst DISTANCE_TO_MOVE = 1;\n\nexport const getPossibleDestinations = (player, otherPlayers) => {\n    const positionAfterSpeed = {\n        x: player.position.x + player.speed.x,\n        y: player.position.y + player.speed.y,\n    };\n    const positions = [];\n    for (let i = -DISTANCE_TO_MOVE; i <= DISTANCE_TO_MOVE; i += 1) {\n        for (let j = -DISTANCE_TO_MOVE; j <= DISTANCE_TO_MOVE; j += 1) {\n            positions.push({\n                baseX: positionAfterSpeed.x,\n                baseY: positionAfterSpeed.y,\n                x: positionAfterSpeed.x + i,\n                y: positionAfterSpeed.y + j,\n                dx: i,\n                dy: j,\n            });\n        }\n    }\n    return positions.filter(\n        (position) => !isPositionColliding(position, otherPlayers),\n    );\n};\n\nfunction isPositionColliding(position, otherPlayers) {\n    return !!otherPlayers\n        .map((player) => player.position)\n        .find((otherPosition) => isEqual(otherPosition, position));\n}\n","import * as gameStates from 'constants/game-states';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { getPossibleDestinations } from 'store/players/selectors';\n\nexport const isGameStarted = (state) => {\n    return state.game.gameState !== gameStates.NOT_STARTED;\n};\n\nexport const isWaitingForPlayerInput = (state) => {\n    return state.game.gameState === gameStates.WAITING_FOR_PLAYER_INPUT;\n};\n\nexport const isAnimatingRandomSelection = (state) => {\n    return state.game.gameState === gameStates.ANIMATING_RANDOM_PLAYER_MOVEMENT;\n};\n\nexport const isAnimatingAISelection = (state) => {\n    return state.game.gameState === gameStates.AI_THINKING_SCREEN;\n};\n\nexport const getAISelectedMove = (state) => {\n    return state.game.selectedAIMove;\n};\n\nexport const getCurrentPlayer = (state) => {\n    if (!isGameStarted(state)) {\n        return null;\n    }\n    return state.players.byId[state.game.currentTurnPlayerId];\n};\n\nexport const getAllPlayers = (state) => {\n    return state.game.players.map((playerId) => state.players.byId[playerId]);\n};\n\nexport const getOtherPlayers = (state, playerId) => {\n    return getAllPlayers(state).filter((player) => player.id !== playerId);\n};\n\nexport const getOtherPlayersPositionInScreen = (state, playerId) => {\n    return getOtherPlayers(state, playerId)\n        .map((player) => player.position)\n        .map((position) => projectToScreenPosition(state, position));\n};\n\nexport const getGameState = (state) => {\n    return state.game.gameState;\n};\n\nexport const hasCurrentPlayerWon = (state) => {\n    const currentPlayer = getCurrentPlayer(state);\n    // eslint-disable-next-line no-restricted-syntax\n    for (const checkpointHasPassed of currentPlayer.checkpointsPassed) {\n        if (!checkpointHasPassed) {\n            return false;\n        }\n    }\n    return true;\n};\n\nexport const getOrderedPlayers = (state) => {\n    const playerOrder = state.mainUI.selectedPlayerOrder;\n    const players = state.mainUI.selectedPlayers;\n    return playerOrder.map((playerId) =>\n        players.find((player) => player.id === playerId),\n    );\n};\n\nexport const getPossibleDestinationsForPlayerInScreen = (state, player) => {\n    const otherPlayers = getAllPlayers(state).filter(\n        (otherPlayer) => otherPlayer.id !== player.id,\n    );\n\n    return getPossibleDestinations(player, otherPlayers).map((eachPosition) => {\n        return {\n            screen: projectToScreenPosition(state, eachPosition),\n            position: eachPosition,\n        };\n    });\n};\n\nexport const getMovedPixelsSinceLastTurn = (state, player) => {\n    if (!player.prevPositions.length || player.prevPositions.length < 2) {\n        return null;\n    }\n    const lastPosition = player.prevPositions[player.prevPositions.length - 2];\n    const moved = {\n        x: lastPosition.x - player.position.x,\n        y: lastPosition.y - player.position.y,\n    };\n    return projectToScreenPosition(state, moved);\n};\n\nexport const getPivotForPlayerInScreen = (state, player) => {\n    const positionAfterSpeed = {\n        x: player.position.x + player.speed.x,\n        y: player.position.y + player.speed.y,\n    };\n    return projectToScreenPosition(state, positionAfterSpeed);\n};\n\nexport const getLatestHighScore = (state) => {\n    return state.game.latestHighScore;\n};\n\nexport const getSelectedPosition = (state) => {\n    return state.game.selectedPosition;\n};\n\nexport const getRaceHistory = (state) => {\n    return state.game.raceHistory;\n};\n","export const circuits = {\n    mouth: {\n        id: 'mouth',\n        name: 'Mouth',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit1/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit1/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp8.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp9.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 37,\n                y: 22,\n            },\n            {\n                x: 37,\n                y: 23,\n            },\n            {\n                x: 37,\n                y: 24,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: 0,\n        },\n    },\n    heart: {\n        id: 'heart',\n        name: 'Heart',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit2/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit2/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp7.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 37,\n                y: 28,\n            },\n            {\n                x: 36,\n                y: 27,\n            },\n            {\n                x: 35,\n                y: 26,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: -2,\n        },\n    },\n    rosco: {\n        id: 'rosco',\n        name: 'Rosco',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit3/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit3/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp8.png`,\n        ],\n        maxPlayers: 4,\n        startingPositions: [\n            {\n                x: 33,\n                y: 34,\n            },\n            {\n                x: 33,\n                y: 33,\n            },\n            {\n                x: 33,\n                y: 32,\n            },\n            {\n                x: 33,\n                y: 35,\n            },\n        ],\n        initialSpeed: {\n            x: -2,\n            y: 0,\n        },\n    },\n    horse: {\n        id: 'horse',\n        name: 'Horse',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit4/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit4/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp8.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp9.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp10.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp11.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp12.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp13.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp14.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp15.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp16.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp17.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp18.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp19.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 26,\n                y: 31,\n            },\n            {\n                x: 26,\n                y: 32,\n            },\n            {\n                x: 26,\n                y: 33,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: 0,\n        },\n    },\n};\n","export const loadImage = (url) => {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        const onLoad = () => {\n            resolve(img);\n        };\n        const onError = (error) => {\n            reject(error);\n        };\n        img.addEventListener('load', onLoad, { once: true });\n        img.addEventListener('error', onError, { once: true });\n        img.src = url;\n    });\n};\n","export const createFromImage = (img) => {\n    const canvas = document.createElement('canvas');\n    const { width, height } = img;\n\n    canvas.width = width;\n    canvas.height = height;\n    canvas.getContext('2d').drawImage(img, 0, 0, width, height);\n\n    const rawData = canvas.getContext('2d').getImageData(0, 0, width, height)\n        .data;\n\n    return {\n        width,\n        height,\n        getPixel: (x, y) => {\n            const basePosition = 4 * (x + y * width);\n\n            return {\n                r: rawData[basePosition + 0],\n                g: rawData[basePosition + 1],\n                b: rawData[basePosition + 2],\n                a: rawData[basePosition + 3],\n            };\n        },\n    };\n};\n","export const hasContent = ({ r, g, b, a }) => {\n    if (a === 0) {\n        return false;\n    }\n    if (r === 255 && g === 255 && b === 255) {\n        return false;\n    }\n\n    return true;\n};\n","/* eslint-disable no-restricted-syntax */\nimport { loadImage } from 'utils/loadImage';\nimport { createFromImage as createPixelGetterFromImage } from 'utils/imgPixelGetter';\nimport {\n    distance,\n    add,\n    scale,\n    substract,\n    round,\n    isEqual,\n} from 'utils/vector2d';\nimport { range } from 'utils/range';\nimport { hasContent } from 'utils/pixel';\nimport { getScreenCoordinates } from 'utils/screenUtils';\n\nexport const createFromConfig = (config) => {\n    const result = {\n        ...config,\n    };\n\n    return loadImage(config.collisionImg)\n        .then((collisionImg) => {\n            result.width = collisionImg.width;\n            result.height = collisionImg.height;\n            return createPixelGetterFromImage(collisionImg);\n        })\n        .then((collisionPixelGetter) => {\n            result.collisionPixelGetter = collisionPixelGetter;\n\n            return Promise.all(\n                config.checkpoints.map((checkpointImg) =>\n                    loadImage(checkpointImg),\n                ),\n            );\n        })\n        .then((loadedCheckpointImages) => {\n            return Promise.all(\n                loadedCheckpointImages.map((checkpointImage) =>\n                    createPixelGetterFromImage(checkpointImage),\n                ),\n            );\n        })\n        .then((checkpointPixelGetters) => {\n            result.checkpointPixelGetters = checkpointPixelGetters;\n            result.centerOfCheckpoints = checkpointPixelGetters.map((cp) =>\n                getCenterOfCheckpoint(cp),\n            );\n            return result;\n        });\n};\n\nexport const doesLineCollide = (line, circuit, otherPlayersPosition) => {\n    const pixelsToCheck = getPixelsToCheck(line).map(round);\n    if (\n        doesAnyPixelCollideInImage(pixelsToCheck, circuit.collisionPixelGetter)\n    ) {\n        return true;\n    }\n    for (const pixelToCheck of pixelsToCheck) {\n        // eslint-disable-next-line no-loop-func\n        const collidesWithOtherPlayer = otherPlayersPosition.find((position) =>\n            isEqual(position, pixelToCheck),\n        );\n        if (collidesWithOtherPlayer) {\n            return true;\n        }\n    }\n    return false;\n};\n\nexport const checkIfPlayerCanMove = ({\n    from,\n    to,\n    circuit,\n    otherPlayers,\n    zoom,\n    gridSize,\n}) => {\n    const movementLine = [\n        getScreenCoordinates(from, gridSize, zoom),\n        getScreenCoordinates(to, gridSize, zoom),\n    ];\n    const otherPlayersPosition = otherPlayers\n        .map((player) => player.position)\n        .map((position) => getScreenCoordinates(position, gridSize, zoom));\n\n    return !doesLineCollide(movementLine, circuit, otherPlayersPosition);\n};\n\nexport const getCheckpointsVisitedInLine = (line, circuit) => {\n    const pixelsToCheck = getPixelsToCheck(line).map(round);\n    return circuit.checkpointPixelGetters\n        .map((checkpointPixelGetter) =>\n            doesAnyPixelCollideInImage(pixelsToCheck, checkpointPixelGetter),\n        )\n        .map((doesItCollide, index) => ({ doesItCollide, index }))\n        .filter(({ doesItCollide }) => !!doesItCollide)\n        .map(({ index }) => index);\n};\n\nexport const getCheckpointsInMovement = ({\n    from,\n    to,\n    circuit,\n    zoom,\n    gridSize,\n}) => {\n    const movementLine = [\n        getScreenCoordinates(from, gridSize, zoom),\n        getScreenCoordinates(to, gridSize, zoom),\n    ];\n    return getCheckpointsVisitedInLine(movementLine, circuit);\n};\n\nexport const getDistanceToNextCheckpoint = ({\n    player,\n    circuit,\n    gridSize,\n    zoom,\n}) => {\n    for (let i = 0; i < player.checkpointsPassed.length; i += 1) {\n        if (!player.checkpointsPassed[i]) {\n            const playerPositionScreen = getScreenCoordinates(\n                player.position,\n                gridSize,\n                zoom,\n            );\n            return distance(\n                playerPositionScreen,\n                circuit.centerOfCheckpoints[i],\n            );\n        }\n    }\n    // All have been visited, so no distance\n    return 0;\n};\n\nexport const getMaxCheckpointDistance = (circuit) => {\n    const checkpoints = circuit.centerOfCheckpoints;\n    const distances = checkpoints.map((cp, index) => {\n        return distance(cp, checkpoints[(index + 1) % checkpoints.length]);\n    });\n    return distances.reduce((acc, eachDistance) => {\n        return Math.max(acc, eachDistance);\n    }, 0);\n};\n\nfunction doesAnyPixelCollideInImage(pixelsToCheck, imagePixelGetter) {\n    for (const pixelToCheck of pixelsToCheck) {\n        const pixelInCollisionMap = imagePixelGetter.getPixel(\n            pixelToCheck.x,\n            pixelToCheck.y,\n        );\n        if (hasContent(pixelInCollisionMap)) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction getPixelsToCheck([start, end]) {\n    const lineLength = distance(start, end);\n    const nPixelsToCheck = Math.ceil(lineLength * 2);\n    if (nPixelsToCheck < 2) {\n        return [];\n    }\n    const diffVector = substract(end, start);\n    const result = range(nPixelsToCheck).map((index) => {\n        const factor = index / (nPixelsToCheck - 1);\n        return add(start, scale(diffVector, factor));\n    });\n\n    return result;\n}\n\nfunction getCenterOfCheckpoint(checkpoint) {\n    const pixelsToCheck = [];\n    for (let i = 0; i < checkpoint.width; i += 1) {\n        for (let j = 0; j < checkpoint.height; j += 1) {\n            if (hasContent(checkpoint.getPixel(i, j))) {\n                pixelsToCheck.push([i, j]);\n            }\n        }\n    }\n    if (!pixelsToCheck.length) {\n        return null;\n    }\n\n    const resultArray = pixelsToCheck.reduce(\n        (acc, pixel) => {\n            return [\n                acc[0] + pixel[0] / pixelsToCheck.length,\n                acc[1] + pixel[1] / pixelsToCheck.length,\n            ];\n        },\n        [0, 0],\n    );\n\n    return { x: resultArray[0], y: resultArray[1] };\n}\n","export const range = (size) => {\n    return [...Array(size).keys()];\n};\n","import Counter from 'utils/Counter';\nimport {\n    addToUpdate as addToGameLoopUpdate,\n    removeFromUpdate as removeFromGameLoopUpdate,\n} from 'utils/gameLoop';\n\nexport const timeout = (timeMs = 1000) => {\n    return new Promise((resolve) => {\n        const counter = new Counter({ timeToWait: timeMs });\n        const notifyPassOfTime = (time) => {\n            counter.notifyTimePassed(time);\n        };\n        addToGameLoopUpdate(notifyPassOfTime);\n        counter.restart({\n            callbackOnEnd: () => {\n                removeFromGameLoopUpdate(notifyPassOfTime);\n                counter.stop();\n                resolve();\n            },\n        });\n    });\n};\n","import { v4 } from 'uuid';\nimport { AI } from 'constants/player-types';\n\nconst LOCAL_STORAGE_ID = 'high-scores';\nconst MAX_SCORES_PER_CIRCUIT = 5;\n\nexport const getAll = () => {\n    try {\n        const all = JSON.parse(localStorage.getItem(LOCAL_STORAGE_ID));\n        return all || {};\n    } catch (e) {\n        return {};\n    }\n};\n\nexport const getByCircuitId = (circuitId) => {\n    const all = getAll();\n    return (all[circuitId] || []).map((score) => ({\n        ...score,\n        date: new Date(score.date),\n    }));\n};\n\nexport const shouldScoreBeAdded = (score, circuit, player) => {\n    if (player.type === AI) {\n        return false;\n    }\n    const circuitScores = getByCircuitId(circuit.id);\n    if (circuitScores.length < MAX_SCORES_PER_CIRCUIT) {\n        return true;\n    }\n    const lastScore = circuitScores[circuitScores.length - 1];\n    if (isBetterScore(score, lastScore)) {\n        return true;\n    }\n\n    return false;\n};\n\nexport const addScore = (score, circuit, player) => {\n    if (!shouldScoreBeAdded(score, circuit, player)) {\n        return null;\n    }\n    const circuitScores = getByCircuitId(circuit.id);\n    let insertBefore;\n    for (let i = 0; i < circuitScores.length; i += 1) {\n        if (isBetterScore(score, circuitScores[i])) {\n            insertBefore = i;\n            break;\n        }\n    }\n    const scoreToAdd = {\n        ...score,\n        id: v4(),\n    };\n    let newScores = circuitScores.slice();\n    if (typeof insertBefore === 'number') {\n        newScores.splice(insertBefore, 0, scoreToAdd);\n    } else {\n        newScores.push(scoreToAdd);\n    }\n    newScores = newScores.slice(0, MAX_SCORES_PER_CIRCUIT);\n    updateCircuitScores(circuit, newScores);\n    return scoreToAdd;\n};\n\nfunction isBetterScore(score, otherScore) {\n    if (score.turns > otherScore.turns) {\n        return false;\n    }\n    if (score.turns < otherScore.turns) {\n        return true;\n    }\n\n    // Same turns, choose the one with better real time:\n    return score.realTimeUsed < otherScore.realTimeUsed;\n}\n\nfunction updateCircuitScores(circuit, newScores) {\n    const all = getAll();\n    const newAll = {\n        ...all,\n        [circuit.id]: newScores,\n    };\n    try {\n        localStorage.setItem(LOCAL_STORAGE_ID, JSON.stringify(newAll, 2));\n    } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn('error saving high score', e);\n    }\n}\n","const levels = [\n    {\n        // level 0\n        randomSolutionChance: 20 / 100,\n        maxIterations: 50,\n        maxThinkingDepth: 5,\n        timeThinking: {\n            min: 2500,\n            max: 3500,\n        },\n    },\n    {\n        // level 1\n        randomSolutionChance: 15 / 100,\n        maxIterations: 200,\n        maxThinkingDepth: 10,\n        timeThinking: {\n            min: 1500,\n            max: 2500,\n        },\n    },\n    {\n        // level 2\n        randomSolutionChance: 7 / 100,\n        maxIterations: 700,\n        maxThinkingDepth: 30,\n        timeThinking: {\n            min: 700,\n            max: 2000,\n        },\n    },\n    {\n        // level 3\n        randomSolutionChance: 0,\n        maxIterations: 1500,\n        maxThinkingDepth: 99999,\n        timeThinking: {\n            min: 100,\n            max: 300,\n        },\n    },\n];\n\nexport default levels;\n","import { getPossibleDestinations } from 'store/players/selectors';\nimport {\n    checkIfPlayerCanMove,\n    getCheckpointsInMovement,\n    getDistanceToNextCheckpoint,\n    getMaxCheckpointDistance,\n} from 'utils/circuit';\nimport {\n    movePlayerTo,\n    addCheckpoints,\n    doesPlayerHaveRepeatedPositions,\n    getAverageSpeed,\n    getCheckpointsPassed,\n    hasPlayerFinishedRace,\n} from 'utils/player';\n\nexport default class PartialCircuitSolution {\n    constructor(playerInfo, currentIteration, circuit, mapZoom, mapGridSize) {\n        this.playerInfo = {\n            ...playerInfo,\n            prevPositions: playerInfo.prevPositions.slice(),\n            checkpointsPassed: playerInfo.checkpointsPassed.slice(),\n        };\n        this.currentIteration = currentIteration;\n        this.circuit = circuit;\n        this.mapZoom = mapZoom;\n        this.mapGridSize = mapGridSize;\n\n        this._updatePartialScore();\n    }\n\n    /**\n     * Returns an array of all possible solutions from this one\n     *\n     * @returns {PartialCircuitSolution[]}\n     */\n    expand(otherPlayers, maxDepthForSolutions) {\n        if (this.currentIteration >= maxDepthForSolutions) {\n            return [];\n        }\n        const otherPlayersToConsider =\n            this.currentIteration === 1 ? otherPlayers : [];\n\n        const canMoveThere = (position) =>\n            checkIfPlayerCanMove({\n                from: this.playerInfo.position,\n                to: position,\n                zoom: this.mapZoom,\n                gridSize: this.mapGridSize,\n                circuit: this.circuit,\n                otherPlayers: [],\n            });\n\n        const possiblePositions = getPossibleDestinations(\n            this.playerInfo,\n            otherPlayersToConsider,\n        ).filter((position) => canMoveThere(position));\n\n        const resultingPlayers = possiblePositions.map((position) => {\n            const visitedCheckpointsInTurn = getCheckpointsInMovement({\n                from: this.playerInfo.position,\n                to: position,\n                zoom: this.mapZoom,\n                gridSize: this.mapGridSize,\n                circuit: this.circuit,\n            });\n\n            const player = movePlayerTo(this.playerInfo, position, 0);\n            return addCheckpoints(player, visitedCheckpointsInTurn);\n        });\n\n        return resultingPlayers.map((player) => {\n            return new PartialCircuitSolution(\n                player,\n                this.currentIteration + 1,\n                this.circuit,\n                this.mapZoom,\n                this.mapGridSize,\n            );\n        });\n    }\n\n    updateScoreWithTotals({\n        maxAvgSpeed,\n        maxCheckpointsCoveredPerTurn,\n        maxCheckpointsCovered,\n    }) {\n        this.avgSpeedScore = (this.avgSpeed + 1) / (maxAvgSpeed + 1);\n        this.checkpointsCoveredPerTurnScore =\n            (this.checkpointsCoveredPerTurn + 1) /\n            (maxCheckpointsCoveredPerTurn + 1);\n        this.checkpointsCoveredScore =\n            (this.checkpointsCovered + 1) / (maxCheckpointsCovered + 1);\n\n        this.score =\n            this.avgSpeedScore * 0.1 +\n            this.checkpointsCoveredPerTurnScore * 0.3 +\n            this.checkpointsCoveredScore * 0.6;\n\n        this.summary = {\n            avgSpeedScore: this.avgSpeedScore.toFixed(2),\n            checkpointsCoveredPerTurnScore: this.checkpointsCoveredPerTurnScore.toFixed(\n                2,\n            ),\n            checkpointsCoveredScore: this.checkpointsCoveredScore.toFixed(2),\n        };\n    }\n\n    _updatePartialScore() {\n        if (!this.playerInfo.prevPositions.length) {\n            this.score = -1;\n            return;\n        }\n        if (doesPlayerHaveRepeatedPositions(this.playerInfo)) {\n            // we really don't want a path going to the same point again\n            this.score = -1000;\n            return;\n        }\n\n        this.avgSpeed = getAverageSpeed(this.playerInfo);\n        const checkpoints = getCheckpointsPassed(this.playerInfo);\n        const nextCheckpoint = 1 - this._getPercentageToNextCheckpoint();\n        this.checkpointsCovered = checkpoints + nextCheckpoint;\n        this.checkpointsCoveredPerTurn =\n            this.checkpointsCovered / this.getTurns();\n\n        this.score = 1; // temp until all scores are calculated\n    }\n\n    getScore() {\n        return this.score;\n    }\n\n    getFirstMove() {\n        const indexWithFirstPosition =\n            this.playerInfo.prevPositions.length - this.currentIteration + 1;\n        return this.playerInfo.prevPositions[indexWithFirstPosition];\n    }\n\n    getTurns() {\n        return this.playerInfo.prevPositions.length;\n    }\n\n    isFinished() {\n        return hasPlayerFinishedRace(this.playerInfo);\n    }\n\n    _getPercentageToNextCheckpoint() {\n        const distanceToNext = getDistanceToNextCheckpoint({\n            player: this.playerInfo,\n            zoom: this.mapZoom,\n            gridSize: this.mapGridSize,\n            circuit: this.circuit,\n        });\n        const maxCPDistance = getMaxCheckpointDistance(this.circuit);\n        return (distanceToNext + 1) / (maxCPDistance + 1);\n    }\n}\n","/* eslint-disable no-loop-func */\nimport { getPossibleDestinations } from 'store/players/selectors';\nimport { pickRandomFromArray } from 'utils/random';\nimport { checkIfPlayerCanMove } from 'utils/circuit';\nimport aiLevels from 'constants/ai-levels';\nimport PartialCircuitSolution from './PartialCircuitSolution';\nimport { waitForNextAnimationFrame } from './request-animation-frame';\n\nexport const chooseNextMovement = (\n    player,\n    otherPlayers,\n    circuit,\n    zoom,\n    gridSize,\n) => {\n    return new Promise((resolve) => {\n        if (shouldGetRandomSolution(player)) {\n            resolve(\n                returnRandomNonCrashingMove({\n                    player,\n                    otherPlayers,\n                    zoom,\n                    circuit,\n                    gridSize,\n                }),\n            );\n            return;\n        }\n\n        const solutionsGenerator = createSolutionsGenerator({\n            player,\n            otherPlayers,\n            circuit,\n            zoom,\n            gridSize,\n        });\n\n        (async () => {\n            // eslint-disable-next-line no-restricted-syntax\n            for await (const solution of solutionsGenerator) {\n                await waitForNextAnimationFrame();\n                if (solution.isFinished) {\n                    resolve(solution.move);\n                    break;\n                }\n            }\n        })();\n    });\n};\n\nasync function* createSolutionsGenerator({\n    player,\n    otherPlayers,\n    circuit,\n    zoom,\n    gridSize,\n}) {\n    let openSolutions = [\n        new PartialCircuitSolution(player, 1, circuit, zoom, gridSize),\n    ];\n    let finishedSolutions = [];\n    let bestFinishedSolution = null;\n\n    const { maxIterations } = aiLevels[player.levelAI];\n    const { maxThinkingDepth } = aiLevels[player.levelAI];\n\n    let currentIteration = 1;\n    const yieldEvery = 50;\n\n    while (openSolutions.length && currentIteration <= maxIterations) {\n        currentIteration += 1;\n        const solutionToExpand = getMostPromisingSolution(openSolutions);\n        openSolutions = openSolutions.filter(\n            (solution) => solution !== solutionToExpand,\n        );\n        const newSolutions = solutionToExpand.expand(\n            otherPlayers,\n            maxThinkingDepth,\n        );\n        const newFinishedSolutions = newSolutions.filter((solution) =>\n            solution.isFinished(),\n        );\n\n        // eslint-disable-next-line no-restricted-syntax\n        for (const solution of newFinishedSolutions) {\n            if (\n                !bestFinishedSolution ||\n                solution.getTurns() < bestFinishedSolution.getTurns()\n            ) {\n                bestFinishedSolution = solution;\n            }\n        }\n        finishedSolutions = finishedSolutions.concat(newFinishedSolutions);\n        const newOpenSolutions = newSolutions\n            .filter((solution) => !solution.isFinished())\n            .filter((solution) => solution.getScore() >= 0)\n            .filter(\n                // removing solutions with more turns than already found ones\n                (solution) =>\n                    !bestFinishedSolution ||\n                    solution.getTurns() < bestFinishedSolution.getTurns(),\n            );\n\n        openSolutions = openSolutions.concat(newOpenSolutions);\n\n        const maxAvgSpeed = openSolutions.reduce(\n            (acc, solution) => Math.max(acc, solution.avgSpeed),\n            0,\n        );\n        const maxCheckpointsCoveredPerTurn = openSolutions.reduce(\n            (acc, solution) =>\n                Math.max(acc, solution.checkpointsCoveredPerTurn),\n            0,\n        );\n        const maxCheckpointsCovered = openSolutions.reduce(\n            (acc, solution) => Math.max(acc, solution.checkpointsCovered),\n            0,\n        );\n        openSolutions.forEach((solution) => {\n            solution.updateScoreWithTotals({\n                maxAvgSpeed,\n                maxCheckpointsCoveredPerTurn,\n                maxCheckpointsCovered,\n            });\n        });\n\n        if (currentIteration % yieldEvery === 0) {\n            yield {\n                isFinished: false,\n            };\n        }\n    }\n\n    let move;\n    if (bestFinishedSolution) {\n        move = bestFinishedSolution.getFirstMove();\n    } else if (openSolutions.length) {\n        move = getMostPromisingSolution(openSolutions).getFirstMove();\n    } else {\n        move = returnRandomMove(player, otherPlayers);\n    }\n    yield {\n        isFinished: true,\n        move,\n    };\n}\n\nfunction shouldGetRandomSolution(player) {\n    const chance = aiLevels[player.levelAI].randomSolutionChance;\n    return Math.random() < chance;\n}\n\nfunction returnRandomMove(player, otherPlayers) {\n    const positions = getPossibleDestinations(player, otherPlayers);\n    return pickRandomFromArray(positions);\n}\n\nfunction returnRandomNonCrashingMove({\n    player,\n    otherPlayers,\n    zoom,\n    circuit,\n    gridSize,\n}) {\n    const canMoveThere = (position) =>\n        checkIfPlayerCanMove({\n            from: player.position,\n            to: position,\n            zoom,\n            gridSize,\n            circuit,\n            otherPlayers: [],\n        });\n\n    let possiblePositions = getPossibleDestinations(\n        player,\n        otherPlayers,\n    ).filter((position) => canMoveThere(position));\n\n    if (!possiblePositions.length) {\n        // If we don't have other option other than crashing\n        possiblePositions = getPossibleDestinations(player, otherPlayers);\n    }\n\n    return pickRandomFromArray(possiblePositions);\n}\n\nfunction getMostPromisingSolution(solutions) {\n    return solutions.reduce((best, solution) => {\n        if (solution.getScore() > best.getScore()) {\n            return solution;\n        }\n        return best;\n    }, solutions[0]);\n}\n","export const waitForNextAnimationFrame = () => {\n    return new Promise((resolve) => {\n        requestAnimationFrame(resolve);\n    });\n};\n","// Based on https://stackoverflow.com/a/4819886/3493388\nfunction checkTouchDevice() {\n    const prefixes = ' -webkit- -moz- -o- -ms- '.split(' ');\n\n    const mq = (query) => {\n        return window.matchMedia(query).matches;\n    };\n\n    if (\n        'ontouchstart' in window ||\n        // eslint-disable-next-line no-undef\n        (window.DocumentTouch && document instanceof DocumentTouch)\n    ) {\n        return true;\n    }\n\n    // include the 'heartz' as a way to have a non matching MQ to help terminate the join\n    // https://git.io/vznFH\n    const query = ['(', prefixes.join('touch-enabled),('), 'heartz', ')'].join(\n        '',\n    );\n    return mq(query);\n}\n\nexport const isTouchDevice = checkTouchDevice();\n","const log = true;\n\n/**\n * Tracks a google analytics event\n *\n * @param {string} action\n * @param {object} [params = {}]\n * @param {string} [params.category]\n * @param {string} [params.label]\n * @param {string} [params.value]\n */\nexport const track = (action, { category, label, value } = {}) => {\n    if (log) {\n        // eslint-disable-next-line no-console\n        console.log('track', action, category, label, value);\n    }\n    if (!window.gtag) {\n        return;\n    }\n    window.gtag('event', action, {\n        event_category: category,\n        event_label: label,\n        value,\n    });\n};\n","import shuffle from 'lodash.shuffle';\nimport * as gameStates from 'constants/game-states';\nimport { circuits } from 'constants/circuits';\nimport {\n    setPlayers,\n    moveTo,\n    notifyCollision,\n    reduceGrounded,\n    notifyVisitedCheckpoints,\n} from 'store/players/actions';\nimport { changeScreen } from 'store/main-ui/actions';\nimport {\n    initGame,\n    setGameState,\n    advancePlayerTurn,\n    setLatestHighScore,\n    setSelectedPosition,\n    initReplay,\n    setSelectedAIMove,\n} from 'store/game/actions';\nimport {\n    getAllPlayers,\n    getCurrentPlayer,\n    hasCurrentPlayerWon,\n    getOtherPlayers,\n    getSelectedPosition,\n} from 'store/game/selectors';\nimport { GAME, MAIN_MENU, LOADING_GAME, REPLAY_GAME } from 'constants/screens';\nimport {\n    TIME_SHOWING_RANDOM_SELECTOR,\n    WAIT_AFTER_AI_GROUNDED,\n    WAIT_AFTER_AI_COLLISION,\n} from 'constants/ux';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport {\n    createFromConfig,\n    getCheckpointsVisitedInLine,\n    checkIfPlayerCanMove,\n} from 'utils/circuit';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { distance } from 'utils/vector2d';\nimport { getPossibleDestinations } from 'store/players/selectors';\nimport { pickRandomFromArray, getRandomInRange } from 'utils/random';\nimport { timeout } from 'utils/gameLoopTimeout';\nimport { shouldScoreBeAdded, addScore } from 'utils/highScoresStorage';\nimport { AI, HUMAN } from 'constants/player-types';\nimport { chooseNextMovement } from 'utils/ai';\nimport aiLevels from 'constants/ai-levels';\nimport { isTouchDevice } from 'utils/is-touch-device';\nimport { storeSavedPlayers } from 'utils/playersStorage';\nimport { track } from 'utils/analytics';\n\nconst notifyGrounded = (nextPlayer) => {\n    return (dispatch) => {\n        if (nextPlayer.type === HUMAN) {\n            dispatch(setGameState(gameStates.NOTIFY_GROUNDED));\n            return;\n        }\n        dispatch(setGameState(gameStates.NOTIFY_AI_GROUNDED));\n        setTimeout(() => {\n            dispatch(reduceGroundedAndNextTurn());\n        }, WAIT_AFTER_AI_GROUNDED);\n    };\n};\n\nexport const startTurn = () => {\n    return (dispatch, getState) => {\n        const nextPlayer = getCurrentPlayer(getState());\n        if (nextPlayer.turnsGrounded) {\n            dispatch(notifyGrounded(nextPlayer));\n            return;\n        }\n\n        if (nextPlayer.type === AI) {\n            dispatch(handleAITurn(nextPlayer));\n            return;\n        }\n\n        if (getState().mainUI.playWithTimer) {\n            dispatch(setGameState(gameStates.PLAYER_TURN_START_SCREEN));\n        } else {\n            dispatch(startWaitingForPlayerInput());\n        }\n    };\n};\n\nexport const nextTurn = () => {\n    return (dispatch) => {\n        dispatch(advancePlayerTurn());\n        dispatch(startTurn());\n    };\n};\n\nexport const reduceGroundedAndNextTurn = () => {\n    return (dispatch, getState) => {\n        const currentPlayer = getCurrentPlayer(getState());\n        dispatch(reduceGrounded(currentPlayer.id));\n        dispatch(nextTurn());\n    };\n};\n\nexport const initGameWithConfig = ({ players, playerOrder, circuit }) => {\n    return (dispatch, getState) => {\n        dispatch(changeScreen(LOADING_GAME));\n        const playersWithMapPosition = initMapPositionForPlayers({\n            players,\n            playerOrder,\n            circuit,\n        }).map(fixPlayersWithoutName);\n\n        dispatch(setPlayers(playersWithMapPosition));\n\n        track('init_game', { category: 'game', label: circuit?.id });\n        track('total_players', {\n            category: 'game',\n            value: players.length,\n            label: circuit?.id,\n        });\n        track('human_players', {\n            category: 'game',\n            value: players.filter((player) => player.type === HUMAN).length,\n            label: circuit?.id,\n        });\n        track('ai_players', {\n            category: 'game',\n            value: players.filter((player) => player.type === AI).length,\n            label: circuit?.id,\n        });\n\n        // if we don't want timer, set infinite time\n        if (!getState().mainUI.playWithTimer) {\n            waitingForPlayerCounter.setTimeToWait(-1);\n        }\n\n        createFromConfig(circuit).then((circuitInfo) => {\n            dispatch(initGame(playerOrder, circuitInfo));\n            dispatch(changeScreen(GAME));\n        });\n    };\n};\n\nexport const initGameWithSavedConfig = () => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const { randomizePlayerOrderOnStart } = state.mainUI;\n        const playerOrder = randomizePlayerOrderOnStart\n            ? shuffle(state.mainUI.selectedPlayerOrder)\n            : state.mainUI.selectedPlayerOrder;\n\n        storeSavedPlayers(\n            state.mainUI.selectedPlayerOrder,\n            state.mainUI.selectedPlayers,\n        );\n\n        dispatch(\n            initGameWithConfig({\n                players: state.mainUI.selectedPlayers,\n                playerOrder,\n                circuit: circuits[state.mainUI.selectedCircuit],\n            }),\n        );\n    };\n};\n\nexport const handlePlayerCollision = (\n    player,\n    newIntendedPosition,\n    timePassed,\n) => {\n    return (dispatch) => {\n        const speed = distance(player.position, newIntendedPosition);\n        track('collision', {\n            category: 'game',\n            label: player?.type === AI ? 'ai' : 'human',\n            value: speed,\n        });\n        dispatch(notifyCollision(player.id, speed, timePassed));\n        if (player.type === AI) {\n            dispatch(setGameState(gameStates.NOTIFY_AI_COLLISION));\n            setTimeout(() => {\n                dispatch(nextTurn());\n            }, WAIT_AFTER_AI_COLLISION);\n            return;\n        }\n        dispatch(setGameState(gameStates.NOTIFY_COLLISION));\n    };\n};\n\nexport const handleCorrectMovement = (\n    player,\n    newIntendedPosition,\n    timePassed,\n    movementLine,\n    circuit,\n) => {\n    return (dispatch, getState) => {\n        dispatch(detectAndStoreCheckpoints(movementLine, circuit));\n        const hasPlayerWon = hasCurrentPlayerWon(getState());\n        dispatch(moveTo(player.id, newIntendedPosition, timePassed));\n        if (hasPlayerWon) {\n            dispatch(handleVictory(getCurrentPlayer(getState()), circuit));\n            return;\n        }\n        dispatch(nextTurn());\n    };\n};\n\nfunction handleVictory(player, circuit) {\n    return (dispatch) => {\n        track('victory', { category: 'game' });\n        const score = {\n            name: player.name,\n            date: new Date(),\n            turns: player.turnsSpent,\n            realTimeUsed: player.realTimeUsed,\n            maxSpeed: player.maxSpeed,\n            crashes: player.crashes,\n            path: player.prevPositions,\n            playerStyle: player.style,\n        };\n\n        if (shouldScoreBeAdded(score, circuit, player)) {\n            const newScore = addScore(score, circuit, player);\n            track('high_score', {\n                category: 'game',\n                label: circuit?.id,\n                value: newScore?.turns,\n            });\n            dispatch(setLatestHighScore(newScore));\n            dispatch(setGameState(gameStates.NOTIFY_HIGH_SCORE));\n        } else {\n            dispatch(setGameState(gameStates.NOTIFY_VICTORY));\n        }\n    };\n}\n\nconst handlePlayerMovement = (player, newIntendedPosition) => {\n    return (dispatch, getState) => {\n        const timePassed = waitingForPlayerCounter.getTimePassed();\n        waitingForPlayerCounter.stop();\n        const state = getState();\n        const circuit = state.game.circuitInfo;\n        const mapZoom = state.map.zoom;\n        const mapGridSize = state.map.gridSize;\n        const canMoveThere = checkIfPlayerCanMove({\n            from: player.position,\n            to: newIntendedPosition,\n            zoom: mapZoom,\n            gridSize: mapGridSize,\n            circuit,\n            otherPlayers: getOtherPlayers(state, player.id),\n        });\n\n        if (!canMoveThere) {\n            dispatch(\n                handlePlayerCollision(player, newIntendedPosition, timePassed),\n            );\n            return;\n        }\n\n        const movementLine = [\n            projectToScreenPosition(state, player.position),\n            projectToScreenPosition(state, newIntendedPosition),\n        ];\n\n        dispatch(\n            handleCorrectMovement(\n                player,\n                newIntendedPosition,\n                timePassed,\n                movementLine,\n                circuit,\n            ),\n        );\n    };\n};\n\nexport const handlePlayerPositionSelection = (player, newIntendedPosition) => {\n    return (dispatch) => {\n        if (isTouchDevice) {\n            dispatch(setSelectedPosition(newIntendedPosition));\n            return;\n        }\n        dispatch(handlePlayerMovement(player, newIntendedPosition));\n    };\n};\n\nexport const confirmPositionSelection = (player) => {\n    return (dispatch, getState) => {\n        const selectedPosition = getSelectedPosition(getState());\n        dispatch(handlePlayerMovement(player, selectedPosition));\n    };\n};\n\nexport const startWaitingForPlayerInput = () => {\n    return (dispatch, getState) => {\n        dispatch(setGameState(gameStates.WAITING_FOR_PLAYER_INPUT));\n        let callbackOnEnd = () => {};\n\n        if (getState().mainUI.playWithTimer) {\n            callbackOnEnd = () => {\n                const selectedPosition = getSelectedPosition(getState());\n                if (selectedPosition) {\n                    // If a position was already selected we choose that one\n                    const player = getCurrentPlayer(getState());\n                    dispatch(handlePlayerMovement(player, selectedPosition));\n                    return;\n                }\n                dispatch(showRandomSelectorAndMovePlayer());\n            };\n        }\n\n        waitingForPlayerCounter.restart({ callbackOnEnd });\n    };\n};\n\nexport const handleAITurn = (player) => {\n    return async (dispatch, getState) => {\n        dispatch(setGameState(gameStates.AI_THINKING_SCREEN));\n        const state = getState();\n        const circuit = state.game.circuitInfo;\n        const otherPlayers = getAllPlayers(getState()).filter(\n            (otherPlayer) => otherPlayer.id !== player.id,\n        );\n        const mapZoom = state.map.zoom;\n        const mapGridSize = state.map.gridSize;\n        const nextMovementPromise = chooseNextMovement(\n            player,\n            otherPlayers,\n            circuit,\n            mapZoom,\n            mapGridSize,\n        );\n\n        const minTimeToWaitForPlayer = getMinTimeToWaitForPlayer(player);\n        // eslint-disable-next-line no-unused-vars\n        const result = await Promise.all([\n            timeout(minTimeToWaitForPlayer),\n            nextMovementPromise,\n        ]);\n        const nextMovement = result[1];\n        dispatch(setSelectedAIMove(nextMovement));\n        await timeout(1000);\n        dispatch(handlePlayerMovement(player, nextMovement));\n    };\n};\n\nfunction getMinTimeToWaitForPlayer(player) {\n    const { timeThinking } = aiLevels[player.levelAI];\n    return getRandomInRange(timeThinking.min, timeThinking.max);\n}\n\nfunction showRandomSelectorAndMovePlayer() {\n    return (dispatch, getState) => {\n        dispatch(setGameState(gameStates.ANIMATING_RANDOM_PLAYER_MOVEMENT));\n        timeout(TIME_SHOWING_RANDOM_SELECTOR).then(() => {\n            const player = getCurrentPlayer(getState());\n            const otherPlayers = getAllPlayers(getState()).filter(\n                (otherPlayer) => otherPlayer.id !== player.id,\n            );\n            const positions = getPossibleDestinations(player, otherPlayers);\n            const nextPosition = pickRandomFromArray(positions);\n            dispatch(handlePlayerMovement(player, nextPosition));\n        });\n    };\n}\n\nexport const detectAndStoreCheckpoints = (movementLine, circuit) => {\n    return (dispatch, getState) => {\n        const visitedCheckpointsInTurn = getCheckpointsVisitedInLine(\n            movementLine,\n            circuit,\n        );\n        if (!visitedCheckpointsInTurn.length) {\n            return;\n        }\n        const currentPlayer = getCurrentPlayer(getState());\n        dispatch(\n            notifyVisitedCheckpoints(\n                currentPlayer.id,\n                visitedCheckpointsInTurn,\n            ),\n        );\n    };\n};\n\nexport const finishGame = () => {\n    return (dispatch) => {\n        track('finish_game', { category: 'game' });\n        dispatch(changeScreen(MAIN_MENU));\n        waitingForPlayerCounter.reset();\n    };\n};\n\nfunction initMapPositionForPlayers({ players, playerOrder, circuit }) {\n    const orderedPlayers = playerOrder.map((playerId) =>\n        players.find((player) => player.id === playerId),\n    );\n\n    return orderedPlayers.map((player, index) => {\n        const initialPosition = circuit.startingPositions[index];\n        return {\n            ...player,\n            position: { ...initialPosition },\n            prevPositions: [{ ...initialPosition }],\n            speed: { ...circuit.initialSpeed },\n            checkpointsPassed: circuit.checkpoints.map(() => false),\n        };\n    });\n}\n\nexport const pause = () => {\n    return (dispatch) => {\n        dispatch(setGameState(gameStates.SHOW_MENU));\n        waitingForPlayerCounter.pause();\n    };\n};\n\nexport const unpause = () => {\n    return (dispatch, getState) => {\n        const lastState = getState().game.prevGameState;\n        dispatch(setGameState(lastState));\n        waitingForPlayerCounter.unpause();\n    };\n};\n\nexport const tryToToggleInGameMenu = () => {\n    return (dispatch, getState) => {\n        const { gameState } = getState().game;\n        switch (gameState) {\n            case gameStates.SHOW_MENU:\n                dispatch(unpause());\n                break;\n            case gameStates.WAITING_FOR_PLAYER_INPUT:\n                dispatch(pause());\n                break;\n            default:\n        }\n    };\n};\n\nexport const tryToShowInGameMenu = () => {\n    return (dispatch, getState) => {\n        const { gameState } = getState().game;\n        switch (gameState) {\n            case gameStates.WAITING_FOR_PLAYER_INPUT:\n                dispatch(pause());\n                break;\n            default:\n        }\n    };\n};\n\nfunction fixPlayersWithoutName(player, index) {\n    if (player.name) {\n        return player;\n    }\n    return {\n        ...player,\n        name: getNameForPlayerWithoutName(index),\n    };\n}\n\nfunction getNameForPlayerWithoutName(index) {\n    switch (index) {\n        case 0:\n            return 'Anonymous';\n        case 1:\n            return 'Mistery racer';\n        case 2:\n            return 'Shy runner';\n        case 3:\n            return 'Jane Doe';\n        default:\n            return 'John Doe';\n    }\n}\n\nexport const showReplay = (score, circuit) => {\n    return (dispatch) => {\n        track('show_replay', { category: 'replay' });\n        createFromConfig(circuit).then((circuitInfo) => {\n            dispatch(initReplay(score, circuitInfo));\n            dispatch(changeScreen(REPLAY_GAME));\n        });\n    };\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction CounterDisplay({ counterObject }) {\n    const [timeLeft, setTimeLeft] = React.useState(0);\n    // Use useRef for mutable variables that we want to persist\n    // without triggering a re-render on their change\n    const requestRef = React.useRef();\n\n    const animate = () => {\n        setTimeLeft(counterObject.getTimeLeft());\n        requestRef.current = requestAnimationFrame(animate);\n    };\n\n    React.useEffect(() => {\n        requestRef.current = requestAnimationFrame(animate);\n        return () => cancelAnimationFrame(requestRef.current);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []); // Make sure the effect runs only once\n\n    return (\n        <div className=\"counter-display\">\n            <div className=\"counter-display-text\">Time left:</div>\n            <div className=\"counter-display-number\">\n                {(timeLeft / 1000).toFixed(3)}\n            </div>\n        </div>\n    );\n}\n\nCounterDisplay.propTypes = {\n    counterObject: PropTypes.shape({\n        getTimeLeft: PropTypes.func,\n    }).isRequired,\n};\n\nexport default CounterDisplay;\n","import PropTypes from 'prop-types';\n\nexport const playerStyle = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n    dotColor: PropTypes.string,\n    dotSize: PropTypes.number,\n    round: PropTypes.string,\n    trailColor: PropTypes.string,\n    trailDotsSize: PropTypes.number,\n    trailWidth: PropTypes.number,\n    icon: PropTypes.string,\n});\n\nexport const vector2d = PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n});\n\nexport const selectablePlayer = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n});\n\nexport const player = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n    position: vector2d.isRequired,\n    speed: vector2d.isRequired,\n    prevPositions: PropTypes.arrayOf(vector2d),\n});\n\nexport const raceHistory = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n    path: PropTypes.arrayOf(vector2d),\n});\n\nexport const Score = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n    turns: PropTypes.number,\n    time: PropTypes.number,\n});\n\nexport const Circuit = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n});\n\nexport const Move = PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n    dx: PropTypes.number,\n    yy: PropTypes.number,\n    baseX: PropTypes.number,\n    baseY: PropTypes.number,\n});\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useState, useEffect } from 'react';\nimport ReactResizeDetector from 'react-resize-detector';\nimport classNames from 'classnames';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { player as playerProp } from 'components/propTypes';\nimport { useSelector } from 'react-redux';\nimport {\n    substract,\n    add,\n    isInsideViewport,\n    getClosestPointInsideViewport,\n} from 'utils/vector2d';\nimport './style.css';\n\nconst PADDING_FOR_VIEWPORT = { x: 120, y: 100 };\n\nconst GameBoardCameraHandler = ({ children, currentPlayer }) => {\n    const [cameraPosition, setCameraPosition] = useState({ x: 0, y: 0 });\n    const [boardSize, setBoardSize] = useState(null);\n    const [isDragging, setIsDragging] = useState(false);\n    const [dragStart, setDragStart] = useState(null);\n    const circuitInfo = useSelector((state) => state.game.circuitInfo);\n    const playerScreenPosition = useSelector((state) =>\n        projectToScreenPosition(state, currentPlayer.position),\n    );\n\n    useEffect(() => {\n        if (!boardSize || !currentPlayer || !currentPlayer.position) {\n            return;\n        }\n        const viewport = {\n            topLeft: substract({ x: 0, y: 0 }, cameraPosition),\n            size: boardSize,\n        };\n        if (\n            isInsideViewport(\n                playerScreenPosition,\n                viewport,\n                PADDING_FOR_VIEWPORT,\n            )\n        ) {\n            return;\n        }\n        const closestPointInViewport = getClosestPointInsideViewport(\n            playerScreenPosition,\n            viewport,\n            PADDING_FOR_VIEWPORT,\n        );\n        const newCameraMovement = substract(\n            closestPointInViewport,\n            playerScreenPosition,\n        );\n\n        setCameraPosition(add(cameraPosition, newCameraMovement));\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currentPlayer, boardSize]);\n\n    const handlePointerDown = (event) => {\n        setIsDragging(true);\n        const coordinates = getCoordinatesFromPointerEvent(event);\n        setDragStart(coordinates);\n    };\n    const handlePointerUp = () => {\n        setIsDragging(false);\n        setDragStart(null);\n    };\n    const handlePointerMove = (event) => {\n        if (!isDragging || !dragStart) {\n            return;\n        }\n        const cursorPosition = getCoordinatesFromPointerEvent(event);\n        const movement = substract(cursorPosition, dragStart);\n        setDragStart(cursorPosition);\n        setCameraPosition(add(cameraPosition, movement));\n    };\n\n    return (\n        <div className=\"game-board\">\n            <ReactResizeDetector\n                handleHeight\n                handleWidth\n                onResize={(width, height) => {\n                    setBoardSize({ width, height });\n                }}\n            >\n                <div\n                    className={classNames('game-board-content', {\n                        'is-dragging': isDragging,\n                    })}\n                    style={{\n                        width: circuitInfo.width,\n                        height: circuitInfo.height,\n                        transform: `translate(${cameraPosition.x}px, ${cameraPosition.y}px)`,\n                    }}\n                    onMouseDown={handlePointerDown}\n                    onMouseUp={handlePointerUp}\n                    onMouseMove={handlePointerMove}\n                    onTouchStart={handlePointerDown}\n                    onTouchEnd={handlePointerUp}\n                    onTouchMove={handlePointerMove}\n                    onTouchCancel={handlePointerUp}\n                >\n                    {children}\n                </div>\n            </ReactResizeDetector>\n        </div>\n    );\n};\n\nGameBoardCameraHandler.propTypes = {\n    currentPlayer: playerProp,\n};\n\nGameBoardCameraHandler.defaultProps = {\n    currentPlayer: null,\n};\n\nfunction getCoordinatesFromPointerEvent(event) {\n    let eventToUse = event;\n\n    if (event.type === 'touchstart' || event.type === 'touchmove') {\n        // eslint-disable-next-line prefer-destructuring\n        eventToUse = event.touches[0];\n    }\n    return {\n        x: eventToUse.clientX,\n        y: eventToUse.clientY,\n    };\n}\n\nexport default GameBoardCameraHandler;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport gridImg from 'assets/grid.png';\nimport './style.css';\n\nconst GRID_IMAGE_SIZE = 60; // px\n\nconst Grid = ({ zoom, cellSize }) => {\n    const GRID_IMG_DENSITY = GRID_IMAGE_SIZE / cellSize;\n    const backgroundSize = (zoom * GRID_IMAGE_SIZE) / GRID_IMG_DENSITY;\n    return (\n        <div\n            className=\"grid\"\n            style={{\n                backgroundImage: `url(${gridImg})`,\n                backgroundSize: `${backgroundSize}px ${backgroundSize}px`,\n            }}\n        />\n    );\n};\n\nGrid.propTypes = {\n    zoom: PropTypes.number.isRequired,\n    cellSize: PropTypes.number.isRequired,\n};\n\nGrid.defaultProps = {};\n\nexport default Grid;\n","import React from 'react';\nimport { playerStyle as playerStyleProp } from 'components/propTypes';\nimport './style.css';\n\nfunction PlayerIcon({ playerStyle }) {\n    return (\n        <div\n            className=\"player-icon\"\n            style={{\n                backgroundImage: `url(${playerStyle.icon})`,\n            }}\n        />\n    );\n}\n\nPlayerIcon.propTypes = {\n    playerStyle: playerStyleProp.isRequired,\n};\n\nexport default PlayerIcon;\n","import React, { useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport PlayerIcon from 'components/PlayerIcon';\nimport './style.css';\n\nconst Player = ({ player, isActive }) => {\n    const rootElement = useRef(null);\n    useEffect(() => {\n        setCSSVars(rootElement.current, player.style);\n    }, [player.style]);\n    const playerScreenPosition = useSelector((state) =>\n        projectToScreenPosition(state, player.position),\n    );\n    return (\n        <div\n            ref={rootElement}\n            className={classNames('player', {\n                'is-active': isActive,\n            })}\n            style={{\n                left: playerScreenPosition.x,\n                top: playerScreenPosition.y,\n            }}\n        >\n            <PlayerIcon playerStyle={player.style} />\n\n            {isActive && <div className=\"player-active-indicator\" />}\n        </div>\n    );\n};\n\nPlayer.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nfunction setCSSVars(element, style) {\n    if (!element) {\n        return;\n    }\n    element.style.setProperty('--player-color', style.dotColor);\n    // element.style.setProperty('--player-size', `${style.dotSize}px`);\n    element.style.setProperty('--player-border-radius', style.round);\n}\n\n// Player.defaultProps = {};\n\nexport default Player;\n","import { doesLineCollide } from 'utils/circuit';\n\nexport const setPlayerCSSVars = (element, style) => {\n    if (!element) {\n        return;\n    }\n    element.style.setProperty('--player-color', style.dotColor);\n    element.style.setProperty('--player-size', `${style.dotSize + 2}px`);\n    element.style.setProperty(\n        '--movement-picker-size',\n        `${style.dotSize - 1}px`,\n    );\n    element.style.setProperty(\n        '--movement-picker-size-center',\n        `${style.dotSize + 2}px`,\n    );\n    element.style.setProperty('--player-border-radius', style.round);\n};\n\nexport const getColorForTempLine = (\n    player,\n    points,\n    circuit,\n    otherPlayersPosition,\n) => {\n    if (doesLineCollide(points, circuit, otherPlayersPosition)) {\n        return 'red';\n    }\n    return player.style.trailColor;\n};\n","// TODO: complex component, transform to class\n\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useRef, useEffect } from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { useSelector } from 'react-redux';\nimport { PathLine } from 'react-svg-pathline';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    getOtherPlayersPositionInScreen,\n    getPossibleDestinationsForPlayerInScreen,\n    getSelectedPosition,\n    getMovedPixelsSinceLastTurn,\n    getPivotForPlayerInScreen,\n} from 'store/game/selectors';\nimport { doesLineCollide } from 'utils/circuit';\nimport { setPlayerCSSVars, getColorForTempLine } from 'utils/playerPainter';\nimport { isTouchDevice } from 'utils/is-touch-device';\n\nimport './style.css';\n\nfunction MovementPicker({ player, onPositionSelected, onConfirmSelection }) {\n    const rootElement = useRef(null);\n    const [tempLine, setTempLine] = useState(null);\n    const [animatePoints, setAnimatePoints] = useState(false);\n\n    useEffect(() => {\n        setPlayerCSSVars(rootElement.current, player.style);\n    }, [player.style]);\n\n    const lastMovement = useSelector((state) =>\n        getMovedPixelsSinceLastTurn(state, player),\n    ) || { x: 0, y: 0 };\n\n    const [translate, setTranslate] = useState(lastMovement);\n\n    useEffect(() => {\n        const timeout = setTimeout(() => {\n            setTranslate({ x: 0, y: 0 });\n            setAnimatePoints(true);\n        });\n\n        return () => clearTimeout(timeout);\n    }, []);\n\n    useEffect(() => {\n        setTempLine(null);\n        return () => setTempLine(null);\n    }, [player]);\n\n    const circuit = useSelector((state) => state.game.circuitInfo);\n    const originalPlayerScreenPosition = useSelector((state) =>\n        projectToScreenPosition(state, player.position),\n    );\n    const possiblePositions = useSelector((state) =>\n        getPossibleDestinationsForPlayerInScreen(state, player),\n    );\n\n    const nextPivot = useSelector((state) =>\n        getPivotForPlayerInScreen(state, player),\n    );\n\n    const otherPlayersPosition = useSelector((state) =>\n        getOtherPlayersPositionInScreen(state, player.id),\n    );\n\n    const selectedPosition = useSelector(getSelectedPosition);\n    const selectedPositionScreen = useSelector((state) =>\n        projectToScreenPosition(state, selectedPosition),\n    );\n    const selectButtonPosition = getSelectButtonPosition(possiblePositions);\n\n    const lineToPaint = tempLine || selectedPositionScreen;\n\n    const wouldCollide =\n        lineToPaint &&\n        doesLineCollide(\n            [originalPlayerScreenPosition, lineToPaint],\n            circuit,\n            otherPlayersPosition,\n        );\n\n    return (\n        <div\n            ref={rootElement}\n            className=\"movement-picker-container\"\n            style={{\n                transform: `translate(${translate.x}px, ${translate.y}px)`,\n            }}\n        >\n            {possiblePositions.map((eachPosition) => (\n                // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n                <div\n                    key={`${player.id}_${eachPosition.position.x}_${eachPosition.position.y}`}\n                    className={classNames('movement-picker', {\n                        'movement-picker-center':\n                            !eachPosition.screen.dx && !eachPosition.screen.dy,\n                    })}\n                    style={{\n                        left: eachPosition.screen.baseX,\n                        top: eachPosition.screen.baseY,\n                        transform: animatePoints\n                            ? `translate(${eachPosition.screen.dx}px, ${eachPosition.screen.dy}px)`\n                            : 'translate(0, 0)',\n                    }}\n                    onClick={() => onPositionSelected(eachPosition.position)}\n                    onMouseEnter={() => setTempLine(eachPosition.screen)}\n                    onMouseLeave={() => setTempLine(null)}\n                />\n            ))}\n            {isTouchDevice && selectedPosition && (\n                // eslint-disable-next-line react/button-has-type\n                <button\n                    className=\"button button-bg movement-picker-select-button\"\n                    style={{\n                        left: selectButtonPosition.x,\n                        top: selectButtonPosition.y,\n                    }}\n                    onClick={onConfirmSelection}\n                >\n                    Select\n                </button>\n            )}\n            {lineToPaint && (\n                <svg className=\"movement-picker-temp-line\">\n                    <PathLine\n                        points={[originalPlayerScreenPosition, lineToPaint]}\n                        stroke={getColorForTempLine(\n                            player,\n                            [originalPlayerScreenPosition, lineToPaint],\n                            circuit,\n                            otherPlayersPosition,\n                        )}\n                        strokeWidth={player.style.trailWidth}\n                        strokeDasharray=\"2\"\n                        fill=\"none\"\n                        r={2}\n                    />\n                </svg>\n            )}\n            <svg className=\"movement-picker-ghost-line\">\n                <PathLine\n                    points={[originalPlayerScreenPosition, nextPivot]}\n                    stroke={player.style.trailColor}\n                    strokeWidth={player.style.trailWidth}\n                    strokeDasharray=\"1\"\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n\n            {lineToPaint && wouldCollide && (\n                <div\n                    className=\"movement-picker-crash\"\n                    style={{\n                        left: lineToPaint.x,\n                        top: lineToPaint.y,\n                    }}\n                />\n            )}\n        </div>\n    );\n}\n\nMovementPicker.propTypes = {\n    player: playerProp.isRequired,\n    onPositionSelected: PropTypes.func.isRequired,\n    onConfirmSelection: PropTypes.func.isRequired,\n};\n\n/**\n * Gets the position to put the button to select (only used for touch devices)\n * Will get the highest y and the mean x\n *\n * @param {Array} possiblePlayerPositions\n * @returns {Point}\n */\nfunction getSelectButtonPosition(possiblePlayerPositions) {\n    if (!possiblePlayerPositions || !possiblePlayerPositions.length) {\n        return { x: 0, y: 0 };\n    }\n    const maxY = possiblePlayerPositions.reduce((acc, position) => {\n        return Math.max(acc, position.screen.y);\n    }, Number.MIN_VALUE);\n\n    const totalX = possiblePlayerPositions.reduce((acc, position) => {\n        return position.screen.x + acc;\n    }, 0);\n\n    return {\n        x: totalX / possiblePlayerPositions.length,\n        y: maxY,\n    };\n}\n\nexport default MovementPicker;\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { PathLine } from 'react-svg-pathline';\nimport { player as playerProp, Move } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    getOtherPlayersPositionInScreen,\n    getPossibleDestinationsForPlayerInScreen,\n} from 'store/game/selectors';\nimport { setPlayerCSSVars, getColorForTempLine } from 'utils/playerPainter';\nimport { pickRandomFromArray } from 'utils/random';\nimport { SWITCH_RANDOM_SELECTION_EVERY } from 'constants/ux.js';\nimport './style.css';\n\nfunction RandomSelectionAnimation({\n    player,\n    children,\n    switchRandomEvery,\n    highlightMove,\n}) {\n    const rootElement = useRef(null);\n    const [tempLine, setTempLine] = useState(null);\n    const [highlightedPosition, setHighlightedPosition] = useState(null);\n    useEffect(() => {\n        setPlayerCSSVars(rootElement.current, player.style);\n    }, [player.style]);\n    useEffect(() => {\n        setTempLine(null);\n        return () => setTempLine(null);\n    }, [player]);\n\n    const circuit = useSelector((state) => state.game.circuitInfo);\n    const originalPlayerScreenPosition = useSelector((state) =>\n        projectToScreenPosition(state, player.position),\n    );\n    const possiblePositions = useSelector((state) =>\n        getPossibleDestinationsForPlayerInScreen(state, player),\n    );\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const randomPosition = pickRandomFromArray(possiblePositions);\n            setHighlightedPosition(randomPosition);\n            setTempLine(randomPosition.screen);\n        }, switchRandomEvery);\n        return () => {\n            clearInterval(interval);\n        };\n    }, [player, possiblePositions, switchRandomEvery]);\n    const otherPlayersPosition = useSelector((state) =>\n        getOtherPlayersPositionInScreen(state, player.id),\n    );\n    const moveToHighlight = useSelector((state) =>\n        projectToScreenPosition(state, highlightMove),\n    );\n\n    return (\n        <div ref={rootElement}>\n            {children && (\n                <div\n                    className=\"random-selection-animation-warning\"\n                    style={{\n                        top: originalPlayerScreenPosition.y,\n                        left: originalPlayerScreenPosition.x,\n                    }}\n                >\n                    {children}\n                </div>\n            )}\n            {possiblePositions.map((eachPosition) => {\n                const key = getKey(player, eachPosition);\n                return (\n                    <div\n                        key={key}\n                        className={classNames('random-selection-animation', {\n                            'is-highlighted':\n                                !moveToHighlight &&\n                                highlightedPosition &&\n                                getKey(player, highlightedPosition) === key,\n                        })}\n                        style={{\n                            left: eachPosition.screen.x,\n                            top: eachPosition.screen.y,\n                        }}\n                    />\n                );\n            })}\n\n            {moveToHighlight && (\n                <div\n                    className=\"random-selection-animation-highlighted-move\"\n                    style={{\n                        left: moveToHighlight.x,\n                        top: moveToHighlight.y,\n                    }}\n                />\n            )}\n\n            {!moveToHighlight && tempLine && (\n                <svg className=\"random-selection-animation-temp-line\">\n                    <PathLine\n                        points={[originalPlayerScreenPosition, tempLine]}\n                        stroke={getColorForTempLine(\n                            player,\n                            [originalPlayerScreenPosition, tempLine],\n                            circuit,\n                            otherPlayersPosition,\n                        )}\n                        strokeWidth={player.style.trailWidth}\n                        strokeDasharray=\"2\"\n                        fill=\"none\"\n                        r={2}\n                    />\n                </svg>\n            )}\n        </div>\n    );\n}\n\nfunction getKey(player, position) {\n    return `${player.id}_${position.position.x}_${position.position.y}`;\n}\n\nRandomSelectionAnimation.propTypes = {\n    player: playerProp.isRequired,\n    children: PropTypes.node,\n    switchRandomEvery: PropTypes.number,\n    highlightMove: Move,\n};\n\nRandomSelectionAnimation.defaultProps = {\n    children: null,\n    switchRandomEvery: SWITCH_RANDOM_SELECTION_EVERY,\n    highlightMove: null,\n};\n\nexport default RandomSelectionAnimation;\n","import React, { useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { PathLine } from 'react-svg-pathline';\n\nimport './style.css';\n\nconst PlayerTrail = ({ player, isActive }) => {\n    const rootElement = useRef(null);\n    useEffect(() => {\n        setCSSVars(rootElement.current, player.style);\n    }, [player.style]);\n    const storeState = useSelector((state) => state);\n    if (!player.prevPositions.length) {\n        return '';\n    }\n    const points = player.prevPositions.map((position) =>\n        projectToScreenPosition(storeState, position),\n    );\n    const pointsWithoutLast = points.slice(0, points.length - 1);\n    return (\n        <div\n            className={classNames('player-trail-container', {\n                'is-active': isActive,\n            })}\n            ref={rootElement}\n        >\n            <svg className=\"player-trail\">\n                <PathLine\n                    points={points}\n                    stroke={player.style.trailColor}\n                    strokeWidth={player.style.trailWidth}\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n            {pointsWithoutLast\n                .map((point, index) => {\n                    return { ...point, turn: index + 1 };\n                })\n                .map((point) => (\n                    <div\n                        key={`${player.id}_${point.x}_${point.y}_${point.turn}`}\n                        className=\"player-trail-point\"\n                        style={{\n                            left: point.x,\n                            top: point.y,\n                        }}\n                    />\n                ))}\n        </div>\n    );\n};\n\nPlayerTrail.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nfunction setCSSVars(element, style) {\n    if (!element) {\n        return;\n    }\n    element.style.setProperty('--player-trail-color', style.dotColor);\n    element.style.setProperty('--player-trail-size', `${style.dotSize}px`);\n    element.style.setProperty('--player-trail-border-radius', style.round);\n}\n\nexport default PlayerTrail;\n","import React from 'react';\nimport Grid from 'components/Grid';\nimport Player from 'components/Player';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n    handlePlayerPositionSelection,\n    confirmPositionSelection,\n} from 'store/game/async-actions';\nimport {\n    getCurrentPlayer,\n    getAllPlayers,\n    isWaitingForPlayerInput,\n    isAnimatingRandomSelection,\n    isAnimatingAISelection,\n    getAISelectedMove,\n} from 'store/game/selectors';\nimport MovementPicker from 'components/MovementPicker';\nimport RandomSelectionAnimation from 'components/RandomSelectionAnimation';\nimport PlayerTrail from 'components/PlayerTrail';\nimport './style.css';\n\nconst GameBoardContents = () => {\n    const dispatch = useDispatch();\n    const players = useSelector((state) => getAllPlayers(state));\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n    const mapZoom = useSelector((state) => state.map.zoom);\n    const gridSize = useSelector((state) => state.map.gridSize);\n    const circuitInfo = useSelector((state) => state.game.circuitInfo);\n    const waitingForPlayerInput = useSelector(isWaitingForPlayerInput);\n    const animatingRandomSelection = useSelector(isAnimatingRandomSelection);\n    const animatingAISelection = useSelector(isAnimatingAISelection);\n    const AIMove = useSelector(getAISelectedMove);\n\n    return (\n        <>\n            <div\n                className=\"game-board-circuit-bg\"\n                style={{\n                    backgroundImage: `url(${circuitInfo.bgImg})`,\n                    backgroundSize: `${circuitInfo.width}px ${circuitInfo.height}px`,\n                }}\n            />\n            <Grid zoom={mapZoom} cellSize={gridSize} />\n            {players.map((player) => (\n                <div key={player.id}>\n                    <Player\n                        player={player}\n                        isActive={player === currentPlayer}\n                    />\n                    <PlayerTrail\n                        player={player}\n                        isActive={player === currentPlayer}\n                    />\n                </div>\n            ))}\n            {currentPlayer && waitingForPlayerInput && (\n                <>\n                    <MovementPicker\n                        key={currentPlayer?.id}\n                        player={currentPlayer}\n                        onPositionSelected={(position) =>\n                            dispatch(\n                                handlePlayerPositionSelection(\n                                    currentPlayer,\n                                    position,\n                                ),\n                            )\n                        }\n                        onConfirmSelection={() => {\n                            dispatch(confirmPositionSelection(currentPlayer));\n                        }}\n                    />\n                </>\n            )}\n            {currentPlayer && animatingRandomSelection && (\n                <>\n                    <RandomSelectionAnimation player={currentPlayer}>\n                        Too late!\n                        <br /> Choosing a random move for you...\n                    </RandomSelectionAnimation>\n                </>\n            )}\n            {currentPlayer && animatingAISelection && (\n                <>\n                    <RandomSelectionAnimation\n                        player={currentPlayer}\n                        switchRandomEvery={getRandomSpeedForAI(currentPlayer)}\n                        highlightMove={AIMove}\n                    />\n                </>\n            )}\n        </>\n    );\n};\n\nfunction getRandomSpeedForAI(player) {\n    switch (player.levelAI) {\n        case 0:\n            return 800;\n        case 1:\n            return 400;\n        case 2:\n            return 200;\n        case 3:\n            return 100;\n        default:\n            return 75;\n    }\n}\n\nGameBoardContents.propTypes = {};\n\nGameBoardContents.defaultProps = {};\n\nexport default GameBoardContents;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport {\n    getCurrentPlayer,\n    isWaitingForPlayerInput,\n} from 'store/game/selectors';\nimport { pause } from 'store/game/async-actions';\nimport CounterDisplay from 'components/CounterDisplay';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport { HUMAN } from 'constants/player-types';\nimport GameBoardCameraHandler from './GameBoardCameraHandler';\nimport GameBoardContents from './GameBoardContents';\nimport './style.css';\n\nconst GameBoard = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n    const waitingForPlayerInput = useSelector(isWaitingForPlayerInput);\n    const playWithTimer = useSelector((state) => state.mainUI.playWithTimer);\n    const shouldShowPauseButton =\n        !currentPlayer || currentPlayer.type === HUMAN;\n\n    return (\n        <div className=\"game-board-container\">\n            <GameBoardCameraHandler currentPlayer={currentPlayer}>\n                <GameBoardContents />\n            </GameBoardCameraHandler>\n            {waitingForPlayerInput && playWithTimer && (\n                <CounterDisplay counterObject={waitingForPlayerCounter} />\n            )}\n            {shouldShowPauseButton && (\n                <div className=\"pause-button-container\">\n                    <button\n                        type=\"button\"\n                        className=\"button button-small\"\n                        onClick={() => dispatch(pause())}\n                    >\n                        Pause\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n};\n\nGameBoard.propTypes = {};\n\nGameBoard.defaultProps = {};\n\nexport default GameBoard;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { player as playerProp } from 'components/propTypes';\nimport PlayerIcon from 'components/PlayerIcon';\n\nconst PlayerListItem = ({ player, isActive }) => {\n    return (\n        <li\n            className={classNames('player-list-item', {\n                'is-active': isActive,\n            })}\n        >\n            <div className=\"player-list-item-decorator-container\">\n                <div className=\"player-list-item-decorator\" />\n                <PlayerIcon playerStyle={player.style} />\n            </div>\n            <div>{player.name}</div>\n        </li>\n    );\n};\n\nPlayerListItem.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default PlayerListItem;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer, getAllPlayers } from 'store/game/selectors';\nimport PlayerListItem from './PlayerListItem';\nimport './style.css';\n\nconst PlayerList = () => {\n    const players = useSelector((state) => getAllPlayers(state));\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        <ul className=\"player-list\">\n            {players.map((player) => (\n                <PlayerListItem\n                    key={player.id}\n                    player={player}\n                    isActive={player === currentPlayer}\n                />\n            ))}\n        </ul>\n    );\n};\n\nexport default PlayerList;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { startTurn } from 'store/game/async-actions';\n\nconst StartGameModal = () => {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(startTurn())}\n        >\n            <div className=\"game-screen-modal-content\">\n                Everybody ready?\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Start game!\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default StartGameModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport { startWaitingForPlayerInput } from 'store/game/async-actions';\n\nconst StartTurnModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(startWaitingForPlayerInput())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>,\n                    it is your turn\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Start my turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default StartTurnModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport pluralize from 'pluralize';\nimport { nextTurn } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyCollisionModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal\" onClick={() => dispatch(nextTurn())}>\n            <div className=\"game-screen-modal-content\">\n                <div>You crashed!</div>\n                <div className=\"secondary-text mt-s\">\n                    (grounded for {currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)})\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Next turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyCollisionModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyAICollisionModal = () => {\n    const [showContent, setShowContent] = useState(false);\n    useEffect(() => {\n        const timeout = setTimeout(() => setShowContent(true), 100);\n        return () => {\n            clearTimeout(timeout);\n        };\n    }, []);\n\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n            <div\n                className={classNames('game-screen-modal-content', {\n                    'is-hidden': !showContent,\n                })}\n            >\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    has crashed :(\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyAICollisionModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { reduceGroundedAndNextTurn } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport pluralize from 'pluralize';\n\nconst NotifyGroundedModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(reduceGroundedAndNextTurn())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>,\n                    you are grounded because you crashed!\n                </div>\n                <div className=\"secondary-text mt-s\">\n                    ({currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)} left)\n                </div>\n\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Next turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyGroundedModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport pluralize from 'pluralize';\n\nconst NotifyAIGroundedModal = () => {\n    const [showContent, setShowContent] = useState(false);\n    useEffect(() => {\n        const timeout = setTimeout(() => setShowContent(true), 100);\n        return () => {\n            clearTimeout(timeout);\n        };\n    }, []);\n\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n            <div\n                className={classNames('game-screen-modal-content', {\n                    'is-hidden': !showContent,\n                })}\n            >\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span> is\n                    grounded after a crash.\n                </div>\n                <div className=\"secondary-text\">\n                    ({currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)} left)\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyAIGroundedModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { finishGame } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyVictoryModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(finishGame())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    won!\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Yay!\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyVictoryModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { unpause, finishGame } from 'store/game/async-actions';\n\nconst InGameMenuModal = () => {\n    const dispatch = useDispatch();\n\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal\" onClick={() => dispatch(unpause())}>\n            <div className=\"game-screen-modal-content\">\n                <div>Paused</div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Continue!\n                </button>\n\n                <button\n                    className=\"button game-screen-modal-button game-screen-modal-button-secondary \"\n                    type=\"button\"\n                    onClick={(event) => {\n                        event.stopPropagation();\n                        dispatch(finishGame());\n                    }}\n                >\n                    Exit game\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default InGameMenuModal;\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { Score, Circuit } from 'components/propTypes';\nimport { useDispatch } from 'react-redux';\nimport { showReplay } from 'store/game/async-actions';\nimport './style.css';\n\nfunction ScoreBoard({ scores, highlightedScore, canReplay, circuit }) {\n    const dispatch = useDispatch();\n\n    const onScoreClicked = (score) => {\n        if (!canReplay) {\n            return;\n        }\n        dispatch(showReplay(score, circuit));\n    };\n    return (\n        <div className=\"score-board\">\n            {!!scores.length &&\n                scores.map((score, index) => (\n                    // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n                    <div\n                        onClick={() => onScoreClicked(score)}\n                        className={classNames('score-board-item', {\n                            'is-highlighted':\n                                highlightedScore &&\n                                highlightedScore.id === score.id,\n                            'is-clickable': canReplay,\n                        })}\n                        key={`score-board-item-${score.id}`}\n                    >\n                        <div className=\"score-board-item-index\">\n                            {index + 1}\n                        </div>\n                        <div className=\"score-board-item-name\">\n                            {score.name}\n                        </div>\n                        <div className=\"score-board-item-turns\">\n                            <span className=\"score-board-item-value\">\n                                {score.turns}\n                            </span>\n                            <span className=\"score-board-item-text\">\n                                {' '}\n                                turns\n                            </span>\n                        </div>\n                        <div className=\"score-board-item-turns\">\n                            <span className=\"score-board-item-value\">\n                                {score.date?.toLocaleDateString()}\n                            </span>\n                        </div>\n\n                        <div className=\"score-board-item-time\">\n                            (\n                            <span className=\"score-board-item-value\">\n                                {(score.realTimeUsed / 1000).toFixed(2)}{' '}\n                            </span>\n                            <span className=\"score-board-item-text\">\n                                seconds\n                            </span>\n                            )\n                        </div>\n                    </div>\n                ))}\n\n            {!scores.length && (\n                <div className=\"score-board-empty\">No high scores yet!</div>\n            )}\n        </div>\n    );\n}\n\nScoreBoard.propTypes = {\n    scores: PropTypes.arrayOf(Score).isRequired,\n    highlightedScore: Score,\n    canReplay: PropTypes.bool,\n    circuit: Circuit.isRequired,\n};\n\nScoreBoard.defaultProps = {\n    highlightedScore: null,\n    canReplay: false,\n};\n\nexport default ScoreBoard;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { finishGame } from 'store/game/async-actions';\nimport { getCurrentPlayer, getLatestHighScore } from 'store/game/selectors';\nimport ScoreBoard from 'components/ScoreBoard';\nimport { getByCircuitId } from 'utils/highScoresStorage';\n\nconst NotifyHighScoreModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n    const highScore = useSelector((state) => getLatestHighScore(state));\n    const circuit = useSelector((state) => state.game.circuitInfo);\n    const highScoresForCircuit = getByCircuitId(circuit.id);\n\n    return (\n        <div className=\"game-screen-modal\">\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    won, and set a high score for this circuit!\n                </div>\n                <div className=\"notify-high-scores-circuit\">\n                    <ScoreBoard\n                        circuit={circuit}\n                        scores={highScoresForCircuit}\n                        highlightedScore={highScore}\n                    />\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                    onClick={() => dispatch(finishGame())}\n                >\n                    Back to main menu\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyHighScoreModal;\n","import React, { useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst AIThinkingModal = () => {\n    const [showContent, setShowContent] = useState(false);\n    useEffect(() => {\n        const timeout = setTimeout(() => setShowContent(true), 1000);\n        return () => {\n            clearTimeout(timeout);\n        };\n    }, []);\n\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n            <div\n                className={classNames('game-screen-modal-content', {\n                    'is-hidden': !showContent,\n                })}\n            >\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span> is\n                    choosing its next move...\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default AIThinkingModal;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport * as gameStates from 'constants/game-states';\nimport { getGameState } from 'store/game/selectors';\nimport StartGameModal from './StartGameModal';\nimport StartTurnModal from './StartTurnModal';\nimport NotifyCollisionModal from './NotifyCollisionModal';\nimport NotifyAICollisionModal from './NotifyAICollisionModal';\nimport NotifyGroundedModal from './NotifyGroundedModal';\nimport NotifyAIGroundedModal from './NotifyAIGroundedModal';\nimport NotifyVictoryModal from './NotifyVictoryModal';\nimport InGameMenuModal from './InGameMenuModal';\nimport NotifyHighScoreModal from './NotifyHighScoreModal';\nimport AIThinkingModal from './AIThinkingModal';\nimport './style.css';\n\nconst GameScreenModals = () => {\n    const gameState = useSelector((state) => getGameState(state));\n\n    switch (gameState) {\n        case gameStates.START_SCREEN:\n            return <StartGameModal />;\n        case gameStates.PLAYER_TURN_START_SCREEN:\n            return <StartTurnModal />;\n        case gameStates.NOTIFY_COLLISION:\n            return <NotifyCollisionModal />;\n        case gameStates.NOTIFY_AI_COLLISION:\n            return <NotifyAICollisionModal />;\n        case gameStates.NOTIFY_GROUNDED:\n            return <NotifyGroundedModal />;\n        case gameStates.NOTIFY_AI_GROUNDED:\n            return <NotifyAIGroundedModal />;\n        case gameStates.NOTIFY_VICTORY:\n            return <NotifyVictoryModal />;\n        case gameStates.NOTIFY_HIGH_SCORE:\n            return <NotifyHighScoreModal />;\n        case gameStates.SHOW_MENU:\n            return <InGameMenuModal />;\n        case gameStates.AI_THINKING_SCREEN:\n            return <AIThinkingModal />;\n        default:\n            return '';\n    }\n};\n\nGameScreenModals.propTypes = {};\n\nGameScreenModals.defaultProps = {};\n\nexport default GameScreenModals;\n","import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\nfunction KeyPressListener({ keys }) {\n    useEffect(() => {\n        const onKeyPress = (event) => {\n            if (keys[event.code]) {\n                keys[event.code]();\n            }\n        };\n        window.document.addEventListener('keyup', onKeyPress);\n\n        return () => {\n            window.document.removeEventListener('keyup', onKeyPress);\n        };\n    }, [keys]);\n    return <></>;\n}\n\nKeyPressListener.propTypes = {\n    keys: PropTypes.objectOf(PropTypes.func).isRequired,\n};\n\nexport default KeyPressListener;\n","import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n// Set the name of the hidden property and the change event for visibility\nlet hidden;\nlet visibilityChange;\nif (typeof document.hidden !== 'undefined') {\n    // Opera 12.10 and Firefox 18 and later support\n    hidden = 'hidden';\n    visibilityChange = 'visibilitychange';\n} else if (typeof document.msHidden !== 'undefined') {\n    hidden = 'msHidden';\n    visibilityChange = 'msvisibilitychange';\n} else if (typeof document.webkitHidden !== 'undefined') {\n    hidden = 'webkitHidden';\n    visibilityChange = 'webkitvisibilitychange';\n}\n\nfunction WindowBlurListener({ onBlur }) {\n    useEffect(() => {\n        // Warn if the browser doesn't support addEventListener or the Page Visibility API\n        if (\n            typeof document.addEventListener === 'undefined' ||\n            hidden === undefined\n        ) {\n            return () => {}; // not supported\n        }\n\n        const handleVisibilityChange = () => {\n            if (document[hidden]) {\n                onBlur();\n            }\n        };\n        document.addEventListener(\n            visibilityChange,\n            handleVisibilityChange,\n            false,\n        );\n        return () => {\n            document.removeEventListener(\n                visibilityChange,\n                handleVisibilityChange,\n                false,\n            );\n        };\n    }, [onBlur]);\n    return <></>;\n}\n\nWindowBlurListener.propTypes = {\n    onBlur: PropTypes.func.isRequired,\n};\n\nexport default WindowBlurListener;\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport GameBoard from 'components/GameBoard';\nimport PlayerList from 'components/PlayerList';\nimport GameScreenModals from 'components/GameScreenModals';\nimport KeyPressListener from 'components/KeyPressListener';\nimport WindowBlurListener from 'components/WindowBlurListener';\nimport {\n    tryToToggleInGameMenu,\n    tryToShowInGameMenu,\n} from 'store/game/async-actions';\n\nimport './style.css';\n\nconst Game = () => {\n    const dispatch = useDispatch();\n    return (\n        <div className=\"transition-opacity\">\n            <KeyPressListener\n                keys={{\n                    Escape: () => dispatch(tryToToggleInGameMenu()),\n                    Space: () => dispatch(tryToToggleInGameMenu()),\n                }}\n            />\n            <WindowBlurListener\n                onBlur={() => dispatch(tryToShowInGameMenu())}\n            />\n            <GameBoard />\n            <PlayerList />\n            <GameScreenModals />\n        </div>\n    );\n};\n\nexport default Game;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction CircuitSelector({ circuit, onClick }) {\n    return (\n        <div className=\"circuit-selector\" onClick={onClick}>\n            <img\n                className=\"circuit-selector-img\"\n                src={circuit.bgImg}\n                alt={circuit.name}\n            />\n            <div className=\"circuit-selector-footer\">\n                <div className=\"circuit-selector-name\">{circuit.name}</div>\n                <div className=\"circuit-selector-players\">\n                    {circuit.maxPlayers} players\n                </div>\n            </div>\n        </div>\n    );\n}\n\nCircuitSelector.propTypes = {\n    circuit: PropTypes.shape({\n        name: PropTypes.string,\n        bgImg: PropTypes.string,\n        maxPlayers: PropTypes.number,\n    }).isRequired,\n    onClick: PropTypes.func.isRequired,\n};\n\nexport default CircuitSelector;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen, setSelectedCircuit } from 'store/main-ui/actions';\nimport { MAIN_MENU, PLAYERS_SELECTION } from 'constants/screens';\nimport { circuits } from 'constants/circuits';\nimport CircuitSelector from 'components/CircuitSelector';\nimport Logo from 'components/Logo';\nimport './style.css';\n\nconst circuitsArray = Object.values(circuits);\n\nfunction CircuitSelection({ className }) {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer circuit-selection',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-top\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Select circuit</h1>\n            </div>\n            <div className=\"menu-content circuit-selection-content transition-from-bottom\">\n                <div className=\"circuit-selection-list\">\n                    {circuitsArray.map((circuit) => (\n                        <CircuitSelector\n                            key={circuit.id}\n                            onClick={() => {\n                                dispatch(setSelectedCircuit(circuit.id));\n                                dispatch(changeScreen(PLAYERS_SELECTION));\n                            }}\n                            circuit={circuit}\n                        />\n                    ))}\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-bottom\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default CircuitSelection;\n","import { v4 as uuid } from 'uuid';\nimport { getRandomName } from 'utils/getRandomName';\nimport { pickRandomFromArray, keepPickingUntilNotInArray } from 'utils/random';\nimport { STYLES } from 'constants/player-styles';\nimport { HUMAN } from 'constants/player-types';\nimport { getPlayersOrderedBy } from 'utils/players-order';\nimport { setSelectedPlayers, updatePlayer } from './actions';\n\nexport const addRandomPlayer = () => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const playerOrder = state.mainUI.selectedPlayerOrder;\n        const players = state.mainUI.selectedPlayers;\n        const allStyles = Object.values(STYLES);\n        const currentNames = players.map((player) => player.name);\n        const currentStyles = players.map((player) => player.style);\n        const newStyle = keepPickingUntilNotInArray(\n            () => pickRandomFromArray(allStyles),\n            currentStyles,\n        );\n        const newName = keepPickingUntilNotInArray(getRandomName, currentNames);\n\n        const newPlayer = {\n            id: uuid(),\n            name: newName,\n            style: newStyle,\n            type: HUMAN,\n            levelAI: 0,\n        };\n\n        dispatch(\n            setSelectedPlayers(\n                players.concat(newPlayer),\n                playerOrder.concat(newPlayer.id),\n            ),\n        );\n    };\n};\n\nexport const selectNewStyleForPlayer = (player) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const players = state.mainUI.selectedPlayers;\n        const allStyles = Object.values(STYLES);\n        const otherPlayers = players.filter(\n            (otherPlayer) => otherPlayer.id !== player.id,\n        );\n\n        const stylesToUse = allStyles.reduce((acc, style) => {\n            if (isStyleUsedByPlayers(style, otherPlayers)) {\n                return acc;\n            }\n            return acc.concat([style]);\n        }, []);\n\n        const currentIndex = stylesToUse.findIndex(\n            (style) => style.id === player.style.id,\n        );\n\n        const nextStyleIndex = (currentIndex + 1) % stylesToUse.length;\n\n        dispatch(\n            updatePlayer(player.id, {\n                style: stylesToUse[nextStyleIndex],\n            }),\n        );\n    };\n};\n\nfunction isStyleUsedByPlayers(style, players) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const player of players) {\n        if (player.style.id === style.id) {\n            return true;\n        }\n    }\n    return false;\n}\n\nexport const limitPlayersTo = (numberOfPlayers) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const players = state.mainUI.selectedPlayers;\n        const order = state.mainUI.selectedPlayerOrder;\n        const orderedPlayers = getPlayersOrderedBy(players, order);\n        dispatch(\n            setSelectedPlayers(\n                orderedPlayers.slice(0, numberOfPlayers),\n                order.slice(0, numberOfPlayers),\n            ),\n        );\n    };\n};\n","import React from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { selectablePlayer } from 'components/propTypes';\nimport PlayerIcon from 'components/PlayerIcon';\nimport { HUMAN, AI } from 'constants/player-types';\nimport './style.css';\n\nfunction PlayerSelector({\n    player,\n    onRemove,\n    canBeRemoved,\n    onNameChange,\n    onTypeChange,\n    onLevelAIChange,\n    onSelectNewStyle,\n}) {\n    return (\n        <div className=\"player-selector\">\n            <div className=\"player-selector-top\">\n                <input\n                    className=\"player-selector-input\"\n                    type=\"text\"\n                    value={player.name}\n                    onChange={(event) => onNameChange(event.target.value)}\n                />\n                <button\n                    type=\"button\"\n                    className=\"player-selector-style-container\"\n                    onClick={onSelectNewStyle}\n                >\n                    <PlayerIcon playerStyle={player.style} />\n                </button>\n                <button\n                    type=\"button\"\n                    className=\"button button-small\"\n                    onClick={onRemove}\n                    disabled={!canBeRemoved}\n                    style={{\n                        opacity: canBeRemoved ? 1 : 0,\n                    }}\n                >\n                    Delete\n                </button>\n            </div>\n            <div className=\"player-selector-bottom\">\n                <button\n                    type=\"button\"\n                    className={classNames('player-selector-toggle', {\n                        'is-selected': player.type === HUMAN,\n                    })}\n                    onClick={() => onTypeChange(HUMAN)}\n                >\n                    Human\n                </button>\n                <button\n                    type=\"button\"\n                    className={classNames('player-selector-toggle', {\n                        'is-selected': player.type === AI,\n                    })}\n                    onClick={() => onTypeChange(AI)}\n                >\n                    AI\n                </button>\n\n                {player.type === AI && (\n                    <div className=\"player-selector-ai-level\">\n                        <input\n                            value={player.levelAI}\n                            type=\"range\"\n                            min=\"0\"\n                            max=\"3\"\n                            step=\"1\"\n                            onChange={(event) =>\n                                onLevelAIChange(\n                                    parseInt(event.target.value, 10),\n                                )\n                            }\n                        />\n                        <div className=\"player-selector-ai-level-text\">\n                            {getRobotNameByLevel(player.levelAI)}\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nfunction getRobotNameByLevel(level) {\n    switch (level) {\n        case 0:\n            return 'Super Easy';\n        case 1:\n            return 'Very Easy';\n        case 2:\n            return 'Easy';\n        case 3:\n            return 'Normal';\n        default:\n            return 'Normal';\n    }\n}\n\nPlayerSelector.propTypes = {\n    player: selectablePlayer.isRequired,\n    onRemove: PropTypes.func.isRequired,\n    onNameChange: PropTypes.func.isRequired,\n    onTypeChange: PropTypes.func.isRequired,\n    onSelectNewStyle: PropTypes.func.isRequired,\n    canBeRemoved: PropTypes.bool.isRequired,\n};\n\nexport default PlayerSelector;\n","/* eslint-disable jsx-a11y/label-has-for */\n/* eslint-disable jsx-a11y/label-has-associated-control */\nimport React, { useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n    changeScreen,\n    removePlayer,\n    updatePlayer,\n    toggleRandomizePlayerOrderOnStart,\n    togglePlayWithTimer,\n} from 'store/main-ui/actions';\nimport {\n    addRandomPlayer,\n    selectNewStyleForPlayer,\n    limitPlayersTo,\n} from 'store/main-ui/async-actions';\nimport { initGameWithSavedConfig } from 'store/game/async-actions';\nimport { circuits } from 'constants/circuits';\nimport { CIRCUIT_SELECTION } from 'constants/screens';\nimport { getOrderedPlayers } from 'store/game/selectors';\nimport PlayerSelector from 'components/PlayerSelector';\nimport Logo from 'components/Logo';\nimport './style.css';\n\nfunction PlayersSelection({ className }) {\n    const dispatch = useDispatch();\n    const players = useSelector(getOrderedPlayers);\n    const circuitId = useSelector((state) => state.mainUI.selectedCircuit);\n    const circuit = circuits[circuitId];\n\n    useEffect(() => {\n        if (players.length && players.length > circuit.maxPlayers) {\n            dispatch(limitPlayersTo(circuit.maxPlayers));\n        }\n    }, [players, circuit, dispatch]);\n\n    const randomizePlayerOrderOnStart = useSelector(\n        (state) => state.mainUI.randomizePlayerOrderOnStart,\n    );\n\n    const playWithTimer = useSelector((state) => state.mainUI.playWithTimer);\n\n    const canBeRemoved = players.length > 1;\n\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Choose players</h1>\n            </div>\n            <div className=\"menu-content player-selection-content transition-from-right\">\n                <div className=\"player-selection-content-inner\">\n                    {players.map((player) => (\n                        <PlayerSelector\n                            key={player.id}\n                            player={player}\n                            onRemove={() => {\n                                if (!canBeRemoved) {\n                                    return;\n                                }\n                                dispatch(removePlayer(player.id));\n                            }}\n                            canBeRemoved={canBeRemoved}\n                            onNameChange={(newName) =>\n                                dispatch(\n                                    updatePlayer(player.id, { name: newName }),\n                                )\n                            }\n                            onTypeChange={(newType) =>\n                                dispatch(\n                                    updatePlayer(player.id, { type: newType }),\n                                )\n                            }\n                            onSelectNewStyle={() =>\n                                dispatch(selectNewStyleForPlayer(player))\n                            }\n                            onLevelAIChange={(newLevelAI) =>\n                                dispatch(\n                                    updatePlayer(player.id, {\n                                        levelAI: newLevelAI,\n                                    }),\n                                )\n                            }\n                        />\n                    ))}\n                    {players.length < circuit.maxPlayers && (\n                        <button\n                            type=\"button\"\n                            className=\"button player-selection-add-player-button\"\n                            onClick={() => dispatch(addRandomPlayer())}\n                        >\n                            Add Player\n                        </button>\n                    )}\n\n                    {players.length > 1 && (\n                        <div className=\"transition-from-right\">\n                            <label className=\"player-selection-checkbox\">\n                                <input\n                                    type=\"checkbox\"\n                                    checked={randomizePlayerOrderOnStart}\n                                    onChange={() =>\n                                        dispatch(\n                                            toggleRandomizePlayerOrderOnStart(),\n                                        )\n                                    }\n                                />\n                                Randomize player order when race starts\n                            </label>\n                        </div>\n                    )}\n                    <div className=\"transition-from-right\">\n                        <label className=\"player-selection-checkbox player-selection-checkbox-last\">\n                            <input\n                                type=\"checkbox\"\n                                checked={playWithTimer}\n                                onChange={() => dispatch(togglePlayWithTimer())}\n                            />\n                            Play with timer\n                        </label>\n                    </div>\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(CIRCUIT_SELECTION));\n                    }}\n                >\n                    Back\n                </button>\n                <div className=\"menu-footer-filler\" />\n                <button\n                    className=\"button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(initGameWithSavedConfig());\n                    }}\n                >\n                    Start game!\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default PlayersSelection;\n","export const getPlayersOrderedBy = (players, order) => {\n    return order.map((playerId) => {\n        return players.find((player) => player.id === playerId);\n    });\n};\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport { circuits } from 'constants/circuits';\nimport Logo from 'components/Logo';\nimport ScoreBoard from 'components/ScoreBoard';\nimport { getByCircuitId } from 'utils/highScoresStorage';\nimport './style.css';\n\nconst circuitsArray = Object.values(circuits);\n\nfunction HighScores() {\n    const [scoresForCurrentCircuit, setScoresForCurrentCircuit] = useState([]);\n    const [activeCircuit, setActiveCircuit] = useState(circuitsArray[0]);\n    useEffect(() => {\n        if (activeCircuit.id) {\n            setScoresForCurrentCircuit(getByCircuitId(activeCircuit.id));\n        }\n    }, [activeCircuit]);\n\n    const dispatch = useDispatch();\n\n    return (\n        <div className=\"full-screen full-screen-with-header-and-footer high-scores\">\n            <div className=\"menu-header transition-from-top\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">High scores</h1>\n            </div>\n            <div className=\"menu-content transition-from-bottom\">\n                <div className=\"high-scores-circuit-tabs-container\">\n                    <div className=\"high-scores-circuit-tabs\">\n                        {circuitsArray.map((circuit) => (\n                            <div\n                                key={circuit.id}\n                                className={classNames(\n                                    'high-scores-circuit-tab',\n                                    {\n                                        'is-active':\n                                            circuit.id === activeCircuit.id,\n                                    },\n                                )}\n                            >\n                                <div onClick={() => setActiveCircuit(circuit)}>\n                                    {circuit.name}\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n\n                <div className=\"high-scores-circuit\">\n                    <ScoreBoard\n                        circuit={activeCircuit}\n                        scores={scoresForCurrentCircuit}\n                        canReplay\n                    />\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-bottom\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default HighScores;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport Logo from 'components/Logo';\n\nimport './style.css';\n\nconst Credits = ({ className }) => {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className={classNames(\n                'full-screen',\n                'full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Credits</h1>\n            </div>\n            <div className=\"menu-content transition-from-right credits-content\">\n                <div className=\"credits-content-item\">\n                    <p>Created by Paco Gómez Granados</p>\n                    <p>\n                        <a\n                            href=\"https://pacog.github.io/portfolio/\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            https://pacog.github.io/portfolio/\n                        </a>\n                    </p>\n                    <p>\n                        <a\n                            href=\"https://twitter.com/PacoGomezGrana\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            @PacoGomezGrana\n                        </a>\n                    </p>\n                </div>\n\n                <div className=\"credits-content-item\">\n                    <p>Based on an original idea by</p>\n                    <p>\n                        <a\n                            href=\"https://twitter.com/esqizo\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            @esqizo\n                        </a>{' '}\n                        and cousins\n                    </p>\n                </div>\n\n                <div className=\"credits-content-item\">\n                    <p>Circuit graphics inspired by</p>\n                    <p>\n                        <a\n                            href=\"https://codepen.io/ste-vg\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Steve Gardner\n                        </a>\n                        ´s{' '}\n                        <a\n                            href=\"https://codepen.io/ste-vg/full/BaaQamG\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Race Car Island\n                        </a>\n                    </p>\n                </div>\n            </div>\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n};\n\nexport default Credits;\n","import React from 'react';\nimport classNames from 'classnames';\n// import Logo from 'components/Logo';\n\nimport './style.css';\n\nconst LoadingGame = ({ className }) => {\n    return (\n        <div className={classNames('full-screen', className)}>\n            <div className=\"loading-game\">\n                <div className=\"lds-ellipsis\">\n                    <div />\n                    <div />\n                    <div />\n                    <div />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default LoadingGame;\n","import React, { useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { raceHistory as raceHistoryProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { PathLine } from 'react-svg-pathline';\nimport { CAR } from 'constants/player-styles';\n\nimport './style.css';\n\nconst defaultStyle = CAR;\n\nconst ReplayPlayerTrail = ({ raceHistory, isActive }) => {\n    const rootElement = useRef(null);\n    useEffect(() => {\n        setCSSVars(rootElement.current, raceHistory.style || defaultStyle);\n    }, [raceHistory]);\n    const storeState = useSelector((state) => state);\n\n    if (!raceHistory.path.length) {\n        return '';\n    }\n    const points = raceHistory.path.map((position) =>\n        projectToScreenPosition(storeState, position),\n    );\n\n    return (\n        <div\n            className={classNames('player-trail-container', {\n                'is-active': isActive,\n            })}\n            ref={rootElement}\n        >\n            <svg className=\"player-trail\">\n                <PathLine\n                    points={points}\n                    stroke={defaultStyle.trailColor}\n                    strokeWidth={defaultStyle.trailWidth}\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n            {points\n                .map((point, index) => {\n                    return { ...point, turn: index + 1 };\n                })\n                .map((point) => (\n                    <div\n                        key={`${point.x}_${point.y}_${point.turn}`}\n                        className=\"player-trail-point\"\n                        style={{\n                            left: point.x,\n                            top: point.y,\n                        }}\n                    />\n                ))}\n        </div>\n    );\n};\n\nReplayPlayerTrail.propTypes = {\n    raceHistory: raceHistoryProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nfunction setCSSVars(element, style) {\n    if (!element) {\n        return;\n    }\n    element.style.setProperty('--player-trail-color', style.dotColor);\n    element.style.setProperty('--player-trail-size', `${style.dotSize}px`);\n    element.style.setProperty('--player-trail-border-radius', style.round);\n}\n\nexport default ReplayPlayerTrail;\n","import React from 'react';\nimport Grid from 'components/Grid';\nimport { useSelector } from 'react-redux';\nimport { getRaceHistory } from 'store/game/selectors';\nimport ReplayPlayerTrail from 'components/ReplayPlayerTrail';\nimport Player from 'components/Player';\nimport { player as playerProp } from 'components/propTypes';\n\nconst ReplayGameBoardContents = ({ playerInPosition }) => {\n    const raceHistory = useSelector((state) => getRaceHistory(state));\n    const mapZoom = useSelector((state) => state.map.zoom);\n    const gridSize = useSelector((state) => state.map.gridSize);\n    const circuitInfo = useSelector((state) => state.game.circuitInfo);\n\n    return (\n        <>\n            <div\n                className=\"replay-game-board-circuit-bg\"\n                style={{\n                    backgroundImage: `url(${circuitInfo.bgImg})`,\n                    backgroundSize: `${circuitInfo.width}px ${circuitInfo.height}px`,\n                }}\n            />\n            <Grid zoom={mapZoom} cellSize={gridSize} />\n            <Player player={playerInPosition} isActive />\n            <ReplayPlayerTrail raceHistory={raceHistory} isActive />\n        </>\n    );\n};\n\nReplayGameBoardContents.propTypes = {\n    playerInPosition: playerProp.isRequired,\n};\n\nReplayGameBoardContents.defaultProps = {};\n\nexport default ReplayGameBoardContents;\n","import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getRaceHistory } from 'store/game/selectors';\nimport GameBoardCameraHandler from 'components/GameBoard/GameBoardCameraHandler';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport ReplayGameBoardContents from './ReplayGameBoardContents';\nimport './style.css';\n\nconst ReplayGameBoard = () => {\n    const raceHistory = useSelector((state) => getRaceHistory(state));\n    const [playerInPosition, setPlayerInPosition] = useState(null);\n    const [currentTurn, setCurrentTurn] = useState(0);\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if (!raceHistory) {\n            return;\n        }\n        setPlayerInPosition({\n            id: raceHistory.id,\n            name: raceHistory.name,\n            style: raceHistory.playerStyle,\n            position: raceHistory.path[currentTurn],\n            speed: { x: 0, y: 0 },\n            prevPositions: [],\n        });\n    }, [raceHistory, currentTurn]);\n\n    return (\n        <div className=\"game-board-container\">\n            {playerInPosition && (\n                <GameBoardCameraHandler currentPlayer={playerInPosition}>\n                    <ReplayGameBoardContents\n                        playerInPosition={playerInPosition}\n                    />\n                </GameBoardCameraHandler>\n            )}\n            <div className=\"game-board-back-button-container\">\n                <button\n                    type=\"button\"\n                    className=\"button button-small\"\n                    onClick={() => dispatch(changeScreen(MAIN_MENU))}\n                >\n                    Back\n                </button>\n            </div>\n            {raceHistory && raceHistory.path.length && (\n                <div className=\"replay-game-board-turn-selector\">\n                    <span className=\"replay-game-board-turn-selector-label\">\n                        Turn:{' '}\n                    </span>\n                    <input\n                        type=\"range\"\n                        value={currentTurn}\n                        max={raceHistory.path.length - 1}\n                        onChange={(e) =>\n                            setCurrentTurn(parseFloat(e.target.value))\n                        }\n                    />\n                    <span className=\"replay-game-board-turn-selector-value\">\n                        {currentTurn + 1}\n                    </span>\n                </div>\n            )}\n        </div>\n    );\n};\n\nReplayGameBoard.propTypes = {};\n\nReplayGameBoard.defaultProps = {};\n\nexport default ReplayGameBoard;\n","import React from 'react';\nimport ReplayGameBoard from 'components/ReplayGameBoard';\nimport './style.css';\n\nconst ReplayGame = () => {\n    return (\n        <div className=\"transition-opacity\">\n            <ReplayGameBoard />\n        </div>\n    );\n};\n\nexport default ReplayGame;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen0({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-0\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>This is your car.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen0.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen0;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen1({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-1\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>You can move it by clicking in of the 9 buttons.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen1.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen1;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen2({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-2\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>\n                        Your next move will depend on your previous move, so be\n                        careful!\n                    </p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen2.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen2;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen3({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-3\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>If you go too fast, you may crash and be penalised.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Done!\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen3.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen3;\n","import React, { useState } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { MAIN_MENU } from 'constants/screens';\nimport Logo from 'components/Logo';\nimport { changeScreen } from 'store/main-ui/actions';\nimport TutorialScreen0 from './TutorialScreen0';\nimport TutorialScreen1 from './TutorialScreen1';\nimport TutorialScreen2 from './TutorialScreen2';\nimport TutorialScreen3 from './TutorialScreen3';\nimport './style.css';\n\nfunction Tutorial({ className }) {\n    const dispatch = useDispatch();\n    const [currentScreen, setCurrentScreen] = useState(0);\n    const goToNextScreen = () => {\n        setCurrentScreen(currentScreen + 1);\n    };\n\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">How to play</h1>\n            </div>\n            <div className=\"menu-content transition-from-right tutorial-screen-container\">\n                {currentScreen === 0 && (\n                    <TutorialScreen0 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 1 && (\n                    <TutorialScreen1 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 2 && (\n                    <TutorialScreen2 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 3 && (\n                    <TutorialScreen3\n                        onNext={() => {\n                            dispatch(changeScreen(MAIN_MENU));\n                        }}\n                    />\n                )}\n            </div>\n\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n                <div className=\"menu-footer-filler\" />\n            </footer>\n        </div>\n    );\n}\n\nexport default Tutorial;\n","import React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { TransitionGroup, CSSTransition } from 'react-transition-group';\nimport * as screens from 'constants/screens';\nimport MainMenu from 'screens/MainMenu';\nimport Game from 'screens/Game';\nimport CircuitSelection from 'screens/CircuitSelection';\nimport PlayersSelection from 'screens/PlayersSelection';\nimport HighScores from 'screens/HighScores';\nimport Credits from 'screens/Credits';\nimport LoadingGame from 'screens/LoadingGame';\nimport ReplayGame from 'screens/ReplayGame';\nimport Tutorial from 'screens/Tutorial';\n\nconst TIME_TO_SHOW_FIRST_SCREEN = 500; // ms\nconst STATE_CHANGE_TRANSITION_TIME = 300; // ms\n\nfunction Router() {\n    const [gameReady, setGameReady] = useState(false);\n    const currentScreenName = useSelector(\n        (state) => state.mainUI.currentScreen,\n    );\n    useEffect(() => {\n        const timeout = setTimeout(() => {\n            setGameReady(true);\n        }, TIME_TO_SHOW_FIRST_SCREEN);\n        return () => clearTimeout(timeout);\n    }, []);\n\n    const allScreens = [\n        {\n            screenName: screens.MAIN_MENU,\n            Component: MainMenu,\n        },\n        {\n            screenName: screens.CIRCUIT_SELECTION,\n            Component: CircuitSelection,\n        },\n        {\n            screenName: screens.PLAYERS_SELECTION,\n            Component: PlayersSelection,\n        },\n        {\n            screenName: screens.HIGH_SCORES,\n            Component: HighScores,\n        },\n        {\n            screenName: screens.GAME,\n            Component: Game,\n        },\n        {\n            screenName: screens.CREDITS,\n            Component: Credits,\n        },\n        {\n            screenName: screens.LOADING_GAME,\n            Component: LoadingGame,\n        },\n        {\n            screenName: screens.REPLAY_GAME,\n            Component: ReplayGame,\n        },\n        {\n            screenName: screens.TUTORIAL,\n            Component: Tutorial,\n        },\n    ];\n\n    return (\n        <TransitionGroup className=\"menu-screen\">\n            {allScreens\n                .filter(\n                    ({ screenName }) =>\n                        gameReady && currentScreenName === screenName,\n                )\n                .map(({ screenName, Component }) => (\n                    <CSSTransition\n                        key={screenName.toString()}\n                        timeout={STATE_CHANGE_TRANSITION_TIME}\n                        classNames=\"fade\"\n                    >\n                        <Component />\n                    </CSSTransition>\n                ))}\n        </TransitionGroup>\n    );\n}\n\nexport default Router;\n","import React, { useEffect } from 'react';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware } from 'redux';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport thunk from 'redux-thunk';\nimport rootReducer from 'store/rootReducer';\nimport { getSavedPlayers } from 'utils/playersStorage';\nimport { setSelectedPlayers } from 'store/main-ui/actions';\nimport Router from './Router';\nimport './App.css';\n\nconst store = createStore(\n    rootReducer,\n    composeWithDevTools(applyMiddleware(thunk)),\n);\n\nfunction App() {\n    useEffect(() => {\n        restoreSavedConfig({ players: getSavedPlayers() });\n    }, []);\n    return (\n        <Provider store={store}>\n            <Router />\n        </Provider>\n    );\n}\n\nfunction restoreSavedConfig({ players }) {\n    if (players) {\n        store.dispatch(\n            setSelectedPlayers(players.players, players.playerOrder),\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport {\n    init as initGameLoop,\n    addToUpdate as addToGameLoopUpdate,\n} from 'utils/gameLoop';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport addVHCSSVar from './utils/add-vh-css-var';\n\nwindow.capac_racer_version = process.env.REACT_APP_VERSION;\n\nReactDOM.render(<App />, document.getElementById('root'));\n\ninitGameLoop();\naddToGameLoopUpdate((time) => {\n    waitingForPlayerCounter.notifyTimePassed(time);\n});\n\naddVHCSSVar();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import debounce from 'lodash.debounce';\n\nexport default function() {\n    const setVH = () => {\n        const vh = window.innerHeight * 0.01;\n        document.documentElement.style.setProperty('--vh', `${vh}px`);\n    };\n\n    window.addEventListener('resize', debounce(setVH, 200));\n    setVH();\n}\n"],"sourceRoot":""}