{"version":3,"sources":["components/Grid/grid.png","utils/Counter.js","utils/waitingForPlayerCounter.js","constants/ux.js","utils/gameLoop.js","constants/player-types.js","utils/clamp.js","utils/vector2d.js","utils/player.js","utils/getUniqueIdString.js","store/players/actions.js","store/players/reducer.js","store/map/reducer.js","constants/screens.js","constants/player-styles.js","utils/random.js","utils/getRandomName.js","store/main-ui/actions.js","store/main-ui/reducer.js","constants/game-states.js","store/game/actions.js","store/game/reducer.js","store/rootReducer.js","utils/playersStorage.js","components/Logo/index.jsx","screens/MainMenu/index.jsx","utils/screenUtils.js","store/map/selectors.js","store/players/selectors.js","store/game/selectors.js","store/main-ui/selectors.js","constants/circuits.js","utils/loadImage.js","utils/imgPixelGetter.js","utils/pixel.js","utils/circuit.js","utils/range.js","utils/gameLoopTimeout.js","utils/highScoresStorage.js","constants/ai-levels.js","utils/PartialCircuitSolution.js","utils/ai.js","utils/request-animation-frame.js","utils/is-touch-device.js","utils/analytics.js","store/game/async-actions.js","components/CounterDisplay/index.jsx","components/propTypes.js","components/GameBoard/GameBoardCameraHandler.jsx","components/Grid/index.jsx","components/PlayerIcon/index.jsx","utils/playerPainter.js","components/Player/index.jsx","components/MovementPicker/PossibleDestinations.jsx","components/MovementPicker/index.jsx","components/RandomSelectionAnimation/index.jsx","components/PlayerTrail/index.jsx","components/GameBoard/GameBoardContents.jsx","components/GameBoard/index.jsx","components/PlayerList/PlayerListItem.jsx","components/PlayerList/index.jsx","components/GameScreenModals/StartGameModal.jsx","components/GameScreenModals/StartTurnModal.jsx","components/GameScreenModals/NotifyCollisionModal.jsx","components/ShowContentAfter/index.jsx","components/GameScreenModals/NotifyAICollisionModal.jsx","components/GameScreenModals/NotifyGroundedModal.jsx","components/GameScreenModals/NotifyAIGroundedModal.jsx","components/GameScreenModals/NotifyVictoryModal.jsx","components/GameScreenModals/InGameMenuModal.jsx","components/ScoreBoard/index.jsx","components/GameScreenModals/NotifyHighScoreModal.jsx","components/GameScreenModals/AIThinkingModal.jsx","components/GameScreenModals/index.jsx","components/KeyPressListener/index.jsx","components/WindowBlurListener/index.jsx","screens/Game/index.jsx","components/CircuitSelector/index.jsx","screens/CircuitSelection/index.jsx","store/main-ui/async-actions.js","components/PlayerSelector/index.jsx","screens/PlayersSelection/index.jsx","utils/players-order.js","screens/HighScores/index.jsx","screens/Credits/index.jsx","screens/LoadingGame/index.jsx","components/ReplayPlayerTrail/index.jsx","components/ReplayGameBoard/ReplayGameBoardContents.jsx","components/ReplayGameBoard/index.jsx","screens/ReplayGame/index.jsx","screens/Tutorial/TutorialScreen0.jsx","screens/Tutorial/TutorialScreen1.jsx","screens/Tutorial/TutorialScreen2.jsx","screens/Tutorial/TutorialScreen3.jsx","screens/Tutorial/index.jsx","Router.jsx","App.js","serviceWorker.js","index.js","utils/addVhCssVar.js"],"names":["module","exports","Counter","timeToWait","started","_elapsedTime","this","_timeToWait","_isRunning","Number","MAX_VALUE","time","_callbackOnEnd","callbackOnEnd","Math","max","counter","initted","delta","lastFrameTimeMs","gameLoop","timestamp","update","requestAnimationFrame","callbacksToUpdate","timeDiff","forEach","callback","removeFromUpdate","filter","eachCallback","addToUpdate","concat","HUMAN","AI","clamp","x","min","add","v1","v2","y","substract","isEqual","magnitude","v","sqrt","distance","round","isInsideViewport","vector","viewport","padding","topLeft","size","width","height","getClosestPointInsideViewport","minX","maxX","minY","maxY","movePlayerTo","player","position","timePassed","newSpeed","speedMagnitude","speed","prevPositions","turnsSpent","maxSpeed","realTimeUsed","crashPlayer","turnsGrounded","floor","crashes","reduceGrounded","addCheckpoints","newIndexes","newCheckpoints","checkpointsPassed","slice","sort","newIndex","usedIds","getUniqueIdString","intendedId","uniqueId","uuid","actionTypes","MOVE_TO","id","SET_PLAYERS","NOTIFY_COLLISION","REDUCE_GROUNDED","NOTIFY_VISITED_CHECKPOINTS","players","combineReducers","byId","state","action","type","reduce","accumulator","PLAYER_DEFAULT_INFO","playerId","newCheckpointIndexes","levelAI","map","zoom","gridSize","MAIN_MENU","GAME","CIRCUIT_SELECTION","PLAYERS_SELECTION","HIGH_SCORES","CREDITS","LOADING_GAME","REPLAY_GAME","TUTORIAL","CAR","name","dotColor","dotSize","trailColor","trailDotsSize","trailWidth","icon","process","ROCKET","TURTLE","SKULL","CLOWN","DANCER","PANDA","COFFIN","BROOM","SAILBOAT","STYLES","pickRandomFromArray","array","length","random","keepPickingUntilNotInArray","pickerFn","arrayToAvoid","maxTries","i","newPick","indexOf","Error","FIRST_NAMES","LAST_NAMES","getRandomName","CHANGE_SCREEN","SET_SELECTED_CIRCUIT","SET_SELECTED_PLAYERS","REMOVE_PLAYER","UPDATE_PLAYER","TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START","TOGGLE_PLAY_WITH_TIMER","changeScreen","screenId","setSelectedPlayers","playerOrder","updatePlayer","attrsToUpdate","initialPlayers","style","Object","values","defaultOrder","mainUI","currentScreen","selectedCircuit","circuitId","selectedPlayerOrder","selectedPlayers","randomizePlayerOrderOnStart","playWithTimer","NOT_STARTED","START_SCREEN","PLAYER_TURN_START_SCREEN","WAITING_FOR_PLAYER_INPUT","ANIMATING_RANDOM_PLAYER_MOVEMENT","NOTIFY_AI_COLLISION","NOTIFY_GROUNDED","NOTIFY_AI_GROUNDED","NOTIFY_VICTORY","NOTIFY_HIGH_SCORE","SHOW_MENU","AI_THINKING_SCREEN","INIT_GAME","INIT_REPLAY","SET_GAME_STATE","ADVANCE_PLAYER_TURN","SET_CIRCUIT","SET_LATEST_HIGH_SCORE","SET_SELECTED_POSITION","SET_SELECTED_AI_MOVE","setGameState","newGameState","defaultState","gameState","gameStates","prevGameState","currentTurnPlayerId","circuitInfo","latestHighScore","selectedPosition","raceHistory","selectedAIMove","game","getNextTurn","highScore","newPosition","newMove","currentPlayer","getSavedPlayers","window","localStorage","result","getItem","e","JSON","parse","Logo","variant","className","defaultProps","MainMenu","dispatch","useDispatch","classNames","onClick","capac_racer_version","getScreenCoordinates","worldPosition","mapZoom","project","n","dx","dy","baseX","baseY","getZoom","getGridSize","projectToScreenPosition","mapGridSize","getPossibleDestinations","otherPlayers","positionAfterSpeed","positions","j","push","find","otherPosition","isPositionColliding","isWaitingForPlayerInput","isAnimatingRandomSelection","isAnimatingAISelection","getAISelectedMove","getCurrentPlayer","isGameStarted","getAllPlayers","getOtherPlayers","getOtherPlayersPositionInScreen","getGameState","getOrderedPlayers","getPossibleDestinationsForPlayerInScreen","otherPlayer","eachPosition","screen","getMovedPixelsSinceLastTurn","lastPosition","moved","getPivotForPlayerInScreen","getLatestHighScore","getSelectedPosition","getRaceHistory","getCircuitInfo","getCurrentScreen","getSelectedCircuit","shouldRandomizePlayerOrderOnStart","shouldPlayWithTimer","circuits","mouth","collisionImg","bgImg","checkpoints","maxPlayers","startingPositions","initialSpeed","heart","rosco","horse","loadImage","url","Promise","resolve","reject","img","Image","addEventListener","once","error","src","createFromImage","canvas","document","createElement","getContext","drawImage","rawData","getImageData","data","getPixel","basePosition","r","g","b","a","hasContent","createFromConfig","config","createPixelGetterFromImage","collisionPixelGetter","all","checkpointImg","loadedCheckpointImages","checkpointImage","checkpointPixelGetters","centerOfCheckpoints","getCenterOfCheckpoint","doesLineCollide","line","circuit","otherPlayersPosition","pixelsToCheck","getPixelsToCheck","doesAnyPixelCollideInImage","pixelToCheck","checkIfPlayerCanMove","from","to","movementLine","getCheckpointsVisitedInLine","checkpointPixelGetter","doesItCollide","index","imagePixelGetter","pixelInCollisionMap","start","end","lineLength","nPixelsToCheck","ceil","diffVector","Array","keys","factor","scale","checkpoint","resultArray","acc","pixel","timeout","timeMs","notifyPassOfTime","notifyTimePassed","addToGameLoopUpdate","restart","removeFromGameLoopUpdate","stop","getAll","getByCircuitId","score","date","Date","shouldScoreBeAdded","circuitScores","isBetterScore","addScore","insertBefore","scoreToAdd","v4","newScores","splice","newAll","setItem","stringify","undefined","console","warn","updateCircuitScores","otherScore","turns","levels","randomSolutionChance","maxIterations","maxThinkingDepth","timeThinking","PartialCircuitSolution","playerInfo","currentIteration","_updatePartialScore","maxDepthForSolutions","otherPlayersToConsider","canMoveThere","visitedCheckpointsInTurn","getCheckpointsInMovement","maxAvgSpeed","maxCheckpointsCoveredPerTurn","maxCheckpointsCovered","avgSpeedScore","avgSpeed","checkpointsCoveredPerTurnScore","checkpointsCoveredPerTurn","checkpointsCoveredScore","checkpointsCovered","summary","toFixed","positionHash","doesPlayerHaveRepeatedPositions","totalDistance","point","nextPoint","getAverageSpeed","getCheckpointsPassed","nextCheckpoint","_getPercentageToNextCheckpoint","getTurns","indexWithFirstPosition","hasPlayerFinishedRace","playerPositionScreen","getDistanceToNextCheckpoint","cp","eachDistance","getMaxCheckpointDistance","chooseNextMovement","chance","aiLevels","shouldGetRandomSolution","possiblePositions","returnRandomNonCrashingMove","solutionsGenerator","createSolutionsGenerator","solution","isFinished","move","openSolutions","finishedSolutions","bestFinishedSolution","solutionToExpand","getMostPromisingSolution","newSolutions","expand","newFinishedSolutions","newOpenSolutions","getScore","updateScoreWithTotals","getFirstMove","returnRandomMove","solutions","best","isTouchDevice","prefixes","split","DocumentTouch","query","matchMedia","matches","mq","join","checkTouchDevice","track","category","label","value","gtag","event_category","event_label","startTurn","getState","nextPlayer","setTimeout","reduceGroundedAndNextTurn","notifyGrounded","startWaitingForPlayerInput","handleAITurn","nextTurn","initGameWithConfig","playersWithMapPosition","initialPosition","initMapPositionForPlayers","fixPlayersWithoutName","setPlayers","waitingForPlayerCounter","setTimeToWait","then","initGame","initGameWithSavedConfig","shuffle","playersInfoToStore","version","storeSavedPlayers","handlePlayerCollision","newIntendedPosition","notifyCollision","handleCorrectMovement","detectAndStoreCheckpoints","hasPlayerWon","hasCurrentPlayerWon","moveTo","path","playerStyle","newScore","handleVictory","handlePlayerMovement","getTimePassed","handlePlayerPositionSelection","nextPosition","nextMovementPromise","minTimeToWaitForPlayer","getMinTimeToWaitForPlayer","nextMovement","finishGame","reset","pause","unpause","lastState","tryToToggleInGameMenu","getNameForPlayerWithoutName","showReplay","initReplay","CounterDisplay","timeLeft","requestRef","animate","setState","props","counterObject","getTimeLeft","cancelAnimationFrame","React","Component","PropTypes","shape","string","number","vector2d","PADDING_FOR_VIEWPORT","isRequired","arrayOf","yy","GameBoardCameraHandler","cameraPosition","boardSize","isDragging","dragStart","moveCurrentPlayerIntoView","playerScreenPosition","closestPointInViewport","newCameraMovement","oldCameraPosition","handlePointerDown","event","coordinates","getCoordinatesFromPointerEvent","handlePointerUp","handlePointerMove","cursorPosition","movement","prevProps","handleHeight","handleWidth","onResize","transform","onMouseDown","onMouseUp","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","children","connect","ownProps","eventToUse","touches","clientX","clientY","Grid","backgroundSize","cellSize","backgroundImage","gridImg","PlayerIcon","getPlayerStyleCSS","getColorForTempLine","points","Player","isActive","useSelector","left","top","PossibleDestinations","div","key","initial","transition","ease","duration","delay","onPositionSelected","onMouseEnter","onPositionHover","onMouseLeave","onPositionHoverEnd","MovementPicker","tempLine","selectButtonPosition","possiblePlayerPositions","MIN_VALUE","getSelectButtonPosition","lineToPaint","selectedPositionScreen","wouldCollide","originalPlayerScreenPosition","lastMovement","screenPosition","onConfirmSelection","stroke","strokeWidth","strokeDasharray","fill","nextPivot","RandomSelectionAnimation","switchRandomEvery","highlightMove","useState","setTempLine","highlightedPosition","setHighlightedPosition","useEffect","interval","setInterval","randomPosition","clearInterval","moveToHighlight","getKey","PlayerTrail","storeState","pointsWithoutLast","turn","GameBoardContents","waitingForPlayerInput","animatingRandomSelection","animatingAISelection","AIMove","getRandomSpeedForAI","GameBoard","shouldShowPauseButton","PlayerListItem","PlayerList","StartGameModal","StartTurnModal","NotifyCollisionModal","pluralize","ShowContentAfter","showContent","showAfter","clearTimeout","render","NotifyAICollisionModal","NotifyGroundedModal","NotifyAIGroundedModal","NotifyVictoryModal","InGameMenuModal","stopPropagation","ScoreBoard","scores","highlightedScore","canReplay","onScoreClicked","toLocaleDateString","NotifyHighScoreModal","highScoresForCircuit","AIThinkingModal","GameScreenModals","KeyPressListener","onKeyPress","code","removeEventListener","propTypes","objectOf","func","hidden","visibilityChange","WindowBlurListener","onBlur","handleVisibilityChange","msHidden","webkitHidden","Game","Escape","Space","CircuitSelector","alt","circuitsArray","CircuitSelection","selectNewStyleForPlayer","allStyles","stylesToUse","isStyleUsedByPlayers","nextStyleIndex","findIndex","PlayerSelector","onRemove","canBeRemoved","onNameChange","onTypeChange","onLevelAIChange","onSelectNewStyle","onChange","target","disabled","opacity","step","parseInt","level","getRobotNameByLevel","PlayersSelection","numberOfPlayers","order","orderedPlayers","getPlayersOrderedBy","newName","newType","newLevelAI","currentNames","currentStyles","newStyle","newPlayer","checked","HighScores","scoresForCurrentCircuit","setScoresForCurrentCircuit","activeCircuit","setActiveCircuit","Credits","href","rel","LoadingGame","defaultStyle","ReplayPlayerTrail","ReplayGameBoardContents","playerInPosition","ReplayGameBoard","setPlayerInPosition","currentTurn","setCurrentTurn","parseFloat","ReplayGame","TutorialScreen0","onNext","TutorialScreen1","TutorialScreen2","TutorialScreen3","Tutorial","setCurrentScreen","goToNextScreen","Router","gameReady","setGameReady","currentScreenName","allScreens","screenName","screens","TransitionGroup","toString","CSSTransition","store","createStore","rootReducer","composeWithDevTools","applyMiddleware","thunk","App","restoreSavedConfig","Boolean","location","hostname","match","ReactDOM","getElementById","setVH","vh","innerHeight","documentElement","setProperty","debounce","addVHCSSVar","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.91f1c82a.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFYWFhAAAAQQerqwAAAAJ0Uk5T/wDltzBKAAAAFklEQVR4nGNggIH6/2DwYJQx0hkwAABHzKo6mLcE9gAAAABJRU5ErkJggg==\"","export default class Counter {\n    /**\n     *\n     * @param {Object} params\n     * @param {number} [params.timeToWait=10000]\n     * @param {boolean} [params.started=false]\n     */\n    constructor({ timeToWait = 10000, started = false }) {\n        this._timeToWait = timeToWait;\n        this._isRunning = started;\n    }\n\n    /** @type {number} */\n    _timeToWait;\n\n    /** @type {boolean} */\n    _isRunning;\n\n    _elapsedTime = 0;\n\n    /**\n     * @param {number} [timeToWait=10000]\n     */\n    setTimeToWait(timeToWait = 10000) {\n        if (timeToWait <= 0) {\n            this._timeToWait = Number.MAX_VALUE;\n        }\n    }\n\n    /**\n     * @param {number} time\n     */\n    notifyTimePassed(time) {\n        if (!this._isRunning) {\n            return;\n        }\n        this._elapsedTime += time;\n        if (this._elapsedTime >= this._timeToWait) {\n            this._callbackOnEnd();\n            this._isRunning = false;\n        }\n    }\n\n    /**\n     *\n     * @param {Object} params\n     * @param {Function} params.callbackOnEnd\n     */\n    restart({ callbackOnEnd = () => {} }) {\n        this._elapsedTime = 0;\n        this._isRunning = true;\n        this._callbackOnEnd = callbackOnEnd;\n    }\n\n    pause() {\n        this._isRunning = false;\n    }\n\n    unpause() {\n        this._isRunning = true;\n    }\n\n    stop() {\n        this._isRunning = false;\n        this._callbackOnEnd = null;\n    }\n\n    reset() {\n        this._elapsedTime = 0;\n        this._isRunning = false;\n        this._callbackOnEnd = null;\n    }\n\n    getTimeLeft() {\n        return Math.max(this._timeToWait - this._elapsedTime, 0);\n    }\n\n    getTimePassed() {\n        return this._elapsedTime;\n    }\n}\n","import { TIME_FOR_USER_TO_PICK_POSITION } from 'constants/ux';\nimport Counter from './Counter';\n\nconst counter = new Counter({ timeToWait: TIME_FOR_USER_TO_PICK_POSITION });\n\nexport default counter;\n","export const TIME_FOR_USER_TO_PICK_POSITION = 30999; // ms\nexport const TIME_SHOWING_RANDOM_SELECTOR = 3000; // ms\nexport const SWITCH_RANDOM_SELECTION_EVERY = 100; // ms\nexport const WAIT_AFTER_AI_COLLISION = 2000;\nexport const WAIT_AFTER_AI_GROUNDED = 2000;\n","let initted = false;\nlet delta = 0;\nlet lastFrameTimeMs = 0;\n// We want to simulate 1000 ms / 60 FPS = 16.667 ms per frame every time we run update()\nconst timestep = 1000 / 60;\n\nfunction gameLoop(timestamp) {\n    delta += timestamp - lastFrameTimeMs;\n    lastFrameTimeMs = timestamp;\n\n    // Simulate the total elapsed time in fixed-size chunks\n    while (delta >= timestep) {\n        update(timestep);\n        delta -= timestep;\n    }\n    requestAnimationFrame(gameLoop);\n}\n\nlet callbacksToUpdate = [];\n\nfunction update(timeDiff) {\n    callbacksToUpdate.forEach((callback) => callback(timeDiff));\n}\n\nexport const init = () => {\n    if (!initted) {\n        requestAnimationFrame(gameLoop);\n        initted = true;\n    }\n};\n\nexport const removeFromUpdate = (callback) => {\n    callbacksToUpdate = callbacksToUpdate.filter(\n        (eachCallback) => callback !== eachCallback,\n    );\n};\n\nexport const addToUpdate = (callback) => {\n    callbacksToUpdate = callbacksToUpdate.concat([callback]);\n    return () => {\n        removeFromUpdate(callback);\n    };\n};\n","export const HUMAN = 'HUMAN';\nexport const AI = 'AI';\n","/**\n *\n * @param {number} x\n * @param {number} [min=0]\n * @param {number} [max=1]\n */\nexport const clamp = (x, min = 0, max = 1) => {\n    return Math.max(Math.min(x, max), min);\n};\n","import { clamp } from './clamp';\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n * @returns {Point}\n */\nexport const add = (v1, v2) => {\n    return { x: v1.x + v2.x, y: v1.y + v2.y };\n};\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n * @returns {Point}\n */\nexport const substract = (v1, v2) => {\n    return { x: v1.x - v2.x, y: v1.y - v2.y };\n};\n\n/**\n * @param {Point} v1\n * @param {number} factor\n * @returns {Point}\n */\nexport const scale = (v1, factor) => {\n    return { x: v1.x * factor, y: v1.y * factor };\n};\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n */\nexport const isEqual = (v1, v2) => {\n    return v1.x === v2.x && v1.y === v2.y;\n};\n\n/**\n * @param {Point} v\n * @returns {number}\n */\nexport const magnitude = (v) => {\n    return Math.sqrt(v.x ** 2 + v.y ** 2);\n};\n\n/**\n * @param {Point} v1\n * @param {Point} v2\n * @returns {number}\n */\nexport const distance = (v1, v2) => {\n    return magnitude(substract(v1, v2));\n};\n\n/**\n * @param {Point} v1\n * @returns {Point}\n */\nexport const round = (v1) => {\n    return { x: Math.round(v1.x), y: Math.round(v1.y) };\n};\n\n/**\n * @param {Point} vector\n * @param {Viewport} viewport\n * @param {Point} padding\n */\nexport const isInsideViewport = (vector, viewport, padding) => {\n    return (\n        vector.x >= viewport.topLeft.x + padding.x &&\n        vector.x <= viewport.topLeft.x + viewport.size.width - padding.x &&\n        vector.y >= viewport.topLeft.y + padding.y &&\n        vector.y <= viewport.topLeft.y + viewport.size.height - padding.y\n    );\n};\n\n/**\n * @param {Point} vector\n * @param {Viewport} viewport\n * @param {Point} padding\n * @returns {Point}\n */\nexport const getClosestPointInsideViewport = (vector, viewport, padding) => {\n    const minX = viewport.topLeft.x + padding.x;\n    const maxX = viewport.topLeft.x + viewport.size.width - padding.x;\n    const minY = viewport.topLeft.y + padding.y;\n    const maxY = viewport.topLeft.y + viewport.size.height - padding.y;\n    return {\n        x: clamp(vector.x, minX, maxX),\n        y: clamp(vector.y, minY, maxY),\n    };\n};\n","import { substract, magnitude, distance } from 'utils/vector2d';\n\nexport const movePlayerTo = (player, position, timePassed) => {\n    const newSpeed = substract(position, player.position);\n    const speedMagnitude = magnitude(newSpeed);\n\n    return {\n        ...player,\n        position,\n        speed: newSpeed,\n        prevPositions: player.prevPositions.concat(position),\n        turnsSpent: player.turnsSpent + 1,\n        maxSpeed: Math.max(speedMagnitude, player.maxSpeed),\n        realTimeUsed: player.realTimeUsed + timePassed,\n    };\n};\n\nexport const crashPlayer = (player, speed, timePassed) => {\n    const newSpeed = { x: 0, y: 0 };\n    const turnsGrounded = Math.floor(speed / 3);\n    return {\n        ...player,\n        speed: newSpeed,\n        turnsGrounded,\n        crashes: player.crashes + 1,\n        turnsSpent: player.turnsSpent + 1,\n        realTimeUsed: player.realTimeUsed + timePassed,\n    };\n};\n\nexport const reduceGrounded = (player) => {\n    return {\n        ...player,\n        turnsGrounded: Math.max(0, player.turnsGrounded - 1),\n        turnsSpent: player.turnsSpent + 1,\n    };\n};\n\nexport const addCheckpoints = (player, newIndexes) => {\n    const newCheckpoints = player.checkpointsPassed.slice();\n    newIndexes.sort().forEach((newIndex) => {\n        // Only do checkpoints in correct order.\n        if (newIndex === 0 || newCheckpoints[newIndex - 1]) {\n            newCheckpoints[newIndex] = true;\n        }\n    });\n    return {\n        ...player,\n        checkpointsPassed: newCheckpoints,\n    };\n};\n\nexport const doesPlayerHaveRepeatedPositions = (player) => {\n    const positionHash = {};\n    // eslint-disable-next-line no-restricted-syntax\n    for (const position of player.prevPositions) {\n        const id = `${position.x}_${position.y}`;\n        if (positionHash[id]) {\n            return true;\n        }\n        positionHash[id] = true;\n    }\n    return false;\n};\n\nexport const getAverageSpeed = (player) => {\n    if (!player.prevPositions.length) {\n        return 0;\n    }\n    let totalDistance = 0;\n    for (let i = 0; i < player.prevPositions.length - 1; i += 1) {\n        const point = player.prevPositions[i];\n        const nextPoint = player.prevPositions[i + 1];\n        totalDistance += distance(point, nextPoint);\n    }\n    return totalDistance / player.prevPositions.length;\n};\n\nexport const getCheckpointsPassed = (player) => {\n    let result = 0;\n    for (let i = 0; i < player.checkpointsPassed.length - 1; i += 1) {\n        if (!player.checkpointsPassed[i]) {\n            break;\n        }\n        result += 1;\n    }\n    return result;\n};\n\nexport const hasPlayerFinishedRace = (player) => {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const checkpoint of player.checkpointsPassed) {\n        if (!checkpoint) {\n            return false;\n        }\n    }\n    return true;\n};\n","import { v4 as uuid } from 'uuid';\n\n/** @type {Object.<string, boolean>} */\nconst usedIds = {};\n\n/**\n * Gets a unique string id. Will return the intended one if it hasn't been used yet, or will add a unique string to it if it has.\n * @param {string} intendedId\n */\nexport const getUniqueIdString = (intendedId) => {\n    if (!usedIds[intendedId]) {\n        usedIds[intendedId] = true;\n        return intendedId;\n    }\n    const uniqueId = `${intendedId}__${uuid()}`;\n    usedIds[uniqueId] = true;\n    return uniqueId;\n};\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const actionTypes = {\n    MOVE_TO: id('MOVE_TO'),\n    SET_PLAYERS: id('SET_PLAYERS'),\n    NOTIFY_COLLISION: id('NOTIFY_COLLISION'),\n    REDUCE_GROUNDED: id('REDUCE_GROUNDED'),\n    NOTIFY_VISITED_CHECKPOINTS: id('NOTIFY_VISITED_CHECKPOINTS'),\n};\n\nexport const moveTo = (playerId, position, timePassed) => {\n    return {\n        type: actionTypes.MOVE_TO,\n        playerId,\n        position,\n        timePassed,\n    };\n};\n\nexport const notifyCollision = (playerId, speed, timePassed) => {\n    return {\n        type: actionTypes.NOTIFY_COLLISION,\n        playerId,\n        speed,\n        timePassed,\n    };\n};\n\nexport const setPlayers = (players) => {\n    return {\n        type: actionTypes.SET_PLAYERS,\n        players,\n    };\n};\n\nexport const reduceGrounded = (playerId) => {\n    return {\n        type: actionTypes.REDUCE_GROUNDED,\n        playerId,\n    };\n};\n\nexport const notifyVisitedCheckpoints = (playerId, newCheckpointIndexes) => {\n    return {\n        type: actionTypes.NOTIFY_VISITED_CHECKPOINTS,\n        playerId,\n        newCheckpointIndexes,\n    };\n};\n","import { combineReducers } from 'redux';\nimport { HUMAN } from 'constants/player-types';\nimport {\n    movePlayerTo,\n    crashPlayer,\n    reduceGrounded,\n    addCheckpoints,\n} from 'utils/player';\nimport { actionTypes } from './actions';\n\n/**\n * @type {import('react').Reducer<import('redux').CombinedState<PlayersState>, import('redux').AnyAction>}\n */\nconst players = combineReducers({\n    byId,\n});\n\nconst PLAYER_DEFAULT_INFO = {\n    position: { x: 0, y: 0 },\n    speed: { x: 0, y: 0 },\n    prevPositions: [],\n    turnsGrounded: 0,\n    checkpointsPassed: [false],\n    turnsSpent: 0,\n    realTimeUsed: 0,\n    maxSpeed: 0,\n    crashes: 0,\n    type: HUMAN,\n    levelAI: 0,\n};\n\nfunction byId(state = {}, action) {\n    switch (action.type) {\n        case actionTypes.SET_PLAYERS:\n            return action.players.reduce((accumulator, player) => {\n                return {\n                    ...accumulator,\n                    [player.id]: {\n                        ...PLAYER_DEFAULT_INFO,\n                        ...player,\n                    },\n                };\n            }, {});\n        case actionTypes.MOVE_TO:\n            return {\n                ...state,\n                [action.playerId]: movePlayerTo(\n                    state[action.playerId],\n                    action.position,\n                    action.timePassed,\n                ),\n            };\n        case actionTypes.NOTIFY_COLLISION:\n            return {\n                ...state,\n                [action.playerId]: crashPlayer(\n                    state[action.playerId],\n                    action.speed,\n                    action.timePassed,\n                ),\n            };\n\n        case actionTypes.REDUCE_GROUNDED:\n            return {\n                ...state,\n                [action.playerId]: reduceGrounded(state[action.playerId]),\n            };\n        case actionTypes.NOTIFY_VISITED_CHECKPOINTS:\n            return {\n                ...state,\n                [action.playerId]: addCheckpoints(\n                    state[action.playerId],\n                    action.newCheckpointIndexes,\n                ),\n            };\n        default:\n            return state;\n    }\n}\n\nexport default players;\n","import { combineReducers } from 'redux';\n\nconst zoom = (state = 2, action) => {\n    switch (action.type) {\n        default:\n            return state;\n    }\n};\n\nconst gridSize = (state = 10, action) => {\n    switch (action.type) {\n        default:\n            return state;\n    }\n};\n\n/**\n * @type {import('react').Reducer<import('redux').CombinedState<MapState>, import('redux').AnyAction>}\n */\nconst map = combineReducers({\n    zoom,\n    gridSize,\n});\n\nexport default map;\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const MAIN_MENU = id('MAIN_MENU');\nexport const GAME = id('GAME');\nexport const CIRCUIT_SELECTION = id('CIRCUIT_SELECTION');\nexport const PLAYERS_SELECTION = id('PLAYERS_SELECTION');\nexport const HIGH_SCORES = id('HIGH_SCORES');\nexport const CREDITS = id('CREDITS');\nexport const LOADING_GAME = id('LOADING_GAME');\nexport const REPLAY_GAME = id('REPLAY_GAME');\nexport const TUTORIAL = id('TUTORIAL');\n","/** @type {PlayerStyle} */\nexport const CAR = {\n    id: 'car',\n    name: 'car',\n    dotColor: '#e4223c',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#e4223c',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/car.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const ROCKET = {\n    id: 'rocket',\n    name: 'rocket',\n    dotColor: '#39c3b6',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#39c3b6',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/rocket.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const TURTLE = {\n    id: 'turtle',\n    name: 'turtle',\n    dotColor: '#43c830',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#43c830',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/turtle.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const SKULL = {\n    id: 'skull',\n    name: 'skull',\n    dotColor: '#9a9e9f',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#9a9e9f',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/skull.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const CLOWN = {\n    id: 'clown',\n    name: 'clown',\n    dotColor: '#fdfffc',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#fdfffc',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/clown.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const DANCER = {\n    id: 'dancer',\n    name: 'dancer',\n    dotColor: '#5c0eab',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#5c0eab',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/dancer.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const PANDA = {\n    id: 'panda',\n    name: 'panda',\n    dotColor: '#212121',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#212121',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/panda.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const COFFIN = {\n    id: 'coffin',\n    name: 'coffin',\n    dotColor: '#ad7222',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#ad7222',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/coffin.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const BROOM = {\n    id: 'broom',\n    name: 'broom',\n    dotColor: '#c5db0f',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#c5db0f',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/broom.png`,\n};\n\n/** @type {PlayerStyle} */\nexport const SAILBOAT = {\n    id: 'sailboat',\n    name: 'sailboat',\n    dotColor: '#016fdf',\n    dotSize: 12, // px\n    round: '50%',\n    trailColor: '#016fdf',\n    trailDotsSize: 6, // px\n    trailWidth: 2, // px\n    icon: `${process.env.PUBLIC_URL}/player-icons/sailboat.png`,\n};\n\nexport const STYLES = {\n    [CAR.id]: CAR,\n    [ROCKET.id]: ROCKET,\n    [TURTLE.id]: TURTLE,\n    [SKULL.id]: SKULL,\n    [CLOWN.id]: CLOWN,\n    [DANCER.id]: DANCER,\n    [PANDA.id]: PANDA,\n    [COFFIN.id]: COFFIN,\n    [BROOM.id]: BROOM,\n    [SAILBOAT.id]: SAILBOAT,\n};\n","export const pickRandomFromArray = (array) => {\n    if (!array || !array.length) {\n        return null;\n    }\n    const randomIndex = Math.floor(Math.random() * array.length);\n    return array[randomIndex];\n};\n\nexport const keepPickingUntilNotInArray = (\n    pickerFn,\n    arrayToAvoid,\n    maxTries = 10000,\n) => {\n    for (let i = 0; i < maxTries; i += 1) {\n        const newPick = pickerFn();\n        if (arrayToAvoid.indexOf(newPick) === -1) {\n            return newPick;\n        }\n    }\n    throw new Error(\n        `keepPickingUntilNotInArray: tried ${maxTries} times, no luck`,\n    );\n};\n\nexport const getRandomInRange = (min, max) => {\n    return min + Math.random() * (max - min);\n};\n","import { pickRandomFromArray } from './random';\n\nconst FIRST_NAMES = [\n    'Max',\n    'Carlitros',\n    'Michael',\n    'Fernando',\n    'Loln',\n    'Esquizo',\n    'Agapito',\n    'Tolomeo',\n];\n\nconst LAST_NAMES = [\n    'Cucaracha',\n    'Aubergine',\n    'Tentacles',\n    'Rex',\n    'Danger',\n    'Senna',\n    'Alonso',\n    'Schumacher',\n    'Jander',\n];\n\nexport const getRandomName = () => {\n    return `${pickRandomFromArray(FIRST_NAMES)} ${pickRandomFromArray(\n        LAST_NAMES,\n    )}`;\n};\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const actionTypes = {\n    CHANGE_SCREEN: id('CHANGE_SCREEN'),\n    SET_SELECTED_CIRCUIT: id('SET_SELECTED_CIRCUIT'),\n    SET_SELECTED_PLAYERS: id('SET_SELECTED_PLAYERS'),\n    REMOVE_PLAYER: id('REMOVE_PLAYER'),\n    UPDATE_PLAYER: id('UPDATE_PLAYER'),\n    TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:\n        'TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START',\n    TOGGLE_PLAY_WITH_TIMER: id('TOGGLE_PLAY_WITH_TIMER'),\n};\nexport const changeScreen = (screenId) => {\n    return {\n        type: actionTypes.CHANGE_SCREEN,\n        screenId,\n    };\n};\nexport const setSelectedCircuit = (circuitId) => {\n    return {\n        type: actionTypes.SET_SELECTED_CIRCUIT,\n        circuitId,\n    };\n};\n\nexport const setSelectedPlayers = (players, playerOrder) => {\n    return {\n        type: actionTypes.SET_SELECTED_PLAYERS,\n        players,\n        playerOrder,\n    };\n};\n\nexport const removePlayer = (playerId) => {\n    return {\n        type: actionTypes.REMOVE_PLAYER,\n        playerId,\n    };\n};\n\nexport const updatePlayer = (playerId, attrsToUpdate) => {\n    return {\n        type: actionTypes.UPDATE_PLAYER,\n        playerId,\n        attrsToUpdate,\n    };\n};\n\nexport const toggleRandomizePlayerOrderOnStart = () => {\n    return {\n        type: actionTypes.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START,\n    };\n};\n\nexport const togglePlayWithTimer = () => {\n    return {\n        type: actionTypes.TOGGLE_PLAY_WITH_TIMER,\n    };\n};\n","import { combineReducers } from 'redux';\nimport { MAIN_MENU } from 'constants/screens';\nimport { STYLES } from 'constants/player-styles';\nimport { getRandomName } from 'utils/getRandomName';\nimport { pickRandomFromArray } from 'utils/random';\nimport { HUMAN } from 'constants/player-types';\nimport { actionTypes } from './actions';\n\nconst currentScreen = (state = MAIN_MENU, action) => {\n    switch (action.type) {\n        case actionTypes.CHANGE_SCREEN:\n            return action.screenId;\n        default:\n            return state;\n    }\n};\n\nconst selectedCircuit = (state = null, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_CIRCUIT:\n            return action.circuitId;\n        default:\n            return state;\n    }\n};\n\n/** @type {Player[]} */\nconst initialPlayers = [\n    {\n        id: 'DEFAULT_PLAYER',\n        name: getRandomName(),\n        style: pickRandomFromArray(Object.values(STYLES)),\n        type: HUMAN,\n        levelAI: 0,\n    },\n];\n\nconst selectedPlayers = (state = initialPlayers, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_PLAYERS:\n            return action.players;\n        case actionTypes.REMOVE_PLAYER:\n            return state.filter((player) => player.id !== action.playerId);\n        case actionTypes.UPDATE_PLAYER:\n            return state.map((player) => {\n                if (player.id !== action.playerId) {\n                    return player;\n                }\n                return {\n                    ...player,\n                    ...action.attrsToUpdate,\n                };\n            });\n        default:\n            return state;\n    }\n};\n\nconst defaultOrder = ['DEFAULT_PLAYER'];\nconst selectedPlayerOrder = (state = defaultOrder, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECTED_PLAYERS:\n            return action.playerOrder;\n        case actionTypes.REMOVE_PLAYER:\n            return state.filter((playerId) => playerId !== action.playerId);\n        default:\n            return state;\n    }\n};\n\nconst randomizePlayerOrderOnStart = (state = true, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_RANDOMIZE_PLAYER_ORDER_ON_START:\n            return !state;\n        default:\n            return state;\n    }\n};\n\nconst playWithTimer = (state = false, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_PLAY_WITH_TIMER:\n            return !state;\n        default:\n            return state;\n    }\n};\n\n/**\n * @type {import('react').Reducer<import('redux').CombinedState<MainUIState>, import('redux').AnyAction>}\n */\nconst mainUI = combineReducers({\n    currentScreen,\n    selectedCircuit,\n    selectedPlayerOrder,\n    selectedPlayers,\n    randomizePlayerOrderOnStart,\n    playWithTimer,\n});\n\nexport default mainUI;\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const NOT_STARTED = id('NOT_STARTED');\nexport const START_SCREEN = id('START_SCREEN');\nexport const PLAYER_TURN_START_SCREEN = id('PLAYER_TURN_START_SCREEN');\nexport const WAITING_FOR_PLAYER_INPUT = id('WAITING_FOR_PLAYER_INPUT');\nexport const ANIMATING_PLAYER_MOVEMENT = id('ANIMATING_PLAYER_MOVEMENT');\nexport const ANIMATING_RANDOM_PLAYER_MOVEMENT = id(\n    'ANIMATING_RANDOM_PLAYER_MOVEMENT',\n);\nexport const NOTIFY_COLLISION = id('NOTIFY_COLLISION');\nexport const NOTIFY_AI_COLLISION = id('NOTIFY_AI_COLLISION');\nexport const NOTIFY_GROUNDED = id('NOTIFY_GROUNDED');\nexport const NOTIFY_AI_GROUNDED = id('NOTIFY_AI_GROUNDED');\nexport const NOTIFY_VICTORY = id('NOTIFY_VICTORY');\nexport const NOTIFY_HIGH_SCORE = id('NOTIFY_HIGH_SCORE');\nexport const SHOW_MENU = id('SHOW_MENU');\nexport const AI_THINKING_SCREEN = id('AI_THINKING_SCREEN');\n","import { getUniqueIdString as id } from 'utils/getUniqueIdString';\n\nexport const actionTypes = {\n    INIT_GAME: id('INIT_GAME'),\n    INIT_REPLAY: id('INIT_REPLAY'),\n    SET_GAME_STATE: id('SET_GAME_STATE'),\n    ADVANCE_PLAYER_TURN: id('ADVANCE_PLAYER_TURN'),\n    SET_CIRCUIT: id('SET_CIRCUIT'),\n    SET_LATEST_HIGH_SCORE: id('SET_LATEST_HIGH_SCORE'),\n    SET_SELECTED_POSITION: id('SET_SELECTED_POSITION'),\n    SET_SELECTED_AI_MOVE: id('SET_SELECTED_AI_MOVE'),\n};\nexport const initGame = (playerOrder, circuitInfo) => {\n    return {\n        type: actionTypes.INIT_GAME,\n        playerOrder,\n        circuitInfo,\n    };\n};\n\nexport const initReplay = (raceHistory, circuitInfo) => {\n    return {\n        type: actionTypes.INIT_REPLAY,\n        raceHistory,\n        circuitInfo,\n    };\n};\n\nexport const setGameState = (newGameState) => {\n    return {\n        type: actionTypes.SET_GAME_STATE,\n        newGameState,\n    };\n};\n\nexport const advancePlayerTurn = () => {\n    return {\n        type: actionTypes.ADVANCE_PLAYER_TURN,\n    };\n};\n\nexport const setLatestHighScore = (highScore) => {\n    return {\n        type: actionTypes.SET_LATEST_HIGH_SCORE,\n        highScore,\n    };\n};\n\nexport const setSelectedPosition = (newPosition) => {\n    return {\n        type: actionTypes.SET_SELECTED_POSITION,\n        newPosition,\n    };\n};\n\nexport const setSelectedAIMove = (newMove) => {\n    return {\n        type: actionTypes.SET_SELECTED_AI_MOVE,\n        newMove,\n    };\n};\n","import * as gameStates from 'constants/game-states';\nimport { actionTypes } from './actions';\n\n/** @type {GameState} */\nconst defaultState = {\n    gameState: gameStates.NOT_STARTED,\n    prevGameState: null, // We store one game state previous to the current so we can go back after pausing\n    players: [],\n    currentTurnPlayerId: null,\n    circuitInfo: null,\n    latestHighScore: null, // If somebody achived a high score, it will be stored here until the next game starts\n    selectedPosition: null, // When we use a touch interface we can store the position that has been selected before confirming the move\n    raceHistory: null, // Used when replaying a game\n    selectedAIMove: null, // When AI selects a move, we show it briefly before moving the player\n};\n\n/**\n *\n * @param {GameState} state\n * @param {import('redux').AnyAction} action\n * @returns {GameState}\n */\nconst game = (state = defaultState, action) => {\n    switch (action.type) {\n        case actionTypes.INIT_GAME:\n            return {\n                ...state,\n                gameState: gameStates.START_SCREEN,\n                currentTurnPlayerId: action.playerOrder[0],\n                players: action.playerOrder.slice(),\n                circuitInfo: { ...action.circuitInfo },\n                latestHighScore: null,\n                selectedPosition: null,\n                selectedAIMove: null,\n            };\n        case actionTypes.INIT_REPLAY:\n            return {\n                ...state,\n                gameState: gameStates.START_SCREEN,\n                circuitInfo: { ...action.circuitInfo },\n                raceHistory: action.raceHistory,\n            };\n        case actionTypes.ADVANCE_PLAYER_TURN:\n            return {\n                ...state,\n                currentTurnPlayerId: getNextTurn(\n                    state.players,\n                    state.currentTurnPlayerId,\n                ),\n                selectedPosition: null,\n                selectedAIMove: null,\n            };\n        case actionTypes.SET_GAME_STATE:\n            return {\n                ...state,\n                gameState: action.newGameState,\n                prevGameState: state.gameState,\n            };\n        case actionTypes.SET_LATEST_HIGH_SCORE:\n            return {\n                ...state,\n                latestHighScore: action.highScore,\n            };\n        case actionTypes.SET_SELECTED_POSITION:\n            return {\n                ...state,\n                selectedPosition: action.newPosition,\n            };\n        case actionTypes.SET_SELECTED_AI_MOVE:\n            return {\n                ...state,\n                selectedAIMove: action.newMove,\n            };\n\n        default:\n            return state;\n    }\n};\n\nexport default game;\n\nfunction getNextTurn(players, currentPlayer) {\n    const currentTurnPlayerId = players.indexOf(currentPlayer);\n    const nextTurn = (currentTurnPlayerId + 1) % players.length;\n    return players[nextTurn];\n}\n","import { combineReducers } from 'redux';\nimport players from './players/reducer';\nimport map from './map/reducer';\nimport mainUI from './main-ui/reducer';\nimport game from './game/reducer';\n\nexport default combineReducers({\n    players,\n    map,\n    mainUI,\n    game,\n});\n","export const storeSavedPlayers = (playerOrder, players) => {\n    if (!window.localStorage) {\n        return;\n    }\n    const playersInfoToStore = {\n        // @ts-ignore\n        version: window.capac_racer_version,\n        playerOrder,\n        players,\n    };\n    try {\n        window.localStorage.setItem(\n            'players',\n            JSON.stringify(playersInfoToStore),\n        );\n    } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn(`Error trying to save localStorage`, e);\n    }\n};\n\nexport const getSavedPlayers = () => {\n    if (!window.localStorage) {\n        return null;\n    }\n    let result;\n    try {\n        result = window.localStorage.getItem('players');\n    } catch (e) {\n        return null;\n    }\n\n    if (!result) {\n        return null;\n    }\n\n    // At some point we may need to check if versions are compatible\n    return JSON.parse(result);\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction Logo({ variant }) {\n    return (\n        <div className={`logo logo-${variant}`}>\n            <div className=\"logo-up\">Capac</div>\n            <div className=\"logo-down\">Racer</div>\n        </div>\n    );\n}\n\nLogo.propTypes = {\n    variant: PropTypes.oneOf(['big', 'small']),\n};\n\nLogo.defaultProps = {\n    variant: 'big',\n};\n\nexport default Logo;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport {\n    CIRCUIT_SELECTION,\n    HIGH_SCORES,\n    CREDITS,\n    TUTORIAL,\n} from 'constants/screens';\nimport Logo from 'components/Logo';\n\nimport './style.css';\n\nconst MainMenu = ({ className }) => {\n    const dispatch = useDispatch();\n    return (\n        <div className={classNames('full-screen', className)}>\n            <div className=\"main-menu-content\">\n                <div className=\"transition-from-left\">\n                    <Logo />\n                </div>\n\n                <div className=\"main-menu-buttons transition-from-right\">\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() =>\n                            dispatch(changeScreen(CIRCUIT_SELECTION))\n                        }\n                    >\n                        Start new game\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(TUTORIAL))}\n                    >\n                        How to play\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(HIGH_SCORES))}\n                    >\n                        High scores\n                    </button>\n                    <button\n                        className=\"button\"\n                        type=\"button\"\n                        onClick={() => dispatch(changeScreen(CREDITS))}\n                    >\n                        Credits\n                    </button>\n                </div>\n            </div>\n            <div className=\"app-version\">\n                v\n                {\n                    // @ts-ignore\n                    window.capac_racer_version\n                }\n            </div>\n        </div>\n    );\n};\n\nexport default MainMenu;\n","/**\n *\n * @param {Point} worldPosition\n * @param {number} gridSize\n * @param {number} mapZoom\n * @returns {Point}\n */\nexport const getScreenCoordinates = (worldPosition, gridSize, mapZoom) => {\n    const project = (n) => {\n        if (typeof n === 'number') {\n            return n * gridSize * mapZoom;\n        }\n        return n;\n    };\n\n    return {\n        x: project(worldPosition.x),\n        y: project(worldPosition.y),\n        dx: project(worldPosition.dx),\n        dy: project(worldPosition.dy),\n        baseX: project(worldPosition.baseX),\n        baseY: project(worldPosition.baseY),\n    };\n};\n","import { getScreenCoordinates } from 'utils/screenUtils';\n\n/**\n * Gets the current zoom on the map\n *\n * @param {RootState} state\n */\nexport const getZoom = (state) => state.map.zoom;\n\n/**\n * Gets the current grid size on the map\n *\n * @param {RootState} state\n */\nexport const getGridSize = (state) => state.map.gridSize;\n\n/**\n * @param {RootState} state\n * @param {Point} worldPosition\n */\nexport const projectToScreenPosition = (state, worldPosition) => {\n    if (!worldPosition) {\n        return worldPosition;\n    }\n    const mapZoom = state.map.zoom;\n    const mapGridSize = state.map.gridSize;\n    return getScreenCoordinates(worldPosition, mapGridSize, mapZoom);\n};\n","import { isEqual } from 'utils/vector2d';\n\nconst DISTANCE_TO_MOVE = 1;\n\n/**\n * @param {Player} player\n * @param {Player[]} otherPlayers\n * @returns {Point[]}\n */\nexport const getPossibleDestinations = (player, otherPlayers) => {\n    const positionAfterSpeed = {\n        x: player.position.x + player.speed.x,\n        y: player.position.y + player.speed.y,\n    };\n    const positions = [];\n    for (let i = -DISTANCE_TO_MOVE; i <= DISTANCE_TO_MOVE; i += 1) {\n        for (let j = -DISTANCE_TO_MOVE; j <= DISTANCE_TO_MOVE; j += 1) {\n            positions.push({\n                baseX: positionAfterSpeed.x,\n                baseY: positionAfterSpeed.y,\n                x: positionAfterSpeed.x + i,\n                y: positionAfterSpeed.y + j,\n                dx: i,\n                dy: j,\n            });\n        }\n    }\n    return positions.filter(\n        (position) => !isPositionColliding(position, otherPlayers),\n    );\n};\n\nfunction isPositionColliding(position, otherPlayers) {\n    return !!otherPlayers\n        .map((player) => player.position)\n        .find((otherPosition) => isEqual(otherPosition, position));\n}\n","import * as gameStates from 'constants/game-states';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { getPossibleDestinations } from 'store/players/selectors';\n\n/**\n * @param {RootState} state\n */\nexport const isGameStarted = (state) => {\n    return state.game.gameState !== gameStates.NOT_STARTED;\n};\n\n/**\n * @param {RootState} state\n */\nexport const isWaitingForPlayerInput = (state) => {\n    return state.game.gameState === gameStates.WAITING_FOR_PLAYER_INPUT;\n};\n\n/**\n * @param {RootState} state\n */\nexport const isAnimatingRandomSelection = (state) => {\n    return state.game.gameState === gameStates.ANIMATING_RANDOM_PLAYER_MOVEMENT;\n};\n\n/**\n * @param {RootState} state\n */\nexport const isAnimatingAISelection = (state) => {\n    return state.game.gameState === gameStates.AI_THINKING_SCREEN;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getAISelectedMove = (state) => {\n    return state.game.selectedAIMove;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getCurrentPlayer = (state) => {\n    if (!isGameStarted(state)) {\n        return null;\n    }\n    return state.players.byId[state.game.currentTurnPlayerId];\n};\n\n/**\n * @param {RootState} state\n */\nexport const getAllPlayers = (state) => {\n    return state.game.players.map((playerId) => state.players.byId[playerId]);\n};\n\n/**\n * @param {RootState} state\n * @param {string} playerId\n */\nexport const getOtherPlayers = (state, playerId) => {\n    return getAllPlayers(state).filter((player) => player.id !== playerId);\n};\n\n/**\n * @param {RootState} state\n * @param {string} playerId\n */\nexport const getOtherPlayersPositionInScreen = (state, playerId) => {\n    return getOtherPlayers(state, playerId)\n        .map((player) => player.position)\n        .map((position) => projectToScreenPosition(state, position));\n};\n\n/**\n * @param {RootState} state\n */\nexport const getGameState = (state) => {\n    return state.game.gameState;\n};\n\n/**\n * @param {RootState} state\n */\nexport const hasCurrentPlayerWon = (state) => {\n    const currentPlayer = getCurrentPlayer(state);\n    // eslint-disable-next-line no-restricted-syntax\n    for (const checkpointHasPassed of currentPlayer.checkpointsPassed) {\n        if (!checkpointHasPassed) {\n            return false;\n        }\n    }\n    return true;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getOrderedPlayers = (state) => {\n    const playerOrder = state.mainUI.selectedPlayerOrder;\n    const players = state.mainUI.selectedPlayers;\n    return playerOrder.map((playerId) =>\n        players.find((player) => player.id === playerId),\n    );\n};\n\n/**\n * @param {RootState} state\n * @param {Player} player\n */\nexport const getPossibleDestinationsForPlayerInScreen = (state, player) => {\n    const otherPlayers = getAllPlayers(state).filter(\n        (otherPlayer) => otherPlayer.id !== player.id,\n    );\n\n    return getPossibleDestinations(player, otherPlayers).map((eachPosition) => {\n        return {\n            screen: projectToScreenPosition(state, eachPosition),\n            position: eachPosition,\n        };\n    });\n};\n\n/**\n * @param {RootState} state\n * @param {Player} player\n */\nexport const getMovedPixelsSinceLastTurn = (state, player) => {\n    if (!player.prevPositions.length || player.prevPositions.length < 2) {\n        return null;\n    }\n    const lastPosition = player.prevPositions[player.prevPositions.length - 2];\n    const moved = {\n        x: lastPosition.x - player.position.x,\n        y: lastPosition.y - player.position.y,\n    };\n    return projectToScreenPosition(state, moved);\n};\n\n/**\n * @param {RootState} state\n * @param {Player} player\n */\nexport const getPivotForPlayerInScreen = (state, player) => {\n    const positionAfterSpeed = {\n        x: player.position.x + player.speed.x,\n        y: player.position.y + player.speed.y,\n    };\n    return projectToScreenPosition(state, positionAfterSpeed);\n};\n\n/**\n * @param {RootState} state\n */\nexport const getLatestHighScore = (state) => {\n    return state.game.latestHighScore;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getSelectedPosition = (state) => {\n    return state.game.selectedPosition;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getRaceHistory = (state) => {\n    return state.game.raceHistory;\n};\n\n/**\n *\n * @param {RootState} state\n */\nexport const getCircuitInfo = (state) => state.game.circuitInfo;\n","/**\n * @param {RootState} state\n */\nexport const getCurrentScreen = (state) => {\n    return state.mainUI.currentScreen;\n};\n\n/**\n * @param {RootState} state\n */\nexport const getSelectedCircuit = (state) => {\n    return state.mainUI.selectedCircuit;\n};\n\n/**\n * @param {RootState} state\n */\nexport const shouldRandomizePlayerOrderOnStart = (state) => {\n    return state.mainUI.randomizePlayerOrderOnStart;\n};\n/**\n * @param {RootState} state\n */\nexport const shouldPlayWithTimer = (state) => {\n    return state.mainUI.playWithTimer;\n};\n","/** @type {Object.<string, CircuitConfig>} */\nexport const circuits = {\n    mouth: {\n        id: 'mouth',\n        name: 'Mouth',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit1/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit1/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp8.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit1/cp9.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 37,\n                y: 22,\n            },\n            {\n                x: 37,\n                y: 23,\n            },\n            {\n                x: 37,\n                y: 24,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: 0,\n        },\n    },\n    heart: {\n        id: 'heart',\n        name: 'Heart',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit2/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit2/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit2/cp7.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 37,\n                y: 28,\n            },\n            {\n                x: 36,\n                y: 27,\n            },\n            {\n                x: 35,\n                y: 26,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: -2,\n        },\n    },\n    rosco: {\n        id: 'rosco',\n        name: 'Rosco',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit3/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit3/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit3/cp8.png`,\n        ],\n        maxPlayers: 4,\n        startingPositions: [\n            {\n                x: 33,\n                y: 34,\n            },\n            {\n                x: 33,\n                y: 33,\n            },\n            {\n                x: 33,\n                y: 32,\n            },\n            {\n                x: 33,\n                y: 35,\n            },\n        ],\n        initialSpeed: {\n            x: -2,\n            y: 0,\n        },\n    },\n    horse: {\n        id: 'horse',\n        name: 'Horse',\n        collisionImg: `${process.env.PUBLIC_URL}/circuits/circuit4/collision.png`,\n        bgImg: `${process.env.PUBLIC_URL}/circuits/circuit4/bg.png`,\n        checkpoints: [\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp1.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp2.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp3.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp4.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp5.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp6.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp7.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp8.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp9.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp10.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp11.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp12.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp13.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp14.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp15.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp16.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp17.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp18.png`,\n            `${process.env.PUBLIC_URL}/circuits/circuit4/cp19.png`,\n        ],\n        maxPlayers: 3,\n        startingPositions: [\n            {\n                x: 26,\n                y: 31,\n            },\n            {\n                x: 26,\n                y: 32,\n            },\n            {\n                x: 26,\n                y: 33,\n            },\n        ],\n        initialSpeed: {\n            x: 2,\n            y: 0,\n        },\n    },\n};\n","export const loadImage = (url) => {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        const onLoad = () => {\n            resolve(img);\n        };\n        const onError = (error) => {\n            reject(error);\n        };\n        img.addEventListener('load', onLoad, { once: true });\n        img.addEventListener('error', onError, { once: true });\n        img.src = url;\n    });\n};\n","/**\n * Creates a pixel geter object that can access pixels of an image\n *\n * @param {HTMLImageElement} img\n * @returns {PixelGetter}\n */\nexport const createFromImage = (img) => {\n    const canvas = document.createElement('canvas');\n    const { width, height } = img;\n\n    canvas.width = width;\n    canvas.height = height;\n    canvas.getContext('2d').drawImage(img, 0, 0, width, height);\n\n    const rawData = canvas.getContext('2d').getImageData(0, 0, width, height)\n        .data;\n\n    return {\n        width,\n        height,\n        getPixel: (x, y) => {\n            const basePosition = 4 * (x + y * width);\n\n            return {\n                r: rawData[basePosition + 0],\n                g: rawData[basePosition + 1],\n                b: rawData[basePosition + 2],\n                a: rawData[basePosition + 3],\n            };\n        },\n    };\n};\n","export const hasContent = ({ r, g, b, a }) => {\n    if (a === 0) {\n        return false;\n    }\n    if (r === 255 && g === 255 && b === 255) {\n        return false;\n    }\n\n    return true;\n};\n","/* eslint-disable no-restricted-syntax */\nimport { loadImage } from 'utils/loadImage';\nimport { createFromImage as createPixelGetterFromImage } from 'utils/imgPixelGetter';\nimport {\n    distance,\n    add,\n    scale,\n    substract,\n    round,\n    isEqual,\n} from 'utils/vector2d';\nimport { range } from 'utils/range';\nimport { hasContent } from 'utils/pixel';\nimport { getScreenCoordinates } from 'utils/screenUtils';\n\n/**\n *\n * @param {CircuitConfig} config\n * @returns {Promise<Circuit>}\n */\nexport const createFromConfig = async (config) => {\n    const collisionImg = await loadImage(config.collisionImg);\n    const collisionPixelGetter = await createPixelGetterFromImage(collisionImg);\n    const loadedCheckpointImages = await Promise.all(\n        config.checkpoints.map((checkpointImg) => loadImage(checkpointImg)),\n    );\n    const checkpointPixelGetters = await Promise.all(\n        loadedCheckpointImages.map((checkpointImage) =>\n            createPixelGetterFromImage(checkpointImage),\n        ),\n    );\n    return {\n        ...config,\n        width: collisionImg.width,\n        height: collisionImg.height,\n        collisionPixelGetter,\n        checkpointPixelGetters,\n        centerOfCheckpoints: checkpointPixelGetters.map(getCenterOfCheckpoint),\n    };\n};\n\n/**\n *\n * @param {Line} line\n * @param {Circuit} circuit\n * @param {Point[]} otherPlayersPosition\n */\nexport const doesLineCollide = (line, circuit, otherPlayersPosition) => {\n    const pixelsToCheck = getPixelsToCheck(line).map(round);\n    if (\n        doesAnyPixelCollideInImage(pixelsToCheck, circuit.collisionPixelGetter)\n    ) {\n        return true;\n    }\n    for (const pixelToCheck of pixelsToCheck) {\n        // eslint-disable-next-line no-loop-func\n        const collidesWithOtherPlayer = otherPlayersPosition.find((position) =>\n            isEqual(position, pixelToCheck),\n        );\n        if (collidesWithOtherPlayer) {\n            return true;\n        }\n    }\n    return false;\n};\n\n/**\n * Checks if a player can move between two points. Will return false if it collides with the circuit or other players, true otherwise\n * @param {Object} params\n * @param {Point} params.from\n * @param {Point} params.to\n * @param {Circuit} params.circuit\n * @param {Player[]} params.otherPlayers\n * @param {number} params.zoom\n * @param {number} params.gridSize\n */\nexport const checkIfPlayerCanMove = ({\n    from,\n    to,\n    circuit,\n    otherPlayers,\n    zoom,\n    gridSize,\n}) => {\n    const movementLine = [\n        getScreenCoordinates(from, gridSize, zoom),\n        getScreenCoordinates(to, gridSize, zoom),\n    ];\n    const otherPlayersPosition = otherPlayers\n        .map((player) => player.position)\n        .map((position) => getScreenCoordinates(position, gridSize, zoom));\n\n    return !doesLineCollide(movementLine, circuit, otherPlayersPosition);\n};\n\n/**\n * Gets the checkpoints visited in a line of movement.\n *\n * @param {Line} line\n * @param {Circuit} circuit\n * @returns {number[]} The indexes of checkpoints that have been visited\n */\nexport const getCheckpointsVisitedInLine = (line, circuit) => {\n    const pixelsToCheck = getPixelsToCheck(line).map(round);\n    return circuit.checkpointPixelGetters\n        .map((checkpointPixelGetter) =>\n            doesAnyPixelCollideInImage(pixelsToCheck, checkpointPixelGetter),\n        )\n        .map((doesItCollide, index) => ({ doesItCollide, index }))\n        .filter(({ doesItCollide }) => !!doesItCollide)\n        .map(({ index }) => index);\n};\n\n/**\n *\n * @param {Object} params\n * @param {Point} params.from\n * @param {Point} params.to\n * @param {Circuit} params.circuit\n * @param {number} params.zoom\n * @param {number} params.gridSize\n * @returns {number[]} The indexes of checkpoints that have been visited\n */\nexport const getCheckpointsInMovement = ({\n    from,\n    to,\n    circuit,\n    zoom,\n    gridSize,\n}) => {\n    const movementLine = [\n        getScreenCoordinates(from, gridSize, zoom),\n        getScreenCoordinates(to, gridSize, zoom),\n    ];\n    return getCheckpointsVisitedInLine(movementLine, circuit);\n};\n\n/**\n * Gets the distance from a player to the next checkpoint\n * @param {Object} params\n * @param {Player} params.player\n * @param {Circuit} params.circuit\n * @param {number} params.gridSize\n * @param {number} params.zoom\n */\nexport const getDistanceToNextCheckpoint = ({\n    player,\n    circuit,\n    gridSize,\n    zoom,\n}) => {\n    for (let i = 0; i < player.checkpointsPassed.length; i += 1) {\n        if (!player.checkpointsPassed[i]) {\n            const playerPositionScreen = getScreenCoordinates(\n                player.position,\n                gridSize,\n                zoom,\n            );\n            return distance(\n                playerPositionScreen,\n                circuit.centerOfCheckpoints[i],\n            );\n        }\n    }\n    // All have been visited, so no distance\n    return 0;\n};\n\n/**\n * Gets the maximum distance between two consecutive checkpoints in a circuit\n * @param {Circuit} circuit\n */\nexport const getMaxCheckpointDistance = (circuit) => {\n    const checkpoints = circuit.centerOfCheckpoints;\n    const distances = checkpoints.map((cp, index) => {\n        return distance(cp, checkpoints[(index + 1) % checkpoints.length]);\n    });\n    return distances.reduce((acc, eachDistance) => {\n        return Math.max(acc, eachDistance);\n    }, 0);\n};\n\n/**\n * @param {Point[]} pixelsToCheck\n * @param {PixelGetter} imagePixelGetter\n */\nfunction doesAnyPixelCollideInImage(pixelsToCheck, imagePixelGetter) {\n    for (const pixelToCheck of pixelsToCheck) {\n        const pixelInCollisionMap = imagePixelGetter.getPixel(\n            pixelToCheck.x,\n            pixelToCheck.y,\n        );\n        if (hasContent(pixelInCollisionMap)) {\n            return true;\n        }\n    }\n    return false;\n}\n\n/**\n * @param {Line} line\n */\nfunction getPixelsToCheck([start, end]) {\n    const lineLength = distance(start, end);\n    const nPixelsToCheck = Math.ceil(lineLength * 2);\n    if (nPixelsToCheck < 2) {\n        return [];\n    }\n    const diffVector = substract(end, start);\n    const result = range(nPixelsToCheck).map((index) => {\n        const factor = index / (nPixelsToCheck - 1);\n        return add(start, scale(diffVector, factor));\n    });\n\n    return result;\n}\n\n/**\n * @param {PixelGetter} checkpoint\n * @returns {Point}\n */\nfunction getCenterOfCheckpoint(checkpoint) {\n    const pixelsToCheck = [];\n    for (let i = 0; i < checkpoint.width; i += 1) {\n        for (let j = 0; j < checkpoint.height; j += 1) {\n            if (hasContent(checkpoint.getPixel(i, j))) {\n                pixelsToCheck.push([i, j]);\n            }\n        }\n    }\n    if (!pixelsToCheck.length) {\n        return null;\n    }\n\n    const resultArray = pixelsToCheck.reduce(\n        (acc, pixel) => {\n            return [\n                acc[0] + pixel[0] / pixelsToCheck.length,\n                acc[1] + pixel[1] / pixelsToCheck.length,\n            ];\n        },\n        [0, 0],\n    );\n\n    return { x: resultArray[0], y: resultArray[1] };\n}\n","export const range = (size) => {\n    return [...Array(size).keys()];\n};\n","import Counter from 'utils/Counter';\nimport {\n    addToUpdate as addToGameLoopUpdate,\n    removeFromUpdate as removeFromGameLoopUpdate,\n} from 'utils/gameLoop';\n\nexport const timeout = (timeMs = 1000) => {\n    return new Promise((resolve) => {\n        const counter = new Counter({ timeToWait: timeMs });\n        const notifyPassOfTime = (time) => {\n            counter.notifyTimePassed(time);\n        };\n        addToGameLoopUpdate(notifyPassOfTime);\n        counter.restart({\n            callbackOnEnd: () => {\n                removeFromGameLoopUpdate(notifyPassOfTime);\n                counter.stop();\n                resolve();\n            },\n        });\n    });\n};\n","import { v4 } from 'uuid';\nimport { AI } from 'constants/player-types';\n\nconst LOCAL_STORAGE_ID = 'high-scores';\nconst MAX_SCORES_PER_CIRCUIT = 5;\n\nexport const getAll = () => {\n    try {\n        const all = JSON.parse(localStorage.getItem(LOCAL_STORAGE_ID));\n        return all || {};\n    } catch (e) {\n        return {};\n    }\n};\n\nexport const getByCircuitId = (circuitId) => {\n    const all = getAll();\n    return (all[circuitId] || []).map((score) => ({\n        ...score,\n        date: new Date(score.date),\n    }));\n};\n\nexport const shouldScoreBeAdded = (score, circuit, player) => {\n    if (player.type === AI) {\n        return false;\n    }\n    const circuitScores = getByCircuitId(circuit.id);\n    if (circuitScores.length < MAX_SCORES_PER_CIRCUIT) {\n        return true;\n    }\n    const lastScore = circuitScores[circuitScores.length - 1];\n    if (isBetterScore(score, lastScore)) {\n        return true;\n    }\n\n    return false;\n};\n\nexport const addScore = (score, circuit, player) => {\n    if (!shouldScoreBeAdded(score, circuit, player)) {\n        return null;\n    }\n    const circuitScores = getByCircuitId(circuit.id);\n    let insertBefore;\n    for (let i = 0; i < circuitScores.length; i += 1) {\n        if (isBetterScore(score, circuitScores[i])) {\n            insertBefore = i;\n            break;\n        }\n    }\n    const scoreToAdd = {\n        ...score,\n        id: v4(),\n    };\n    let newScores = circuitScores.slice();\n    if (typeof insertBefore === 'number') {\n        newScores.splice(insertBefore, 0, scoreToAdd);\n    } else {\n        newScores.push(scoreToAdd);\n    }\n    newScores = newScores.slice(0, MAX_SCORES_PER_CIRCUIT);\n    updateCircuitScores(circuit, newScores);\n    return scoreToAdd;\n};\n\nfunction isBetterScore(score, otherScore) {\n    if (score.turns > otherScore.turns) {\n        return false;\n    }\n    if (score.turns < otherScore.turns) {\n        return true;\n    }\n\n    // Same turns, choose the one with better real time:\n    return score.realTimeUsed < otherScore.realTimeUsed;\n}\n\nfunction updateCircuitScores(circuit, newScores) {\n    const all = getAll();\n    const newAll = {\n        ...all,\n        [circuit.id]: newScores,\n    };\n    try {\n        localStorage.setItem(\n            LOCAL_STORAGE_ID,\n            JSON.stringify(newAll, undefined, 2),\n        );\n    } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn('error saving high score', e);\n    }\n}\n","/** @type {AILevel[]} */\nconst levels = [\n    {\n        // level 0\n        randomSolutionChance: 20 / 100,\n        maxIterations: 50,\n        maxThinkingDepth: 5,\n        timeThinking: {\n            min: 2500,\n            max: 3500,\n        },\n    },\n    {\n        // level 1\n        randomSolutionChance: 15 / 100,\n        maxIterations: 200,\n        maxThinkingDepth: 10,\n        timeThinking: {\n            min: 1500,\n            max: 2500,\n        },\n    },\n    {\n        // level 2\n        randomSolutionChance: 7 / 100,\n        maxIterations: 700,\n        maxThinkingDepth: 30,\n        timeThinking: {\n            min: 700,\n            max: 2000,\n        },\n    },\n    {\n        // level 3\n        randomSolutionChance: 0,\n        maxIterations: 1500,\n        maxThinkingDepth: 99999,\n        timeThinking: {\n            min: 100,\n            max: 300,\n        },\n    },\n];\n\nexport default levels;\n","import { getPossibleDestinations } from 'store/players/selectors';\nimport {\n    checkIfPlayerCanMove,\n    getCheckpointsInMovement,\n    getDistanceToNextCheckpoint,\n    getMaxCheckpointDistance,\n} from 'utils/circuit';\nimport {\n    movePlayerTo,\n    addCheckpoints,\n    doesPlayerHaveRepeatedPositions,\n    getAverageSpeed,\n    getCheckpointsPassed,\n    hasPlayerFinishedRace,\n} from 'utils/player';\n\nexport default class PartialCircuitSolution {\n    constructor(playerInfo, currentIteration, circuit, mapZoom, mapGridSize) {\n        this.playerInfo = {\n            ...playerInfo,\n            prevPositions: playerInfo.prevPositions.slice(),\n            checkpointsPassed: playerInfo.checkpointsPassed.slice(),\n        };\n        this.currentIteration = currentIteration;\n        this.circuit = circuit;\n        this.mapZoom = mapZoom;\n        this.mapGridSize = mapGridSize;\n\n        this._updatePartialScore();\n    }\n\n    /**\n     * Returns an array of all possible solutions from this one\n     *\n     * @returns {PartialCircuitSolution[]}\n     */\n    expand(otherPlayers, maxDepthForSolutions) {\n        if (this.currentIteration >= maxDepthForSolutions) {\n            return [];\n        }\n        const otherPlayersToConsider =\n            this.currentIteration === 1 ? otherPlayers : [];\n\n        const canMoveThere = (position) =>\n            checkIfPlayerCanMove({\n                from: this.playerInfo.position,\n                to: position,\n                zoom: this.mapZoom,\n                gridSize: this.mapGridSize,\n                circuit: this.circuit,\n                otherPlayers: [],\n            });\n\n        const possiblePositions = getPossibleDestinations(\n            this.playerInfo,\n            otherPlayersToConsider,\n        ).filter((position) => canMoveThere(position));\n\n        const resultingPlayers = possiblePositions.map((position) => {\n            const visitedCheckpointsInTurn = getCheckpointsInMovement({\n                from: this.playerInfo.position,\n                to: position,\n                zoom: this.mapZoom,\n                gridSize: this.mapGridSize,\n                circuit: this.circuit,\n            });\n\n            const player = movePlayerTo(this.playerInfo, position, 0);\n            return addCheckpoints(player, visitedCheckpointsInTurn);\n        });\n\n        return resultingPlayers.map((player) => {\n            return new PartialCircuitSolution(\n                player,\n                this.currentIteration + 1,\n                this.circuit,\n                this.mapZoom,\n                this.mapGridSize,\n            );\n        });\n    }\n\n    updateScoreWithTotals({\n        maxAvgSpeed,\n        maxCheckpointsCoveredPerTurn,\n        maxCheckpointsCovered,\n    }) {\n        this.avgSpeedScore = (this.avgSpeed + 1) / (maxAvgSpeed + 1);\n        this.checkpointsCoveredPerTurnScore =\n            (this.checkpointsCoveredPerTurn + 1) /\n            (maxCheckpointsCoveredPerTurn + 1);\n        this.checkpointsCoveredScore =\n            (this.checkpointsCovered + 1) / (maxCheckpointsCovered + 1);\n\n        this.score =\n            this.avgSpeedScore * 0.1 +\n            this.checkpointsCoveredPerTurnScore * 0.3 +\n            this.checkpointsCoveredScore * 0.6;\n\n        this.summary = {\n            avgSpeedScore: this.avgSpeedScore.toFixed(2),\n            checkpointsCoveredPerTurnScore: this.checkpointsCoveredPerTurnScore.toFixed(\n                2,\n            ),\n            checkpointsCoveredScore: this.checkpointsCoveredScore.toFixed(2),\n        };\n    }\n\n    _updatePartialScore() {\n        if (!this.playerInfo.prevPositions.length) {\n            this.score = -1;\n            return;\n        }\n        if (doesPlayerHaveRepeatedPositions(this.playerInfo)) {\n            // we really don't want a path going to the same point again\n            this.score = -1000;\n            return;\n        }\n\n        this.avgSpeed = getAverageSpeed(this.playerInfo);\n        const checkpoints = getCheckpointsPassed(this.playerInfo);\n        const nextCheckpoint = 1 - this._getPercentageToNextCheckpoint();\n        this.checkpointsCovered = checkpoints + nextCheckpoint;\n        this.checkpointsCoveredPerTurn =\n            this.checkpointsCovered / this.getTurns();\n\n        this.score = 1; // temp until all scores are calculated\n    }\n\n    getScore() {\n        return this.score;\n    }\n\n    getFirstMove() {\n        const indexWithFirstPosition =\n            this.playerInfo.prevPositions.length - this.currentIteration + 1;\n        return this.playerInfo.prevPositions[indexWithFirstPosition];\n    }\n\n    getTurns() {\n        return this.playerInfo.prevPositions.length;\n    }\n\n    isFinished() {\n        return hasPlayerFinishedRace(this.playerInfo);\n    }\n\n    _getPercentageToNextCheckpoint() {\n        const distanceToNext = getDistanceToNextCheckpoint({\n            player: this.playerInfo,\n            zoom: this.mapZoom,\n            gridSize: this.mapGridSize,\n            circuit: this.circuit,\n        });\n        const maxCPDistance = getMaxCheckpointDistance(this.circuit);\n        return (distanceToNext + 1) / (maxCPDistance + 1);\n    }\n}\n","/* eslint-disable no-loop-func */\nimport { getPossibleDestinations } from 'store/players/selectors';\nimport { pickRandomFromArray } from 'utils/random';\nimport { checkIfPlayerCanMove } from 'utils/circuit';\nimport aiLevels from 'constants/ai-levels';\nimport PartialCircuitSolution from './PartialCircuitSolution';\nimport { waitForNextAnimationFrame } from './request-animation-frame';\n\n/**\n * @param {Player} player\n * @param {Player[]} otherPlayers\n * @param {Circuit} circuit\n * @param {number} zoom\n * @param {number} gridSize\n * @returns {Promise<Point>}\n */\nexport const chooseNextMovement = (\n    player,\n    otherPlayers,\n    circuit,\n    zoom,\n    gridSize,\n) => {\n    return new Promise((resolve) => {\n        if (shouldGetRandomSolution(player)) {\n            resolve(\n                returnRandomNonCrashingMove({\n                    player,\n                    otherPlayers,\n                    zoom,\n                    circuit,\n                    gridSize,\n                }),\n            );\n            return;\n        }\n\n        const solutionsGenerator = createSolutionsGenerator({\n            player,\n            otherPlayers,\n            circuit,\n            zoom,\n            gridSize,\n        });\n\n        (async () => {\n            // eslint-disable-next-line no-restricted-syntax\n            for await (const solution of solutionsGenerator) {\n                await waitForNextAnimationFrame();\n                if (solution.isFinished) {\n                    resolve(solution.move);\n                    break;\n                }\n            }\n        })();\n    });\n};\n\n/**\n * Generate numbers in the Fibonacci sequence.\n *\n * @generator\n * @function createSolutionsGenerator\n * @yields {AINextMoveSolution}\n */\nasync function* createSolutionsGenerator({\n    player,\n    otherPlayers,\n    circuit,\n    zoom,\n    gridSize,\n}) {\n    let openSolutions = [\n        new PartialCircuitSolution(player, 1, circuit, zoom, gridSize),\n    ];\n    /** @type {PartialCircuitSolution[]} */\n    let finishedSolutions = [];\n    let bestFinishedSolution = null;\n\n    const { maxIterations } = aiLevels[player.levelAI];\n    const { maxThinkingDepth } = aiLevels[player.levelAI];\n\n    let currentIteration = 1;\n    const yieldEvery = 50;\n\n    while (openSolutions.length && currentIteration <= maxIterations) {\n        currentIteration += 1;\n        const solutionToExpand = getMostPromisingSolution(openSolutions);\n        openSolutions = openSolutions.filter(\n            (solution) => solution !== solutionToExpand,\n        );\n        const newSolutions = solutionToExpand.expand(\n            otherPlayers,\n            maxThinkingDepth,\n        );\n        const newFinishedSolutions = newSolutions.filter((solution) =>\n            solution.isFinished(),\n        );\n\n        // eslint-disable-next-line no-restricted-syntax\n        for (const solution of newFinishedSolutions) {\n            if (\n                !bestFinishedSolution ||\n                solution.getTurns() < bestFinishedSolution.getTurns()\n            ) {\n                bestFinishedSolution = solution;\n            }\n        }\n        finishedSolutions = finishedSolutions.concat(newFinishedSolutions);\n        const newOpenSolutions = newSolutions\n            .filter((solution) => !solution.isFinished())\n            .filter((solution) => solution.getScore() >= 0)\n            .filter(\n                // removing solutions with more turns than already found ones\n                (solution) =>\n                    !bestFinishedSolution ||\n                    solution.getTurns() < bestFinishedSolution.getTurns(),\n            );\n\n        openSolutions = openSolutions.concat(newOpenSolutions);\n\n        const maxAvgSpeed = openSolutions.reduce(\n            (acc, solution) => Math.max(acc, solution.avgSpeed),\n            0,\n        );\n        const maxCheckpointsCoveredPerTurn = openSolutions.reduce(\n            (acc, solution) =>\n                Math.max(acc, solution.checkpointsCoveredPerTurn),\n            0,\n        );\n        const maxCheckpointsCovered = openSolutions.reduce(\n            (acc, solution) => Math.max(acc, solution.checkpointsCovered),\n            0,\n        );\n        openSolutions.forEach((solution) => {\n            solution.updateScoreWithTotals({\n                maxAvgSpeed,\n                maxCheckpointsCoveredPerTurn,\n                maxCheckpointsCovered,\n            });\n        });\n\n        if (currentIteration % yieldEvery === 0) {\n            yield {\n                isFinished: false,\n            };\n        }\n    }\n\n    /** @type {Point} */\n    let move;\n    if (bestFinishedSolution) {\n        move = bestFinishedSolution.getFirstMove();\n    } else if (openSolutions.length) {\n        move = getMostPromisingSolution(openSolutions).getFirstMove();\n    } else {\n        move = returnRandomMove(player, otherPlayers);\n    }\n    yield {\n        isFinished: true,\n        move,\n    };\n}\n\n/**\n * @param {Player} player\n */\nfunction shouldGetRandomSolution(player) {\n    const chance = aiLevels[player.levelAI].randomSolutionChance;\n    return Math.random() < chance;\n}\n\n/**\n * @param {Player} player\n * @param {Player[]} otherPlayers\n * @returns {Point}\n */\nfunction returnRandomMove(player, otherPlayers) {\n    const positions = getPossibleDestinations(player, otherPlayers);\n    return pickRandomFromArray(positions);\n}\n\nfunction returnRandomNonCrashingMove({\n    player,\n    otherPlayers,\n    zoom,\n    circuit,\n    gridSize,\n}) {\n    const canMoveThere = (position) =>\n        checkIfPlayerCanMove({\n            from: player.position,\n            to: position,\n            zoom,\n            gridSize,\n            circuit,\n            otherPlayers: [],\n        });\n\n    let possiblePositions = getPossibleDestinations(\n        player,\n        otherPlayers,\n    ).filter((position) => canMoveThere(position));\n\n    if (!possiblePositions.length) {\n        // If we don't have other option other than crashing\n        possiblePositions = getPossibleDestinations(player, otherPlayers);\n    }\n\n    return pickRandomFromArray(possiblePositions);\n}\n\n/**\n *\n * @param {PartialCircuitSolution[]} solutions\n */\nfunction getMostPromisingSolution(solutions) {\n    return solutions.reduce((best, solution) => {\n        if (solution.getScore() > best.getScore()) {\n            return solution;\n        }\n        return best;\n    }, solutions[0]);\n}\n","export const waitForNextAnimationFrame = () => {\n    return new Promise((resolve) => {\n        requestAnimationFrame(resolve);\n    });\n};\n","/* eslint-disable no-undef */\n// Based on https://stackoverflow.com/a/4819886/3493388\nfunction checkTouchDevice() {\n    const prefixes = ' -webkit- -moz- -o- -ms- '.split(' ');\n\n    const mq = (query) => {\n        return window.matchMedia(query).matches;\n    };\n\n    if (\n        'ontouchstart' in window ||\n        // @ts-ignore\n        (window.DocumentTouch && document instanceof DocumentTouch)\n    ) {\n        return true;\n    }\n\n    // include the 'heartz' as a way to have a non matching MQ to help terminate the join\n    // https://git.io/vznFH\n    const query = ['(', prefixes.join('touch-enabled),('), 'heartz', ')'].join(\n        '',\n    );\n    return mq(query);\n}\n\nexport const isTouchDevice = checkTouchDevice();\n","const log = process.env.NODE_ENV === 'development';\n\n/**\n * Tracks a google analytics event\n *\n * @param {string} action\n * @param {object} [params = {}]\n * @param {string} [params.category]\n * @param {string} [params.label]\n * @param {any} [params.value]\n */\nexport const track = (action, { category, label, value } = {}) => {\n    if (log) {\n        // eslint-disable-next-line no-console\n        console.log('track', action, category, label, value);\n    }\n    // @ts-ignore\n    if (!window.gtag) {\n        return;\n    }\n    if (process.env.NODE_ENV === 'development') {\n        return;\n    }\n    // @ts-ignore\n    window.gtag('event', action, {\n        event_category: category,\n        event_label: label,\n        value,\n    });\n};\n","import shuffle from 'lodash.shuffle';\nimport * as gameStates from 'constants/game-states';\nimport { circuits } from 'constants/circuits';\nimport {\n    setPlayers,\n    moveTo,\n    notifyCollision,\n    reduceGrounded,\n    notifyVisitedCheckpoints,\n} from 'store/players/actions';\nimport { changeScreen } from 'store/main-ui/actions';\nimport {\n    initGame,\n    setGameState,\n    advancePlayerTurn,\n    setLatestHighScore,\n    setSelectedPosition,\n    initReplay,\n    setSelectedAIMove,\n} from 'store/game/actions';\nimport {\n    getAllPlayers,\n    getCurrentPlayer,\n    hasCurrentPlayerWon,\n    getOtherPlayers,\n    getSelectedPosition,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport { GAME, MAIN_MENU, LOADING_GAME, REPLAY_GAME } from 'constants/screens';\nimport {\n    TIME_SHOWING_RANDOM_SELECTOR,\n    WAIT_AFTER_AI_GROUNDED,\n    WAIT_AFTER_AI_COLLISION,\n} from 'constants/ux';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport {\n    createFromConfig,\n    getCheckpointsVisitedInLine,\n    checkIfPlayerCanMove,\n} from 'utils/circuit';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { distance } from 'utils/vector2d';\nimport { getPossibleDestinations } from 'store/players/selectors';\nimport { pickRandomFromArray, getRandomInRange } from 'utils/random';\nimport { timeout } from 'utils/gameLoopTimeout';\nimport { shouldScoreBeAdded, addScore } from 'utils/highScoresStorage';\nimport { AI, HUMAN } from 'constants/player-types';\nimport { chooseNextMovement } from 'utils/ai';\nimport aiLevels from 'constants/ai-levels';\nimport { isTouchDevice } from 'utils/is-touch-device';\nimport { storeSavedPlayers } from 'utils/playersStorage';\nimport { track } from 'utils/analytics';\n\n/**\n * @param {Player} nextPlayer\n */\nconst notifyGrounded = (nextPlayer) => {\n    return (dispatch) => {\n        if (nextPlayer.type === HUMAN) {\n            dispatch(setGameState(gameStates.NOTIFY_GROUNDED));\n            return;\n        }\n        dispatch(setGameState(gameStates.NOTIFY_AI_GROUNDED));\n        setTimeout(() => {\n            dispatch(reduceGroundedAndNextTurn());\n        }, WAIT_AFTER_AI_GROUNDED);\n    };\n};\n\nexport const startTurn = () => {\n    return (dispatch, getState) => {\n        const nextPlayer = getCurrentPlayer(getState());\n        if (nextPlayer.turnsGrounded) {\n            dispatch(notifyGrounded(nextPlayer));\n            return;\n        }\n\n        if (nextPlayer.type === AI) {\n            dispatch(handleAITurn(nextPlayer));\n            return;\n        }\n\n        if (getState().mainUI.playWithTimer) {\n            dispatch(setGameState(gameStates.PLAYER_TURN_START_SCREEN));\n        } else {\n            dispatch(startWaitingForPlayerInput());\n        }\n    };\n};\n\nexport const nextTurn = () => {\n    return (dispatch) => {\n        dispatch(advancePlayerTurn());\n        dispatch(startTurn());\n    };\n};\n\nexport const reduceGroundedAndNextTurn = () => {\n    return (dispatch, getState) => {\n        const currentPlayer = getCurrentPlayer(getState());\n        dispatch(reduceGrounded(currentPlayer.id));\n        dispatch(nextTurn());\n    };\n};\n\n/**\n * Inits the game with a certain config\n *\n * @param {Object} config\n * @param {Player[]} config.players\n * @param {string[]} config.playerOrder\n * @param {CircuitConfig} config.circuit\n * @returns {(dispatch: any, getState: any) => void}\n */\nexport const initGameWithConfig = ({ players, playerOrder, circuit }) => {\n    return (dispatch, getState) => {\n        dispatch(changeScreen(LOADING_GAME));\n        const playersWithMapPosition = initMapPositionForPlayers({\n            players,\n            playerOrder,\n            circuit,\n        }).map(fixPlayersWithoutName);\n\n        dispatch(setPlayers(playersWithMapPosition));\n\n        track('init_game', { category: 'game', label: circuit?.id });\n        track('total_players', {\n            category: 'game',\n            value: players.length,\n            label: circuit?.id,\n        });\n        track('human_players', {\n            category: 'game',\n            value: players.filter((player) => player.type === HUMAN).length,\n            label: circuit?.id,\n        });\n        track('ai_players', {\n            category: 'game',\n            value: players.filter((player) => player.type === AI).length,\n            label: circuit?.id,\n        });\n\n        // if we don't want timer, set infinite time\n        if (!getState().mainUI.playWithTimer) {\n            waitingForPlayerCounter.setTimeToWait(-1);\n        }\n\n        createFromConfig(circuit).then((circuitInfo) => {\n            dispatch(initGame(playerOrder, circuitInfo));\n            dispatch(changeScreen(GAME));\n        });\n    };\n};\n\nexport const initGameWithSavedConfig = () => {\n    return (dispatch, getState) => {\n        /** @type {RootState} */\n        const state = getState();\n        const { randomizePlayerOrderOnStart } = state.mainUI;\n        const playerOrder = randomizePlayerOrderOnStart\n            ? shuffle(state.mainUI.selectedPlayerOrder)\n            : state.mainUI.selectedPlayerOrder;\n\n        storeSavedPlayers(\n            state.mainUI.selectedPlayerOrder,\n            state.mainUI.selectedPlayers,\n        );\n\n        dispatch(\n            initGameWithConfig({\n                players: state.mainUI.selectedPlayers,\n                playerOrder,\n                circuit: circuits[state.mainUI.selectedCircuit],\n            }),\n        );\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n * @param {number} timePassed\n */\nexport const handlePlayerCollision = (\n    player,\n    newIntendedPosition,\n    timePassed,\n) => {\n    return (dispatch) => {\n        const speed = distance(player.position, newIntendedPosition);\n        track('collision', {\n            category: 'game',\n            label: player?.type === AI ? 'ai' : 'human',\n            value: speed,\n        });\n        dispatch(notifyCollision(player.id, speed, timePassed));\n        if (player.type === AI) {\n            dispatch(setGameState(gameStates.NOTIFY_AI_COLLISION));\n            setTimeout(() => {\n                dispatch(nextTurn());\n            }, WAIT_AFTER_AI_COLLISION);\n            return;\n        }\n        dispatch(setGameState(gameStates.NOTIFY_COLLISION));\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n * @param {number} timePassed\n * @param {Line} movementLine\n * @param {Circuit} circuit\n */\nexport const handleCorrectMovement = (\n    player,\n    newIntendedPosition,\n    timePassed,\n    movementLine,\n    circuit,\n) => {\n    return (dispatch, getState) => {\n        dispatch(detectAndStoreCheckpoints(movementLine, circuit));\n        const hasPlayerWon = hasCurrentPlayerWon(getState());\n        dispatch(moveTo(player.id, newIntendedPosition, timePassed));\n        if (hasPlayerWon) {\n            dispatch(handleVictory(getCurrentPlayer(getState()), circuit));\n            return;\n        }\n        dispatch(nextTurn());\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Circuit} circuit\n */\nfunction handleVictory(player, circuit) {\n    return (dispatch) => {\n        track('victory', { category: 'game' });\n        const score = {\n            name: player.name,\n            date: new Date(),\n            turns: player.turnsSpent,\n            realTimeUsed: player.realTimeUsed,\n            maxSpeed: player.maxSpeed,\n            crashes: player.crashes,\n            path: player.prevPositions,\n            playerStyle: player.style,\n        };\n\n        if (shouldScoreBeAdded(score, circuit, player)) {\n            const newScore = addScore(score, circuit, player);\n            track('high_score', {\n                category: 'game',\n                label: circuit?.id,\n                value: newScore?.turns,\n            });\n            dispatch(setLatestHighScore(newScore));\n            dispatch(setGameState(gameStates.NOTIFY_HIGH_SCORE));\n        } else {\n            dispatch(setGameState(gameStates.NOTIFY_VICTORY));\n        }\n    };\n}\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n */\nconst handlePlayerMovement = (player, newIntendedPosition) => {\n    return (dispatch, getState) => {\n        const timePassed = waitingForPlayerCounter.getTimePassed();\n        waitingForPlayerCounter.stop();\n        const state = getState();\n        const circuit = getCircuitInfo(state);\n        const mapZoom = state.map.zoom;\n        const mapGridSize = state.map.gridSize;\n        const canMoveThere = checkIfPlayerCanMove({\n            from: player.position,\n            to: newIntendedPosition,\n            zoom: mapZoom,\n            gridSize: mapGridSize,\n            circuit,\n            otherPlayers: getOtherPlayers(state, player.id),\n        });\n\n        if (!canMoveThere) {\n            dispatch(\n                handlePlayerCollision(player, newIntendedPosition, timePassed),\n            );\n            return;\n        }\n\n        const movementLine = [\n            projectToScreenPosition(state, player.position),\n            projectToScreenPosition(state, newIntendedPosition),\n        ];\n\n        dispatch(\n            handleCorrectMovement(\n                player,\n                newIntendedPosition,\n                timePassed,\n                movementLine,\n                circuit,\n            ),\n        );\n    };\n};\n\n/**\n * @param {Player} player\n * @param {Point} newIntendedPosition\n */\nexport const handlePlayerPositionSelection = (player, newIntendedPosition) => {\n    return (dispatch) => {\n        if (isTouchDevice) {\n            dispatch(setSelectedPosition(newIntendedPosition));\n            return;\n        }\n        dispatch(handlePlayerMovement(player, newIntendedPosition));\n    };\n};\n\n/**\n * @param {Player} player\n */\nexport const confirmPositionSelection = (player) => {\n    return (dispatch, getState) => {\n        const selectedPosition = getSelectedPosition(getState());\n        dispatch(handlePlayerMovement(player, selectedPosition));\n    };\n};\n\nexport const startWaitingForPlayerInput = () => {\n    return (dispatch, getState) => {\n        dispatch(setGameState(gameStates.WAITING_FOR_PLAYER_INPUT));\n        let callbackOnEnd = () => {};\n\n        if (getState().mainUI.playWithTimer) {\n            callbackOnEnd = () => {\n                const selectedPosition = getSelectedPosition(getState());\n                if (selectedPosition) {\n                    // If a position was already selected we choose that one\n                    const player = getCurrentPlayer(getState());\n                    dispatch(handlePlayerMovement(player, selectedPosition));\n                    return;\n                }\n                dispatch(showRandomSelectorAndMovePlayer());\n            };\n        }\n\n        waitingForPlayerCounter.restart({ callbackOnEnd });\n    };\n};\n\n/**\n * @param {Player} player\n */\nexport const handleAITurn = (player) => {\n    return async (dispatch, getState) => {\n        dispatch(setGameState(gameStates.AI_THINKING_SCREEN));\n        const state = getState();\n        const circuit = getCircuitInfo(state);\n        const otherPlayers = getAllPlayers(getState()).filter(\n            (otherPlayer) => otherPlayer.id !== player.id,\n        );\n        const mapZoom = state.map.zoom;\n        const mapGridSize = state.map.gridSize;\n        const nextMovementPromise = chooseNextMovement(\n            player,\n            otherPlayers,\n            circuit,\n            mapZoom,\n            mapGridSize,\n        );\n\n        const minTimeToWaitForPlayer = getMinTimeToWaitForPlayer(player);\n        // eslint-disable-next-line no-unused-vars\n        const result = await Promise.all([\n            timeout(minTimeToWaitForPlayer),\n            nextMovementPromise,\n        ]);\n        const nextMovement = result[1];\n        dispatch(setSelectedAIMove(nextMovement));\n        await timeout(1000);\n        dispatch(handlePlayerMovement(player, nextMovement));\n    };\n};\n\n/**\n * @param {Player} player\n */\nfunction getMinTimeToWaitForPlayer(player) {\n    const { timeThinking } = aiLevels[player.levelAI];\n    return getRandomInRange(timeThinking.min, timeThinking.max);\n}\n\nfunction showRandomSelectorAndMovePlayer() {\n    return (dispatch, getState) => {\n        dispatch(setGameState(gameStates.ANIMATING_RANDOM_PLAYER_MOVEMENT));\n        timeout(TIME_SHOWING_RANDOM_SELECTOR).then(() => {\n            const player = getCurrentPlayer(getState());\n            const otherPlayers = getAllPlayers(getState()).filter(\n                (otherPlayer) => otherPlayer.id !== player.id,\n            );\n            const positions = getPossibleDestinations(player, otherPlayers);\n            const nextPosition = pickRandomFromArray(positions);\n            dispatch(handlePlayerMovement(player, nextPosition));\n        });\n    };\n}\n\n/**\n * @param {Line} movementLine\n * @param {Circuit} circuit\n */\nexport const detectAndStoreCheckpoints = (movementLine, circuit) => {\n    return (dispatch, getState) => {\n        const visitedCheckpointsInTurn = getCheckpointsVisitedInLine(\n            movementLine,\n            circuit,\n        );\n        if (!visitedCheckpointsInTurn.length) {\n            return;\n        }\n        const currentPlayer = getCurrentPlayer(getState());\n        dispatch(\n            notifyVisitedCheckpoints(\n                currentPlayer.id,\n                visitedCheckpointsInTurn,\n            ),\n        );\n    };\n};\n\nexport const finishGame = () => {\n    return (dispatch) => {\n        track('finish_game', { category: 'game' });\n        dispatch(changeScreen(MAIN_MENU));\n        waitingForPlayerCounter.reset();\n    };\n};\n\n/**\n * @param {Object} params\n * @param {Player[]} params.players\n * @param {string[]} params.playerOrder\n * @param {CircuitConfig} params.circuit\n */\nfunction initMapPositionForPlayers({ players, playerOrder, circuit }) {\n    const orderedPlayers = playerOrder.map((playerId) =>\n        players.find((player) => player.id === playerId),\n    );\n\n    return orderedPlayers.map((player, index) => {\n        const initialPosition = circuit.startingPositions[index];\n        return {\n            ...player,\n            position: { ...initialPosition },\n            prevPositions: [{ ...initialPosition }],\n            speed: { ...circuit.initialSpeed },\n            checkpointsPassed: circuit.checkpoints.map(() => false),\n        };\n    });\n}\n\nexport const pause = () => {\n    return (dispatch) => {\n        dispatch(setGameState(gameStates.SHOW_MENU));\n        waitingForPlayerCounter.pause();\n    };\n};\n\nexport const unpause = () => {\n    return (dispatch, getState) => {\n        const lastState = getState().game.prevGameState;\n        dispatch(setGameState(lastState));\n        waitingForPlayerCounter.unpause();\n    };\n};\n\nexport const tryToToggleInGameMenu = () => {\n    return (dispatch, getState) => {\n        const { gameState } = getState().game;\n        switch (gameState) {\n            case gameStates.SHOW_MENU:\n                dispatch(unpause());\n                break;\n            case gameStates.WAITING_FOR_PLAYER_INPUT:\n                dispatch(pause());\n                break;\n            default:\n        }\n    };\n};\n\nexport const tryToShowInGameMenu = () => {\n    return (dispatch, getState) => {\n        const { gameState } = getState().game;\n        switch (gameState) {\n            case gameStates.WAITING_FOR_PLAYER_INPUT:\n                dispatch(pause());\n                break;\n            default:\n        }\n    };\n};\n\n/**\n * @param {Player} player\n * @param {number} index\n */\nfunction fixPlayersWithoutName(player, index) {\n    if (player.name) {\n        return player;\n    }\n    return {\n        ...player,\n        name: getNameForPlayerWithoutName(index),\n    };\n}\n\n/**\n * @param {number} index\n */\nfunction getNameForPlayerWithoutName(index) {\n    switch (index) {\n        case 0:\n            return 'Anonymous';\n        case 1:\n            return 'Mistery racer';\n        case 2:\n            return 'Shy runner';\n        case 3:\n            return 'Jane Doe';\n        default:\n            return 'John Doe';\n    }\n}\n\n/**\n * @param {*} score\n * @param {Circuit} circuit\n */\nexport const showReplay = (score, circuit) => {\n    return (dispatch) => {\n        track('show_replay', { category: 'replay' });\n        createFromConfig(circuit).then((circuitInfo) => {\n            dispatch(initReplay(score, circuitInfo));\n            dispatch(changeScreen(REPLAY_GAME));\n        });\n    };\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nclass CounterDisplay extends React.Component {\n    state = {\n        timeLeft: 0,\n    };\n\n    /** @type {number} */\n    requestRef = null;\n\n    componentDidMount() {\n        this.animate();\n    }\n\n    componentWillUnmount() {\n        if (this.requestRef) {\n            cancelAnimationFrame(this.requestRef);\n        }\n    }\n\n    animate = () => {\n        this.setState({\n            timeLeft: this.props.counterObject.getTimeLeft(),\n        });\n        this.requestRef = requestAnimationFrame(this.animate);\n    };\n\n    render() {\n        return (\n            <div className=\"counter-display\">\n                <div className=\"counter-display-text\">Time left:</div>\n                <div className=\"counter-display-number\">\n                    {(this.state.timeLeft / 1000).toFixed(3)}\n                </div>\n            </div>\n        );\n    }\n}\n\nCounterDisplay.propTypes = {\n    counterObject: PropTypes.shape({\n        getTimeLeft: PropTypes.func,\n    }).isRequired,\n};\n\nexport default CounterDisplay;\n","import PropTypes from 'prop-types';\n\nexport const playerStyle = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n    dotColor: PropTypes.string,\n    dotSize: PropTypes.number,\n    round: PropTypes.string,\n    trailColor: PropTypes.string,\n    trailDotsSize: PropTypes.number,\n    trailWidth: PropTypes.number,\n    icon: PropTypes.string,\n});\n\nexport const vector2d = PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n});\n\nexport const selectablePlayer = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n});\n\nexport const player = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n    position: vector2d.isRequired,\n    speed: vector2d.isRequired,\n    prevPositions: PropTypes.arrayOf(vector2d),\n});\n\nexport const raceHistory = PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    style: playerStyle,\n    path: PropTypes.arrayOf(vector2d),\n});\n\nexport const Score = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n    turns: PropTypes.number,\n    time: PropTypes.number,\n});\n\nexport const Circuit = PropTypes.shape({\n    id: PropTypes.string,\n    name: PropTypes.string,\n});\n\nexport const Move = PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n    dx: PropTypes.number,\n    yy: PropTypes.number,\n    baseX: PropTypes.number,\n    baseY: PropTypes.number,\n});\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport ReactResizeDetector from 'react-resize-detector';\nimport classNames from 'classnames';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    player as playerProp,\n    Circuit as circuitProp,\n    vector2d as vector2dProp,\n} from 'components/propTypes';\nimport { connect } from 'react-redux';\nimport {\n    substract,\n    add,\n    isInsideViewport,\n    getClosestPointInsideViewport,\n} from 'utils/vector2d';\nimport { getCircuitInfo, getCurrentPlayer } from 'store/game/selectors';\nimport './style.css';\n\nconst PADDING_FOR_VIEWPORT = { x: 120, y: 100 };\n\n/**\n * @typedef {object} GameBoardCameraHandlerProps\n * @property {Player} currentPlayer\n * @property {*} children\n * @property {Circuit} circuitInfo\n * @property {Point} playerScreenPosition\n */\n\nclass GameBoardCameraHandler extends React.Component {\n    state = {\n        /** @type {Point} */\n        cameraPosition: { x: 0, y: 0 },\n        /** @type {{width: number, height: number}} */\n        boardSize: null,\n        isDragging: false,\n        /** @type {Point} */\n        dragStart: null,\n    };\n\n    /**\n     * @type {GameBoardCameraHandlerProps}\n     */\n    props;\n\n    componentDidMount() {\n        this.moveCurrentPlayerIntoView();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.currentPlayer !== prevProps.currentPlayer) {\n            this.moveCurrentPlayerIntoView();\n        }\n    }\n\n    moveCurrentPlayerIntoView = () => {\n        if (\n            !this.state.boardSize ||\n            !this.props.currentPlayer ||\n            !this.props.currentPlayer.position\n        ) {\n            return;\n        }\n        const viewport = {\n            topLeft: substract({ x: 0, y: 0 }, this.state.cameraPosition),\n            size: this.state.boardSize,\n        };\n        if (\n            isInsideViewport(\n                this.props.playerScreenPosition,\n                viewport,\n                PADDING_FOR_VIEWPORT,\n            )\n        ) {\n            return;\n        }\n        const closestPointInViewport = getClosestPointInsideViewport(\n            this.props.playerScreenPosition,\n            viewport,\n            PADDING_FOR_VIEWPORT,\n        );\n        const newCameraMovement = substract(\n            closestPointInViewport,\n            this.props.playerScreenPosition,\n        );\n\n        const oldCameraPosition = this.state.cameraPosition;\n\n        // TODO find a way of not doing state changes on prop update\n        // eslint-disable-next-line react/no-did-update-set-state\n        this.setState({\n            cameraPosition: add(oldCameraPosition, newCameraMovement),\n        });\n    };\n\n    handlePointerDown = (event) => {\n        const coordinates = getCoordinatesFromPointerEvent(event);\n        this.setState({\n            isDragging: true,\n            dragStart: coordinates,\n        });\n    };\n\n    handlePointerUp = () => {\n        this.setState({\n            isDragging: false,\n            dragStart: null,\n        });\n    };\n\n    handlePointerMove = (event) => {\n        if (!this.state.isDragging || !this.state.dragStart) {\n            return;\n        }\n        const cursorPosition = getCoordinatesFromPointerEvent(event);\n        const movement = substract(cursorPosition, this.state.dragStart);\n        const oldCameraPosition = this.state.cameraPosition;\n\n        this.setState({\n            dragStart: cursorPosition,\n            cameraPosition: add(oldCameraPosition, movement),\n        });\n    };\n\n    render() {\n        return (\n            <div className=\"game-board\">\n                <ReactResizeDetector\n                    handleHeight\n                    handleWidth\n                    onResize={(width, height) => {\n                        this.setState(\n                            {\n                                boardSize: { width, height },\n                            },\n                            this.moveCurrentPlayerIntoView,\n                        );\n                    }}\n                >\n                    <div\n                        className={classNames('game-board-content', {\n                            'is-dragging': this.state.isDragging,\n                        })}\n                        style={{\n                            width: this.props.circuitInfo.width,\n                            height: this.props.circuitInfo.height,\n                            transform: `translate(${this.state.cameraPosition.x}px, ${this.state.cameraPosition.y}px)`,\n                        }}\n                        onMouseDown={this.handlePointerDown}\n                        onMouseUp={this.handlePointerUp}\n                        onMouseMove={this.handlePointerMove}\n                        onTouchStart={this.handlePointerDown}\n                        onTouchEnd={this.handlePointerUp}\n                        onTouchMove={this.handlePointerMove}\n                        onTouchCancel={this.handlePointerUp}\n                    >\n                        {this.props.children}\n                    </div>\n                </ReactResizeDetector>\n            </div>\n        );\n    }\n}\n\nGameBoardCameraHandler.propTypes = {\n    currentPlayer: playerProp,\n    children: PropTypes.node,\n    circuitInfo: circuitProp,\n    playerScreenPosition: vector2dProp,\n};\n\nGameBoardCameraHandler.defaultProps = {\n    currentPlayer: null,\n    children: <></>,\n    circuitInfo: null,\n    playerScreenPosition: null,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n    const currentPlayer = getCurrentPlayer(state);\n    return {\n        ...ownProps,\n        circuitInfo: getCircuitInfo(state),\n        playerScreenPosition: projectToScreenPosition(\n            state,\n            currentPlayer?.position,\n        ),\n        currentPlayer,\n    };\n};\n\nexport default connect(mapStateToProps)(GameBoardCameraHandler);\n\nfunction getCoordinatesFromPointerEvent(event) {\n    let eventToUse = event;\n\n    if (event.type === 'touchstart' || event.type === 'touchmove') {\n        // eslint-disable-next-line prefer-destructuring\n        eventToUse = event.touches[0];\n    }\n    return {\n        x: eventToUse.clientX,\n        y: eventToUse.clientY,\n    };\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n// @ts-ignore\nimport gridImg from './grid.png';\nimport './style.css';\n\nconst GRID_IMAGE_SIZE = 60; // px\n\nconst Grid = ({ zoom, cellSize }) => {\n    const GRID_IMG_DENSITY = GRID_IMAGE_SIZE / cellSize;\n    const backgroundSize = (zoom * GRID_IMAGE_SIZE) / GRID_IMG_DENSITY;\n    return (\n        <div\n            className=\"grid\"\n            style={{\n                backgroundImage: `url(${gridImg})`,\n                backgroundSize: `${backgroundSize}px ${backgroundSize}px`,\n            }}\n        />\n    );\n};\n\nGrid.propTypes = {\n    zoom: PropTypes.number.isRequired,\n    cellSize: PropTypes.number.isRequired,\n};\n\nGrid.defaultProps = {};\n\nexport default Grid;\n","import React from 'react';\nimport { playerStyle as playerStyleProp } from 'components/propTypes';\nimport './style.css';\n\nfunction PlayerIcon({ playerStyle }) {\n    return (\n        <div\n            className=\"player-icon\"\n            style={{\n                backgroundImage: `url(${playerStyle.icon})`,\n            }}\n        />\n    );\n}\n\nPlayerIcon.propTypes = {\n    playerStyle: playerStyleProp.isRequired,\n};\n\nexport default PlayerIcon;\n","import { doesLineCollide } from 'utils/circuit';\n\n/**\n *\n * @param {Player} player\n * @returns {React.CSSProperties}\n */\nexport const getPlayerStyleCSS = (player) => {\n    if (!player) {\n        return {};\n    }\n\n    return {\n        // @ts-ignore\n        '--player-color': player.style.dotColor,\n        '--player-border-radius': player.style.round,\n        '--player-trail-border-radius': player.style.round,\n        '--player-size': `${player.style.dotSize + 2}px`,\n        '--movement-picker-size': `${player.style.dotSize - 1}px`,\n        '--movement-picker-size-center': `${player.style.dotSize + 2}px`,\n        '--player-trail-color': player.style.dotColor,\n        '--player-trail-size': `${player.style.dotSize}px`,\n    };\n};\n\nexport const getColorForTempLine = (\n    player,\n    points,\n    circuit,\n    otherPlayersPosition,\n) => {\n    if (doesLineCollide(points, circuit, otherPlayersPosition)) {\n        return 'red';\n    }\n    return player.style.trailColor;\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport PlayerIcon from 'components/PlayerIcon';\nimport { getPlayerStyleCSS } from 'utils/playerPainter';\nimport './style.css';\n\nconst Player = ({ player, isActive }) => {\n    const playerScreenPosition = useSelector((state) =>\n        // @ts-ignore\n        projectToScreenPosition(state, player.position),\n    );\n    return (\n        <div\n            className={classNames('player', {\n                'is-active': isActive,\n            })}\n            style={{\n                ...getPlayerStyleCSS(player),\n                left: playerScreenPosition.x,\n                top: playerScreenPosition.y,\n            }}\n        >\n            <PlayerIcon playerStyle={player.style} />\n\n            {isActive && <div className=\"player-active-indicator\" />}\n        </div>\n    );\n};\n\nPlayer.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default Player;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { motion } from 'framer-motion';\nimport { player as playerProp } from 'components/propTypes';\n\nfunction PossibleDestinations(props) {\n    return (\n        <>\n            {props.possiblePositions.map((eachPosition, index) => (\n                // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n                <motion.div\n                    key={`${props.player.id}_${eachPosition.position.x}_${eachPosition.position.y}`}\n                    className={classNames('movement-picker', {\n                        'movement-picker-center':\n                            !eachPosition.screen.dx && !eachPosition.screen.dy,\n                    })}\n                    style={{\n                        left: eachPosition.screen.baseX,\n                        top: eachPosition.screen.baseY,\n                    }}\n                    animate={{\n                        x: eachPosition.screen.dx,\n                        y: eachPosition.screen.dy,\n                    }}\n                    initial={{\n                        x: 0,\n                        y: 0,\n                    }}\n                    transition={{\n                        ease: 'easeInOut',\n                        duration: 0.3,\n                        delay: 0.2 + index * 0.1,\n                    }}\n                    onClick={() =>\n                        props.onPositionSelected(eachPosition.position)\n                    }\n                    onMouseEnter={() =>\n                        props.onPositionHover(eachPosition.screen)\n                    }\n                    onMouseLeave={props.onPositionHoverEnd}\n                />\n            ))}\n        </>\n    );\n}\n\nPossibleDestinations.propTypes = {\n    onPositionSelected: PropTypes.func.isRequired,\n    onPositionHover: PropTypes.func.isRequired,\n    onPositionHoverEnd: PropTypes.func.isRequired,\n    player: playerProp.isRequired,\n    possiblePositions: PropTypes.arrayOf(PropTypes.any).isRequired,\n};\nPossibleDestinations.defaultProps = {};\n\nexport default PossibleDestinations;\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { PathLine } from 'react-svg-pathline';\nimport { motion } from 'framer-motion';\nimport {\n    player as playerProp,\n    vector2d as vector2dProp,\n    Circuit as circuitProp,\n} from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    getOtherPlayersPositionInScreen,\n    getPossibleDestinationsForPlayerInScreen,\n    getSelectedPosition,\n    getMovedPixelsSinceLastTurn,\n    getPivotForPlayerInScreen,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport { doesLineCollide } from 'utils/circuit';\nimport { getColorForTempLine, getPlayerStyleCSS } from 'utils/playerPainter';\nimport { isTouchDevice } from 'utils/is-touch-device';\nimport PossibleDestinations from './PossibleDestinations';\n\nimport './style.css';\n\nclass MovementPicker extends React.Component {\n    state = {\n        tempLine: null,\n    };\n\n    render() {\n        const selectButtonPosition = getSelectButtonPosition(\n            this.props.possiblePositions,\n        );\n\n        const lineToPaint =\n            this.state.tempLine || this.props.selectedPositionScreen;\n\n        const wouldCollide =\n            lineToPaint &&\n            doesLineCollide(\n                [this.props.originalPlayerScreenPosition, lineToPaint],\n                this.props.circuit,\n                this.props.otherPlayersPosition,\n            );\n        return (\n            <motion.div\n                className=\"movement-picker-container\"\n                animate={{\n                    x: 0,\n                    y: 0,\n                }}\n                initial={{\n                    x: this.props.lastMovement.x,\n                    y: this.props.lastMovement.y,\n                }}\n                transition={{ ease: 'easeIn', duration: 0.3 }}\n                style={{\n                    ...getPlayerStyleCSS(this.props.player),\n                }}\n            >\n                <PossibleDestinations\n                    onPositionSelected={this.props.onPositionSelected}\n                    onPositionHover={(screenPosition) =>\n                        this.setState({ tempLine: screenPosition })\n                    }\n                    onPositionHoverEnd={() => this.setState({ tempLine: null })}\n                    player={this.props.player}\n                    possiblePositions={this.props.possiblePositions}\n                />\n                {isTouchDevice && this.props.selectedPosition && (\n                    // eslint-disable-next-line react/button-has-type\n                    <button\n                        className=\"button button-bg movement-picker-select-button\"\n                        style={{\n                            left: selectButtonPosition.x,\n                            top: selectButtonPosition.y,\n                        }}\n                        onClick={this.props.onConfirmSelection}\n                    >\n                        Select\n                    </button>\n                )}\n                {lineToPaint && (\n                    <svg className=\"movement-picker-temp-line\">\n                        <PathLine\n                            points={[\n                                this.props.originalPlayerScreenPosition,\n                                lineToPaint,\n                            ]}\n                            // @ts-ignore\n                            stroke={getColorForTempLine(\n                                this.props.player,\n                                [\n                                    this.props.originalPlayerScreenPosition,\n                                    lineToPaint,\n                                ],\n                                this.props.circuit,\n                                this.props.otherPlayersPosition,\n                            )}\n                            strokeWidth={this.props.player.style.trailWidth}\n                            strokeDasharray=\"2\"\n                            fill=\"none\"\n                            r={2}\n                        />\n                    </svg>\n                )}\n                <svg className=\"movement-picker-ghost-line\">\n                    <PathLine\n                        points={[\n                            this.props.originalPlayerScreenPosition,\n                            this.props.nextPivot,\n                        ]}\n                        // @ts-ignore\n                        stroke={this.props.player.style.trailColor}\n                        strokeWidth={this.props.player.style.trailWidth}\n                        strokeDasharray=\"1\"\n                        fill=\"none\"\n                        r={2}\n                    />\n                </svg>\n\n                {lineToPaint && wouldCollide && (\n                    <div\n                        className=\"movement-picker-crash\"\n                        style={{\n                            left: lineToPaint.x,\n                            top: lineToPaint.y,\n                        }}\n                    />\n                )}\n            </motion.div>\n        );\n    }\n}\n\nMovementPicker.propTypes = {\n    player: playerProp.isRequired,\n    onPositionSelected: PropTypes.func.isRequired,\n    onConfirmSelection: PropTypes.func.isRequired,\n    lastMovement: vector2dProp,\n    circuit: circuitProp.isRequired,\n    originalPlayerScreenPosition: circuitProp.isRequired,\n    possiblePositions: PropTypes.arrayOf(vector2dProp).isRequired,\n    nextPivot: vector2dProp.isRequired,\n    otherPlayersPosition: PropTypes.arrayOf(vector2dProp),\n    selectedPosition: vector2dProp,\n    selectedPositionScreen: vector2dProp,\n};\n\nMovementPicker.defaultProps = {\n    lastMovement: {\n        x: 0,\n        y: 0,\n    },\n    otherPlayersPosition: [],\n    selectedPosition: null,\n    selectedPositionScreen: null,\n};\n\nconst mapStateToProps = (state, ownProps) => {\n    const selectedPosition = getSelectedPosition(state);\n    return {\n        ...ownProps,\n        lastMovement: getMovedPixelsSinceLastTurn(state, ownProps.player) || {\n            x: 0,\n            y: 0,\n        },\n        circuit: getCircuitInfo(state),\n        originalPlayerScreenPosition: projectToScreenPosition(\n            state,\n            ownProps.player.position,\n        ),\n        possiblePositions: getPossibleDestinationsForPlayerInScreen(\n            state,\n            ownProps.player,\n        ),\n        nextPivot: getPivotForPlayerInScreen(state, ownProps.player),\n        otherPlayersPosition: getOtherPlayersPositionInScreen(\n            state,\n            ownProps.player.id,\n        ),\n        selectedPosition,\n        selectedPositionScreen: projectToScreenPosition(\n            state,\n            selectedPosition,\n        ),\n    };\n};\n\nexport default connect(mapStateToProps)(MovementPicker);\n\n/**\n * Gets the position to put the button to select (only used for touch devices)\n * Will get the highest y and the mean x\n *\n * @param {Array} possiblePlayerPositions\n * @returns {Point}\n */\nfunction getSelectButtonPosition(possiblePlayerPositions) {\n    if (!possiblePlayerPositions || !possiblePlayerPositions.length) {\n        return { x: 0, y: 0 };\n    }\n    const maxY = possiblePlayerPositions.reduce((acc, position) => {\n        return Math.max(acc, position.screen.y);\n    }, Number.MIN_VALUE);\n\n    const totalX = possiblePlayerPositions.reduce((acc, position) => {\n        return position.screen.x + acc;\n    }, 0);\n\n    return {\n        x: totalX / possiblePlayerPositions.length,\n        y: maxY,\n    };\n}\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { PathLine } from 'react-svg-pathline';\nimport { player as playerProp, Move } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport {\n    getOtherPlayersPositionInScreen,\n    getPossibleDestinationsForPlayerInScreen,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport { getPlayerStyleCSS, getColorForTempLine } from 'utils/playerPainter';\nimport { pickRandomFromArray } from 'utils/random';\nimport { SWITCH_RANDOM_SELECTION_EVERY } from 'constants/ux.js';\nimport './style.css';\n\nfunction RandomSelectionAnimation({\n    player,\n    children,\n    switchRandomEvery,\n    highlightMove,\n}) {\n    const [tempLine, setTempLine] = useState(null);\n    const [highlightedPosition, setHighlightedPosition] = useState(null);\n\n    useEffect(() => {\n        setTempLine(null);\n        return () => setTempLine(null);\n    }, [player]);\n\n    const circuit = useSelector(getCircuitInfo);\n    const originalPlayerScreenPosition = useSelector((state) =>\n        projectToScreenPosition(state, player.position),\n    );\n    const possiblePositions = useSelector((state) =>\n        getPossibleDestinationsForPlayerInScreen(state, player),\n    );\n    useEffect(() => {\n        const interval = setInterval(() => {\n            const randomPosition = pickRandomFromArray(possiblePositions);\n            setHighlightedPosition(randomPosition);\n            setTempLine(randomPosition.screen);\n        }, switchRandomEvery);\n        return () => {\n            clearInterval(interval);\n        };\n    }, [player, possiblePositions, switchRandomEvery]);\n    const otherPlayersPosition = useSelector((state) =>\n        getOtherPlayersPositionInScreen(state, player.id),\n    );\n    const moveToHighlight = useSelector((state) =>\n        projectToScreenPosition(state, highlightMove),\n    );\n\n    return (\n        <div style={getPlayerStyleCSS(player)}>\n            {children && (\n                <div\n                    className=\"random-selection-animation-warning\"\n                    style={{\n                        top: originalPlayerScreenPosition.y,\n                        left: originalPlayerScreenPosition.x,\n                    }}\n                >\n                    {children}\n                </div>\n            )}\n            {possiblePositions.map((eachPosition) => {\n                const key = getKey(player, eachPosition);\n                return (\n                    <div\n                        key={key}\n                        className={classNames('random-selection-animation', {\n                            'is-highlighted':\n                                !moveToHighlight &&\n                                highlightedPosition &&\n                                getKey(player, highlightedPosition) === key,\n                        })}\n                        style={{\n                            left: eachPosition.screen.x,\n                            top: eachPosition.screen.y,\n                        }}\n                    />\n                );\n            })}\n\n            {moveToHighlight && (\n                <div\n                    className=\"random-selection-animation-highlighted-move\"\n                    style={{\n                        left: moveToHighlight.x,\n                        top: moveToHighlight.y,\n                    }}\n                />\n            )}\n\n            {!moveToHighlight && tempLine && (\n                <svg className=\"random-selection-animation-temp-line\">\n                    <PathLine\n                        points={[originalPlayerScreenPosition, tempLine]}\n                        stroke={getColorForTempLine(\n                            player,\n                            [originalPlayerScreenPosition, tempLine],\n                            circuit,\n                            otherPlayersPosition,\n                        )}\n                        strokeWidth={player.style.trailWidth}\n                        strokeDasharray=\"2\"\n                        fill=\"none\"\n                        r={2}\n                    />\n                </svg>\n            )}\n        </div>\n    );\n}\n\nfunction getKey(player, position) {\n    return `${player.id}_${position.position.x}_${position.position.y}`;\n}\n\nRandomSelectionAnimation.propTypes = {\n    player: playerProp.isRequired,\n    children: PropTypes.node,\n    switchRandomEvery: PropTypes.number,\n    highlightMove: Move,\n};\n\nRandomSelectionAnimation.defaultProps = {\n    children: null,\n    switchRandomEvery: SWITCH_RANDOM_SELECTION_EVERY,\n    highlightMove: null,\n};\n\nexport default RandomSelectionAnimation;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { player as playerProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { PathLine } from 'react-svg-pathline';\nimport { getPlayerStyleCSS } from 'utils/playerPainter';\nimport './style.css';\n\nconst PlayerTrail = ({ player, isActive }) => {\n    const storeState = useSelector((state) => state);\n    if (!player.prevPositions.length) {\n        return <></>;\n    }\n    const points = player.prevPositions.map((position) =>\n        // @ts-ignore\n        projectToScreenPosition(storeState, position),\n    );\n    const pointsWithoutLast = points.slice(0, points.length - 1);\n    return (\n        <div\n            className={classNames('player-trail-container', {\n                'is-active': isActive,\n            })}\n            style={getPlayerStyleCSS(player)}\n        >\n            <svg className=\"player-trail\">\n                <PathLine\n                    points={points}\n                    // @ts-ignore\n                    stroke={player.style.trailColor}\n                    strokeWidth={player.style.trailWidth}\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n            {pointsWithoutLast\n                .map((point, index) => {\n                    return { ...point, turn: index + 1 };\n                })\n                .map((point) => (\n                    <div\n                        key={`${player.id}_${point.x}_${point.y}_${point.turn}`}\n                        className=\"player-trail-point\"\n                        style={{\n                            left: point.x,\n                            top: point.y,\n                        }}\n                    />\n                ))}\n        </div>\n    );\n};\n\nPlayerTrail.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default PlayerTrail;\n","import React from 'react';\nimport Grid from 'components/Grid';\nimport Player from 'components/Player';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n    handlePlayerPositionSelection,\n    confirmPositionSelection,\n} from 'store/game/async-actions';\nimport {\n    getCurrentPlayer,\n    getAllPlayers,\n    isWaitingForPlayerInput,\n    isAnimatingRandomSelection,\n    isAnimatingAISelection,\n    getAISelectedMove,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport MovementPicker from 'components/MovementPicker';\nimport RandomSelectionAnimation from 'components/RandomSelectionAnimation';\nimport PlayerTrail from 'components/PlayerTrail';\nimport { getZoom, getGridSize } from 'store/map/selectors';\nimport './style.css';\n\nconst GameBoardContents = () => {\n    const dispatch = useDispatch();\n    const players = useSelector(getAllPlayers);\n    const currentPlayer = useSelector(getCurrentPlayer);\n    const mapZoom = useSelector(getZoom);\n    const gridSize = useSelector(getGridSize);\n    const circuitInfo = useSelector(getCircuitInfo);\n    const waitingForPlayerInput = useSelector(isWaitingForPlayerInput);\n    const animatingRandomSelection = useSelector(isAnimatingRandomSelection);\n    const animatingAISelection = useSelector(isAnimatingAISelection);\n    const AIMove = useSelector(getAISelectedMove);\n\n    return (\n        <>\n            <div\n                className=\"game-board-circuit-bg\"\n                style={{\n                    backgroundImage: `url(${circuitInfo.bgImg})`,\n                    backgroundSize: `${circuitInfo.width}px ${circuitInfo.height}px`,\n                }}\n            />\n            <Grid zoom={mapZoom} cellSize={gridSize} />\n            {players.map((player) => (\n                <div key={player.id}>\n                    <Player\n                        player={player}\n                        isActive={player === currentPlayer}\n                    />\n                    <PlayerTrail\n                        player={player}\n                        isActive={player === currentPlayer}\n                    />\n                </div>\n            ))}\n            {currentPlayer && waitingForPlayerInput && (\n                <>\n                    <MovementPicker\n                        key={currentPlayer?.id}\n                        player={currentPlayer}\n                        onPositionSelected={(position) =>\n                            dispatch(\n                                handlePlayerPositionSelection(\n                                    currentPlayer,\n                                    position,\n                                ),\n                            )\n                        }\n                        onConfirmSelection={() => {\n                            dispatch(confirmPositionSelection(currentPlayer));\n                        }}\n                    />\n                </>\n            )}\n            {currentPlayer && animatingRandomSelection && (\n                <>\n                    <RandomSelectionAnimation player={currentPlayer}>\n                        Too late!\n                        <br /> Choosing a random move for you...\n                    </RandomSelectionAnimation>\n                </>\n            )}\n            {currentPlayer && animatingAISelection && (\n                <>\n                    <RandomSelectionAnimation\n                        player={currentPlayer}\n                        switchRandomEvery={getRandomSpeedForAI(currentPlayer)}\n                        highlightMove={AIMove}\n                    />\n                </>\n            )}\n        </>\n    );\n};\n\nfunction getRandomSpeedForAI(player) {\n    switch (player.levelAI) {\n        case 0:\n            return 800;\n        case 1:\n            return 400;\n        case 2:\n            return 200;\n        case 3:\n            return 100;\n        default:\n            return 75;\n    }\n}\n\nGameBoardContents.propTypes = {};\n\nGameBoardContents.defaultProps = {};\n\nexport default GameBoardContents;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport {\n    getCurrentPlayer,\n    isWaitingForPlayerInput,\n} from 'store/game/selectors';\nimport { shouldPlayWithTimer } from 'store/main-ui/selectors';\nimport { pause } from 'store/game/async-actions';\nimport CounterDisplay from 'components/CounterDisplay';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport { HUMAN } from 'constants/player-types';\nimport GameBoardCameraHandler from './GameBoardCameraHandler';\nimport GameBoardContents from './GameBoardContents';\nimport './style.css';\n\nconst GameBoard = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    const waitingForPlayerInput = useSelector(isWaitingForPlayerInput);\n    const playWithTimer = useSelector(shouldPlayWithTimer);\n    const shouldShowPauseButton =\n        !currentPlayer || currentPlayer.type === HUMAN;\n\n    return (\n        <div className=\"game-board-container\">\n            <GameBoardCameraHandler>\n                <GameBoardContents />\n            </GameBoardCameraHandler>\n            {waitingForPlayerInput && playWithTimer && (\n                <CounterDisplay counterObject={waitingForPlayerCounter} />\n            )}\n            {shouldShowPauseButton && (\n                <div className=\"pause-button-container\">\n                    <button\n                        type=\"button\"\n                        className=\"button button-small\"\n                        onClick={() => dispatch(pause())}\n                    >\n                        Pause\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n};\n\nGameBoard.propTypes = {};\n\nGameBoard.defaultProps = {};\n\nexport default GameBoard;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { player as playerProp } from 'components/propTypes';\nimport PlayerIcon from 'components/PlayerIcon';\n\nconst PlayerListItem = ({ player, isActive }) => {\n    return (\n        <li\n            className={classNames('player-list-item', {\n                'is-active': isActive,\n            })}\n        >\n            <div className=\"player-list-item-decorator-container\">\n                <div className=\"player-list-item-decorator\" />\n                <PlayerIcon playerStyle={player.style} />\n            </div>\n            <div>{player.name}</div>\n        </li>\n    );\n};\n\nPlayerListItem.propTypes = {\n    player: playerProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default PlayerListItem;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer, getAllPlayers } from 'store/game/selectors';\nimport PlayerListItem from './PlayerListItem';\nimport './style.css';\n\nconst PlayerList = () => {\n    const players = useSelector((state) => getAllPlayers(state));\n    const currentPlayer = useSelector((state) => getCurrentPlayer(state));\n\n    return (\n        <ul className=\"player-list\">\n            {players.map((player) => (\n                <PlayerListItem\n                    key={player.id}\n                    player={player}\n                    isActive={player === currentPlayer}\n                />\n            ))}\n        </ul>\n    );\n};\n\nexport default PlayerList;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { startTurn } from 'store/game/async-actions';\n\nconst StartGameModal = () => {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(startTurn())}\n        >\n            <div className=\"game-screen-modal-content\">\n                Everybody ready?\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Start game!\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default StartGameModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport { startWaitingForPlayerInput } from 'store/game/async-actions';\n\nconst StartTurnModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(startWaitingForPlayerInput())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>,\n                    it is your turn\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Start my turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default StartTurnModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport pluralize from 'pluralize';\nimport { nextTurn } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyCollisionModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal\" onClick={() => dispatch(nextTurn())}>\n            <div className=\"game-screen-modal-content\">\n                <div>You crashed!</div>\n                <div className=\"secondary-text mt-s\">\n                    (grounded for {currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)})\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Next turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyCollisionModal;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass ShowContentAfter extends React.Component {\n    /** @type {number} */\n    timeout;\n\n    state = {\n        showContent: false,\n    };\n\n    componentDidMount() {\n        this.timeout = window.setTimeout(\n            () => this.setState({ showContent: true }),\n            this.props.showAfter,\n        );\n    }\n\n    componentWillUnmount() {\n        if (this.timeout) {\n            window.clearTimeout(this.timeout);\n            this.timeout = null;\n        }\n    }\n\n    render() {\n        return <>{this.props.render(this.state.showContent)}</>;\n    }\n}\n\nShowContentAfter.propTypes = {\n    showAfter: PropTypes.number,\n    render: PropTypes.func,\n};\n\nShowContentAfter.defaultProps = {\n    showAfter: 100, // ms\n    render: () => {},\n};\n\nexport default ShowContentAfter;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport ShowContentAfter from 'components/ShowContentAfter';\n\nconst NotifyAICollisionModal = () => {\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <ShowContentAfter\n            render={(showContent) => (\n                <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n                    <div\n                        className={classNames('game-screen-modal-content', {\n                            'is-hidden': !showContent,\n                        })}\n                    >\n                        <div>\n                            <span className=\"player-name\">\n                                {currentPlayer.name}\n                            </span>{' '}\n                            has crashed :(\n                        </div>\n                    </div>\n                </div>\n            )}\n        />\n    );\n};\n\nexport default NotifyAICollisionModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { reduceGroundedAndNextTurn } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport pluralize from 'pluralize';\n\nconst NotifyGroundedModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(reduceGroundedAndNextTurn())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>,\n                    you are grounded because you crashed!\n                </div>\n                <div className=\"secondary-text mt-s\">\n                    ({currentPlayer.turnsGrounded}{' '}\n                    {pluralize('turn', currentPlayer.turnsGrounded)} left)\n                </div>\n\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Next turn\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyGroundedModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport pluralize from 'pluralize';\nimport ShowContentAfter from 'components/ShowContentAfter';\n\nconst NotifyAIGroundedModal = () => {\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <ShowContentAfter\n            render={(showContent) => (\n                <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n                    <div\n                        className={classNames('game-screen-modal-content', {\n                            'is-hidden': !showContent,\n                        })}\n                    >\n                        <div>\n                            <span className=\"player-name\">\n                                {currentPlayer.name}\n                            </span>{' '}\n                            is grounded after a crash.\n                        </div>\n                        <div className=\"secondary-text\">\n                            ({currentPlayer.turnsGrounded}{' '}\n                            {pluralize('turn', currentPlayer.turnsGrounded)}{' '}\n                            left)\n                        </div>\n                    </div>\n                </div>\n            )}\n        />\n    );\n};\n\nexport default NotifyAIGroundedModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { finishGame } from 'store/game/async-actions';\nimport { getCurrentPlayer } from 'store/game/selectors';\n\nconst NotifyVictoryModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div\n            className=\"game-screen-modal\"\n            onClick={() => dispatch(finishGame())}\n        >\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    won!\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Yay!\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyVictoryModal;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport { unpause, finishGame } from 'store/game/async-actions';\n\nconst InGameMenuModal = () => {\n    const dispatch = useDispatch();\n\n    return (\n        // eslint-disable-next-line jsx-a11y/click-events-have-key-events\n        <div className=\"game-screen-modal\" onClick={() => dispatch(unpause())}>\n            <div className=\"game-screen-modal-content\">\n                <div>Paused</div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                >\n                    Continue!\n                </button>\n\n                <button\n                    className=\"button game-screen-modal-button game-screen-modal-button-secondary \"\n                    type=\"button\"\n                    onClick={(event) => {\n                        event.stopPropagation();\n                        dispatch(finishGame());\n                    }}\n                >\n                    Exit game\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default InGameMenuModal;\n","/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { Score, Circuit } from 'components/propTypes';\nimport { useDispatch } from 'react-redux';\nimport { showReplay } from 'store/game/async-actions';\nimport './style.css';\n\nfunction ScoreBoard({ scores, highlightedScore, canReplay, circuit }) {\n    const dispatch = useDispatch();\n\n    const onScoreClicked = (score) => {\n        if (!canReplay) {\n            return;\n        }\n        dispatch(showReplay(score, circuit));\n    };\n    return (\n        <div className=\"score-board\">\n            {!!scores.length &&\n                scores.map((score, index) => (\n                    // eslint-disable-next-line jsx-a11y/no-static-element-interactions\n                    <div\n                        onClick={() => onScoreClicked(score)}\n                        className={classNames('score-board-item', {\n                            'is-highlighted':\n                                highlightedScore &&\n                                highlightedScore.id === score.id,\n                            'is-clickable': canReplay,\n                        })}\n                        key={`score-board-item-${score.id}`}\n                    >\n                        <div className=\"score-board-item-index\">\n                            {index + 1}\n                        </div>\n                        <div className=\"score-board-item-name\">\n                            {score.name}\n                        </div>\n                        <div className=\"score-board-item-turns\">\n                            <span className=\"score-board-item-value\">\n                                {score.turns}\n                            </span>\n                            <span className=\"score-board-item-text\">\n                                {' '}\n                                turns\n                            </span>\n                        </div>\n                        <div className=\"score-board-item-turns\">\n                            <span className=\"score-board-item-value\">\n                                {score.date?.toLocaleDateString()}\n                            </span>\n                        </div>\n\n                        <div className=\"score-board-item-time\">\n                            (\n                            <span className=\"score-board-item-value\">\n                                {(score.realTimeUsed / 1000).toFixed(2)}{' '}\n                            </span>\n                            <span className=\"score-board-item-text\">\n                                seconds\n                            </span>\n                            )\n                        </div>\n                    </div>\n                ))}\n\n            {!scores.length && (\n                <div className=\"score-board-empty\">No high scores yet!</div>\n            )}\n        </div>\n    );\n}\n\nScoreBoard.propTypes = {\n    scores: PropTypes.arrayOf(Score).isRequired,\n    highlightedScore: Score,\n    canReplay: PropTypes.bool,\n    circuit: Circuit.isRequired,\n};\n\nScoreBoard.defaultProps = {\n    highlightedScore: null,\n    canReplay: false,\n};\n\nexport default ScoreBoard;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { finishGame } from 'store/game/async-actions';\nimport {\n    getCurrentPlayer,\n    getLatestHighScore,\n    getCircuitInfo,\n} from 'store/game/selectors';\nimport ScoreBoard from 'components/ScoreBoard';\nimport { getByCircuitId } from 'utils/highScoresStorage';\n\nconst NotifyHighScoreModal = () => {\n    const dispatch = useDispatch();\n    const currentPlayer = useSelector(getCurrentPlayer);\n    const highScore = useSelector(getLatestHighScore);\n    const circuit = useSelector(getCircuitInfo);\n    const highScoresForCircuit = getByCircuitId(circuit.id);\n\n    return (\n        <div className=\"game-screen-modal\">\n            <div className=\"game-screen-modal-content\">\n                <div>\n                    <span className=\"player-name\">{currentPlayer.name}</span>{' '}\n                    won, and set a high score for this circuit!\n                </div>\n                <div className=\"notify-high-scores-circuit\">\n                    <ScoreBoard\n                        circuit={circuit}\n                        scores={highScoresForCircuit}\n                        highlightedScore={highScore}\n                    />\n                </div>\n                <button\n                    className=\"button game-screen-modal-button\"\n                    type=\"button\"\n                    onClick={() => dispatch(finishGame())}\n                >\n                    Back to main menu\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default NotifyHighScoreModal;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { getCurrentPlayer } from 'store/game/selectors';\nimport ShowContentAfter from 'components/ShowContentAfter';\n\nconst AIThinkingModal = () => {\n    const currentPlayer = useSelector(getCurrentPlayer);\n\n    return (\n        <ShowContentAfter\n            showAfter={1000}\n            render={(showContent) => (\n                <div className=\"game-screen-modal game-screen-modal-non-invasive\">\n                    <div\n                        className={classNames('game-screen-modal-content', {\n                            'is-hidden': !showContent,\n                        })}\n                    >\n                        <div>\n                            <span className=\"player-name\">\n                                {currentPlayer.name}\n                            </span>{' '}\n                            is choosing its next move...\n                        </div>\n                    </div>\n                </div>\n            )}\n        />\n    );\n};\n\nexport default AIThinkingModal;\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport * as gameStates from 'constants/game-states';\nimport { getGameState } from 'store/game/selectors';\nimport StartGameModal from './StartGameModal';\nimport StartTurnModal from './StartTurnModal';\nimport NotifyCollisionModal from './NotifyCollisionModal';\nimport NotifyAICollisionModal from './NotifyAICollisionModal';\nimport NotifyGroundedModal from './NotifyGroundedModal';\nimport NotifyAIGroundedModal from './NotifyAIGroundedModal';\nimport NotifyVictoryModal from './NotifyVictoryModal';\nimport InGameMenuModal from './InGameMenuModal';\nimport NotifyHighScoreModal from './NotifyHighScoreModal';\nimport AIThinkingModal from './AIThinkingModal';\nimport './style.css';\n\nconst GameScreenModals = () => {\n    const gameState = useSelector(getGameState);\n\n    switch (gameState) {\n        case gameStates.START_SCREEN:\n            return <StartGameModal />;\n        case gameStates.PLAYER_TURN_START_SCREEN:\n            return <StartTurnModal />;\n        case gameStates.NOTIFY_COLLISION:\n            return <NotifyCollisionModal />;\n        case gameStates.NOTIFY_AI_COLLISION:\n            return <NotifyAICollisionModal />;\n        case gameStates.NOTIFY_GROUNDED:\n            return <NotifyGroundedModal />;\n        case gameStates.NOTIFY_AI_GROUNDED:\n            return <NotifyAIGroundedModal />;\n        case gameStates.NOTIFY_VICTORY:\n            return <NotifyVictoryModal />;\n        case gameStates.NOTIFY_HIGH_SCORE:\n            return <NotifyHighScoreModal />;\n        case gameStates.SHOW_MENU:\n            return <InGameMenuModal />;\n        case gameStates.AI_THINKING_SCREEN:\n            return <AIThinkingModal />;\n        default:\n            return <></>;\n    }\n};\n\nGameScreenModals.propTypes = {};\n\nGameScreenModals.defaultProps = {};\n\nexport default GameScreenModals;\n","import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\nfunction KeyPressListener({ keys }) {\n    useEffect(() => {\n        const onKeyPress = (event) => {\n            if (keys[event.code]) {\n                keys[event.code]();\n            }\n        };\n        window.document.addEventListener('keyup', onKeyPress);\n\n        return () => {\n            window.document.removeEventListener('keyup', onKeyPress);\n        };\n    }, [keys]);\n    return <></>;\n}\n\nKeyPressListener.propTypes = {\n    keys: PropTypes.objectOf(PropTypes.func).isRequired,\n};\n\nexport default KeyPressListener;\n","import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\n// Set the name of the hidden property and the change event for visibility\nlet hidden;\nlet visibilityChange;\nif (typeof document.hidden !== 'undefined') {\n    // Opera 12.10 and Firefox 18 and later support\n    hidden = 'hidden';\n    visibilityChange = 'visibilitychange';\n    // @ts-ignore\n} else if (typeof document.msHidden !== 'undefined') {\n    hidden = 'msHidden';\n    visibilityChange = 'msvisibilitychange';\n    // @ts-ignore\n} else if (typeof document.webkitHidden !== 'undefined') {\n    hidden = 'webkitHidden';\n    visibilityChange = 'webkitvisibilitychange';\n}\n\nfunction WindowBlurListener({ onBlur }) {\n    useEffect(() => {\n        // Warn if the browser doesn't support addEventListener or the Page Visibility API\n        if (\n            typeof document.addEventListener === 'undefined' ||\n            hidden === undefined\n        ) {\n            return () => {}; // not supported\n        }\n\n        const handleVisibilityChange = () => {\n            if (document[hidden]) {\n                onBlur();\n            }\n        };\n        document.addEventListener(\n            visibilityChange,\n            handleVisibilityChange,\n            false,\n        );\n        return () => {\n            document.removeEventListener(\n                visibilityChange,\n                handleVisibilityChange,\n                false,\n            );\n        };\n    }, [onBlur]);\n    return <></>;\n}\n\nWindowBlurListener.propTypes = {\n    onBlur: PropTypes.func.isRequired,\n};\n\nexport default WindowBlurListener;\n","import React from 'react';\nimport { useDispatch } from 'react-redux';\nimport GameBoard from 'components/GameBoard';\nimport PlayerList from 'components/PlayerList';\nimport GameScreenModals from 'components/GameScreenModals';\nimport KeyPressListener from 'components/KeyPressListener';\nimport WindowBlurListener from 'components/WindowBlurListener';\nimport {\n    tryToToggleInGameMenu,\n    tryToShowInGameMenu,\n} from 'store/game/async-actions';\n\nimport './style.css';\n\nconst Game = () => {\n    const dispatch = useDispatch();\n    return (\n        <div className=\"transition-opacity\">\n            <KeyPressListener\n                keys={{\n                    Escape: () => dispatch(tryToToggleInGameMenu()),\n                    Space: () => dispatch(tryToToggleInGameMenu()),\n                }}\n            />\n            <WindowBlurListener\n                onBlur={() => dispatch(tryToShowInGameMenu())}\n            />\n            <GameBoard />\n            <PlayerList />\n            <GameScreenModals />\n        </div>\n    );\n};\n\nexport default Game;\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport './style.css';\n\nfunction CircuitSelector({ circuit, onClick }) {\n    return (\n        <div className=\"circuit-selector\" onClick={onClick}>\n            <img\n                className=\"circuit-selector-img\"\n                src={circuit.bgImg}\n                alt={circuit.name}\n            />\n            <div className=\"circuit-selector-footer\">\n                <div className=\"circuit-selector-name\">{circuit.name}</div>\n                <div className=\"circuit-selector-players\">\n                    {circuit.maxPlayers} players\n                </div>\n            </div>\n        </div>\n    );\n}\n\nCircuitSelector.propTypes = {\n    circuit: PropTypes.shape({\n        name: PropTypes.string,\n        bgImg: PropTypes.string,\n        maxPlayers: PropTypes.number,\n    }).isRequired,\n    onClick: PropTypes.func.isRequired,\n};\n\nexport default CircuitSelector;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen, setSelectedCircuit } from 'store/main-ui/actions';\nimport { MAIN_MENU, PLAYERS_SELECTION } from 'constants/screens';\nimport { circuits } from 'constants/circuits';\nimport CircuitSelector from 'components/CircuitSelector';\nimport Logo from 'components/Logo';\nimport './style.css';\n\nconst circuitsArray = Object.values(circuits);\n\nfunction CircuitSelection({ className }) {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer circuit-selection',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-top\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Select circuit</h1>\n            </div>\n            <div className=\"menu-content circuit-selection-content transition-from-bottom\">\n                <div className=\"circuit-selection-list\">\n                    {circuitsArray.map((circuit) => (\n                        <CircuitSelector\n                            key={circuit.id}\n                            onClick={() => {\n                                dispatch(setSelectedCircuit(circuit.id));\n                                dispatch(changeScreen(PLAYERS_SELECTION));\n                            }}\n                            circuit={circuit}\n                        />\n                    ))}\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-bottom\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default CircuitSelection;\n","import { v4 as uuid } from 'uuid';\nimport { getRandomName } from 'utils/getRandomName';\nimport { pickRandomFromArray, keepPickingUntilNotInArray } from 'utils/random';\nimport { STYLES } from 'constants/player-styles';\nimport { HUMAN } from 'constants/player-types';\nimport { getPlayersOrderedBy } from 'utils/players-order';\nimport { setSelectedPlayers, updatePlayer } from './actions';\n\nexport const addRandomPlayer = () => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const playerOrder = state.mainUI.selectedPlayerOrder;\n        const players = state.mainUI.selectedPlayers;\n        const allStyles = Object.values(STYLES);\n        const currentNames = players.map((player) => player.name);\n        const currentStyles = players.map((player) => player.style);\n        const newStyle = keepPickingUntilNotInArray(\n            () => pickRandomFromArray(allStyles),\n            currentStyles,\n        );\n        const newName = keepPickingUntilNotInArray(getRandomName, currentNames);\n\n        const newPlayer = {\n            id: uuid(),\n            name: newName,\n            style: newStyle,\n            type: HUMAN,\n            levelAI: 0,\n        };\n\n        dispatch(\n            setSelectedPlayers(\n                players.concat(newPlayer),\n                playerOrder.concat(newPlayer.id),\n            ),\n        );\n    };\n};\n\nexport const selectNewStyleForPlayer = (player) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const players = state.mainUI.selectedPlayers;\n        const allStyles = Object.values(STYLES);\n        const otherPlayers = players.filter(\n            (otherPlayer) => otherPlayer.id !== player.id,\n        );\n\n        const stylesToUse = allStyles.reduce((acc, style) => {\n            if (isStyleUsedByPlayers(style, otherPlayers)) {\n                return acc;\n            }\n            return acc.concat([style]);\n        }, []);\n\n        const currentIndex = stylesToUse.findIndex(\n            (style) => style.id === player.style.id,\n        );\n\n        const nextStyleIndex = (currentIndex + 1) % stylesToUse.length;\n\n        dispatch(\n            updatePlayer(player.id, {\n                style: stylesToUse[nextStyleIndex],\n            }),\n        );\n    };\n};\n\nfunction isStyleUsedByPlayers(style, players) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const player of players) {\n        if (player.style.id === style.id) {\n            return true;\n        }\n    }\n    return false;\n}\n\nexport const limitPlayersTo = (numberOfPlayers) => {\n    return (dispatch, getState) => {\n        const state = getState();\n        const players = state.mainUI.selectedPlayers;\n        const order = state.mainUI.selectedPlayerOrder;\n        const orderedPlayers = getPlayersOrderedBy(players, order);\n        dispatch(\n            setSelectedPlayers(\n                orderedPlayers.slice(0, numberOfPlayers),\n                order.slice(0, numberOfPlayers),\n            ),\n        );\n    };\n};\n","import React from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { selectablePlayer } from 'components/propTypes';\nimport PlayerIcon from 'components/PlayerIcon';\nimport { HUMAN, AI } from 'constants/player-types';\nimport './style.css';\n\nfunction PlayerSelector({\n    player,\n    onRemove,\n    canBeRemoved,\n    onNameChange,\n    onTypeChange,\n    onLevelAIChange,\n    onSelectNewStyle,\n}) {\n    return (\n        <div className=\"player-selector\">\n            <div className=\"player-selector-top\">\n                <input\n                    className=\"player-selector-input\"\n                    type=\"text\"\n                    value={player.name}\n                    onChange={(event) => onNameChange(event.target.value)}\n                />\n                <button\n                    type=\"button\"\n                    className=\"player-selector-style-container\"\n                    onClick={onSelectNewStyle}\n                >\n                    <PlayerIcon playerStyle={player.style} />\n                </button>\n                <button\n                    type=\"button\"\n                    className=\"button button-small\"\n                    onClick={onRemove}\n                    disabled={!canBeRemoved}\n                    style={{\n                        opacity: canBeRemoved ? 1 : 0,\n                    }}\n                >\n                    Delete\n                </button>\n            </div>\n            <div className=\"player-selector-bottom\">\n                <button\n                    type=\"button\"\n                    className={classNames('player-selector-toggle', {\n                        'is-selected': player.type === HUMAN,\n                    })}\n                    onClick={() => onTypeChange(HUMAN)}\n                >\n                    Human\n                </button>\n                <button\n                    type=\"button\"\n                    className={classNames('player-selector-toggle', {\n                        'is-selected': player.type === AI,\n                    })}\n                    onClick={() => onTypeChange(AI)}\n                >\n                    AI\n                </button>\n\n                {player.type === AI && (\n                    <div className=\"player-selector-ai-level\">\n                        <input\n                            value={player.levelAI}\n                            type=\"range\"\n                            min=\"1\"\n                            max=\"3\"\n                            step=\"1\"\n                            onChange={(event) =>\n                                onLevelAIChange(\n                                    parseInt(event.target.value, 10),\n                                )\n                            }\n                        />\n                        <div className=\"player-selector-ai-level-text\">\n                            {getRobotNameByLevel(player.levelAI)}\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nfunction getRobotNameByLevel(level) {\n    switch (level) {\n        case 0:\n            return 'Super Easy';\n        case 1:\n            return 'Very Easy';\n        case 2:\n            return 'Easy';\n        case 3:\n            return 'Normal';\n        default:\n            return 'Normal';\n    }\n}\n\nPlayerSelector.propTypes = {\n    player: selectablePlayer.isRequired,\n    onRemove: PropTypes.func.isRequired,\n    onNameChange: PropTypes.func.isRequired,\n    onTypeChange: PropTypes.func.isRequired,\n    onSelectNewStyle: PropTypes.func.isRequired,\n    canBeRemoved: PropTypes.bool.isRequired,\n};\n\nexport default PlayerSelector;\n","/* eslint-disable jsx-a11y/label-has-for */\n/* eslint-disable jsx-a11y/label-has-associated-control */\nimport React, { useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n    changeScreen,\n    removePlayer,\n    updatePlayer,\n    toggleRandomizePlayerOrderOnStart,\n    togglePlayWithTimer,\n} from 'store/main-ui/actions';\nimport {\n    addRandomPlayer,\n    selectNewStyleForPlayer,\n    limitPlayersTo,\n} from 'store/main-ui/async-actions';\nimport { initGameWithSavedConfig } from 'store/game/async-actions';\nimport { circuits } from 'constants/circuits';\nimport { CIRCUIT_SELECTION } from 'constants/screens';\nimport { getOrderedPlayers } from 'store/game/selectors';\nimport PlayerSelector from 'components/PlayerSelector';\nimport Logo from 'components/Logo';\nimport {\n    getSelectedCircuit,\n    shouldRandomizePlayerOrderOnStart,\n    shouldPlayWithTimer,\n} from 'store/main-ui/selectors';\nimport './style.css';\n\nfunction PlayersSelection({ className }) {\n    const dispatch = useDispatch();\n    const players = useSelector(getOrderedPlayers);\n    const circuitId = useSelector(getSelectedCircuit);\n    const circuit = circuits[circuitId];\n\n    useEffect(() => {\n        if (players.length && players.length > circuit.maxPlayers) {\n            dispatch(limitPlayersTo(circuit.maxPlayers));\n        }\n    }, [players, circuit, dispatch]);\n\n    const randomizePlayerOrderOnStart = useSelector(\n        shouldRandomizePlayerOrderOnStart,\n    );\n\n    const playWithTimer = useSelector(shouldPlayWithTimer);\n\n    const canBeRemoved = players.length > 1;\n\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Choose players</h1>\n            </div>\n            <div className=\"menu-content player-selection-content transition-from-right\">\n                <div className=\"player-selection-content-inner\">\n                    {players.map((player) => (\n                        <PlayerSelector\n                            key={player.id}\n                            player={player}\n                            onRemove={() => {\n                                if (!canBeRemoved) {\n                                    return;\n                                }\n                                dispatch(removePlayer(player.id));\n                            }}\n                            canBeRemoved={canBeRemoved}\n                            onNameChange={(newName) =>\n                                dispatch(\n                                    updatePlayer(player.id, { name: newName }),\n                                )\n                            }\n                            onTypeChange={(newType) =>\n                                dispatch(\n                                    updatePlayer(player.id, { type: newType }),\n                                )\n                            }\n                            onSelectNewStyle={() =>\n                                dispatch(selectNewStyleForPlayer(player))\n                            }\n                            onLevelAIChange={(newLevelAI) =>\n                                dispatch(\n                                    updatePlayer(player.id, {\n                                        levelAI: newLevelAI,\n                                    }),\n                                )\n                            }\n                        />\n                    ))}\n                    {players.length < circuit.maxPlayers && (\n                        <button\n                            type=\"button\"\n                            className=\"button player-selection-add-player-button\"\n                            onClick={() => dispatch(addRandomPlayer())}\n                        >\n                            Add Player\n                        </button>\n                    )}\n\n                    {players.length > 1 && (\n                        <div className=\"transition-from-right\">\n                            <label className=\"player-selection-checkbox\">\n                                <input\n                                    type=\"checkbox\"\n                                    checked={randomizePlayerOrderOnStart}\n                                    onChange={() =>\n                                        dispatch(\n                                            toggleRandomizePlayerOrderOnStart(),\n                                        )\n                                    }\n                                />\n                                Randomize player order when race starts\n                            </label>\n                        </div>\n                    )}\n                    <div className=\"transition-from-right\">\n                        <label className=\"player-selection-checkbox player-selection-checkbox-last\">\n                            <input\n                                type=\"checkbox\"\n                                checked={playWithTimer}\n                                onChange={() => dispatch(togglePlayWithTimer())}\n                            />\n                            Play with timer\n                        </label>\n                    </div>\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(CIRCUIT_SELECTION));\n                    }}\n                >\n                    Back\n                </button>\n                <div className=\"menu-footer-filler\" />\n                <button\n                    className=\"button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(initGameWithSavedConfig());\n                    }}\n                >\n                    Start game!\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default PlayersSelection;\n","export const getPlayersOrderedBy = (players, order) => {\n    return order.map((playerId) => {\n        return players.find((player) => player.id === playerId);\n    });\n};\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\n/* eslint-disable jsx-a11y/click-events-have-key-events */\nimport React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport { circuits } from 'constants/circuits';\nimport Logo from 'components/Logo';\nimport ScoreBoard from 'components/ScoreBoard';\nimport { getByCircuitId } from 'utils/highScoresStorage';\nimport './style.css';\n\nconst circuitsArray = Object.values(circuits);\n\nfunction HighScores() {\n    const [scoresForCurrentCircuit, setScoresForCurrentCircuit] = useState([]);\n    const [activeCircuit, setActiveCircuit] = useState(circuitsArray[0]);\n    useEffect(() => {\n        if (activeCircuit.id) {\n            setScoresForCurrentCircuit(getByCircuitId(activeCircuit.id));\n        }\n    }, [activeCircuit]);\n\n    const dispatch = useDispatch();\n\n    return (\n        <div className=\"full-screen full-screen-with-header-and-footer high-scores\">\n            <div className=\"menu-header transition-from-top\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">High scores</h1>\n            </div>\n            <div className=\"menu-content transition-from-bottom\">\n                <div className=\"high-scores-circuit-tabs-container\">\n                    <div className=\"high-scores-circuit-tabs\">\n                        {circuitsArray.map((circuit) => (\n                            <div\n                                key={circuit.id}\n                                className={classNames(\n                                    'high-scores-circuit-tab',\n                                    {\n                                        'is-active':\n                                            circuit.id === activeCircuit.id,\n                                    },\n                                )}\n                            >\n                                <div onClick={() => setActiveCircuit(circuit)}>\n                                    {circuit.name}\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                </div>\n\n                <div className=\"high-scores-circuit\">\n                    <ScoreBoard\n                        circuit={activeCircuit}\n                        scores={scoresForCurrentCircuit}\n                        canReplay\n                    />\n                </div>\n            </div>\n\n            <footer className=\"menu-footer transition-from-bottom\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n}\n\nexport default HighScores;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport Logo from 'components/Logo';\n\nimport './style.css';\n\nconst Credits = ({ className }) => {\n    const dispatch = useDispatch();\n    return (\n        <div\n            className={classNames(\n                'full-screen',\n                'full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">Credits</h1>\n            </div>\n            <div className=\"menu-content transition-from-right credits-content\">\n                <div className=\"credits-content-item\">\n                    <p>Created by Paco Gmez Granados</p>\n                    <p>\n                        <a\n                            href=\"https://pacog.github.io/portfolio/\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            https://pacog.github.io/portfolio/\n                        </a>\n                    </p>\n                    <p>\n                        <a\n                            href=\"https://twitter.com/PacoGomezGrana\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            @PacoGomezGrana\n                        </a>\n                    </p>\n                </div>\n\n                <div className=\"credits-content-item\">\n                    <p>Based on an original idea by</p>\n                    <p>\n                        <a\n                            href=\"https://twitter.com/esqizo\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            @esqizo\n                        </a>{' '}\n                        and cousins\n                    </p>\n                </div>\n\n                <div className=\"credits-content-item\">\n                    <p>Circuit graphics inspired by</p>\n                    <p>\n                        <a\n                            href=\"https://codepen.io/ste-vg\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Steve Gardner\n                        </a>\n                        s{' '}\n                        <a\n                            href=\"https://codepen.io/ste-vg/full/BaaQamG\"\n                            target=\"_BLANK\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Race Car Island\n                        </a>\n                    </p>\n                </div>\n            </div>\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n            </footer>\n        </div>\n    );\n};\n\nexport default Credits;\n","import React from 'react';\nimport classNames from 'classnames';\n// import Logo from 'components/Logo';\n\nimport './style.css';\n\nconst LoadingGame = ({ className }) => {\n    return (\n        <div className={classNames('full-screen', className)}>\n            <div className=\"loading-game\">\n                <div className=\"lds-ellipsis\">\n                    <div />\n                    <div />\n                    <div />\n                    <div />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default LoadingGame;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { useSelector } from 'react-redux';\nimport { raceHistory as raceHistoryProp } from 'components/propTypes';\nimport { projectToScreenPosition } from 'store/map/selectors';\nimport { PathLine } from 'react-svg-pathline';\nimport { CAR } from 'constants/player-styles';\nimport { getPlayerStyleCSS } from 'utils/playerPainter';\n\nimport './style.css';\n\nconst defaultStyle = CAR;\n\nconst ReplayPlayerTrail = ({ raceHistory, isActive }) => {\n    const storeState = useSelector((state) => state);\n\n    if (!raceHistory.path.length) {\n        return <></>;\n    }\n    const points = raceHistory.path.map((position) =>\n        projectToScreenPosition(storeState, position),\n    );\n\n    return (\n        <div\n            className={classNames('player-trail-container', {\n                'is-active': isActive,\n            })}\n            style={getPlayerStyleCSS(raceHistory)}\n        >\n            <svg className=\"player-trail\">\n                <PathLine\n                    points={points}\n                    stroke={defaultStyle.trailColor}\n                    strokeWidth={defaultStyle.trailWidth}\n                    fill=\"none\"\n                    r={2}\n                />\n            </svg>\n            {points\n                .map((point, index) => {\n                    return { ...point, turn: index + 1 };\n                })\n                .map((point) => (\n                    <div\n                        key={`${point.x}_${point.y}_${point.turn}`}\n                        className=\"player-trail-point\"\n                        style={{\n                            left: point.x,\n                            top: point.y,\n                        }}\n                    />\n                ))}\n        </div>\n    );\n};\n\nReplayPlayerTrail.propTypes = {\n    raceHistory: raceHistoryProp.isRequired,\n    isActive: PropTypes.bool.isRequired,\n};\n\nexport default ReplayPlayerTrail;\n","import React from 'react';\nimport Grid from 'components/Grid';\nimport { useSelector } from 'react-redux';\nimport { getRaceHistory, getCircuitInfo } from 'store/game/selectors';\nimport ReplayPlayerTrail from 'components/ReplayPlayerTrail';\nimport Player from 'components/Player';\nimport { player as playerProp } from 'components/propTypes';\n\nconst ReplayGameBoardContents = ({ playerInPosition }) => {\n    const raceHistory = useSelector((state) => getRaceHistory(state));\n    const mapZoom = useSelector((state) => state.map.zoom);\n    const gridSize = useSelector((state) => state.map.gridSize);\n    const circuitInfo = useSelector(getCircuitInfo);\n\n    return (\n        <>\n            <div\n                className=\"replay-game-board-circuit-bg\"\n                style={{\n                    backgroundImage: `url(${circuitInfo.bgImg})`,\n                    backgroundSize: `${circuitInfo.width}px ${circuitInfo.height}px`,\n                }}\n            />\n            <Grid zoom={mapZoom} cellSize={gridSize} />\n            <Player player={playerInPosition} isActive />\n            <ReplayPlayerTrail raceHistory={raceHistory} isActive />\n        </>\n    );\n};\n\nReplayGameBoardContents.propTypes = {\n    playerInPosition: playerProp.isRequired,\n};\n\nReplayGameBoardContents.defaultProps = {};\n\nexport default ReplayGameBoardContents;\n","import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getRaceHistory } from 'store/game/selectors';\nimport GameBoardCameraHandler from 'components/GameBoard/GameBoardCameraHandler';\nimport { changeScreen } from 'store/main-ui/actions';\nimport { MAIN_MENU } from 'constants/screens';\nimport ReplayGameBoardContents from './ReplayGameBoardContents';\nimport './style.css';\n\nconst ReplayGameBoard = () => {\n    const raceHistory = useSelector((state) => getRaceHistory(state));\n    const [playerInPosition, setPlayerInPosition] = useState(null);\n    const [currentTurn, setCurrentTurn] = useState(0);\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        if (!raceHistory) {\n            return;\n        }\n        setPlayerInPosition({\n            id: raceHistory.id,\n            name: raceHistory.name,\n            style: raceHistory.playerStyle,\n            position: raceHistory.path[currentTurn],\n            speed: { x: 0, y: 0 },\n            prevPositions: [],\n        });\n    }, [raceHistory, currentTurn]);\n\n    return (\n        <div className=\"game-board-container\">\n            {playerInPosition && (\n                <GameBoardCameraHandler currentPlayer={playerInPosition}>\n                    <ReplayGameBoardContents\n                        playerInPosition={playerInPosition}\n                    />\n                </GameBoardCameraHandler>\n            )}\n            <div className=\"game-board-back-button-container\">\n                <button\n                    type=\"button\"\n                    className=\"button button-small\"\n                    onClick={() => dispatch(changeScreen(MAIN_MENU))}\n                >\n                    Back\n                </button>\n            </div>\n            {raceHistory && raceHistory.path.length && (\n                <div className=\"replay-game-board-turn-selector\">\n                    <span className=\"replay-game-board-turn-selector-label\">\n                        Turn:{' '}\n                    </span>\n                    <input\n                        type=\"range\"\n                        value={currentTurn}\n                        max={raceHistory.path.length - 1}\n                        onChange={(e) =>\n                            setCurrentTurn(parseFloat(e.target.value))\n                        }\n                    />\n                    <span className=\"replay-game-board-turn-selector-value\">\n                        {currentTurn + 1}\n                    </span>\n                </div>\n            )}\n        </div>\n    );\n};\n\nReplayGameBoard.propTypes = {};\n\nReplayGameBoard.defaultProps = {};\n\nexport default ReplayGameBoard;\n","import React from 'react';\nimport ReplayGameBoard from 'components/ReplayGameBoard';\nimport './style.css';\n\nconst ReplayGame = () => {\n    return (\n        <div className=\"transition-opacity\">\n            <ReplayGameBoard />\n        </div>\n    );\n};\n\nexport default ReplayGame;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen0({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-0\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>This is your car.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen0.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen0;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen1({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-1\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>You can move it by clicking in of the 9 buttons.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen1.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen1;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen2({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-2\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>\n                        Your next move will depend on your previous move, so be\n                        careful!\n                    </p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Next\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen2.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen2;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction TutorialScreen3({ onNext }) {\n    return (\n        <div className=\"tutorial-screen\">\n            <div\n                className=\"tutorial-screen-image  tutorial-screen-image-3\n            \"\n            />\n            <div className=\"tutorial-screen-text\">\n                <div className=\"tutorial-screen-text-filler\">\n                    <p>If you go too fast, you may crash and be penalised.</p>\n                </div>\n                <button\n                    className=\"button tutorial-screen-button\"\n                    type=\"button\"\n                    onClick={onNext}\n                >\n                    Done!\n                </button>\n            </div>\n        </div>\n    );\n}\n\nTutorialScreen3.propTypes = {\n    onNext: PropTypes.func.isRequired,\n};\n\nexport default TutorialScreen3;\n","import React, { useState } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { MAIN_MENU } from 'constants/screens';\nimport Logo from 'components/Logo';\nimport { changeScreen } from 'store/main-ui/actions';\nimport TutorialScreen0 from './TutorialScreen0';\nimport TutorialScreen1 from './TutorialScreen1';\nimport TutorialScreen2 from './TutorialScreen2';\nimport TutorialScreen3 from './TutorialScreen3';\nimport './style.css';\n\nfunction Tutorial({ className }) {\n    const dispatch = useDispatch();\n    const [currentScreen, setCurrentScreen] = useState(0);\n    const goToNextScreen = () => {\n        setCurrentScreen(currentScreen + 1);\n    };\n\n    return (\n        <div\n            className={classNames(\n                'full-screen full-screen-with-header-and-footer',\n                className,\n            )}\n        >\n            <div className=\"menu-header transition-from-right\">\n                <Logo variant=\"small\" />\n                <h1 className=\"menu-header-title\">How to play</h1>\n            </div>\n            <div className=\"menu-content transition-from-right tutorial-screen-container\">\n                {currentScreen === 0 && (\n                    <TutorialScreen0 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 1 && (\n                    <TutorialScreen1 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 2 && (\n                    <TutorialScreen2 onNext={goToNextScreen} />\n                )}\n                {currentScreen === 3 && (\n                    <TutorialScreen3\n                        onNext={() => {\n                            dispatch(changeScreen(MAIN_MENU));\n                        }}\n                    />\n                )}\n            </div>\n\n            <footer className=\"menu-footer transition-from-right\">\n                <button\n                    className=\"button menu-footer-back-button\"\n                    type=\"button\"\n                    onClick={() => {\n                        dispatch(changeScreen(MAIN_MENU));\n                    }}\n                >\n                    Back\n                </button>\n                <div className=\"menu-footer-filler\" />\n            </footer>\n        </div>\n    );\n}\n\nexport default Tutorial;\n","import React, { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { TransitionGroup, CSSTransition } from 'react-transition-group';\nimport * as screens from 'constants/screens';\nimport MainMenu from 'screens/MainMenu';\nimport Game from 'screens/Game';\nimport CircuitSelection from 'screens/CircuitSelection';\nimport PlayersSelection from 'screens/PlayersSelection';\nimport HighScores from 'screens/HighScores';\nimport Credits from 'screens/Credits';\nimport LoadingGame from 'screens/LoadingGame';\nimport ReplayGame from 'screens/ReplayGame';\nimport Tutorial from 'screens/Tutorial';\nimport { getCurrentScreen } from 'store/main-ui/selectors';\n\nconst TIME_TO_SHOW_FIRST_SCREEN = 500; // ms\nconst STATE_CHANGE_TRANSITION_TIME = 300; // ms\n\nfunction Router() {\n    const [gameReady, setGameReady] = useState(false);\n    const currentScreenName = useSelector(getCurrentScreen);\n    useEffect(() => {\n        const timeout = setTimeout(() => {\n            setGameReady(true);\n        }, TIME_TO_SHOW_FIRST_SCREEN);\n        return () => clearTimeout(timeout);\n    }, []);\n\n    const allScreens = [\n        {\n            screenName: screens.MAIN_MENU,\n            Component: MainMenu,\n        },\n        {\n            screenName: screens.CIRCUIT_SELECTION,\n            Component: CircuitSelection,\n        },\n        {\n            screenName: screens.PLAYERS_SELECTION,\n            Component: PlayersSelection,\n        },\n        {\n            screenName: screens.HIGH_SCORES,\n            Component: HighScores,\n        },\n        {\n            screenName: screens.GAME,\n            Component: Game,\n        },\n        {\n            screenName: screens.CREDITS,\n            Component: Credits,\n        },\n        {\n            screenName: screens.LOADING_GAME,\n            Component: LoadingGame,\n        },\n        {\n            screenName: screens.REPLAY_GAME,\n            Component: ReplayGame,\n        },\n        {\n            screenName: screens.TUTORIAL,\n            Component: Tutorial,\n        },\n    ];\n\n    return (\n        <TransitionGroup className=\"menu-screen\">\n            {allScreens\n                .filter(\n                    ({ screenName }) =>\n                        gameReady &&\n                        currentScreenName === screenName.toString(),\n                )\n                .map(({ screenName, Component }) => (\n                    <CSSTransition\n                        key={screenName.toString()}\n                        timeout={STATE_CHANGE_TRANSITION_TIME}\n                        classNames=\"fade\"\n                    >\n                        <Component className=\"\" />\n                    </CSSTransition>\n                ))}\n        </TransitionGroup>\n    );\n}\n\nexport default Router;\n","import React, { useEffect } from 'react';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware } from 'redux';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport thunk from 'redux-thunk';\nimport rootReducer from 'store/rootReducer';\nimport { getSavedPlayers } from 'utils/playersStorage';\nimport { setSelectedPlayers } from 'store/main-ui/actions';\nimport Router from './Router';\nimport './App.css';\n\nconst store = createStore(\n    rootReducer,\n    composeWithDevTools(applyMiddleware(thunk)),\n);\n\nfunction App() {\n    useEffect(() => {\n        restoreSavedConfig({ players: getSavedPlayers() });\n    }, []);\n    return (\n        <Provider store={store}>\n            <Router />\n        </Provider>\n    );\n}\n\nfunction restoreSavedConfig({ players }) {\n    if (players) {\n        store.dispatch(\n            setSelectedPlayers(players.players, players.playerOrder),\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import 'type-defs';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport waitingForPlayerCounter from 'utils/waitingForPlayerCounter';\nimport {\n    init as initGameLoop,\n    addToUpdate as addToGameLoopUpdate,\n} from 'utils/gameLoop';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport addVHCSSVar from './utils/addVhCssVar';\n\n// @ts-ignore\nwindow.capac_racer_version = process.env.REACT_APP_VERSION;\n\nReactDOM.render(<App />, document.getElementById('root'));\n\ninitGameLoop();\naddToGameLoopUpdate((time) => {\n    waitingForPlayerCounter.notifyTimePassed(time);\n});\n\naddVHCSSVar();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import debounce from 'lodash.debounce';\n\nexport default function() {\n    const setVH = () => {\n        const vh = window.innerHeight * 0.01;\n        document.documentElement.style.setProperty('--vh', `${vh}px`);\n    };\n\n    window.addEventListener('resize', debounce(setVH, 200));\n    setVH();\n}\n"],"sourceRoot":""}